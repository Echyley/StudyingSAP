/*! For license information please see smartedit.js.LICENSE.txt */
(()=>{var e={32053:(e,t,n)=>{"use strict";var i=n(68406);var o=n(32709);var s=n(12549);function __decorate(e,t,n,i){var o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s;return o>3&&s&&Object.defineProperty(t,n,s),s}function __metadata(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}(function(){function MerchandisingSmartEditModule(e,t){this.contextualMenuService=e;this.contextualMenuService.addItems({MerchandisingCarouselComponent:[{key:"MerchandisingCarouselComponent",i18nKey:"Edit Strategy",action:{callback:function(e,n){t.get("merchandisingUrl").then(function(e){var t="https://"+e;window.open(t)}.bind(this))}},displayClass:"sap-icon sap-icon--activate"}]})}MerchandisingSmartEditModule=__decorate([s.SeEntryModule("merchandisingsmartedit"),o.NgModule({imports:[i.UpgradeModule],declarations:[],entryComponents:[],providers:[]}),__metadata("design:paramtypes",[s.IContextualMenuService,s.ISharedDataService])],MerchandisingSmartEditModule);return MerchandisingSmartEditModule})()},73720:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=n(30178);var o=n(32709);var s=n(12549);function __decorate(e,t,n,i){var o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s;return o>3&&s&&Object.defineProperty(t,n,s),s}t.PersonalizationPromotionsSmarteditModule=class PersonalizationPromotionsSmarteditModule{};t.PersonalizationPromotionsSmarteditModule=__decorate([s.SeEntryModule("personalizationpromotionssmartedit"),o.NgModule({imports:[i.CommonModule]})],t.PersonalizationPromotionsSmarteditModule)},30520:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=n(30178);var o=n(32709);var s=n(19662);var r=n(47692);var a=n(78471);var l=n(22389);var c=n(12549);var d=n(38788);var p=n(38102);var u=n(51132);var m=n(67564);var h=n(22630);var g=n(66791);function _interopDefaultLegacy(e){return e&&typeof e==="object"&&"default"in e?e:{default:e}}function _interopNamespace(e){if(e&&e.__esModule)return e;var t=Object.create(null);if(e){Object.keys(e).forEach((function(n){if(n!=="default"){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:true,get:function(){return e[n]}})}}))}t["default"]=e;return Object.freeze(t)}var _=_interopDefaultLegacy(u);var v=_interopNamespace(h);function __decorate(e,t,n,i){var o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s;return o>3&&s&&Object.defineProperty(t,n,s),s}function __param(e,t){return function(n,i){t(n,i,e)}}function __metadata(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}function __awaiter(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))}const S={SHORT_DATE_FORMAT:"M/D/YY",MODEL_DATE_FORMAT:"YYYY-MM-DDTHH:mm:SSZ"};const y={ANGULAR_FORMAT:"short",MOMENT_FORMAT:"M/D/YY h:mm A",MOMENT_ISO:"YYYY-MM-DDTHH:mm:00ZZ",ISO:"yyyy-MM-ddTHH:mm:00Z"};t.PERSONALIZATION_MODEL_STATUS_CODES=void 0;(function(e){e["ENABLED"]="ENABLED";e["DISABLED"]="DISABLED";e["DELETED"]="DELETED"})(t.PERSONALIZATION_MODEL_STATUS_CODES||(t.PERSONALIZATION_MODEL_STATUS_CODES={}));const C={ALL:"ALL",ENABLED:"ENABLED",DISABLED:"DISABLED"};const f={0:{borderClass:"personalizationsmarteditComponentSelected0",listClass:"personalizationsmarteditComponentSelectedList0"},1:{borderClass:"personalizationsmarteditComponentSelected1",listClass:"personalizationsmarteditComponentSelectedList1"},2:{borderClass:"personalizationsmarteditComponentSelected2",listClass:"personalizationsmarteditComponentSelectedList2"},3:{borderClass:"personalizationsmarteditComponentSelected3",listClass:"personalizationsmarteditComponentSelectedList3"},4:{borderClass:"personalizationsmarteditComponentSelected4",listClass:"personalizationsmarteditComponentSelectedList4"},5:{borderClass:"personalizationsmarteditComponentSelected5",listClass:"personalizationsmarteditComponentSelectedList5"},6:{borderClass:"personalizationsmarteditComponentSelected6",listClass:"personalizationsmarteditComponentSelectedList6"},7:{borderClass:"personalizationsmarteditComponentSelected7",listClass:"personalizationsmarteditComponentSelectedList7"},8:{borderClass:"personalizationsmarteditComponentSelected8",listClass:"personalizationsmarteditComponentSelectedList8"},9:{borderClass:"personalizationsmarteditComponentSelected9",listClass:"personalizationsmarteditComponentSelectedList9"},10:{borderClass:"personalizationsmarteditComponentSelected10",listClass:"personalizationsmarteditComponentSelectedList10"},11:{borderClass:"personalizationsmarteditComponentSelected11",listClass:"personalizationsmarteditComponentSelectedList11"},12:{borderClass:"personalizationsmarteditComponentSelected12",listClass:"personalizationsmarteditComponentSelectedList12"},13:{borderClass:"personalizationsmarteditComponentSelected13",listClass:"personalizationsmarteditComponentSelectedList13"},14:{borderClass:"personalizationsmarteditComponentSelected14",listClass:"personalizationsmarteditComponentSelectedList14"}};const E="personalizationsmartedit.container.combinedview.toolbar";const I="personalizationsmartedit.container.pagecustomizations.toolbar";const b={OLD:"old",NEW:"new",DELETE:"delete",UPDATE:"update"};const T={ALL:"all",ONLY_THIS_PAGE:"onlythispage"};const O={ALL:"all",CURRENT:"current",PARENTS:"parents"};const P="CxCmsComponentContainer";const w="data-smartedit-container-source-id";const A={BASIC_INFO_TAB_NAME:"basicinfotab",BASIC_INFO_TAB_FORM_NAME:"form.basicinfotab",TARGET_GROUP_TAB_NAME:"targetgrptab",TARGET_GROUP_TAB_FORM_NAME:"form.targetgrptab"};const R={CONFIRM_OK:"confirmOk",CONFIRM_CANCEL:"confirmCancel",CONFIRM_NEXT:"confirmNext"};const D={CRITERIA_AND:"AND",CRITERIA_OR:"OR"};t.PersonalizationsmarteditDateUtils=class PersonalizationsmarteditDateUtils{constructor(e){this.translateService=e}formatDate(e,t){t=t||y.MOMENT_FORMAT;if(e){if(e.match&&e.match(/^(\d{4})\-(\d{2})\-(\d{2})T(\d{2}):(\d{2}):(\d{2})(\+|\-)(\d{4})$/)){e=`${e.slice(0,-2)}:${e.slice(-2)}`}return _["default"](new Date(e)).format(t)}else{return""}}formatDateWithMessage(e,t){t=t||S.SHORT_DATE_FORMAT;if(e){return this.formatDate(e,t)}else{return this.translateService.instant("personalization.toolbar.pagecustomizations.nodatespecified")}}isDateInThePast(e){if(c.stringUtils.isBlank(e)){return false}else{return _["default"](e,y.MOMENT_FORMAT).isBefore()}}isDateValidOrEmpty(e){return c.stringUtils.isBlank(e)||this.isDateValid(e)}isDateValid(e){return _["default"](e,y.MOMENT_FORMAT).isValid()}isDateRangeValid(e,t){if(c.stringUtils.isBlank(e)||c.stringUtils.isBlank(t)){return true}else{return _["default"](new Date(e)).isSameOrBefore(_["default"](new Date(t)))}}isDateStrFormatValid(e,t){t=t||y.MOMENT_FORMAT;if(c.stringUtils.isBlank(e)){return false}else{return _["default"](e,t,true).isValid()}}};t.PersonalizationsmarteditDateUtils=__decorate([o.Injectable(),__metadata("design:paramtypes",[p.TranslateService])],t.PersonalizationsmarteditDateUtils);window.__smartedit__.addDecoratorPayload("Component","DatetimePickerRangeComponent",{selector:"datetime-picker-range",template:`<fd-layout-grid class="pe-datetime-range"><div [fdLayoutGridCol]="6" class="pe-datetime-range__from" [ngClass]="{ 'has-error': !isFromDateValid }"><label for="pe-start-date" fd-form-label class="perso__datetimepicker__label">{{ 'personalization.modal.customizationvariationmanagement.basicinformationtab.details.startdate' | translate }}</label><se-help><span translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.startdate.help"></span></se-help><fd-datetime-picker [allowNull]="true" id="pe-start-date" name="pe-dateFrom" [placeholder]="placeholderText | translate" [disabled]="!isEditable" [(ngModel)]="fdDateFrom" (ngModelChange)="dateFromOnChange(fdDateFrom)"></fd-datetime-picker><span *ngIf="!isFromDateValid" class="pe-datetime__error-msg pe-datetime__msg" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.wrongdateformatfrom.description"></span></div><div [fdLayoutGridCol]="6" class="pe-datetime-range__to" [ngClass]="{ 'has-error': !isToDateValid, 'has-warning': isEndDateInThePast }"><label for="pe-end-date" fd-form-label class="perso__datetimepicker__label">{{ 'personalization.modal.customizationvariationmanagement.basicinformationtab.details.enddate' | translate }}</label><se-help><span translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.enddate.help"></span></se-help><fd-datetime-picker [allowNull]="true" id="pe-end-date" name="pe-dateTo" [placeholder]="placeholderText | translate" [disabled]="!isEditable" [(ngModel)]="fdDateTo" (ngModelChange)="dateToOnChange(fdDateTo)"></fd-datetime-picker><span *ngIf="!isToDateValid" class="pe-datetime__error-msg pe-datetime__msg" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.wrongdateformatfrom.description"></span> <span *ngIf="isEndDateInThePast" class="help-block pe-datetime__warning-msg pe-datetime__msg"><span translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.enddateinthepast.description"></span></span></div></fd-layout-grid>`,changeDetection:o.ChangeDetectionStrategy.OnPush});t.DatetimePickerRangeComponent=class DatetimePickerRangeComponent{constructor(e,t){this.dateUtil=e;this.cdr=t;this.placeholderText="personalization.commons.datetimepicker.placeholder";this.dateFromChange=new o.EventEmitter;this.dateToChange=new o.EventEmitter;this.isFromDateValid=true;this.isToDateValid=true;this.isEndDateInThePast=false}ngAfterViewInit(){this._initDateTime()}dateFromOnChange(e){if(!!e){this.isFromDateValid=e.isDateValid();this.dateFrom=this.dateUtil.formatDate(e.toString(),undefined)}else{this.isFromDateValid=true;this.dateFrom=""}this.dateFromChange.emit(this.dateFrom)}dateToOnChange(e){if(!!e){this.isToDateValid=e.isDateValid();this.dateTo=this.dateUtil.formatDate(e.toString(),undefined)}else{this.isToDateValid=true;this.dateTo=""}this.isEndDateInThePast=this.dateUtil.isDateInThePast(this.dateTo);this.dateToChange.emit(this.dateTo)}_initDateTime(){if(!!this.dateFrom){this.fdDateFrom=d.FdDate.getFdDateByDate(new Date(this.dateFrom))}else{this.fdDateFrom=d.FdDate.getToday();this.dateFromOnChange(this.fdDateFrom)}if(!!this.dateTo){this.fdDateTo=d.FdDate.getFdDateByDate(new Date(this.dateTo))}else{this.fdDateTo=d.FdDate.getToday();this.dateToOnChange(this.fdDateTo)}this.cdr.detectChanges()}};__decorate([o.Input(),__metadata("design:type",String)],t.DatetimePickerRangeComponent.prototype,"dateFrom",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.DatetimePickerRangeComponent.prototype,"dateTo",void 0);__decorate([o.Input(),__metadata("design:type",Boolean)],t.DatetimePickerRangeComponent.prototype,"isEditable",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.DatetimePickerRangeComponent.prototype,"dateFromChange",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.DatetimePickerRangeComponent.prototype,"dateToChange",void 0);t.DatetimePickerRangeComponent=__decorate([o.Component({selector:"datetime-picker-range",template:`<fd-layout-grid class="pe-datetime-range"><div [fdLayoutGridCol]="6" class="pe-datetime-range__from" [ngClass]="{ 'has-error': !isFromDateValid }"><label for="pe-start-date" fd-form-label class="perso__datetimepicker__label">{{ 'personalization.modal.customizationvariationmanagement.basicinformationtab.details.startdate' | translate }}</label><se-help><span translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.startdate.help"></span></se-help><fd-datetime-picker [allowNull]="true" id="pe-start-date" name="pe-dateFrom" [placeholder]="placeholderText | translate" [disabled]="!isEditable" [(ngModel)]="fdDateFrom" (ngModelChange)="dateFromOnChange(fdDateFrom)"></fd-datetime-picker><span *ngIf="!isFromDateValid" class="pe-datetime__error-msg pe-datetime__msg" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.wrongdateformatfrom.description"></span></div><div [fdLayoutGridCol]="6" class="pe-datetime-range__to" [ngClass]="{ 'has-error': !isToDateValid, 'has-warning': isEndDateInThePast }"><label for="pe-end-date" fd-form-label class="perso__datetimepicker__label">{{ 'personalization.modal.customizationvariationmanagement.basicinformationtab.details.enddate' | translate }}</label><se-help><span translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.enddate.help"></span></se-help><fd-datetime-picker [allowNull]="true" id="pe-end-date" name="pe-dateTo" [placeholder]="placeholderText | translate" [disabled]="!isEditable" [(ngModel)]="fdDateTo" (ngModelChange)="dateToOnChange(fdDateTo)"></fd-datetime-picker><span *ngIf="!isToDateValid" class="pe-datetime__error-msg pe-datetime__msg" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.wrongdateformatfrom.description"></span> <span *ngIf="isEndDateInThePast" class="help-block pe-datetime__warning-msg pe-datetime__msg"><span translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.enddateinthepast.description"></span></span></div></fd-layout-grid>`,changeDetection:o.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[t.PersonalizationsmarteditDateUtils,o.ChangeDetectorRef])],t.DatetimePickerRangeComponent);t.DatetimePickerRangeModule=class DatetimePickerRangeModule{};t.DatetimePickerRangeModule=__decorate([o.NgModule({imports:[i.CommonModule,s.FormsModule,a.FormModule,c.SeTranslationModule.forChild(),c.HelpModule,r.DatetimePickerModule,l.LayoutGridModule],declarations:[t.DatetimePickerRangeComponent],entryComponents:[t.DatetimePickerRangeComponent],exports:[t.DatetimePickerRangeComponent]})],t.DatetimePickerRangeModule);t.PersonalizationInfiniteScrollDirective=class PersonalizationInfiniteScrollDirective{constructor(e){this.element=e;this.scrollPercent=75;this.onScrollAction=new o.EventEmitter}ngOnInit(){this.scrollEvent=m.fromEvent(this.element.nativeElement,"scroll");this.subscription=this.scrollEvent.subscribe((e=>{if((e.target.scrollTop+e.target.offsetHeight)/e.target.scrollHeight>this.scrollPercent/100){this.onScrollAction.emit(null)}}))}ngOnDestroy(){if(this.subscription){this.subscription.unsubscribe()}}};__decorate([o.Input(),__metadata("design:type",Object)],t.PersonalizationInfiniteScrollDirective.prototype,"scrollPercent",void 0);__decorate([o.Output(),__metadata("design:type",Object)],t.PersonalizationInfiniteScrollDirective.prototype,"onScrollAction",void 0);t.PersonalizationInfiniteScrollDirective=__decorate([o.Directive({selector:"[persoInfiniteScroll]"}),__param(0,o.Inject(o.ElementRef)),__metadata("design:paramtypes",[o.ElementRef])],t.PersonalizationInfiniteScrollDirective);window.__smartedit__.addDecoratorPayload("Component","PersonalizationsmarteditInfiniteScrollingComponent",{selector:"personalization-infinite-scrolling",template:`<div [ngClass]="dropDownContainerClass" persoInfiniteScroll (onScrollAction)="nextPage()" [scrollPercent]="distance" *ngIf="initiated"><div [ngClass]="dropDownClass"><ng-content></ng-content></div></div>`});t.PersonalizationsmarteditInfiniteScrollingComponent=class PersonalizationsmarteditInfiniteScrollingComponent{constructor(){this.distance=80;this.initiated=false}ngOnInit(){this.init()}ngOnChanges(){this.init()}nextPage(){this.fetchPage()}init(){const e=this.initiated;this.initiated=true;if(e){this.nextPage()}}};__decorate([o.Input(),__metadata("design:type",String)],t.PersonalizationsmarteditInfiniteScrollingComponent.prototype,"dropDownContainerClass",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.PersonalizationsmarteditInfiniteScrollingComponent.prototype,"dropDownClass",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.PersonalizationsmarteditInfiniteScrollingComponent.prototype,"distance",void 0);__decorate([o.Input(),__metadata("design:type",Function)],t.PersonalizationsmarteditInfiniteScrollingComponent.prototype,"fetchPage",void 0);t.PersonalizationsmarteditInfiniteScrollingComponent=__decorate([o.Component({selector:"personalization-infinite-scrolling",template:`<div [ngClass]="dropDownContainerClass" persoInfiniteScroll (onScrollAction)="nextPage()" [scrollPercent]="distance" *ngIf="initiated"><div [ngClass]="dropDownClass"><ng-content></ng-content></div></div>`})],t.PersonalizationsmarteditInfiniteScrollingComponent);window.__smartedit__.addDecoratorPayload("Component","PersonalizationPreventParentScrollComponent",{selector:"personalization-prevent-parent-scroll",template:`<div persoPreventParentScroll><ng-content></ng-content></div>`});t.PersonalizationPreventParentScrollComponent=class PersonalizationPreventParentScrollComponent{};t.PersonalizationPreventParentScrollComponent=__decorate([o.Component({selector:"personalization-prevent-parent-scroll",template:`<div persoPreventParentScroll><ng-content></ng-content></div>`})],t.PersonalizationPreventParentScrollComponent);t.PersonalizationPreventParentScrollDirective=class PersonalizationPreventParentScrollDirective{constructor(e){this.element=e;this.mouseWheelEventHandler=e=>this.onMouseWheel(e)}ngOnInit(){const e=this.element.nativeElement;e.addEventListener("mousewheel",this.mouseWheelEventHandler);e.addEventListener("DOMMouseScroll",this.mouseWheelEventHandler)}ngOnDestroy(){const e=this.element.nativeElement;e.removeEventListener("mousewheel",this.mouseWheelEventHandler);e.removeEventListener("DOMMouseScroll",this.mouseWheelEventHandler)}onMouseWheel(e){const t=this.element.nativeElement;const n=e.originalEvent&&(e.originalEvent.wheelDeltaY||e.originalEvent.wheelDelta);const i=-(e.deltaY||e.delta)||0;t.parentElement.parentElement.parentElement.scrollTop-=e.wheelDeltaY||n||e.wheelDelta||i;e.stopPropagation();e.preventDefault();e.returnValue=false}};t.PersonalizationPreventParentScrollDirective=__decorate([o.Directive({selector:"[persoPreventParentScroll]"}),__param(0,o.Inject(o.ElementRef)),__metadata("design:paramtypes",[o.ElementRef])],t.PersonalizationPreventParentScrollDirective);window.__smartedit__.addDecoratorPayload("Component","ScrollZoneComponent",{selector:"personalizationsmartedit-scroll-zone",template:`<ng-template #scrollZoneBody><personalizationsmartedit-scroll-zone-body-container><personalizationsmartedit-scroll-zone-body [hidden]="!scrollZoneTop" [isTransparent]="isTransparent" [additionalClasses]="['perso__scrollzone--top']" (scrollZoneBodyMouseenter)="onScrollTopMouseenter()" (scrollZoneBodyMouseleave)="stopScroll()"></personalizationsmartedit-scroll-zone-body><personalizationsmartedit-scroll-zone-body [hidden]="!scrollZoneBottom" [isTransparent]="isTransparent" [additionalClasses]="['perso__scrollzone--bottom']" (scrollZoneBodyMouseenter)="onScrollBottomMouseenter()" (scrollZoneBodyMouseleave)="stopScroll()"></personalizationsmartedit-scroll-zone-body></personalizationsmartedit-scroll-zone-body-container></ng-template>`});t.ScrollZoneComponent=class ScrollZoneComponent{constructor(e,t){this.viewContainerRef=e;this.document=t;this.scrollZoneTop=false;this.scrollZoneBottom=false;this.scrollZoneVisible=false;this.isTransparent=false}ngAfterViewInit(){if(this.scrollZoneVisible){this.createScrollZoneBody()}}ngOnChanges(e){const t=e.scrollZoneVisible;if(t&&!t.firstChange){if(t.currentValue){this.createScrollZoneBody()}else{this.destroyScrollZoneBody()}}}ngOnDestroy(){this.destroyScrollZoneBody()}onScrollTopMouseenter(){this.isScrolling=true;this.scrollTop()}onScrollBottomMouseenter(){this.isScrolling=true;this.scrollBottom()}stopScroll(){this.isScrolling=false;clearTimeout(this.scrollZoneTopTimeout);clearTimeout(this.scrollZoneBottomTimeout)}scrollTop(){if(!this.isScrolling){clearTimeout(this.scrollZoneTopTimeout);return}this.scrollZoneTop=this.elementToScroll.scrollTop()<=2?false:true;this.scrollZoneBottom=true;this.elementToScroll.scrollTop(this.elementToScroll.scrollTop()-15);this.scrollZoneTopTimeout=setTimeout((()=>{this.scrollTop()}),100)}scrollBottom(){if(!this.isScrolling){clearTimeout(this.scrollZoneBottomTimeout);return}this.scrollZoneTop=true;const e=this.elementToScroll.get(0).scrollHeight-this.elementToScroll.scrollTop();this.scrollZoneBottom=Math.abs(e-this.elementToScroll.outerHeight())<2?false:true;this.elementToScroll.scrollTop(this.elementToScroll.scrollTop()+15);this.scrollZoneBottomTimeout=setTimeout((()=>{this.scrollBottom()}),100)}createScrollZoneBody(){if(this.viewRef){return}this.viewRef=this.viewContainerRef.createEmbeddedView(this.scrollZoneBody);const e=this.viewRef.rootNodes[0];this.document.body.appendChild(e);this.scrollZoneTop=true;this.scrollZoneBottom=true}destroyScrollZoneBody(){if(!this.viewRef){return}this.viewRef.destroy();this.viewRef=null}};__decorate([o.Input(),__metadata("design:type",Boolean)],t.ScrollZoneComponent.prototype,"scrollZoneVisible",void 0);__decorate([o.Input(),__metadata("design:type",Boolean)],t.ScrollZoneComponent.prototype,"isTransparent",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.ScrollZoneComponent.prototype,"elementToScroll",void 0);__decorate([o.ViewChild("scrollZoneBody",{static:true}),__metadata("design:type",o.TemplateRef)],t.ScrollZoneComponent.prototype,"scrollZoneBody",void 0);t.ScrollZoneComponent=__decorate([o.Component({selector:"personalizationsmartedit-scroll-zone",template:`<ng-template #scrollZoneBody><personalizationsmartedit-scroll-zone-body-container><personalizationsmartedit-scroll-zone-body [hidden]="!scrollZoneTop" [isTransparent]="isTransparent" [additionalClasses]="['perso__scrollzone--top']" (scrollZoneBodyMouseenter)="onScrollTopMouseenter()" (scrollZoneBodyMouseleave)="stopScroll()"></personalizationsmartedit-scroll-zone-body><personalizationsmartedit-scroll-zone-body [hidden]="!scrollZoneBottom" [isTransparent]="isTransparent" [additionalClasses]="['perso__scrollzone--bottom']" (scrollZoneBodyMouseenter)="onScrollBottomMouseenter()" (scrollZoneBodyMouseleave)="stopScroll()"></personalizationsmartedit-scroll-zone-body></personalizationsmartedit-scroll-zone-body-container></ng-template>`}),__param(1,o.Inject(i.DOCUMENT)),__metadata("design:paramtypes",[o.ViewContainerRef,Document])],t.ScrollZoneComponent);window.__smartedit__.addDecoratorPayload("Component","ScrollZoneBodyComponent",{selector:"personalizationsmartedit-scroll-zone-body",template:`<div class="perso__scrollzone" [ngClass]="cssClasses" (mouseenter)="onMouseenter()" (mouseleave)="onMouseleave()"></div>`,changeDetection:o.ChangeDetectionStrategy.OnPush});let M=class ScrollZoneBodyComponent{constructor(){this.additionalClasses=[];this.isTransparent=false;this.scrollZoneBodyMouseenter=new o.EventEmitter;this.scrollZoneBodyMouseleave=new o.EventEmitter;this.cssClasses=[]}ngOnChanges(){this.cssClasses=this.getCssClasses(this.isTransparent,this.additionalClasses||[])}onMouseenter(){this.scrollZoneBodyMouseenter.emit()}onMouseleave(){this.scrollZoneBodyMouseleave.emit()}getCssClasses(e,t){const n=e?"perso__scrollzone--transparent":"perso__scrollzone--normal";return[n,...t]}};__decorate([o.Input(),__metadata("design:type",Array)],M.prototype,"additionalClasses",void 0);__decorate([o.Input(),__metadata("design:type",Boolean)],M.prototype,"isTransparent",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],M.prototype,"scrollZoneBodyMouseenter",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],M.prototype,"scrollZoneBodyMouseleave",void 0);M=__decorate([o.Component({selector:"personalizationsmartedit-scroll-zone-body",template:`<div class="perso__scrollzone" [ngClass]="cssClasses" (mouseenter)="onMouseenter()" (mouseleave)="onMouseleave()"></div>`,changeDetection:o.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[])],M);window.__smartedit__.addDecoratorPayload("Component","ScrollZoneBodyContainerComponent",{selector:"personalizationsmartedit-scroll-zone-body-container",template:`<ng-content></ng-content>`,changeDetection:o.ChangeDetectionStrategy.OnPush});let N=class ScrollZoneBodyContainerComponent{};N=__decorate([o.Component({selector:"personalizationsmartedit-scroll-zone-body-container",template:`<ng-content></ng-content>`,changeDetection:o.ChangeDetectionStrategy.OnPush})],N);t.ScrollZoneModule=class ScrollZoneModule{};t.ScrollZoneModule=__decorate([o.NgModule({imports:[i.CommonModule,c.TranslationModule.forChild()],providers:[],declarations:[t.ScrollZoneComponent,N,M],entryComponents:[t.ScrollZoneComponent],exports:[M,t.ScrollZoneComponent]})],t.ScrollZoneModule);class IPersonalizationsmarteditContextMenuServiceProxy{openDeleteAction(e){"proxyFunction";return undefined}openAddAction(e){"proxyFunction";return undefined}openEditAction(e){"proxyFunction";return undefined}openEditComponentAction(e){"proxyFunction";return undefined}}class IPersonalizationsmarteditContextServiceProxy{setPersonalization(e){"proxyFunction";return undefined}setCustomize(e){"proxyFunction";return undefined}setCombinedView(e){"proxyFunction";return undefined}setSeData(e){"proxyFunction";return undefined}}class PaginationHelper{constructor(e={}){this.count=e.count||0;this.page=e.page||0;this.totalCount=e.totalCount||0;this.totalPages=e.totalPages||0}reset(){this.count=50;this.page=-1;this.totalPages=1;this.totalCount=0}getCount(){return this.count}getPage(){return this.page}getTotalCount(){return this.totalCount}getTotalPages(){return this.totalPages}isLastPage(){return this.getPage()===this.getTotalPages()}}class PersonalizationsmarteditCommerceCustomizationService{constructor(){this.nonCommerceActionTypes=["cxCmsActionData"];this.types=[]}isNonCommerceAction(e){return this.nonCommerceActionTypes.some((t=>t===e.type))}isCommerceAction(e){return!this.isNonCommerceAction(e)}isTypeEnabled(e,t){return t!==undefined&&t!==null&&t[e.confProperty]===true}registerType(e){const t=e.type;let n=false;this.types.forEach((e=>{if(e.type===t){n=true}}));if(!n){this.types.push(e)}}getAvailableTypes(e){return this.types.filter((t=>this.isTypeEnabled(t,e)))}isCommerceCustomizationEnabled(e){const t=this.getAvailableTypes(e);return t.length>0}getNonCommerceActionsCount(e){return(e.actions||[]).filter(this.isNonCommerceAction,this).length}getCommerceActionsCountMap(e){const t={};(e.actions||[]).filter(this.isCommerceAction,this).forEach((e=>{const n=e.type.toLowerCase();let i=t[n];if(i===undefined){i=1}else{i+=1}t[n]=i}));return t}getCommerceActionsCount(e){return(e.actions||[]).filter(this.isCommerceAction,this).length}}t.PersonalizationsmarteditMessageHandler=class PersonalizationsmarteditMessageHandler{constructor(e){this.alertService=e}sendInformation(e){this.alertService.showInfo(e)}sendError(e){this.alertService.showDanger(e)}sendWarning(e){this.alertService.showWarning(e)}sendSuccess(e){this.alertService.showSuccess(e)}};t.PersonalizationsmarteditMessageHandler=__decorate([o.Injectable(),__metadata("design:paramtypes",[c.IAlertService])],t.PersonalizationsmarteditMessageHandler);t.PersonalizationsmarteditUtils=class PersonalizationsmarteditUtils{constructor(e,t,n){this.translateService=e;this.l10nPipe=t;this.catalogService=n}pushToArrayIfValueExists(e,t,n){if(n){e.push({key:t,value:n})}}getVariationCodes(e){if(typeof e===undefined||e===null){return[]}const t=e.map((e=>e.code)).filter((e=>typeof e!=="undefined"));return t}getVariationKey(e,t){if(e===undefined||t===undefined){return[]}const n=t.map((t=>({variationCode:t.code,customizationCode:e,catalog:t.catalog,catalogVersion:t.catalogVersion})));return n}getSegmentTriggerForVariation(e){const t=e.triggers||[];const n=t.filter((e=>e.type==="segmentTriggerData"));if(n.length===0){return{}}return n[0]}isPersonalizationItemEnabled(e){return e.status===t.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED}getEnablementTextForCustomization(e,t){t=t||"personalization";if(this.isPersonalizationItemEnabled(e)){return this.translateService.instant(t+".customization.enabled")}else{return this.translateService.instant(t+".customization.disabled")}}getEnablementTextForVariation(e,t){t=t||"personalization";if(this.isPersonalizationItemEnabled(e)){return this.translateService.instant(t+".variation.enabled")}else{return this.translateService.instant(t+".variation.disabled")}}getEnablementActionTextForVariation(e,t){t=t||"personalization";if(this.isPersonalizationItemEnabled(e)){return this.translateService.instant(t+".variation.options.disable")}else{return this.translateService.instant(t+".variation.options.enable")}}getActivityStateForCustomization(e){if(e.status===t.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED){const t=new Date(e.enabledStartDate);const n=new Date(e.enabledEndDate);const i=_["default"](t).isValid();const o=_["default"](n).isValid();if(!i&&!o||i&&!o&&_["default"]().isAfter(t,"minute")||!i&&o&&_["default"]().isBefore(n,"minute")||_["default"]().isBetween(t,n,"minute","[]")){return"perso__status--enabled"}else{return"perso__status--ignore"}}else{return"perso__status--disabled"}}getActivityStateForVariation(e,t){if(t.enabled){return this.getActivityStateForCustomization(e)}else{return"perso__status--disabled"}}isItemVisible(e){return e.status!==t.PERSONALIZATION_MODEL_STATUS_CODES.DELETED}getVisibleItems(e){return e.filter((e=>this.isItemVisible(e)))}getValidRank(e,t,n){const i=e.indexOf(t);const o=n<0?-1:1;let s=i+n;while(s>=0&&s<e.length&&!this.isItemVisible(e[s])){s+=o}s=s>=e.length?e.length-1:s;s=s<0?0:s;return e[s].rank}getStatusesMapping(){const e=[];e.push({code:C.ALL,text:"personalization.context.status.all",modelStatuses:[t.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED,t.PERSONALIZATION_MODEL_STATUS_CODES.DISABLED]});e.push({code:C.ENABLED,text:"personalization.context.status.enabled",modelStatuses:[t.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED]});e.push({code:C.DISABLED,text:"personalization.context.status.disabled",modelStatuses:[t.PERSONALIZATION_MODEL_STATUS_CODES.DISABLED]});return e}getClassForElement(e){const t=e%Object.keys(f).length;return f[t].listClass}getLetterForElement(e){const t=e%Object.keys(f).length;return String.fromCharCode("a".charCodeAt(0)+t).toUpperCase()}getCommerceCustomizationTooltip(e,t,n){t=t||"";n=n||"\n";let i="";v.forEach(e.commerceCustomizations,((e,o)=>{i+=t+this.translateService.instant("personalization.modal.manager.commercecustomization."+o)+": "+e+n}));return i}getCommerceCustomizationTooltipHTML(e){return this.getCommerceCustomizationTooltip(e,"<div>","</div>")}isItemFromCurrentCatalog(e,t){const n=t.seExperienceData.catalogDescriptor;return e.catalog===n.catalogId&&e.catalogVersion===n.catalogVersion}hasCommerceActions(e){return e.numberOfCommerceActions>0}getCatalogVersionNameByUuid(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.catalogService.getCatalogVersionByUuid(e);let n=yield this.l10nPipe.transform(t.catalogName).pipe(g.take(1)).toPromise();n=n+" ("+t.version+")";return n}))}getAndSetCatalogVersionNameL10N(e){return __awaiter(this,void 0,void 0,(function*(){e.catalogVersionNameL10N=yield this.getCatalogVersionNameByUuid(e.catalog+"/"+e.catalogVersion)}))}uniqueArray(e,t,n){n=n||"code";t.forEach((t=>{if(!e.some((e=>e[n]===t[n]))){e.push(t)}}));return e}};t.PersonalizationsmarteditUtils=__decorate([o.Injectable(),__metadata("design:paramtypes",[p.TranslateService,c.L10nPipe,c.ICatalogService])],t.PersonalizationsmarteditUtils);class Customize{constructor(){this.enabled=false;this.selectedCustomization=null;this.selectedVariations=null;this.selectedComponents=null}}class CombinedView{constructor(){this.enabled=false;this.selectedItems=null;this.customize=new Customize}}class Personalization{constructor(){this.enabled=false}}class SeData{constructor(){this.pageId=null;this.seExperienceData=null;this.seConfigurationData=null}}t.PersonalizationsmarteditContextUtils=class PersonalizationsmarteditContextUtils{getContextObject(){return{personalization:new Personalization,customize:new Customize,combinedView:new CombinedView,seData:new SeData}}clearCustomizeContext(e){const t=e.getCustomize();t.enabled=false;t.selectedCustomization=null;t.selectedVariations=null;t.selectedComponents=null;e.setCustomize(t)}clearCustomizeContextAndReloadPreview(e,t){const n=h.cloneDeep(t.getCustomize().selectedVariations);this.clearCustomizeContext(t);if(h.isObject(n)&&!h.isArray(n)){e.removePersonalizationDataFromPreview()}}clearCombinedViewCustomizeContext(e){const t=e.getCombinedView();t.customize.enabled=false;t.customize.selectedCustomization=null;t.customize.selectedVariations=null;t.customize.selectedComponents=null;if(h.isArray(t.selectedItems)){t.selectedItems.forEach((e=>{delete e.highlighted}))}e.setCombinedView(t)}clearCombinedViewContext(e){const t=e.getCombinedView();t.enabled=false;t.selectedItems=null;e.setCombinedView(t)}clearCombinedViewContextAndReloadPreview(e,t){const n=h.cloneDeep(t.getCombinedView().enabled);const i=h.cloneDeep(t.getCombinedView().selectedItems);this.clearCombinedViewContext(t);if(n&&i){e.removePersonalizationDataFromPreview()}}};t.PersonalizationsmarteditContextUtils=__decorate([o.Injectable()],t.PersonalizationsmarteditContextUtils);t.PersonalizationsmarteditCommonsComponentsModule=class PersonalizationsmarteditCommonsComponentsModule{};t.PersonalizationsmarteditCommonsComponentsModule=__decorate([o.NgModule({imports:[c.TranslationModule.forChild(),i.CommonModule,c.L10nPipeModule,t.DatetimePickerRangeModule,t.ScrollZoneModule],providers:[{provide:"PaginationHelper",useFactory:()=>e=>new PaginationHelper(e)},c.L10nPipe,t.PersonalizationsmarteditUtils,t.PersonalizationsmarteditDateUtils,t.PersonalizationsmarteditContextUtils,t.PersonalizationsmarteditMessageHandler,PersonalizationsmarteditCommerceCustomizationService],declarations:[t.PersonalizationInfiniteScrollDirective,t.PersonalizationPreventParentScrollDirective,t.PersonalizationsmarteditInfiniteScrollingComponent,t.PersonalizationPreventParentScrollComponent],entryComponents:[t.PersonalizationsmarteditInfiniteScrollingComponent,t.PersonalizationPreventParentScrollComponent],exports:[t.PersonalizationInfiniteScrollDirective,t.PersonalizationPreventParentScrollDirective,t.PersonalizationsmarteditInfiniteScrollingComponent,t.PersonalizationPreventParentScrollComponent]})],t.PersonalizationsmarteditCommonsComponentsModule);var x;t.BaseSiteHeaderInterceptor=x=class BaseSiteHeaderInterceptor{constructor(e){this.sharedDataService=e}intercept(e,t){if(x.PERSONALIZATION_ENDPOINT.test(e.url)){return m.from(this.sharedDataService.get("experience")).pipe(g.switchMap((n=>{if(n.catalogDescriptor.siteId){const i=e.clone({headers:e.headers.set(x.HEADER_NAME,n.catalogDescriptor.siteId)});return t.handle(i)}return t.handle(e)})))}else{return t.handle(e)}}};t.BaseSiteHeaderInterceptor.HEADER_NAME="Basesite";t.BaseSiteHeaderInterceptor.PERSONALIZATION_ENDPOINT=/\/personalizationwebservices/;t.BaseSiteHeaderInterceptor=x=__decorate([o.Injectable(),__metadata("design:paramtypes",[c.ISharedDataService])],t.BaseSiteHeaderInterceptor);t.TriggerActionId=void 0;(function(e){e["AND"]="AND";e["OR"]="OR";e["NOT"]="NOT"})(t.TriggerActionId||(t.TriggerActionId={}));t.TriggerType=void 0;(function(e){e["DEFAULT_TRIGGER"]="defaultTriggerData";e["SEGMENT_TRIGGER"]="segmentTriggerData";e["EXPRESSION_TRIGGER"]="expressionTriggerData";e["GROUP_EXPRESSION"]="groupExpressionData";e["SEGMENT_EXPRESSION"]="segmentExpressionData";e["NEGATION_EXPRESSION"]="negationExpressionData";e["CONTAINER_TYPE"]="container";e["ITEM_TYPE"]="item";e["DROPZONE_TYPE"]="dropzone"})(t.TriggerType||(t.TriggerType={}));const F=new o.InjectionToken("PERSONLIZATION_SEARCH_EXTENSION_TOKEN");const L=new o.InjectionToken("PERSONLIZATION_SEARCH_EXTENSION_INJECTOR_TOKEN");const U=new o.InjectionToken("PERSONLIZATION_PROMOTION_EXTENSION_TOKEN");const k=new o.InjectionToken("PERSONLIZATION_PROMOTION_EXTENSION_INJECTOR_TOKEN");t.COMBINED_VIEW_TOOLBAR_ITEM_KEY=E;t.COMPONENT_CONTAINER_TYPE=P;t.CONTAINER_SOURCE_ID_ATTR=w;t.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS=R;t.CUSTOMIZATION_VARIATION_MANAGEMENT_SEGMENTTRIGGER_GROUPBY=D;t.CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS=A;t.CUSTOMIZE_VIEW_TOOLBAR_ITEM_KEY=I;t.CombinedView=CombinedView;t.Customize=Customize;t.DATE_CONSTANTS=y;t.IPersonalizationsmarteditContextMenuServiceProxy=IPersonalizationsmarteditContextMenuServiceProxy;t.IPersonalizationsmarteditContextServiceProxy=IPersonalizationsmarteditContextServiceProxy;t.PERSONALIZATION_CATALOG_FILTER=O;t.PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING=f;t.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES=b;t.PERSONALIZATION_CUSTOMIZATION_PAGE_FILTER=T;t.PERSONALIZATION_DATE_FORMATS=S;t.PERSONALIZATION_VIEW_STATUS_MAPPING_CODES=C;t.PERSONLIZATION_PROMOTION_EXTENSION_INJECTOR_TOKEN=k;t.PERSONLIZATION_PROMOTION_EXTENSION_TOKEN=U;t.PERSONLIZATION_SEARCH_EXTENSION_INJECTOR_TOKEN=L;t.PERSONLIZATION_SEARCH_EXTENSION_TOKEN=F;t.PaginationHelper=PaginationHelper;t.Personalization=Personalization;t.PersonalizationsmarteditCommerceCustomizationService=PersonalizationsmarteditCommerceCustomizationService;t.SeData=SeData},65545:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=n(54526);var o=n(32709);var s=n(9501);var r=n(30520);var a=n(12549);var l=n(22630);var c=n(38102);var d=n(30178);function __decorate(e,t,n,i){var o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s;return o>3&&s&&Object.defineProperty(t,n,s),s}function __param(e,t){return function(n,i){t(n,i,e)}}function __metadata(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}function __awaiter(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))}const p="CURRENT_PAGE_CONTEXT_CATALOG";const u="CURRENT_PAGE_CONTEXT_CATALOG_VERSION";const m="/personalizationwebservices/v1/catalogs/:catalogId/catalogVersions/:catalogVersion/actions";const h=`/cmswebservices/v1/sites/${a.PAGE_CONTEXT_SITE_ID}/catalogs/${p}/versions/${u}/pagescontentslots`;let g=class PersonalizationsmarteditComponentHandlerService{constructor(e,t,n,i,o){this.crossFrameEventService=t;this.yjQuery=n;this.componentHandlerService=i;this.pageInfoService=o;this.resource=e.get(h);this.crossFrameEventService.subscribe(a.EVENTS.PAGE_CHANGE,(()=>this.reloadPageContentSlots()))}getParentContainerForComponent(e){const t=e.closest(`[${a.CONTAINER_TYPE_ATTRIBUTE}=${r.COMPONENT_CONTAINER_TYPE}]`);return t}getParentContainerIdForComponent(e){const t=e.closest(`[${a.CONTAINER_TYPE_ATTRIBUTE}=${r.COMPONENT_CONTAINER_TYPE}]`);return t.attr(a.CONTAINER_ID_ATTRIBUTE)}getPageContentSlots(){return __awaiter(this,void 0,void 0,(function*(){if(!this.pageContentSlots){yield this.reloadPageContentSlots()}return this.pageContentSlots}))}getParentContainerSourceIdForComponent(e){const t=e.closest(`[${a.CONTAINER_TYPE_ATTRIBUTE}=${r.COMPONENT_CONTAINER_TYPE}]`);return t.attr(r.CONTAINER_SOURCE_ID_ATTR)}getParentSlotForComponent(e){const t=e.closest(`[${a.TYPE_ATTRIBUTE}=${a.CONTENT_SLOT_TYPE}]`);return t}getParentSlotIdForComponent(e){return this.componentHandlerService.getParentSlotForComponent(e)}getOriginalComponent(e,t){return this.componentHandlerService.getOriginalComponent(e,t)}isExternalComponent(e,t){return this.componentHandlerService.isExternalComponent(e,t)}getCatalogVersionUuid(e){return this.componentHandlerService.getCatalogVersionUuid(e)}getAllSlotsSelector(){return this.componentHandlerService.getAllSlotsSelector()}getFromJQuerySelector(e){return this.yjQuery(e)}getFromSelector(e){if(typeof e==="string"){return this.yjQuery(e)}else{return this.getFromHTMLSelector(e)}}getFromHTMLSelector(e){return this.yjQuery(e)}getContainerSourceIdForContainerId(e){let t=this.getAllSlotsSelector();t+=" ["+a.CONTAINER_ID_ATTRIBUTE+'="'+e+'"]';const n=this.getFromSelector(t);return n[0]?n[0].getAttribute(r.CONTAINER_SOURCE_ID_ATTR):""}isSlotShared(e){return __awaiter(this,void 0,void 0,(function*(){yield this.getPageContentSlots();const t=l.first(this.pageContentSlots.filter((t=>t.slotId===e)));return t&&t.slotShared}))}reloadPageContentSlots(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.pageInfoService.getPageUID();const t=yield this.resource.get({pageId:e});this.pageContentSlots=l.uniq(t.pageContentSlotList||[])}))}};g=__decorate([o.Injectable(),__param(2,o.Inject(a.YJQUERY_TOKEN)),__metadata("design:paramtypes",[a.IRestServiceFactory,a.CrossFrameEventService,Function,a.IComponentHandlerService,a.IPageInfoService])],g);let _=class PersonalizationsmarteditContextServiceReverseProxy{applySynchronization(){"proxyFunction";return undefined}isCurrentPageActiveWorkflowRunning(){"proxyFunction";return undefined}};_=__decorate([a.GatewayProxied("applySynchronization","isCurrentPageActiveWorkflowRunning"),o.Injectable()],_);let v=class PersonalizationsmarteditContextService{constructor(e,t,n,i){this.yjQuery=e;this.contextualMenuService=t;this.personalizationsmarteditContextServiceReverseProxy=n;this.personalizationsmarteditContextUtils=i;const o=i.getContextObject();this.setPersonalization(o.personalization);try{const e=window.sessionStorage.getItem("CombinedView");const t=window.sessionStorage.getItem("Customize");this.setCustomize(JSON.parse(t)||o.customize);this.setCombinedView(JSON.parse(e)||o.combinedView)}catch(e){this.setCustomize(o.customize);this.setCombinedView(o.combinedView)}this.setSeData(o.seData)}getPersonalization(){return this.personalization}setPersonalization(e){this.personalization=e;this.contextualMenuService.refreshMenuItems()}getCustomize(){return this.customize}setCustomize(e){this.customize=e;this.contextualMenuService.refreshMenuItems()}getCombinedView(){return this.combinedView}setCombinedView(e){this.combinedView=e;this.contextualMenuService.refreshMenuItems()}getSeData(){return this.seData}setSeData(e){this.seData=e}isCurrentPageActiveWorkflowRunning(){return this.personalizationsmarteditContextServiceReverseProxy.isCurrentPageActiveWorkflowRunning()}};v=__decorate([o.Injectable(),__param(0,o.Inject(a.YJQUERY_TOKEN)),__metadata("design:paramtypes",[Function,a.IContextualMenuService,_,r.PersonalizationsmarteditContextUtils])],v);let S=class PersonalizationsmarteditContextServiceProxy extends r.IPersonalizationsmarteditContextServiceProxy{constructor(e,t){super();this.personalizationsmarteditContextService=e;this.crossFrameEventService=t}setPersonalization(e){this.personalizationsmarteditContextService.setPersonalization(e)}setCustomize(e){this.personalizationsmarteditContextService.setCustomize(e);this.crossFrameEventService.publish("PERSONALIZATION_CUSTOMIZE_CONTEXT_SYNCHRONIZED")}setCombinedView(e){this.personalizationsmarteditContextService.setCombinedView(e);this.crossFrameEventService.publish("PERSONALIZATION_COMBINEDVIEW_CONTEXT_SYNCHRONIZED")}setSeData(e){this.personalizationsmarteditContextService.setSeData(e)}};S=__decorate([a.GatewayProxied("setPersonalization","setCustomize","setCombinedView","setSeData"),o.Injectable(),__metadata("design:paramtypes",[v,a.CrossFrameEventService])],S);var y;let C=y=class PersonalizationsmarteditContextualMenuService{constructor(e,t,n,i,o){this.personalizationsmarteditContextService=e;this.personalizationsmarteditComponentHandlerService=t;this.personalizationsmarteditUtils=n;this.personalizationsmarteditContextMenuServiceProxy=i;this.crossFrameEventService=o;this.isWorkflowRunningBoolean=false;this.init()}updateWorkflowStatus(){return __awaiter(this,void 0,void 0,(function*(){this.isWorkflowRunningBoolean=yield this.personalizationsmarteditContextService.isCurrentPageActiveWorkflowRunning()}))}openDeleteAction(e){const t=l.isString(e.componentAttributes)?JSON.parse(e.componentAttributes):e.componentAttributes;const n={};n.containerId=e.containerId;n.containerSourceId=t.smarteditContainerSourceId;n.slotId=e.slotId;n.actionId=t.smarteditPersonalizationActionId||null;n.selectedVariationCode=t.smarteditPersonalizationVariationId||null;n.selectedCustomizationCode=t.smarteditPersonalizationCustomizationId||null;const i=t.smarteditCatalogVersionUuid.split("/");n.componentCatalog=i[0];n.componentCatalogVersion=i[1];const o=this.getSelectedCustomization(n.selectedCustomizationCode);n.catalog=o.catalog;n.catalogVersion=o.catalogVersion;n.slotsToRefresh=this.getSlotsToRefresh(t.smarteditContainerSourceId);this.personalizationsmarteditContextMenuServiceProxy.openDeleteAction(n)}openAddAction(e){const t=l.isString(e.componentAttributes)?JSON.parse(e.componentAttributes):e.componentAttributes;const n={};n.componentType=e.componentType;n.componentId=e.componentId;n.containerId=e.containerId;n.containerSourceId=t.smarteditContainerSourceId;n.slotId=e.slotId;n.actionId=t.smarteditPersonalizationActionId||null;n.selectedVariationCode=this.getSelectedVariationCode();const i=t.smarteditCatalogVersionUuid.split("/");n.componentCatalog=i[0];const o=this.getSelectedCustomization();n.catalog=o.catalog;n.selectedCustomizationCode=o.code;const s=this.personalizationsmarteditComponentHandlerService.getParentSlotForComponent(e.element);const r=this.personalizationsmarteditComponentHandlerService.getCatalogVersionUuid(s).split("/");n.slotCatalog=r[0];n.slotsToRefresh=this.getSlotsToRefresh(t.smarteditContainerSourceId);n.slotsToRefresh.push(e.slotId);return this.personalizationsmarteditContextMenuServiceProxy.openAddAction(n)}openEditAction(e){const t=l.isString(e.componentAttributes)?JSON.parse(e.componentAttributes):e.componentAttributes;const n={};n.componentType=e.componentType;n.componentId=e.componentId;n.containerId=e.containerId;n.containerSourceId=t.smarteditContainerSourceId;n.slotId=e.slotId;n.actionId=t.smarteditPersonalizationActionId||null;n.selectedVariationCode=t.smarteditPersonalizationVariationId||null;n.selectedCustomizationCode=t.smarteditPersonalizationCustomizationId||null;n.componentUuid=t.smarteditComponentUuid||null;n.slotsToRefresh=this.getSlotsToRefresh(t.smarteditContainerSourceId);return this.personalizationsmarteditContextMenuServiceProxy.openEditAction(n)}openEditComponentAction(e){const t=l.isString(e.componentAttributes)?JSON.parse(e.componentAttributes):e.componentAttributes;const n={};n.smarteditComponentType=t.smarteditComponentType;n.smarteditComponentUuid=t.smarteditComponentUuid;n.smarteditCatalogVersionUuid=t.smarteditCatalogVersionUuid;return this.personalizationsmarteditContextMenuServiceProxy.openEditComponentAction(n)}isCustomizationFromCurrentCatalog(e){const t=this.contextCombinedView.selectedItems||[];const n=t.filter((t=>t.customization.code===e.componentAttributes.smarteditPersonalizationCustomizationId&&t.variation.code===e.componentAttributes.smarteditPersonalizationVariationId));const i=n.shift();if(i){return this.personalizationsmarteditUtils.isItemFromCurrentCatalog(i.customization,this.personalizationsmarteditContextService.getSeData())}return false}isPersonalizationAllowedInWorkflow(){this.refreshContext();return this.isEditPersonalizationInWorkflowAllowed(this.contextPersonalization.enabled)}isContextualMenuAddItemEnabled(e){this.refreshContext();let t=this.isContextualMenuEnabled();t=t&&!this.isElementHighlighted(e);t=t&&this.isSlotInCurrentCatalog(e);t=t&&this.isSelectedCustomizationFromCurrentCatalog();return this.isEditPersonalizationInWorkflowAllowed(t)}isContextualMenuEditItemEnabled(e){this.refreshContext();let t=this.contextPersonalization.enabled;t=t&&!l.isUndefined(e.componentAttributes.smarteditPersonalizationActionId);t=t&&this.isSlotInCurrentCatalog(e);t=t&&(this.isSelectedCustomizationFromCurrentCatalog()||this.isCustomizationFromCurrentCatalog(e));return this.isEditPersonalizationInWorkflowAllowed(t)}isContextualMenuDeleteItemEnabled(e){return this.isContextualMenuEditItemEnabled(e)}isContextualMenuShowActionListEnabled(e){this.refreshContext();let t=!l.isUndefined(e.componentAttributes.smarteditPersonalizationActionId);t=t&&this.contextCombinedView.enabled;t=t&&!this.contextCombinedView.customize.selectedCustomization;return t}isContextualMenuInfoEnabled(){this.refreshContext();let e=this.contextPersonalization.enabled;e=e&&!l.isObject(this.contextCustomize.selectedVariations);e=e||l.isArray(this.contextCustomize.selectedVariations);e=e&&!this.contextCombinedView.enabled;return e}isContextualMenuInfoItemEnabled(){const e=this.isContextualMenuInfoEnabled();return e||!this.isEditPersonalizationInWorkflowAllowed(this.contextPersonalization.enabled)}isContextualMenuEditComponentItemEnabled(e){this.refreshContext();let t=this.contextPersonalization.enabled;t=t&&!this.contextCombinedView.enabled&&this.isComponentInCurrentCatalog(e);return t}isEditPersonalizationInWorkflowAllowed(e){const t=this.personalizationsmarteditContextService.getSeData().seConfigurationData||[];const n=t[y.EDIT_PERSONALIZATION_IN_WORKFLOW]===true;if(n){return e}else{return e&&!this.isWorkflowRunningBoolean}}isCustomizeObjectValid(e){return l.isObject(e.selectedCustomization)&&l.isObject(e.selectedVariations)&&!l.isArray(e.selectedVariations)}isContextualMenuEnabled(){return this.isCustomizeObjectValid(this.contextCustomize)||this.contextCombinedView.enabled&&this.isCustomizeObjectValid(this.contextCombinedView.customize)}isElementHighlighted(e){if(this.contextCombinedView.enabled){return this.contextCombinedView.customize.selectedComponents.includes(e.componentAttributes.smarteditContainerSourceId)}else{return this.contextCustomize.selectedComponents.includes(e.componentAttributes.smarteditContainerSourceId)}}isSlotInCurrentCatalog(e){const t=this.personalizationsmarteditComponentHandlerService.getParentSlotForComponent(e.element);const n=this.personalizationsmarteditComponentHandlerService.getCatalogVersionUuid(t);const i=this.contextSeData.seExperienceData.catalogDescriptor.catalogVersionUuid;return i===n}isComponentInCurrentCatalog(e){const t=this.contextSeData.seExperienceData.catalogDescriptor.catalogVersionUuid;const n=e.componentAttributes.smarteditCatalogVersionUuid;return t===n}isSelectedCustomizationFromCurrentCatalog(){const e=this.contextCustomize.selectedCustomization||this.contextCombinedView.customize.selectedCustomization;if(e){return this.personalizationsmarteditUtils.isItemFromCurrentCatalog(e,this.personalizationsmarteditContextService.getSeData())}return false}init(){this.crossFrameEventService.subscribe(a.EVENTS.PAGE_CHANGE,(()=>{this.updateWorkflowStatus()}));this.crossFrameEventService.subscribe(a.EVENTS.PAGE_UPDATED,(()=>{this.updateWorkflowStatus()}))}refreshContext(){this.contextPersonalization=this.personalizationsmarteditContextService.getPersonalization();this.contextCustomize=this.personalizationsmarteditContextService.getCustomize();this.contextCombinedView=this.personalizationsmarteditContextService.getCombinedView();this.contextSeData=this.personalizationsmarteditContextService.getSeData()}getSelectedVariationCode(){if(this.personalizationsmarteditContextService.getCombinedView().enabled){return this.personalizationsmarteditContextService.getCombinedView().customize.selectedVariations.code}return this.personalizationsmarteditContextService.getCustomize().selectedVariations.code}getSelectedCustomization(e){if(this.personalizationsmarteditContextService.getCombinedView().enabled){let t=this.personalizationsmarteditContextService.getCombinedView().customize.selectedCustomization;if(!t&&e){t=this.personalizationsmarteditContextService.getCombinedView().selectedItems.filter((t=>t.customization.code===e))[0].customization}return t}return this.personalizationsmarteditContextService.getCustomize().selectedCustomization}getSlotsToRefresh(e){let t=this.personalizationsmarteditComponentHandlerService.getAllSlotsSelector();t+=' [data-smartedit-container-source-id="'+e+'"]';const n=this.personalizationsmarteditComponentHandlerService.getFromSelector(t);const i=Array.prototype.slice.call(l.map(n,(e=>this.personalizationsmarteditComponentHandlerService.getParentSlotIdForComponent(this.personalizationsmarteditComponentHandlerService.getFromSelector(e)))));return i}};C.EDIT_PERSONALIZATION_IN_WORKFLOW="personalizationsmartedit.editPersonalizationInWorkflow.enabled";C=y=__decorate([o.Injectable(),__metadata("design:paramtypes",[v,g,r.PersonalizationsmarteditUtils,r.IPersonalizationsmarteditContextMenuServiceProxy,a.CrossFrameEventService])],C);let f=class PersonalizationsmarteditCustomizeViewHelper{constructor(e){this.personalizationsmarteditComponentHandlerService=e}getSourceContainersInfo(){let e=this.personalizationsmarteditComponentHandlerService.getAllSlotsSelector();e+=" [data-smartedit-container-source-id]";const t=this.personalizationsmarteditComponentHandlerService.getFromSelector(e);const n=t.map(((e,t)=>{const n=this.personalizationsmarteditComponentHandlerService.getFromJQuerySelector(t);return{containerId:this.personalizationsmarteditComponentHandlerService.getParentContainerIdForComponent(n),containerSourceId:this.personalizationsmarteditComponentHandlerService.getParentContainerSourceIdForComponent(n)}}));return l.countBy(n,"containerSourceId")}};f=__decorate([o.Injectable(),__metadata("design:paramtypes",[g])],f);let E=class PersonalizationsmarteditRestService{constructor(e,t){this.restServiceFactory=e;this.personalizationsmarteditContextService=t}getCxCmsAllActionsForContainer(e,t){const n=this.restServiceFactory.get(m);let i={type:"CXCMSACTION",customizationStatus:"ENABLED",variationStatus:"ENABLED",catalogs:"ALL",needsTotal:true,containerId:e,pageSize:(t===null||t===void 0?void 0:t.currentSize)||25,currentPage:(t===null||t===void 0?void 0:t.currentPage)||0};i=this.extendRequestParamObjWithCatalogAwarePathVariables(i);return n.get(i)}extendRequestParamObjWithCatalogAwarePathVariables(e){const t=this.personalizationsmarteditContextService.getSeData().seExperienceData;const n={catalogId:t.catalogDescriptor.catalogId,catalogVersion:t.catalogDescriptor.catalogVersion};const i=Object.assign(Object.assign({},e),n);return i}};E=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.IRestServiceFactory,v])],E);let I=class servicesModule{};I=__decorate([o.NgModule({providers:[v,E,f,C,g,_,{provide:r.IPersonalizationsmarteditContextServiceProxy,useClass:S},a.moduleUtils.initialize((e=>e.updateWorkflowStatus()),[C])]})],I);window.__smartedit__.addDecoratorPayload("Component","PersonalizationsmarteditCombinedViewComponentLightUpDecorator",{selector:"personalizationsmartedit-combined-view-component-light-up",template:`<div [ngClass]="classForElement" class="pe-combined-view-component-letter">{{ letterForElement }}</div><div><ng-content></ng-content></div>`,changeDetection:o.ChangeDetectionStrategy.OnPush});let b=class PersonalizationsmarteditCombinedViewComponentLightUpDecorator extends a.AbstractDecorator{constructor(e,t,n,i,o){super();this.personalizationsmarteditContextService=e;this.crossFrameEventService=t;this.cdr=n;this.$element=i(o.nativeElement);this.letterForElement="";this.classForElement=""}ngOnInit(){this.allBorderClassess=Object.values(r.PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING).map((({borderClass:e})=>e)).join(" ");this.unSubscribeRegOverlayRerender=this.crossFrameEventService.subscribe(a.OVERLAY_RERENDERED_EVENT,(()=>{this.calculate()}));this.calculate()}ngOnDestroy(){this.unSubscribeRegOverlayRerender()}calculate(){const e=this.personalizationsmarteditContextService.getCombinedView();if(!e.enabled){return}const t=this.$element.parent().closest('[class~="smartEditComponentX"][data-smartedit-container-source-id][data-smartedit-container-type="CxCmsComponentContainer"][data-smartedit-personalization-customization-id][data-smartedit-personalization-variation-id]');if(t.length===0){return}t.removeClass(this.allBorderClassess);(e.selectedItems||[]).forEach(((e,n)=>{let i=t.data().smarteditPersonalizationCustomizationId===e.customization.code;i=i&&t.data().smarteditPersonalizationVariationId===e.variation.code;if(i){const e=n%Object.keys(r.PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING).length;t.addClass(r.PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING[e].borderClass);this.letterForElement=String.fromCharCode("a".charCodeAt(0)+e).toUpperCase();this.classForElement=r.PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING[e].listClass;this.cdr.detectChanges()}}))}};b=__decorate([o.Component({selector:"personalizationsmartedit-combined-view-component-light-up",template:`<div [ngClass]="classForElement" class="pe-combined-view-component-letter">{{ letterForElement }}</div><div><ng-content></ng-content></div>`,changeDetection:o.ChangeDetectionStrategy.OnPush}),__param(3,o.Inject(a.YJQUERY_TOKEN)),__metadata("design:paramtypes",[v,a.CrossFrameEventService,o.ChangeDetectorRef,Function,o.ElementRef])],b);window.__smartedit__.addDecoratorPayload("Component","PersonalizationsmarteditComponentLightUpDecorator",{selector:"personalizationsmartedit-component-light-up",template:`<div><ng-content></ng-content></div>`,changeDetection:o.ChangeDetectionStrategy.OnPush});let T=class PersonalizationsmarteditComponentLightUpDecorator extends a.AbstractDecorator{constructor(e,t,n,i,o){super();this.personalizationsmarteditContextService=e;this.personalizationsmarteditComponentHandlerService=t;this.crossFrameEventService=n;this.CONTAINER_TYPE="CxCmsComponentContainer";this.ACTION_ID_ATTR="data-smartedit-personalization-action-id";this.$element=o(i.nativeElement);this.PARENT_CONTAINER_SELECTOR=`[class~="${a.OVERLAY_COMPONENT_CLASS}"][${r.CONTAINER_SOURCE_ID_ATTR}][${a.CONTAINER_TYPE_ATTRIBUTE}="${this.CONTAINER_TYPE}"]`;this.PARENT_CONTAINER_WITH_ACTION_SELECTOR=`[class~="${a.OVERLAY_COMPONENT_CLASS}"][${a.CONTAINER_TYPE_ATTRIBUTE}="${this.CONTAINER_TYPE}"][${this.ACTION_ID_ATTR}]`;this.COMPONENT_SELECTOR=`[${a.ID_ATTRIBUTE}][${a.CATALOG_VERSION_UUID_ATTRIBUTE}][${a.TYPE_ATTRIBUTE}]`}ngAfterViewInit(){this.unRegisterCustomizeContextSynchronized=this.crossFrameEventService.subscribe("PERSONALIZATION_CUSTOMIZE_CONTEXT_SYNCHRONIZED",(()=>this.delayToggleCssClasses()));this.delayToggleCssClasses()}ngOnDestroy(){this.unRegisterCustomizeContextSynchronized()}delayToggleCssClasses(){setTimeout((()=>{this.toggleCssClasses()}),500)}toggleCssClasses(){const e=this.$element.parent().closest(this.COMPONENT_SELECTOR);const t=e.closest(this.PARENT_CONTAINER_SELECTOR);const n=this.isVariationComponentSelected(e);t.toggleClass("perso__component-decorator",n);t.toggleClass("hyicon hyicon-checkedlg perso__component-decorator-icon",n);t.toggleClass("personalizationsmarteditComponentSelected",this.isComponentSelected())}isVariationComponentSelected(e){let t=false;const n=this.personalizationsmarteditContextService.getCustomize();if(n.selectedCustomization&&n.selectedVariations){const n=e.closest(this.PARENT_CONTAINER_WITH_ACTION_SELECTOR);t=n.length>0}return t}isComponentSelected(){if(!Array.isArray(this.personalizationsmarteditContextService.getCustomize().selectedVariations)){return false}const e=this.personalizationsmarteditComponentHandlerService.getParentContainerIdForComponent(this.$element);const t=this.personalizationsmarteditContextService.getCustomize().selectedComponents;return!!(t===null||t===void 0?void 0:t.includes(e))}};T=__decorate([o.Component({selector:"personalizationsmartedit-component-light-up",template:`<div><ng-content></ng-content></div>`,changeDetection:o.ChangeDetectionStrategy.OnPush}),__param(4,o.Inject(a.YJQUERY_TOKEN)),__metadata("design:paramtypes",[v,g,a.CrossFrameEventService,o.ElementRef,Function])],T);let O=class PersonalizationsmarteditContextMenuServiceProxy extends r.IPersonalizationsmarteditContextMenuServiceProxy{constructor(){super()}};O=__decorate([a.GatewayProxied("openDeleteAction","openAddAction","openEditAction","openEditComponentAction"),o.Injectable(),__metadata("design:paramtypes",[])],O);window.__smartedit__.addDecoratorPayload("Component","ShowComponentInfoListComponent",{selector:"perso-show-component-info-list",template:`<div class="pe-component-info"><div class="pe-component-info__info-layout"><div *ngIf="!isPageBlocked"><div *ngIf="!isPersonalizationAllowedInWorkflow"><div class="pe-component-info__title" translate="personalization.modal.showcomponentinfolist.help.noactionsinworkflow.title"></div><div class="perso__page-level-help-message" translate="personalization.modal.showcomponentinfolist.help.noactionsinworkflow"></div></div><div *ngIf="isContextualMenuInfoEnabled"><div class="pe-component-info__title" translate="personalization.modal.showcomponentinfolist.title"></div><div class="perso__page-level-help-message" *ngIf="!isPersonalizationAllowedInWorkflow" translate="personalization.modal.showcomponentinfolist.help.noactionsinworkflow.componentinfo"></div><div class="perso__page-level-help-message" *ngIf="pagination.totalCount > 0 && isPersonalizationAllowedInWorkflow" translate="personalization.modal.showcomponentinfolist.help.label"></div><div class="perso__page-level-help-message" *ngIf="pagination.totalCount === 0 && isPersonalizationAllowedInWorkflow" translate="personalization.modal.showcomponentinfolist.help.nocustomizations"></div></div></div><div *ngIf="isPageBlocked"><div class="pe-component-info__title" translate="personalization.modal.showcomponentinfolist.blocked.title"></div><div class="perso__page-level-help-message" translate="personalization.modal.showcomponentinfolist.blocked.label"></div></div></div><div class="perso__page-level-help-message pe-component-info__info-layout" *ngIf="pagination.totalCount > 0 && isContextualMenuInfoEnabled"><span translate="personalization.modal.showcomponentinfolist.help.numberofenabledcustomizations"></span> <span>{{ pagination.totalCount }}</span></div><div [hidden]="pagination.totalCount === 0 || !isContextualMenuInfoEnabled"><personalization-infinite-scrolling [fetchPage]="fetchActionsPage" [dropDownContainerClass]="'pe-component-info__wrapper'"><personalization-prevent-parent-scroll><div [ngClass]="isCustomizationVisible ? 'pe-component-info__list-item' : '' " *ngFor="let action of actions"><div class="pe-component-info__names-layout"><div class="perso-wrap-ellipsis" [title]="action.customizationName">{{ action.customizationName }}</div><div class="perso-wrap-ellipsis perso-tree__primary-data" [title]="action.variationName">{{ action.variationName }}</div></div><div [ngClass]="isCustomizationVisible ? 'pe-component-info__icon' : '' "><se-tooltip *ngIf="!action.customization.isFromCurrentCatalog" [triggers]="['mouseenter', 'mouseleave']"><span se-tooltip-trigger [ngClass]="isCustomizationVisible ? 'perso__globe-icon sap-icon--globe' : '' "></span> <span se-tooltip-body>{{ action.customization.catalogVersionNameL10N | seL10n | async }}</span></se-tooltip></div></div><div class="pe-spinner--inner" *ngIf="moreCustomizationsRequestProcessing"><div class="spinner-md spinner-light"></div></div></personalization-prevent-parent-scroll></personalization-infinite-scrolling></div></div>`});let P=class ShowComponentInfoListComponent{constructor(e,t,n,i,o,s,a,l,c,d){this.persoComponentHandlerService=t;this.persoContextService=n;this.persoContextualMenuService=i;this.persoMessageHandler=o;this.persoRestService=s;this.persoUtils=a;this.permissionService=l;this.translateService=c;this.cdr=d;({componentAttributes:{smarteditContainerId:this.containerId}}=e);this.pagination=new r.PaginationHelper({});this.pagination.reset();this.isPageBlocked=false;this.isContextualMenuInfoEnabled=false;this.isPersonalizationAllowedInWorkflow=false;this.moreCustomizationsRequestProcessing=false;const p=25;this.customizationsFilter={currentSize:p,currentPage:this.pagination.getPage()+1};this.actions=[];this.isCustomizationVisible=false;this.fetchActionsPage=()=>this.fetchMoreActions()}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.containerIdExists=!!this.containerId;this.containerSourceId=this.containerIdExists?this.persoComponentHandlerService.getContainerSourceIdForContainerId(this.containerId):"";this.setCustomizationVisible();this.isPageBlocked=yield this.isPersonalizationBlockedOnPage();this.isPersonalizationAllowedInWorkflow=this.persoContextualMenuService.isPersonalizationAllowedInWorkflow();this.isContextualMenuInfoEnabled=this.persoContextualMenuService.isContextualMenuInfoEnabled();this.cdr.detectChanges()}))}fetchMoreActions(){return __awaiter(this,void 0,void 0,(function*(){if(!this.pagination.isLastPage()&&!this.moreCustomizationsRequestProcessing&&this.containerIdExists){this.moreCustomizationsRequestProcessing=true;const e=this.setCustomizationsFilterForNextPage();yield this.fetchAllActionsForContainerId(this.containerSourceId,e)}}))}isPersonalizationBlockedOnPage(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.permissionService.isPermitted([{names:["se.personalization.page"]}]);return!e}))}setCustomizationsFilterForNextPage(){const e=this.pagination.getPage()+1;this.customizationsFilter.currentPage=e;return this.customizationsFilter}fetchAllActionsForContainerId(e,t){return __awaiter(this,void 0,void 0,(function*(){try{const n=yield this.persoRestService.getCxCmsAllActionsForContainer(e,t);const i=(n.actions||[]).map((e=>this.getActionsWithCustomizations(e)));const o=yield Promise.all(i);this.persoUtils.uniqueArray(this.actions,o,"variationCode");this.setCustomizationVisible();this.pagination=new r.PaginationHelper(n.pagination)}catch(e){this.persoMessageHandler.sendError(this.translateService.instant("personalization.error.gettingactions"))}finally{this.moreCustomizationsRequestProcessing=false}}))}getActionsWithCustomizations(e){return __awaiter(this,void 0,void 0,(function*(){const t={catalog:e.actionCatalog,catalogVersion:e.actionCatalogVersion,catalogVersionNameL10N:"",isFromCurrentCatalog:false};t.isFromCurrentCatalog=this.persoUtils.isItemFromCurrentCatalog(t,this.persoContextService.getSeData());yield this.persoUtils.getAndSetCatalogVersionNameL10N(t);return Object.assign(Object.assign({},e),{customization:t})}))}setCustomizationVisible(){this.isCustomizationVisible=this.containerIdExists&&this.actions.length>0}};P=__decorate([o.Component({selector:"perso-show-component-info-list",template:`<div class="pe-component-info"><div class="pe-component-info__info-layout"><div *ngIf="!isPageBlocked"><div *ngIf="!isPersonalizationAllowedInWorkflow"><div class="pe-component-info__title" translate="personalization.modal.showcomponentinfolist.help.noactionsinworkflow.title"></div><div class="perso__page-level-help-message" translate="personalization.modal.showcomponentinfolist.help.noactionsinworkflow"></div></div><div *ngIf="isContextualMenuInfoEnabled"><div class="pe-component-info__title" translate="personalization.modal.showcomponentinfolist.title"></div><div class="perso__page-level-help-message" *ngIf="!isPersonalizationAllowedInWorkflow" translate="personalization.modal.showcomponentinfolist.help.noactionsinworkflow.componentinfo"></div><div class="perso__page-level-help-message" *ngIf="pagination.totalCount > 0 && isPersonalizationAllowedInWorkflow" translate="personalization.modal.showcomponentinfolist.help.label"></div><div class="perso__page-level-help-message" *ngIf="pagination.totalCount === 0 && isPersonalizationAllowedInWorkflow" translate="personalization.modal.showcomponentinfolist.help.nocustomizations"></div></div></div><div *ngIf="isPageBlocked"><div class="pe-component-info__title" translate="personalization.modal.showcomponentinfolist.blocked.title"></div><div class="perso__page-level-help-message" translate="personalization.modal.showcomponentinfolist.blocked.label"></div></div></div><div class="perso__page-level-help-message pe-component-info__info-layout" *ngIf="pagination.totalCount > 0 && isContextualMenuInfoEnabled"><span translate="personalization.modal.showcomponentinfolist.help.numberofenabledcustomizations"></span> <span>{{ pagination.totalCount }}</span></div><div [hidden]="pagination.totalCount === 0 || !isContextualMenuInfoEnabled"><personalization-infinite-scrolling [fetchPage]="fetchActionsPage" [dropDownContainerClass]="'pe-component-info__wrapper'"><personalization-prevent-parent-scroll><div [ngClass]="isCustomizationVisible ? 'pe-component-info__list-item' : '' " *ngFor="let action of actions"><div class="pe-component-info__names-layout"><div class="perso-wrap-ellipsis" [title]="action.customizationName">{{ action.customizationName }}</div><div class="perso-wrap-ellipsis perso-tree__primary-data" [title]="action.variationName">{{ action.variationName }}</div></div><div [ngClass]="isCustomizationVisible ? 'pe-component-info__icon' : '' "><se-tooltip *ngIf="!action.customization.isFromCurrentCatalog" [triggers]="['mouseenter', 'mouseleave']"><span se-tooltip-trigger [ngClass]="isCustomizationVisible ? 'perso__globe-icon sap-icon--globe' : '' "></span> <span se-tooltip-body>{{ action.customization.catalogVersionNameL10N | seL10n | async }}</span></se-tooltip></div></div><div class="pe-spinner--inner" *ngIf="moreCustomizationsRequestProcessing"><div class="spinner-md spinner-light"></div></div></personalization-prevent-parent-scroll></personalization-infinite-scrolling></div></div>`}),__param(0,o.Inject(a.CONTEXTUAL_MENU_ITEM_DATA)),__metadata("design:paramtypes",[Object,g,v,C,r.PersonalizationsmarteditMessageHandler,E,r.PersonalizationsmarteditUtils,a.IPermissionService,c.TranslateService,o.ChangeDetectorRef])],P);let w=class ShowComponentInfoListModule{};w=__decorate([o.NgModule({imports:[d.CommonModule,a.SeTranslationModule.forChild(),r.PersonalizationsmarteditCommonsComponentsModule,a.TooltipModule,a.L10nPipeModule],declarations:[P],entryComponents:[P],exports:[P]})],w);window.__smartedit__.addDecoratorPayload("Component","ShowActionListComponent",{selector:"perso-show-action-list",template:`<div class="pe-combinedview-ranking"><div class="pe-combinedview-ranking__info-layout"><div class="pe-combinedview-ranking__title" translate="personalization.modal.showactionlist.title"></div><div class="perso__page-level-help-message" translate="personalization.modal.showactionlist.help.label"></div></div><div class="pe-combinedview-ranking__list-item" *ngFor="let item of selectedItems; index as i" [hidden]="!item.visible"><div class="pe-combinedview-ranking__letter-layout"><div [ngClass]="getClassForElement(i)" [textContent]="getLetterForElement(i)"></div></div><div class="pe-combinedview-ranking__names-layout"><div class="perso-wrap-ellipsis" [textContent]="item.customization.name" title="{{item.customization.name}}"></div><div class="perso-wrap-ellipsis perso-tree__primary-data" [textContent]="item.variation.name" title="{{item.variation.name}}"></div></div><div class="pe-combinedview-ranking__icon"><se-tooltip *ngIf="!isCustomizationFromCurrentCatalog(item.customization)" [triggers]="['mouseenter', 'mouseleave']" [placement]="'top right'"><span se-tooltip-trigger class="perso__globe-icon sap-icon--globe"></span> <span se-tooltip-body>{{ item.variation.catalogVersionNameL10N | seL10n | async }}</span></se-tooltip></div></div></div>`});let A=class ShowActionListComponent{constructor(e,t,n,i,o,s){this.contextualMenuItem=e;this.persoContextService=t;this.persoUtils=n;this.persoComponentHandlerService=i;this.persoContextualMenuService=o;this.COMPONENT_SELECTOR="showactionlistbutton";this.isContextualMenuShowActionListEnabled=false;this.$element=s(`[class~="${this.COMPONENT_SELECTOR}"]`)}ngOnInit(){this.selectedItems=this.persoContextService.getCombinedView().selectedItems;this.containerId=this.persoComponentHandlerService.getParentContainerIdForComponent(this.$element);this.containerIdExists=!!this.containerId;this.containerSourceId=this.containerIdExists?this.persoComponentHandlerService.getContainerSourceIdForContainerId(this.containerId):"";this.isContextualMenuShowActionListEnabled=this.persoContextualMenuService.isContextualMenuShowActionListEnabled(this.contextualMenuItem);(this.selectedItems||[]).forEach(((e,t)=>{this.initItem(e)}))}getLetterForElement(e){return this.persoUtils.getLetterForElement(e)}getClassForElement(e){return this.persoUtils.getClassForElement(e)}initItem(e){e.visible=false;(e.variation.actions||[]).forEach((t=>{if(t.containerId&&t.containerId===this.containerSourceId){e.visible=true}}));this.persoUtils.getAndSetCatalogVersionNameL10N(e.variation)}isCustomizationFromCurrentCatalog(e){return this.persoUtils.isItemFromCurrentCatalog(e,this.persoContextService.getSeData())}};A=__decorate([o.Component({selector:"perso-show-action-list",template:`<div class="pe-combinedview-ranking"><div class="pe-combinedview-ranking__info-layout"><div class="pe-combinedview-ranking__title" translate="personalization.modal.showactionlist.title"></div><div class="perso__page-level-help-message" translate="personalization.modal.showactionlist.help.label"></div></div><div class="pe-combinedview-ranking__list-item" *ngFor="let item of selectedItems; index as i" [hidden]="!item.visible"><div class="pe-combinedview-ranking__letter-layout"><div [ngClass]="getClassForElement(i)" [textContent]="getLetterForElement(i)"></div></div><div class="pe-combinedview-ranking__names-layout"><div class="perso-wrap-ellipsis" [textContent]="item.customization.name" title="{{item.customization.name}}"></div><div class="perso-wrap-ellipsis perso-tree__primary-data" [textContent]="item.variation.name" title="{{item.variation.name}}"></div></div><div class="pe-combinedview-ranking__icon"><se-tooltip *ngIf="!isCustomizationFromCurrentCatalog(item.customization)" [triggers]="['mouseenter', 'mouseleave']" [placement]="'top right'"><span se-tooltip-trigger class="perso__globe-icon sap-icon--globe"></span> <span se-tooltip-body>{{ item.variation.catalogVersionNameL10N | seL10n | async }}</span></se-tooltip></div></div></div>`}),__param(0,o.Inject(a.CONTEXTUAL_MENU_ITEM_DATA)),__param(5,o.Inject(a.YJQUERY_TOKEN)),__metadata("design:paramtypes",[Object,v,r.PersonalizationsmarteditUtils,g,C,Function])],A);let R=class ShowActionListModule{};R=__decorate([o.NgModule({imports:[d.CommonModule,a.TooltipModule,a.L10nPipeModule,a.SeTranslationModule.forChild(),r.PersonalizationsmarteditCommonsComponentsModule],providers:[],declarations:[A],entryComponents:[A],exports:[A]})],R);let D=class CustomizeViewServiceProxy{constructor(e){this.personalizationsmarteditCustomizeViewHelper=e}getSourceContainersInfo(){return this.personalizationsmarteditCustomizeViewHelper.getSourceContainersInfo()}};D=__decorate([a.GatewayProxied("getSourceContainersInfo"),o.Injectable(),__metadata("design:paramtypes",[f])],D);let M=class CustomizeViewModule{};M=__decorate([o.NgModule({imports:[I],providers:[D]})],M);window.__smartedit__.addDecoratorPayload("Component","SharedSlotComponent",{selector:"perso-shared-slot",template:`<div class="se-decorative-panel-wrapper"><div class="cmsx-ctx-wrapper1 se-slot-contextual-menu-level1"><div class="cmsx-ctx-wrapper2 se-slot-contextual-menu-level2"><div *ngIf="slotSharedFlag"><div class="se-decorator-panel-padding-center"></div><div class="se-decorative-panel-slot-contextual-menu"><div class="se-shared-slot-button-template" *ngIf="slotSharedFlag"><se-popup-overlay [popupOverlay]="popupConfig" [popupOverlayTrigger]="isPopupOpened" (popupOverlayOnHide)="hidePopup()"><button type="button" class="se-slot-ctx-menu__dropdown-toggle sap-icon--chain-link se-slot-ctx-menu__dropdown-toggle-icon" [ngClass]="{'se-slot-ctx-menu__dropdown-toggle--open': isPopupOpened}" id="sharedSlotButton-{{ slotId }}" (click)="onButtonClick()"></button><div class="se-slot__dropdown-menu" se-popup-overlay-body><div class="se-shared-slot__body"><div class="se-shared-slot__description" translate="personalization.slot.shared.popover.message"></div></div></div></se-popup-overlay></div></div></div></div></div></div>`});let N=class SharedSlotComponent{constructor(e,t,n,i){this.contextualMenuItem=e;this.persoComponentHandlerService=t;this.crossFrameEventService=n;this.cdr=i;this.popupConfig={halign:"left",valign:"bottom",additionalClasses:["se-slot-ctx-menu__divider","se-slot-ctx-menu__dropdown-toggle-wrapper"]};this.buttonName="SharedSlotButton";this.isPopupOpened=false;this.isPopupOpenedPreviousValue=false}ngOnInit(){this.slotSharedFlag=false;this.persoComponentHandlerService.isSlotShared(this.slotId).then((e=>{this.slotSharedFlag=e}));this.unRegOuterFrameClicked=this.crossFrameEventService.subscribe(a.EVENT_OUTER_FRAME_CLICKED,(()=>{this.isPopupOpened=false}));this.cdr.detectChanges()}ngOnChanges(e){if(e.active&&e.active.currentValue){this.isPopupOpened=false}}ngOnDestroy(){if(this.unRegOuterFrameClicked){this.unRegOuterFrameClicked()}}ngDoCheck(){if(this.isPopupOpenedPreviousValue!==this.isPopupOpened){this.contextualMenuItem.setRemainOpen(this.buttonName,this.isPopupOpened);this.isPopupOpenedPreviousValue=this.isPopupOpened}}onButtonClick(){this.isPopupOpened=!this.isPopupOpened}hidePopup(){this.isPopupOpened=false}get componentAttributes(){return this.contextualMenuItem.componentAttributes}get slotId(){return this.componentAttributes.smarteditComponentId}};N=__decorate([o.Component({selector:"perso-shared-slot",template:`<div class="se-decorative-panel-wrapper"><div class="cmsx-ctx-wrapper1 se-slot-contextual-menu-level1"><div class="cmsx-ctx-wrapper2 se-slot-contextual-menu-level2"><div *ngIf="slotSharedFlag"><div class="se-decorator-panel-padding-center"></div><div class="se-decorative-panel-slot-contextual-menu"><div class="se-shared-slot-button-template" *ngIf="slotSharedFlag"><se-popup-overlay [popupOverlay]="popupConfig" [popupOverlayTrigger]="isPopupOpened" (popupOverlayOnHide)="hidePopup()"><button type="button" class="se-slot-ctx-menu__dropdown-toggle sap-icon--chain-link se-slot-ctx-menu__dropdown-toggle-icon" [ngClass]="{'se-slot-ctx-menu__dropdown-toggle--open': isPopupOpened}" id="sharedSlotButton-{{ slotId }}" (click)="onButtonClick()"></button><div class="se-slot__dropdown-menu" se-popup-overlay-body><div class="se-shared-slot__body"><div class="se-shared-slot__description" translate="personalization.slot.shared.popover.message"></div></div></div></se-popup-overlay></div></div></div></div></div></div>`}),__param(0,o.Inject(a.CONTEXTUAL_MENU_ITEM_DATA)),__metadata("design:paramtypes",[Object,g,a.CrossFrameEventService,o.ChangeDetectorRef])],N);const x="^.*Component$";const F="se.edit.page";t.PersonalizationsmarteditModule=class PersonalizationsmarteditModule{};t.PersonalizationsmarteditModule=__decorate([a.SeEntryModule("personalizationsmartedit"),o.NgModule({imports:[a.SeTranslationModule.forChild(),s.BrowserModule,r.PersonalizationsmarteditCommonsComponentsModule,w,M,R,a.PopupOverlayModule,I],providers:[C,g,{provide:i.HTTP_INTERCEPTORS,useClass:r.BaseSiteHeaderInterceptor,multi:true,deps:[a.ISharedDataService]},{provide:r.IPersonalizationsmarteditContextMenuServiceProxy,useClass:O},a.moduleUtils.bootstrap(((e,t,n)=>{e.addMappings({"^.*Slot$":["personalizationsmarteditSharedSlot","se.slotContextualMenu"]});e.addMappings({COMP_REGEX_PKEYS:["personalizationsmarteditComponentLightUp","personalizationsmarteditCombinedViewComponentLightUp"]});t.addDecorator({key:"personalizationsmarteditComponentLightUp",nameI18nKey:"personalizationsmarteditComponentLightUp"});t.addDecorator({key:"personalizationsmarteditCombinedViewComponentLightUp",nameI18nKey:"personalizationsmarteditCombinedViewComponentLightUp"});t.addDecorator({key:"personalizationsmarteditSharedSlot",nameI18nKey:"personalizationsmarteditSharedSlot"});t.addContextualMenuButton({key:"personalizationsmartedit.context.show.action.list",i18nKey:"personalization.context.action.list.show",nameI18nKey:"personalization.context.action.list.show",regexpKeys:[x],condition:e=>n.isContextualMenuShowActionListEnabled(e),action:{component:A},displayClass:"showactionlistbutton",displayIconClass:"hyicon hyicon-combinedview cmsx-ctx__icon personalization-ctx__icon",displaySmallIconClass:"hyicon hyicon-combinedview cmsx-ctx__icon--small",permissions:["se.read.page"],priority:500});t.addContextualMenuButton({key:"personalizationsmartedit.context.info.action",i18nKey:"personalization.context.action.info",nameI18nKey:"personalization.context.action.info",regexpKeys:[x],condition:()=>n.isContextualMenuInfoItemEnabled(),action:{component:P},displayClass:"infoactionbutton",displayIconClass:"hyicon hyicon-msginfo cmsx-ctx__icon personalization-ctx__icon",displaySmallIconClass:"hyicon hyicon-msginfo cmsx-ctx__icon--small",permissions:[F],priority:510});t.addContextualMenuButton({key:"personalizationsmartedit.context.add.action",i18nKey:"personalization.context.action.add",nameI18nKey:"personalization.context.action.add",regexpKeys:[x],condition:e=>n.isContextualMenuAddItemEnabled(e),action:{callback:e=>{n.openAddAction(e)}},displayClass:"addactionbutton",displayIconClass:"hyicon hyicon-addlg cmsx-ctx__icon personalization-ctx__icon",displaySmallIconClass:"hyicon hyicon-addlg cmsx-ctx__icon--small",permissions:[F],priority:520});t.addContextualMenuButton({key:"personalizationsmartedit.context.component.edit.action",i18nKey:"personalization.context.component.action.edit",nameI18nKey:"personalization.context.component.action.edit",regexpKeys:[x],condition:e=>n.isContextualMenuEditComponentItemEnabled(e),action:{callback:e=>{n.openEditComponentAction(e)}},displayClass:"editbutton",displayIconClass:"sap-icon--edit cmsx-ctx__icon",displaySmallIconClass:"sap-icon--edit cmsx-ctx__icon--small",permissions:[F],priority:530});t.addContextualMenuButton({key:"personalizationsmartedit.context.edit.action",i18nKey:"personalization.context.action.edit",nameI18nKey:"personalization.context.action.edit",regexpKeys:[x],condition:e=>n.isContextualMenuEditItemEnabled(e),action:{callback:e=>{n.openEditAction(e)}},displayClass:"replaceactionbutton",displayIconClass:"hyicon hyicon-change cmsx-ctx__icon personalization-ctx__icon",displaySmallIconClass:"hyicon hyicon-change cmsx-ctx__icon--small",permissions:[F],priority:540});t.addContextualMenuButton({key:"personalizationsmartedit.context.delete.action",i18nKey:"personalization.context.action.delete",nameI18nKey:"personalization.context.action.delete",regexpKeys:[x],condition:e=>n.isContextualMenuDeleteItemEnabled(e),action:{callback:e=>{n.openDeleteAction(e)}},displayClass:"removeactionbutton",displayIconClass:"hyicon hyicon-removelg cmsx-ctx__icon personalization-ctx__icon",displaySmallIconClass:"hyicon hyicon-removelg cmsx-ctx__icon--small",permissions:[F],priority:550});t.addContextualMenuButton({key:"personalizationsmarteditSharedSlot",nameI18nKey:"slotcontextmenu.title.shared.button",regexpKeys:["^.*Slot$"],action:{component:N},permissions:["se.read.page"]})}),[a.IDecoratorService,a.IFeatureService,C,g,r.IPersonalizationsmarteditContextServiceProxy,D])],declarations:[T,b,N],entryComponents:[T,b,N]})],t.PersonalizationsmarteditModule)},57219:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=n(32709);var o=n(9501);var s=n(12549);function __decorate(e,t,n,i){var o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s;return o>3&&s&&Object.defineProperty(t,n,s),s}t.PersonalizationsearchSmarteditModule=class PersonalizationsearchSmarteditModule{};t.PersonalizationsearchSmarteditModule=__decorate([s.SeEntryModule("personalizationsearchsmartedit"),i.NgModule({imports:[o.BrowserModule],declarations:[],entryComponents:[],exports:[],providers:[]})],t.PersonalizationsearchSmarteditModule)},3490:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=n(32709);var o=n(12549);var s=n(38102);var r=n(30178);var a=n(19662);var l=n(38788);var c=n(51132);var d=n(67564);var p=n(66791);var u=n(22630);var m=n(99662);function _interopNamespace(e){if(e&&e.__esModule)return e;var t=Object.create(null);if(e){Object.keys(e).forEach((function(n){if(n!=="default"){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:true,get:function(){return e[n]}})}}))}t["default"]=e;return Object.freeze(t)}var h=_interopNamespace(c);function __decorate(e,t,n,i){var o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s;return o>3&&s&&Object.defineProperty(t,n,s),s}function __param(e,t){return function(n,i){t(n,i,e)}}function __metadata(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}function __awaiter(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))}t.AssetsService=class AssetsService{constructor(){this.PROD_ASSETS_SRC="/cmssmartedit"}getAssetsRoot(){return this.PROD_ASSETS_SRC}};t.AssetsService=__decorate([i.Injectable()],t.AssetsService);const g="WORKFLOW_CREATED_EVENT";const _="WORKFLOW_FINISHED_EVENT";const v=new o.EvictionTag({event:g});const S=new o.EvictionTag({event:_});const y=new o.EvictionTag({event:"WORKFLOW_TASKS_MENU_OPENED_EVENT"});const C=new o.EvictionTag({event:"SLOT_UPDATE_EVENT"});class IContextAwareEditableItemService{isItemEditable(e){"proxyFunction";return null}}const f="CURRENT_CONTEXT_CATALOG";const E="CURRENT_CONTEXT_CATALOG_VERSION";const I="CURRENT_CONTEXT_SITE_ID";const b="CURRENT_PAGE_CONTEXT_CATALOG";const T="CURRENT_PAGE_CONTEXT_CATALOG_VERSION";const O="/cmswebservices/v1/types";const P=`/cmswebservices/v1/sites/${I}/catalogs/${f}/versions/${E}/items`;const w=`/cmswebservices/v1/sites/${o.PAGE_CONTEXT_SITE_ID}/catalogs/${b}/versions/${T}/pagescontentslotscomponents`;const A=`/cmswebservices/v1/catalogs/${b}/versions/${T}/pages/:pageUid/contentslots/:slotUid/typerestrictions`;const R=`/cmswebservices/v1/catalogs/${b}/versions/${T}/pages/:pageUid/typerestrictions`;const D=`/cmswebservices/v1/sites/${I}/catalogs/${f}/versions/${E}/pages`;const M="pages/:siteId/:catalogId/:catalogVersion";const N="trashedpages/:siteId/:catalogId/:catalogVersion";const x=`/cmswebservices/v1/sites/${o.PAGE_CONTEXT_SITE_ID}/catalogs/${b}/versions/${T}/pagescontentslots`;const F=`/cmswebservices/v1/sites/:${I}/catalogs/:${f}/versions/:${E}/pagetemplates`;const L="navigations/:siteId/:catalogId/:catalogVersion";const U=`/cmswebservices/v1/sites/:${I}/catalogs/:${f}/versions/:${E}/navigations`;const k=`/cmswebservices/v1/sites/:${I}/catalogs/:${f}/versions/:${E}/navigations/:navigationUid/entries`;const V="/cmswebservices/v1/navigationentrytypes";const j=`/cmswebservices/v1/sites/${o.PAGE_CONTEXT_SITE_ID}/catalogs/${b}/versions/${T}/pagesrestrictions`;const z="/cmswebservices/v1/sites/:siteUID/catalogs/:catalogId/versions/:catalogVersion/pagesrestrictions";const B="/cmswebservices/v1/restrictiontypes";const H="/cmswebservices/v1/pagetypesrestrictiontypes";const G="/cmswebservices/v1/pagetypes";const W=`/cmssmarteditwebservices/v1/sites/${o.PAGE_CONTEXT_SITE_ID}/catalogs/${b}/versions/${T}/synchronizations/versions/:target/pages/:pageUid`;const $=`/cmssmarteditwebservices/v1/sites/${I}/catalogs/${f}/versions/${E}/synchronizations/versions/:target`;class IPageContentSlotsComponentsRestService{clearCache(){"proxyFunction"}getSlotsToComponentsMapForPageUid(e){"proxyFunction";return null}getComponentsForSlot(e){"proxyFunction";return null}}t.SynchronizationResourceService=class SynchronizationResourceService{constructor(e){this.restServiceFactory=e}getPageSynchronizationGetRestService(e){const t=new o.URIBuilder(W).replaceParams(e).build();return this.restServiceFactory.get(t)}getPageSynchronizationPostRestService(e){const t=new o.URIBuilder($).replaceParams(e).build();return this.restServiceFactory.get(t)}};t.SynchronizationResourceService=__decorate([i.Injectable(),__metadata("design:paramtypes",[o.IRestServiceFactory])],t.SynchronizationResourceService);t.ComponentService=class ComponentService{constructor(e,t,n,i){this.restServiceFactory=e;this.cmsitemsRestService=t;this.pageInfoService=n;this.pageContentSlotsComponentsRestService=i;this.pageComponentTypesRestServiceURI="/cmssmarteditwebservices/v1/catalogs/:catalogId/versions/:catalogVersion/pages/:pageId/types";this.pageComponentTypesRestService=this.restServiceFactory.get(this.pageComponentTypesRestServiceURI);this.restServiceForAddExistingComponent=this.restServiceFactory.get(w)}getSupportedComponentTypesForCurrentPage(e){return this.pageComponentTypesRestService.get(e)}createNewComponent(e,t){const n={name:e.name,slotId:e.targetSlotId,pageId:e.pageId,position:e.position,typeCode:e.componentType,itemtype:e.componentType,catalogVersion:e.catalogVersionUuid,uid:"",uuid:""};if(typeof t==="object"){for(const e in t){if(t.hasOwnProperty(e)){n[e]=t[e]}}}else if(t){throw new Error(`ComponentService.createNewComponent() - Illegal componentPayload - [${t}]`)}return this.cmsitemsRestService.create(n)}updateComponent(e){return this.cmsitemsRestService.update(e)}addExistingComponent(e,t,n,i){return this.restServiceForAddExistingComponent.save({pageId:e,slotId:n,componentId:t,position:i})}loadComponentItem(e){return this.cmsitemsRestService.getById(e)}loadPagedComponentItemsByCatalogVersion(e){const t={pageSize:e.pageSize,currentPage:e.page,mask:e.mask,sort:"name",typeCode:"AbstractCMSComponent",catalogId:e.catalogId,catalogVersion:e.catalogVersion,itemSearchParams:""};return this.cmsitemsRestService.get(t)}getSlotsForComponent(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.getContentSlotsForComponents();return Object.entries(t).filter((([,t])=>t.find((t=>t.uuid===e)))).map((([e])=>e))}))}getContentSlotsForComponents(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.pageInfoService.getPageUID();return yield this.pageContentSlotsComponentsRestService.getSlotsToComponentsMapForPageUid(e)}))}};__decorate([o.Cached({actions:[o.rarelyChangingContent],tags:[o.pageChangeEvictionTag]}),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Promise)],t.ComponentService.prototype,"getSupportedComponentTypesForCurrentPage",null);t.ComponentService=__decorate([i.Injectable(),__metadata("design:paramtypes",[o.IRestServiceFactory,o.CmsitemsRestService,o.IPageInfoService,IPageContentSlotsComponentsRestService])],t.ComponentService);t.SlotStatus=void 0;(function(e){e["TEMPLATE"]="TEMPLATE";e["PAGE"]="PAGE";e["OVERRIDE"]="OVERRIDE"})(t.SlotStatus||(t.SlotStatus={}));t.JOB_STATUS=void 0;(function(e){e["RUNNING"]="RUNNING";e["ERROR"]="ERROR";e["FAILURE"]="FAILURE";e["FINISHED"]="FINISHED";e["UNKNOWN"]="UNKNOWN";e["ABORTED"]="ABORTED";e["PENDING"]="PENDING"})(t.JOB_STATUS||(t.JOB_STATUS={}));t.StructureTypeCategory=void 0;(function(e){e["COMPONENT"]="COMPONENT";e["PREVIEW"]="PREVIEW";e["PAGE"]="PAGE";e["RESTRICTION"]="RESTRICTION"})(t.StructureTypeCategory||(t.StructureTypeCategory={}));const K={UNAVAILABLE:"UNAVAILABLE",IN_SYNC:"IN_SYNC",NOT_SYNC:"NOT_SYNC",IN_PROGRESS:"IN_PROGRESS",SYNC_FAILED:"SYNC_FAILED"};const q={SLOW_POLLING_TIME:2e4,FAST_POLLING_TIME:4e3,SPEED_UP:"syncPollingSpeedUp",SLOW_DOWN:"syncPollingSlowDown",FAST_FETCH:"syncFastFetch",FETCH_STATUS:"fetchStatus",FETCH_SYNC_STATUS_ONCE:"fetchSyncStatusOnce"};const Y={CATALOG_SYNCHRONIZED:"CATALOG_SYNCHRONIZED_EVENT"};t.SynchronizationStatus=void 0;(function(e){e["Unavailable"]="UNAVAILABLE";e["InSync"]="IN_SYNC";e["NotSync"]="NOT_SYNC";e["InProgress"]="IN_PROGRESS";e["SyncFailed"]="SYNC_FAILED"})(t.SynchronizationStatus||(t.SynchronizationStatus={}));class SynchronizationUtils{isInSync(e){return e.status===t.SynchronizationStatus.InSync}isInNotSync(e){return e.status===t.SynchronizationStatus.NotSync}isSyncInFailed(e){return e.status===t.SynchronizationStatus.SyncFailed}isSyncInProgress(e){return e.status===t.SynchronizationStatus.InProgress}isExternalItem(e){return!!e.isExternal}}const Q=new SynchronizationUtils;class SyncQueue{constructor(){this.items=[]}getItems(){return this.items}addItems(e){this.items=this.items.concat(e)}removeItem(e){this.items=this.items.filter((t=>t!==e.itemId))}itemExists(e){return this.getItems().includes(e.itemId)}isEmpty(){return this.getItems().length===0}hasAtLeastOneItem(){return this.getItems().length>0}emptyItems(){this.items=[]}}window.__smartedit__.addDecoratorPayload("Component","SynchronizationPanelComponent",{selector:"se-synchronization-panel",template:`<div class="se-sync-panel"><se-message *ngIf="message" [type]="message.type"><ng-container se-message-description>{{ message.description }}</ng-container></se-message><div class="se-sync-panel__sync-info" [style.visibility]="showItemList ? 'visible': 'hidden'"><se-spinner [isSpinning]="isLoading"></se-spinner><se-synchronization-panel-item *ngFor="let item of getAllItems(); let i = index" class="se-sync-panel__row" [index]="i" [item]="item" [rootItem]="getRootItem()" [selectAllLabel]="selectAllLabel" [disableList]="disableList" [disableItem]="api.disableItem" (selectionChange)="selectionChange($event)"></se-synchronization-panel-item></div><div class="se-sync-panel__footer" *ngIf="showFooter"><button fd-button class="se-sync-panel__sync-btn fd-button--compact fd-button--emphasized" [disabled]="isSyncButtonDisabled()" (click)="syncItems()" label="{{ 'se.cms.actionitem.page.sync' | translate }}"></button></div></div>`,styles:[`.se-sync-panel__sync-info{max-height:300px;overflow-y:auto}.se-sync-panel__row{display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:0 20px;height:40px;border-bottom:1px solid var(--sapGroup_ContentBorderColor)}.se-sync-panel__row:first-child{height:50px}.se-sync-panel__row:last-child{border-bottom:none}.se-sync-panel__footer{padding:20px;border-top:1px solid var(--sapGroup_ContentBorderColor);display:flex;flex-direction:row;align-items:center;justify-content:flex-end}.se-sync-panel__sync-btn{text-transform:capitalize;padding:0 20px;margin-left:8px}`]});t.SynchronizationPanelComponent=class SynchronizationPanelComponent{constructor(e,t,n,o,s,r,a,l,c,d){this.waitDialogService=e;this.logService=t;this.crossFrameEventService=n;this.systemEventService=o;this.timerService=s;this.alertService=r;this.translateService=a;this.sharedDataService=l;this.catalogService=c;this.userTrackingService=d;this.getApi=new i.EventEmitter;this.selectedItemsUpdate=new i.EventEmitter;this.syncStatusReady=new i.EventEmitter;this.syncItemsUpdated=new i.EventEmitter;this.showFooter=true;this.showItemList=true;this.message=null;this.disableList=false;this.isLoading=false;this.SYNC_POLLING_SPEED_PREFIX="syncPanel-";this.syncQueue=new SyncQueue;this.api={selectAll:()=>{if(!this.isRootItemExist()){throw new Error("Synchronization status is not available. The 'selectAll' function should be used with 'onSyncStatusReady' event.")}this.toggleRootItem(true)},displayItemList:e=>{this.showItemList=e},disableItemList:e=>{this.disableList=e},setMessage:e=>{this.message=e},disableItem:null}}ngOnInit(){this.getApi.emit(this.api);this.unsubscribeFastFetch=this.crossFrameEventService.subscribe(q.FAST_FETCH,((e,t)=>this.fetchSyncStatus(t)));this.fetchSyncStatus();this.reSyncTimer=this.timerService.createTimer((()=>this.fetchSyncStatus()),q.SLOW_POLLING_TIME);this.reSyncTimer.start()}ngOnDestroy(){const e=this.timerService.createTimer((()=>{if(this.syncQueue.isEmpty()){this.reSyncTimer.teardown();this.unsubscribeFastFetch();this.systemEventService.publishAsync(q.SLOW_DOWN,this.SYNC_POLLING_SPEED_PREFIX+this.itemId);this.toggleRootItem(false);this.toggleWaitModal(false);e.teardown()}else{this.toggleWaitModal(true)}}),200);e.start()}syncItems(){const e=this.getSelectedItemPayloads();const t=e.map((e=>e.itemId));this.userTrackingService.trackingUserAction(o.USER_TRACKING_FUNCTIONALITY.TOOL_BAR,"Sync");this.syncQueue.addItems(t);if(this.atLeastOneSelectedItemExists()){this.toggleWaitModal(true);return this.performSync(e).then((()=>{this.speedUpPolling()}),(()=>{this.logService.warn("[synchronizationPanel] - Could not perform synchronization.");this.toggleWaitModal(false);this.syncQueue.emptyItems()}))}else{return Promise.resolve()}}selectionChange(e){if(e===0){this.toggleAllDependentItems()}this.saveCurrentlySelectedItemsInStorage();this.selectedItemsUpdate.emit(this.getSelectedItems())}isSyncButtonDisabled(){return this.disableList||this.noSelectedItems()||this.syncQueue.hasAtLeastOneItem()}fetchSyncStatus(e){return __awaiter(this,void 0,void 0,(function*(){if(e&&e.itemId!==this.itemId){return}this.isLoading=true;const t=yield this.getSyncStatus(this.itemId);this.setRootItem(t);this.restoreSelectionAfterFetchingUpdatedItems();this.markExternalItems();this.showSyncErrors();this.updateSyncQueue();this.setExternalItemsCatalogVersionName();if(this.syncQueue.isEmpty()){this.slowDownPolling();this.toggleWaitModal(false)}this.syncStatusReady.emit(this.getRootItem());this.syncItemsUpdated.emit();this.isLoading=false}))}markExternalItems(){const e=this.getRootItem();const t=e.catalogVersionUuid;const n=this.getDependentItems();n.forEach((e=>{e.isExternal=e.catalogVersionUuid!==t}))}getAllItems(){return this.isRootItemExist()?[this.getRootItem(),...this.getDependentItems()]:[]}getRootItem(){return this.rootItem}setExternalItemsCatalogVersionName(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getCurrentExperience();const t=this.getAllItems();const n=t.filter((e=>Q.isExternalItem(e)));const i=n.map((t=>new Promise((n=>__awaiter(this,void 0,void 0,(function*(){const{catalogName:i}=yield this.catalogService.getCatalogVersionByUuid(t.catalogVersionUuid,e.siteDescriptor.uid);t.catalogVersionName=i;n(t)}))))));yield Promise.all(i)}))}slowDownPolling(){this.reSyncTimer.restart(q.SLOW_POLLING_TIME);this.systemEventService.publishAsync(q.SLOW_DOWN,this.SYNC_POLLING_SPEED_PREFIX+this.itemId)}speedUpPolling(){this.reSyncTimer.restart(q.FAST_POLLING_TIME);this.systemEventService.publishAsync(q.SPEED_UP,this.SYNC_POLLING_SPEED_PREFIX+this.itemId)}setRootItem(e){this.rootItem=e}isRootItemExist(){return this.getRootItem()!=null}getDependentItems(){return this.isRootItemExist()?this.getRootItem().selectedDependencies:[]}getCurrentExperience(){return this.sharedDataService.get(o.EXPERIENCE_STORAGE_KEY)}getSelectedItemPayloads(){return this.getSelectedItems().map((({itemId:e,itemType:t})=>({itemId:e,itemType:t})))}getSelectedItems(){return this.getAllItems().filter((e=>e.selected))}toggleRootItem(e){if(this.isRootItemExist()){const t=this.getRootItem();t.selected=e;this.selectionChange(0)}}toggleAllDependentItems(){this.getDependentItems().filter((e=>!Q.isInSync(e))).filter((e=>!Q.isExternalItem(e))).forEach((e=>{e.selected=this.getRootItem().selected}))}toggleWaitModal(e){if(e){this.waitDialogService.showWaitModal("se.sync.synchronizing")}else{this.waitDialogService.hideWaitModal()}}saveCurrentlySelectedItemsInStorage(){this.selectedItemsStorage=this.getSelectedItems()}getSelectedItemsFromStorage(){return this.selectedItemsStorage||[]}restoreSelectionAfterFetchingUpdatedItems(){const e=this.getSelectedItemsFromStorage();const t=e.map((e=>e.itemId));this.getAllItems().filter((e=>!Q.isInSync(e))).filter((e=>t.indexOf(e.itemId)>-1)).forEach((e=>e.selected=true))}updateSyncQueue(){const e=this.syncQueue.hasAtLeastOneItem();const t=this.getAllItems();t.filter((e=>this.syncQueue.itemExists(e))).filter((e=>!(Q.isSyncInProgress(e)||Q.isInNotSync(e)))).forEach((e=>this.syncQueue.removeItem(e)));t.filter((e=>!this.syncQueue.itemExists(e))).filter((e=>Q.isSyncInProgress(e))).forEach((e=>this.syncQueue.addItems([e.itemId])));const n=this.syncQueue.isEmpty();if(e&&n){this.systemEventService.publishAsync(o.EVENT_CONTENT_CATALOG_UPDATE)}}showSyncErrors(){const e=this.getAllItems().filter((e=>this.syncQueue.itemExists(e))).filter((e=>Q.isSyncInFailed(e))).map((e=>e.itemId));if(e.length>0){this.alertService.showDanger({message:this.translateService.instant("se.cms.synchronization.panel.failure.message",{items:e.join(" ")}),minWidth:"",mousePersist:true,duration:1e3,dismissible:true,width:"300px"})}}atLeastOneSelectedItemExists(){return this.getSelectedItems().length>0}noSelectedItems(){return this.getSelectedItems().length===0}};__decorate([i.Input(),__metadata("design:type",String)],t.SynchronizationPanelComponent.prototype,"itemId",void 0);__decorate([i.Input(),__metadata("design:type",String)],t.SynchronizationPanelComponent.prototype,"selectAllLabel",void 0);__decorate([i.Input(),__metadata("design:type",Function)],t.SynchronizationPanelComponent.prototype,"getSyncStatus",void 0);__decorate([i.Input(),__metadata("design:type",Function)],t.SynchronizationPanelComponent.prototype,"performSync",void 0);__decorate([i.Input(),__metadata("design:type",Boolean)],t.SynchronizationPanelComponent.prototype,"showFooter",void 0);__decorate([i.Output(),__metadata("design:type",Object)],t.SynchronizationPanelComponent.prototype,"getApi",void 0);__decorate([i.Output(),__metadata("design:type",Object)],t.SynchronizationPanelComponent.prototype,"selectedItemsUpdate",void 0);__decorate([i.Output(),__metadata("design:type",Object)],t.SynchronizationPanelComponent.prototype,"syncStatusReady",void 0);__decorate([i.Output(),__metadata("design:type",i.EventEmitter)],t.SynchronizationPanelComponent.prototype,"syncItemsUpdated",void 0);t.SynchronizationPanelComponent=__decorate([i.Component({selector:"se-synchronization-panel",template:`<div class="se-sync-panel"><se-message *ngIf="message" [type]="message.type"><ng-container se-message-description>{{ message.description }}</ng-container></se-message><div class="se-sync-panel__sync-info" [style.visibility]="showItemList ? 'visible': 'hidden'"><se-spinner [isSpinning]="isLoading"></se-spinner><se-synchronization-panel-item *ngFor="let item of getAllItems(); let i = index" class="se-sync-panel__row" [index]="i" [item]="item" [rootItem]="getRootItem()" [selectAllLabel]="selectAllLabel" [disableList]="disableList" [disableItem]="api.disableItem" (selectionChange)="selectionChange($event)"></se-synchronization-panel-item></div><div class="se-sync-panel__footer" *ngIf="showFooter"><button fd-button class="se-sync-panel__sync-btn fd-button--compact fd-button--emphasized" [disabled]="isSyncButtonDisabled()" (click)="syncItems()" label="{{ 'se.cms.actionitem.page.sync' | translate }}"></button></div></div>`,styles:[`.se-sync-panel__sync-info{max-height:300px;overflow-y:auto}.se-sync-panel__row{display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:0 20px;height:40px;border-bottom:1px solid var(--sapGroup_ContentBorderColor)}.se-sync-panel__row:first-child{height:50px}.se-sync-panel__row:last-child{border-bottom:none}.se-sync-panel__footer{padding:20px;border-top:1px solid var(--sapGroup_ContentBorderColor);display:flex;flex-direction:row;align-items:center;justify-content:flex-end}.se-sync-panel__sync-btn{text-transform:capitalize;padding:0 20px;margin-left:8px}`]}),__metadata("design:paramtypes",[o.IWaitDialogService,o.LogService,o.CrossFrameEventService,o.SystemEventService,o.TimerService,o.IAlertService,s.TranslateService,o.ISharedDataService,o.ICatalogService,o.IUserTrackingService])],t.SynchronizationPanelComponent);window.__smartedit__.addDecoratorPayload("Component","SynchronizationPanelItemComponent",{selector:"se-synchronization-panel-item",template:`<div class="se-sync-panel-item-checkbox fd-form__item"><input *ngIf="!item.isExternal" type="checkbox" [id]="'sync-info__checkbox_' + index" class="se-sync-panel-item-checkbox__field fd-form__control" [(ngModel)]="item.selected" (ngModelChange)="onSelectionChange()" [attr.disabled]="isItemDisabled() ? true : null"/> <label *ngIf="index === 0" [for]="'sync-info__checkbox_' + index" class="se-sync-panel-item-checkbox__label se-sync-panel-item-checkbox__label--select-all fd-form-label" [title]="getSelectAllLabel() | translate" [translate]="getSelectAllLabel()"></label> <label *ngIf="index !== 0 && !item.isExternal" [for]="'sync-info__checkbox_' + index" class="se-sync-panel-item-checkbox__label fd-form-label" [title]="item.name | translate" [translate]="item.name"></label><se-tooltip *ngIf="index !== 0 && item.isExternal" [isChevronVisible]="true" [triggers]="['mouseenter', 'mouseleave']"><label se-tooltip-trigger [for]="'sync-info__checkbox_' + index" class="se-sync-panel-item-checkbox__label fd-form-label" [translate]="item.name"></label><div se-tooltip-body translate="se.cms.synchronization.slot.external.component"></div></se-tooltip></div><span *ngIf="showPopoverOverSyncIcon()"><se-tooltip [isChevronVisible]="true" [placement]="'left'" [triggers]="['mouseenter', 'mouseleave']" [title]="getInfoTitle()" class="pull-right se-sync-panel-item-info-icon" [ngClass]="{ 'se-sync-panel--icon-globe': item.isExternal }"><ng-container *ngIf="!item.isExternal" se-tooltip-trigger><ng-container *ngTemplateOutlet="syncInfoIcon"></ng-container></ng-container><span *ngIf="item.isExternal" class="sap-icon--globe" se-tooltip-trigger></span><div se-tooltip-body><ng-container *ngIf="!item.isExternal"><div *ngFor="let dependentItem of item.dependentItemTypesOutOfSync">{{ dependentItem.i18nKey | translate }}</div></ng-container><div *ngIf="item.isExternal">{{ item.catalogVersionName | seL10n | async }}</div></div></se-tooltip></span><span *ngIf="!showPopoverOverSyncIcon()" class="pull-right se-sync-panel-item-info-icon"><ng-container *ngTemplateOutlet="syncInfoIcon"></ng-container></span><ng-template #syncInfoIcon><span [attr.status]="item.status" class="se-sync-panel-item-info-icon__icon" [ngClass]="{\n                'sap-icon--accept': isInSync(),\n                'sap-icon--message-warning': !isInSync()\n            }"></span></ng-template>`,styles:[`.se-sync-panel-item-checkbox{display:flex;flex-direction:row;align-items:center;margin:0!important}.se-sync-panel-item-checkbox__field{margin:0!important}.se-sync-panel-item-checkbox input[type=checkbox]{height:13px;width:13px;position:relative}.se-sync-panel-item-checkbox__label{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;max-width:190px;margin:0!important;padding-left:8px!important;text-transform:capitalize}.se-sync-panel-item-checkbox__label--select-all{font-weight:700!important}.se-sync-panel-item-info-icon{font-size:1rem!important;line-height:1.25;font-weight:400}.se-sync-panel-item-info-icon__icon[class*=sap-icon].sap-icon--accept{font-size:1rem!important;line-height:1.25;font-weight:400;color:var(--sapIndicationColor_4)!important}.se-sync-panel-item-info-icon__icon.sap-icon--message-warning{font-size:1rem!important;line-height:1.25;font-weight:400;color:var(--sapIndicationColor_3)}`]});t.SynchronizationPanelItemComponent=class SynchronizationPanelItemComponent{constructor(){this.selectionChange=new i.EventEmitter}getSelectAllLabel(){return this.selectAllLabel||"se.cms.synchronization.page.select.all.slots"}isItemDisabled(){var e;if(this.disableList||this.disableItem&&this.disableItem(this.item)){return true}return this.item!==this.rootItem&&!!((e=this.rootItem)===null||e===void 0?void 0:e.selected)||Q.isInSync(this.item)}showPopoverOverSyncIcon(){var e;return((e=this.item.dependentItemTypesOutOfSync)===null||e===void 0?void 0:e.length)>0||Q.isExternalItem(this.item)}getInfoTitle(){return!Q.isExternalItem(this.item)?"se.cms.synchronization.panel.update.title":""}isInSync(){return Q.isInSync(this.item)}onSelectionChange(){this.selectionChange.emit(this.index)}};__decorate([i.Input(),__metadata("design:type",Number)],t.SynchronizationPanelItemComponent.prototype,"index",void 0);__decorate([i.Input(),__metadata("design:type",Object)],t.SynchronizationPanelItemComponent.prototype,"item",void 0);__decorate([i.Input(),__metadata("design:type",Object)],t.SynchronizationPanelItemComponent.prototype,"rootItem",void 0);__decorate([i.Input(),__metadata("design:type",String)],t.SynchronizationPanelItemComponent.prototype,"selectAllLabel",void 0);__decorate([i.Input(),__metadata("design:type",Boolean)],t.SynchronizationPanelItemComponent.prototype,"disableList",void 0);__decorate([i.Input(),__metadata("design:type",Function)],t.SynchronizationPanelItemComponent.prototype,"disableItem",void 0);__decorate([i.Output(),__metadata("design:type",Object)],t.SynchronizationPanelItemComponent.prototype,"selectionChange",void 0);t.SynchronizationPanelItemComponent=__decorate([i.Component({selector:"se-synchronization-panel-item",template:`<div class="se-sync-panel-item-checkbox fd-form__item"><input *ngIf="!item.isExternal" type="checkbox" [id]="'sync-info__checkbox_' + index" class="se-sync-panel-item-checkbox__field fd-form__control" [(ngModel)]="item.selected" (ngModelChange)="onSelectionChange()" [attr.disabled]="isItemDisabled() ? true : null"/> <label *ngIf="index === 0" [for]="'sync-info__checkbox_' + index" class="se-sync-panel-item-checkbox__label se-sync-panel-item-checkbox__label--select-all fd-form-label" [title]="getSelectAllLabel() | translate" [translate]="getSelectAllLabel()"></label> <label *ngIf="index !== 0 && !item.isExternal" [for]="'sync-info__checkbox_' + index" class="se-sync-panel-item-checkbox__label fd-form-label" [title]="item.name | translate" [translate]="item.name"></label><se-tooltip *ngIf="index !== 0 && item.isExternal" [isChevronVisible]="true" [triggers]="['mouseenter', 'mouseleave']"><label se-tooltip-trigger [for]="'sync-info__checkbox_' + index" class="se-sync-panel-item-checkbox__label fd-form-label" [translate]="item.name"></label><div se-tooltip-body translate="se.cms.synchronization.slot.external.component"></div></se-tooltip></div><span *ngIf="showPopoverOverSyncIcon()"><se-tooltip [isChevronVisible]="true" [placement]="'left'" [triggers]="['mouseenter', 'mouseleave']" [title]="getInfoTitle()" class="pull-right se-sync-panel-item-info-icon" [ngClass]="{ 'se-sync-panel--icon-globe': item.isExternal }"><ng-container *ngIf="!item.isExternal" se-tooltip-trigger><ng-container *ngTemplateOutlet="syncInfoIcon"></ng-container></ng-container><span *ngIf="item.isExternal" class="sap-icon--globe" se-tooltip-trigger></span><div se-tooltip-body><ng-container *ngIf="!item.isExternal"><div *ngFor="let dependentItem of item.dependentItemTypesOutOfSync">{{ dependentItem.i18nKey | translate }}</div></ng-container><div *ngIf="item.isExternal">{{ item.catalogVersionName | seL10n | async }}</div></div></se-tooltip></span><span *ngIf="!showPopoverOverSyncIcon()" class="pull-right se-sync-panel-item-info-icon"><ng-container *ngTemplateOutlet="syncInfoIcon"></ng-container></span><ng-template #syncInfoIcon><span [attr.status]="item.status" class="se-sync-panel-item-info-icon__icon" [ngClass]="{\n                'sap-icon--accept': isInSync(),\n                'sap-icon--message-warning': !isInSync()\n            }"></span></ng-template>`,styles:[`.se-sync-panel-item-checkbox{display:flex;flex-direction:row;align-items:center;margin:0!important}.se-sync-panel-item-checkbox__field{margin:0!important}.se-sync-panel-item-checkbox input[type=checkbox]{height:13px;width:13px;position:relative}.se-sync-panel-item-checkbox__label{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;max-width:190px;margin:0!important;padding-left:8px!important;text-transform:capitalize}.se-sync-panel-item-checkbox__label--select-all{font-weight:700!important}.se-sync-panel-item-info-icon{font-size:1rem!important;line-height:1.25;font-weight:400}.se-sync-panel-item-info-icon__icon[class*=sap-icon].sap-icon--accept{font-size:1rem!important;line-height:1.25;font-weight:400;color:var(--sapIndicationColor_4)!important}.se-sync-panel-item-info-icon__icon.sap-icon--message-warning{font-size:1rem!important;line-height:1.25;font-weight:400;color:var(--sapIndicationColor_3)}`]})],t.SynchronizationPanelItemComponent);t.SynchronizationPanelModule=class SynchronizationPanelModule{};t.SynchronizationPanelModule=__decorate([i.NgModule({imports:[r.CommonModule,a.FormsModule,o.TranslationModule.forChild(),o.TooltipModule,o.MessageModule,o.SpinnerModule,l.ButtonModule,o.L10nPipeModule],declarations:[t.SynchronizationPanelComponent,t.SynchronizationPanelItemComponent],entryComponents:[t.SynchronizationPanelComponent],exports:[t.SynchronizationPanelComponent]})],t.SynchronizationPanelModule);const Z=5e3;t.SynchronizationService=class SynchronizationService{constructor(e,t,n,i,o,s){this.restServiceFactory=e;this.timerService=t;this.translateService=n;this.alertService=i;this.authenticationService=o;this.crossFrameEventService=s;this.BASE_URL="/cmswebservices";this.SYNC_JOB_INFO_BY_TARGET_URI="/cmswebservices/v1/catalogs/:catalog/synchronizations/targetversions/:target";this.SYNC_JOB_INFO_BY_SOURCE_AND_TARGET_URI="/cmswebservices/v1/catalogs/:catalog/versions/:source/synchronizations/versions/:target";this.intervalHandle={};this.syncRequested=[];this.syncJobInfoByTargetRestService=this.restServiceFactory.get(this.SYNC_JOB_INFO_BY_TARGET_URI);this.syncJobInfoBySourceAndTargetRestService=this.restServiceFactory.get(this.SYNC_JOB_INFO_BY_SOURCE_AND_TARGET_URI,"catalog")}updateCatalogSync(e){return __awaiter(this,void 0,void 0,(function*(){const t=this._getJobKey(e.catalogId,e.sourceCatalogVersion,e.targetCatalogVersion);this.addCatalogSyncRequest(t);try{const t=yield this.syncJobInfoBySourceAndTargetRestService.save({catalog:e.catalogId,source:e.sourceCatalogVersion,target:e.targetCatalogVersion});return t}catch(t){const n=this.translateService.instant("sync.running.error.msg",{catalogName:e.name});if(t.statusText==="Conflict"){this.alertService.showDanger({message:n,minWidth:"",mousePersist:true,duration:1e3,dismissible:true,width:"300px"})}return null}}))}getCatalogSyncStatus(e){if(e.sourceCatalogVersion){return this.getSyncJobInfoBySourceAndTarget(e)}else{return this.getLastSyncJobInfoByTarget(e)}}getSyncJobInfoBySourceAndTarget(e){return this.syncJobInfoBySourceAndTargetRestService.get({catalog:e.catalogId,source:e.sourceCatalogVersion,target:e.targetCatalogVersion})}getLastSyncJobInfoByTarget(e){return this.syncJobInfoByTargetRestService.get({catalog:e.catalogId,target:e.targetCatalogVersion})}startAutoGetSyncData(e,t){const{catalogId:n,sourceCatalogVersion:i,targetCatalogVersion:o}=e;const s=this._getJobKey(n,i,o);const r=this.timerService.createTimer((()=>this._autoSyncCallback(e,t,s)),Z);r.start();this.intervalHandle[s]=r}stopAutoGetSyncData(e){const t=this._getJobKey(e.catalogId,e.sourceCatalogVersion,e.targetCatalogVersion);if(this.intervalHandle[t]){if(this.syncRequested.indexOf(t)>-1){this.intervalHandle[t].discardWhenNextSynced=true}else{this.intervalHandle[t].stop();this.intervalHandle[t]=undefined}}}_autoSyncCallback(e,t,n){return __awaiter(this,void 0,void 0,(function*(){const i=yield this.authenticationService.isAuthenticated(this.BASE_URL);if(!i){this.stopAutoGetSyncData(e)}const o=yield this.getCatalogSyncStatus(e);const s=this.syncRequestedCallback(e)(o);t(s);if(!this.intervalHandle[n]){this.startAutoGetSyncData(e,t)}}))}syncRequestedCallback(e){const t=this._getJobKey(e.catalogId,e.sourceCatalogVersion,e.targetCatalogVersion);return n=>{if(this.catalogSyncInProgress(t)){if(this.catalogSyncFinished(n)){this.removeCatalogSyncRequest(t);this.crossFrameEventService.publish(Y.CATALOG_SYNCHRONIZED,e)}if(this.intervalHandle[t].discardWhenNextSynced&&this.catalogSyncFinished(n)||this.catalogSyncAborted(n)){this.intervalHandle[t].stop();this.intervalHandle[t]=undefined;this.removeCatalogSyncRequest(t)}}return n}}catalogSyncInProgress(e){return this.syncRequested.indexOf(e)>-1}catalogSyncFinished(e){return e.syncStatus===t.JOB_STATUS.FINISHED}catalogSyncAborted(e){return e.syncStatus===t.JOB_STATUS.ABORTED}removeCatalogSyncRequest(e){const t=this.syncRequested.indexOf(e);if(t>-1){this.syncRequested.splice(t,1)}}addCatalogSyncRequest(e){if(this.syncRequested.indexOf(e)===-1){this.syncRequested.push(e)}}_getJobKey(e,t,n){return e+"_"+t+"_"+n}};t.SynchronizationService=__decorate([o.OperationContextRegistered("/cmswebservices/v1/catalogs/:catalog/synchronizations/targetversions/:target",o.OPERATION_CONTEXT.CMS),o.OperationContextRegistered("/cmswebservices/v1/catalogs/:catalog/versions/:source/synchronizations/versions/:target",o.OPERATION_CONTEXT.CMS),i.Injectable(),__metadata("design:paramtypes",[o.IRestServiceFactory,o.TimerService,s.TranslateService,o.IAlertService,o.IAuthenticationService,o.CrossFrameEventService])],t.SynchronizationService);t.CMSTimeService=class CMSTimeService{constructor(e){this.translate=e}getTimeAgo(e){const t=Math.floor(h.duration(e).asDays());const n=Math.floor(h.duration(e).asHours());if(t>=1){return t+" "+this.translate.instant("se.cms.actionitem.page.workflow.action.started.days.ago")}else if(n>=1){return n+" "+this.translate.instant("se.cms.actionitem.page.workflow.action.started.hours.ago")}return"<1 "+this.translate.instant("se.cms.actionitem.page.workflow.action.started.hours.ago")}};t.CMSTimeService=__decorate([i.Injectable(),__metadata("design:paramtypes",[s.TranslateService])],t.CMSTimeService);var X;t.VersionExperienceInterceptor=X=class VersionExperienceInterceptor{constructor(e){this.sharedDataService=e}intercept(e,t){if(this.isGET(e)&&this.isPreviewDataTypeResourceEndpoint(e.url)){return d.from(this.sharedDataService.get(o.EXPERIENCE_STORAGE_KEY)).pipe(p.switchMap((n=>{if(n.versionId){const n=e.clone({url:e.url.replace(X.MODE_DEFAULT,X.MODE_PREVIEW_VERSION)});return t.handle(n)}else{return t.handle(e)}})))}else{return t.handle(e)}}isGET(e){return e.method==="GET"}isPreviewDataTypeResourceEndpoint(e){return e.indexOf(O)>-1&&e.indexOf(X.PREVIEW_DATA_TYPE)>-1}};t.VersionExperienceInterceptor.MODE_DEFAULT="DEFAULT";t.VersionExperienceInterceptor.MODE_PREVIEW_VERSION="PREVIEWVERSION";t.VersionExperienceInterceptor.PREVIEW_DATA_TYPE="PreviewData";t.VersionExperienceInterceptor=X=__decorate([i.Injectable(),__metadata("design:paramtypes",[o.ISharedDataService])],t.VersionExperienceInterceptor);class IComponentSharedService{isComponentShared(e){"proxyFunction";return null}}t.TypePermissionNames=void 0;(function(e){e["CREATE"]="create";e["READ"]="read";e["CHANGE"]="change";e["REMOVE"]="remove"})(t.TypePermissionNames||(t.TypePermissionNames={}));t.TypePermissionsRestService=class TypePermissionsRestService{constructor(e,t,n){this.logService=e;this.sessionService=t;this.URI="/permissionswebservices/v1/permissions/types/search";this.resource=n.get(this.URI)}hasCreatePermissionForTypes(e){return this.getPermissionsForTypesAndName(e,t.TypePermissionNames.CREATE)}hasReadPermissionForTypes(e){return this.getPermissionsForTypesAndName(e,t.TypePermissionNames.READ)}hasUpdatePermissionForTypes(e){return this.getPermissionsForTypesAndName(e,t.TypePermissionNames.CHANGE)}hasDeletePermissionForTypes(e){return this.getPermissionsForTypesAndName(e,t.TypePermissionNames.REMOVE)}hasAllPermissionsForTypes(e){return __awaiter(this,void 0,void 0,(function*(){const n={};const i=yield this.getAllPermissionsForTypes(e);return i.reduce(((e,n)=>{if(n.permissions){e[n.id]={};e[n.id][t.TypePermissionNames.READ]=this.getPermissionByNameAndResult(n,t.TypePermissionNames.READ);e[n.id][t.TypePermissionNames.CHANGE]=this.getPermissionByNameAndResult(n,t.TypePermissionNames.CHANGE);e[n.id][t.TypePermissionNames.CREATE]=this.getPermissionByNameAndResult(n,t.TypePermissionNames.CREATE);e[n.id][t.TypePermissionNames.REMOVE]=this.getPermissionByNameAndResult(n,t.TypePermissionNames.REMOVE)}return e}),n)}))}getAllPermissionsForTypes(e){return __awaiter(this,void 0,void 0,(function*(){if(e.length===0){return[]}const n=yield this.sessionService.getCurrentUsername();if(!n){return[]}try{const i=[t.TypePermissionNames.CREATE,t.TypePermissionNames.CHANGE,t.TypePermissionNames.READ,t.TypePermissionNames.REMOVE].join(",");const o=yield this.resource.queryByPost({principalUid:n},{types:e.join(","),permissionNames:i});return o.permissionsList||[]}catch(t){if(t){this.logService.error(`TypePermissionsRestService - no composed types ${e} exist`)}return Promise.reject(t)}}))}getPermissionByNameAndResult(e,t){const n=e.permissions.find((e=>e.key===t));return JSON.parse(n.value)}getPermissionsForTypesAndName(e,t){return __awaiter(this,void 0,void 0,(function*(){const n=yield this.getAllPermissionsForTypes(e);return n.reduce(((e,n)=>{if(n.permissions){e[n.id]=this.getPermissionByNameAndResult(n,t)}return e}),{})}))}};__decorate([o.Cached({actions:[o.rarelyChangingContent],tags:[o.authorizationEvictionTag]}),__metadata("design:type",Function),__metadata("design:paramtypes",[Array]),__metadata("design:returntype",Promise)],t.TypePermissionsRestService.prototype,"getAllPermissionsForTypes",null);t.TypePermissionsRestService=__decorate([i.Injectable(),__metadata("design:paramtypes",[o.LogService,o.ISessionService,o.IRestServiceFactory])],t.TypePermissionsRestService);var J;(function(e){e["READ"]="read";e["CHANGE"]="change"})(J||(J={}));t.AttributePermissionsRestService=class AttributePermissionsRestService{constructor(e,t,n){this.sessionService=t;this.logService=n;this.ATTRIBUTE_PERMISSIONS_URI="/permissionswebservices/v1/permissions/attributes/search";this.permissionRestService=e.get(this.ATTRIBUTE_PERMISSIONS_URI)}hasReadPermissionOnAttributesInType(e,t){return this.getPermissionsForAttributesAndNameByType(e,t,J.READ)}hasChangePermissionOnAttributesInType(e,t){return this.getPermissionsForAttributesAndNameByType(e,t,J.CHANGE)}getAllPermissionsForAttributes(e){return __awaiter(this,void 0,void 0,(function*(){if(e.length<=0){return[]}const t=yield this.sessionService.getCurrentUsername();if(!t){return[]}try{const n=yield this.permissionRestService.queryByPost({principalUid:t},{attributes:e.join(","),permissionNames:J.CHANGE+","+J.READ});return n.permissionsList||[]}catch(t){if(t){this.logService.error(`AttributePermissionsRestService - couldn't retrieve attribute permissions ${e}`)}return[]}}))}getPermissionsForAttributesAndNameByType(e,t,n){const i=t.map((t=>e+"."+t));return this.getPermissionsForAttributesAndName(i,n).then((t=>t[e]))}getPermissionsForAttributesAndName(e,t){return __awaiter(this,void 0,void 0,(function*(){const n=yield this.getAllPermissionsForAttributes(e);const i=this.concatPermissionsNotFound(e,n);return i.reduce(((e,n)=>{if(n.permissions){const i=this.parsePermissionsResultId(n.id);if(!e[i.type]){e[i.type]={}}e[i.type][i.attribute]=this.getPermissionByNameFromResult(n,t)}return e}),{})}))}parsePermissionsResultId(e){const t=e.split(".");if(t.length!==2){throw new Error("AttributePermissionsRestService - Received invalid attribute permissions")}return{type:t[0],attribute:t[1]}}getPermissionByNameFromResult(e,t){const n=e.permissions.find((e=>e.key===t));return JSON.parse(n.value)}concatPermissionsNotFound(e,t){const n=t.map((e=>e.id));const i=u.difference(e,n);return t.concat(i.map((e=>({id:e,permissions:[{key:J.READ,value:"false"},{key:J.CHANGE,value:"false"}]}))))}};__decorate([o.Cached({actions:[o.rarelyChangingContent],tags:[o.authorizationEvictionTag]}),__metadata("design:type",Function),__metadata("design:paramtypes",[Array]),__metadata("design:returntype",Promise)],t.AttributePermissionsRestService.prototype,"getAllPermissionsForAttributes",null);t.AttributePermissionsRestService=__decorate([i.Injectable(),__metadata("design:paramtypes",[o.IRestServiceFactory,o.ISessionService,o.LogService])],t.AttributePermissionsRestService);class IRemoveComponentService{removeComponent(e){"proxyFunction";return null}}class ISlotVisibilityService{getHiddenComponents(e){"proxyFunction";return null}reloadSlotsInfo(){"proxyFunction";return null}}class IEditorEnablerService{enableForComponents(e){"proxyFunction"}onClickEditButton({slotUuid:e,componentAttributes:t}){"proxyFunction";return null}isSlotEditableForNonExternalComponent(e){"proxyFunction";return null}}class IComponentMenuConditionAndCallbackService{externalCondition(e){"proxyFunction";return null}sharedCondition(e){"proxyFunction";return null}removeCondition(e){"proxyFunction";return null}removeCallback(e,t){"proxyFunction";return null}cloneCondition(e){"proxyFunction";return null}cloneCallback(e){"proxyFunction";return null}editConditionForHiddenComponent(e){"proxyFunction";return null}dragCondition(e){"proxyFunction";return null}}t.SlotSynchronizationService=class SlotSynchronizationService{constructor(e){this.syncPollingService=e}getSyncStatus(e,t){return __awaiter(this,void 0,void 0,(function*(){const n=yield this.syncPollingService.getSyncStatus(e);const i=this.findSlotStatus(n.selectedDependencies||[],t);if(i!==null){i.fromSharedDependency=false;return i}else{const e=this.findSlotStatus(n.sharedDependencies||[],t);if(e!==null){e.fromSharedDependency=true;return e}}return null}))}performSync(e,t){return this.syncPollingService.performSync(e,t)}syncStatusExists(e){return!!e}findSlotStatus(e,t){return e.find((e=>e.name===t))||null}};t.SlotSynchronizationService=__decorate([i.Injectable(),__metadata("design:paramtypes",[o.ISyncPollingService])],t.SlotSynchronizationService);t.SlotUnsharedService=class SlotUnsharedService{constructor(e,t){this.cmsItemsRestService=e;this.pageContentSlotsService=t;this.slotUnsharedStatus="OVERRIDE"}isSlotUnshared(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.pageContentSlotsService.getSlotStatus(e);return t===this.slotUnsharedStatus}))}isSlotShared(e){return this.pageContentSlotsService.isSlotShared(e)}revertToSharedSlot(e){return this.cmsItemsRestService.delete(e)}};t.SlotUnsharedService=__decorate([i.Injectable(),__metadata("design:paramtypes",[o.CmsitemsRestService,o.PageContentSlotsService])],t.SlotUnsharedService);class IComponentEditingFacade{addNewComponentToSlot(e,t,n,i){"proxyFunction";return null}addExistingComponentToSlot(e,t,n){"proxyFunction";return null}cloneExistingComponentToSlot(e){"proxyFunction";return null}moveComponent(e,t,n,i){"proxyFunction";return null}}window.__smartedit__.addDecoratorPayload("Component","ActionableAlertComponent",{selector:"se-actionable-alert",changeDetection:i.ChangeDetectionStrategy.OnPush,template:`<div>\n        <p>{{ description | translate : descriptionDetails }}</p>\n        <div>\n            <a fd-link href (click)="onHyperLinkClick($event)">{{\n                hyperlinkLabel | translate : hyperlinkDetails\n            }}</a>\n        </div>\n    </div> `});t.ActionableAlertComponent=class ActionableAlertComponent{constructor(){this.hyperLinkClick=new i.EventEmitter}onHyperLinkClick(e){e.preventDefault();this.hyperLinkClick.emit()}};__decorate([i.Input(),__metadata("design:type",String)],t.ActionableAlertComponent.prototype,"description",void 0);__decorate([i.Input(),__metadata("design:type",Object)],t.ActionableAlertComponent.prototype,"descriptionDetails",void 0);__decorate([i.Input(),__metadata("design:type",String)],t.ActionableAlertComponent.prototype,"hyperlinkLabel",void 0);__decorate([i.Input(),__metadata("design:type",Object)],t.ActionableAlertComponent.prototype,"hyperlinkDetails",void 0);__decorate([i.Output(),__metadata("design:type",i.EventEmitter)],t.ActionableAlertComponent.prototype,"hyperLinkClick",void 0);t.ActionableAlertComponent=__decorate([i.Component({selector:"se-actionable-alert",changeDetection:i.ChangeDetectionStrategy.OnPush,template:`<div>\n        <p>{{ description | translate : descriptionDetails }}</p>\n        <div>\n            <a fd-link href (click)="onHyperLinkClick($event)">{{\n                hyperlinkLabel | translate : hyperlinkDetails\n            }}</a>\n        </div>\n    </div> `}),__metadata("design:paramtypes",[])],t.ActionableAlertComponent);window.__smartedit__.addDecoratorPayload("Component","SharedComponentButtonComponent",{selector:"shared-component-button",template:`<div class="se-ctx-menu-btn__msg"><div class="se-ctx-menu-btn__msg-title" translate="se.cms.contextmenu.shared.component.info.title"></div><div *ngIf="isReady" class="se-ctx-menu-btn__msg-description" [translate]="message"></div><se-spinner [isSpinning]="!isReady"></se-spinner></div>`,changeDetection:i.ChangeDetectionStrategy.OnPush});t.SharedComponentButtonComponent=class SharedComponentButtonComponent{constructor(e,t,n){this.contextAwareEditableItemService=t;this.cdr=n;this.isReady=false;({componentAttributes:{smarteditComponentId:this.smarteditComponentId}}=e)}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.contextAwareEditableItemService.isItemEditable(this.smarteditComponentId);this.message=`se.cms.contextmenu.shared.component.info.msg${e?".editable":""}`;this.isReady=true;if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}};t.SharedComponentButtonComponent=__decorate([i.Component({selector:"shared-component-button",template:`<div class="se-ctx-menu-btn__msg"><div class="se-ctx-menu-btn__msg-title" translate="se.cms.contextmenu.shared.component.info.title"></div><div *ngIf="isReady" class="se-ctx-menu-btn__msg-description" [translate]="message"></div><se-spinner [isSpinning]="!isReady"></se-spinner></div>`,changeDetection:i.ChangeDetectionStrategy.OnPush}),__param(0,i.Inject(o.CONTEXTUAL_MENU_ITEM_DATA)),__metadata("design:paramtypes",[Object,IContextAwareEditableItemService,i.ChangeDetectorRef])],t.SharedComponentButtonComponent);window.__smartedit__.addDecoratorPayload("Component","ExternalComponentButtonComponent",{selector:"se-external-component-button",template:`<div class="se-ctx-menu-btn__msg" *ngIf="isReady">{{ catalogVersion }}</div>`,providers:[o.L10nPipe],changeDetection:i.ChangeDetectionStrategy.OnPush});t.ExternalComponentButtonComponent=class ExternalComponentButtonComponent{constructor(e,t,n,i){this.catalogService=t;this.l10nPipe=n;this.cdr=i;this.isReady=false;({componentAttributes:{smarteditCatalogVersionUuid:this.catalogVersionUuid}}=e)}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.catalogService.getCatalogVersionByUuid(this.catalogVersionUuid);const t=yield this.l10nPipe.transform(e.catalogName).pipe(p.take(1)).toPromise();this.catalogVersion=`${t} (${e.version})`;this.isReady=true;if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}};t.ExternalComponentButtonComponent=__decorate([i.Component({selector:"se-external-component-button",template:`<div class="se-ctx-menu-btn__msg" *ngIf="isReady">{{ catalogVersion }}</div>`,providers:[o.L10nPipe],changeDetection:i.ChangeDetectionStrategy.OnPush}),__param(0,i.Inject(o.CONTEXTUAL_MENU_ITEM_DATA)),__metadata("design:paramtypes",[Object,o.ICatalogService,o.L10nPipe,i.ChangeDetectorRef])],t.ExternalComponentButtonComponent);class IComponentVisibilityAlertService{checkAndAlertOnComponentVisibility(e){"proxyFunction";return null}}window.__smartedit__.addDecoratorPayload("Component","ComponentVisibilityAlertComponent",{selector:"se-component-visibility-alert",template:`<div>\n        <p [translate]="message"></p>\n        <div>\n            <a fd-link style="cursor:pointer" (click)="onClick()" [translate]="hyperlinkLabel"></a>\n        </div>\n    </div>`,changeDetection:i.ChangeDetectionStrategy.OnPush});t.ComponentVisibilityAlertComponent=class ComponentVisibilityAlertComponent{constructor(e,t,n){this.editorModalService=e;this.componentVisibilityAlertService=t;this.alertRef=n;this.hyperlinkLabel="se.cms.component.visibility.alert.hyperlink";({component:this.component,message:this.message}=this.alertRef.data)}onClick(){return __awaiter(this,void 0,void 0,(function*(){this.alertRef.dismiss();this.checkProvidedArguments(this.component);const e=yield this.editorModalService.openAndRerenderSlot(this.component.itemType,this.component.itemId,"visibilityTab");this.componentVisibilityAlertService.checkAndAlertOnComponentVisibility({itemId:e.uuid,itemType:e.itemtype,catalogVersion:e.catalogVersion,restricted:e.restricted,slotId:this.component.slotId,visible:e.visible})}))}checkProvidedArguments(e){const t=[e.itemId,e.itemType,e.slotId];const n=t.filter((e=>e&&!o.stringUtils.isBlank(e)));if(n.length!==t.length){throw new Error("componentVisibilityAlertService.checkAndAlertOnComponentVisibility - missing properly typed parameters")}}};t.ComponentVisibilityAlertComponent=__decorate([i.Component({selector:"se-component-visibility-alert",template:`<div>\n        <p [translate]="message"></p>\n        <div>\n            <a fd-link style="cursor:pointer" (click)="onClick()" [translate]="hyperlinkLabel"></a>\n        </div>\n    </div>`,changeDetection:i.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[o.IEditorModalService,IComponentVisibilityAlertService,l.AlertRef])],t.ComponentVisibilityAlertComponent);t.ComponentVisibilityAlertModule=class ComponentVisibilityAlertModule{};t.ComponentVisibilityAlertModule=__decorate([i.NgModule({imports:[o.TranslationModule.forChild(),m.LinkModule],declarations:[t.ComponentVisibilityAlertComponent],entryComponents:[t.ComponentVisibilityAlertComponent]})],t.ComponentVisibilityAlertModule);window.__smartedit__.addDecoratorPayload("Component","SlotSyncButtonComponent",{selector:"slot-sync-button",template:`<div class="se-slot-sync-button-template" *ngIf="isReady"><se-popup-overlay #popupOverlayComponent [popupOverlay]="popupConfig" [popupOverlayTrigger]="isPopupOpened" (popupOverlayOnHide)="onPopupHide()"><div><se-tooltip *ngIf="newSlotIsNotSynchronized && !slotIsShared" [triggers]="['mouseenter', 'mouseleave']" [placement]="'bottom'" [additionalClasses]="['se-slot-ctx-menu__tooltip-area']"><span class="se-slot-ctx-menu__popover-ancor" se-tooltip-trigger></span><div class="se-popover--inner-content" se-tooltip-body translate="se.cms.slot.sync.from.page.level"></div></se-tooltip><se-tooltip *ngIf="newSlotIsNotSynchronized && slotIsShared" [triggers]="['mouseenter', 'mouseleave']" [placement]="'bottom'" [additionalClasses]="['se-slot-ctx-menu__tooltip-area']"><span class="se-slot-ctx-menu__popover-ancor" se-tooltip-trigger></span><div se-tooltip-body class="se-popover--inner-content" translate="se.cms.slot.sync.from.catalog.level"></div></se-tooltip><button type="button" (click)="dropdownToggle()" class="se-slot-ctx-menu__dropdown-toggle" [ngClass]="{\n                'se-slot-ctx-menu__dropdown-toggle--open': isPopupOpened,\n                'se-slot-ctx-menu__dropdown-toggle--disabled': newSlotIsNotSynchronized\n            }" id="slot-sync-button-{{slotId}}"><span class="sap-icon--synchronize se-slot-ctx-menu__dropdown-toggle-icon" title="{{ 'se.cms.pagetree.slot.node.menu.icon.synchronize.title' | translate }}"></span> <span *ngIf="!isSlotInSync" class="sap-icon--alert se-slot-sync__btn-status se-slot-ctx-menu__dropdown-toggle-add-on"></span></button></div><div class="se-slot__dropdown-menu" se-popup-overlay-body><div class="se-toolbar-menu-content__wrapper" *ngIf="isPopupOpened"><div class="se-slot-contextual-menu__header" translate="se.cms.synchronization.slot.header"></div><div class="se-slot-sync__body"><se-slot-synchronization-panel-wrapper [slotId]="slotId" (slotSyncItemsUpdated)="updatePosition()"></se-slot-synchronization-panel-wrapper></div></div></div></se-popup-overlay></div>`,styles:[`slot-sync-button .se-slot-ctx-menu__tooltip-area{position:absolute}slot-sync-button .se-slot-ctx-menu__tooltip-area,slot-sync-button .se-slot-ctx-menu__tooltip-area .fd-popover__control,slot-sync-button .se-slot-ctx-menu__tooltip-area>div{width:100%;height:100%}`],encapsulation:i.ViewEncapsulation.None});t.SlotSyncButtonComponent=class SlotSyncButtonComponent{constructor(e,t,n,i,o){this.contextualMenuItem=e;this.slotSynchronizationService=t;this.pageInfoService=n;this.crossFrameEventService=i;this.cdr=o;this.buttonName="slotSyncButton";this.isPopupOpened=false;this.isReady=false;this.isSlotInSync=true;this.newSlotIsNotSynchronized=false;this.slotIsShared=false;this.popupConfig={halign:"left",valign:"bottom",additionalClasses:["se-slot-ctx-menu__divider","se-slot-ctx-menu__dropdown-toggle-wrapper"]}}ngOnInit(){this.unregisterSyncPolling=this.crossFrameEventService.subscribe(q.FAST_FETCH,(()=>this.getSyncStatus()));this.unregisterOuterFrameClicked=this.crossFrameEventService.subscribe(o.EVENT_OUTER_FRAME_CLICKED,(()=>{if(this.crossFrameEventService.isIframe()){this.isPopupOpened=false;if(!this.cdr.destroyed){this.cdr.detectChanges()}}}));this.unregisterInnerFrameClicked=this.crossFrameEventService.subscribe(o.EVENT_INNER_FRAME_CLICKED,(()=>{if(!this.crossFrameEventService.isIframe()){this.isPopupOpened=false;if(!this.cdr.destroyed){this.cdr.detectChanges()}}}));return this.getSyncStatus()}ngOnDestroy(){if(this.unregisterSyncPolling){this.unregisterSyncPolling()}if(this.unregisterOuterFrameClicked){this.unregisterOuterFrameClicked()}if(this.unregisterInnerFrameClicked){this.unregisterInnerFrameClicked()}}ngDoCheck(){if(this.isPopupOpenedPreviousValue!==this.isPopupOpened){this.contextualMenuItem.setRemainOpen(this.buttonName,this.isPopupOpened);this.isPopupOpenedPreviousValue=this.isPopupOpened}}get slotId(){return this.contextualMenuItem.componentAttributes.smarteditComponentId}dropdownToggle(){this.isPopupOpened=!this.isPopupOpened}onPopupHide(){this.isPopupOpened=false}updatePosition(){setTimeout((()=>this.popupOverlay.updatePosition()))}getSyncStatus(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.pageInfoService.getPageUUID();const t=yield this.slotSynchronizationService.getSyncStatus(e,this.slotId);if(this.slotSynchronizationService.syncStatusExists(t)){this.isSlotInSync=this.statusIsInSync(t);this.newSlotIsNotSynchronized=this.slotHasBeenSynchronizedAtLeastOnce(t);this.slotIsShared=t.fromSharedDependency;this.isReady=true}else{this.isReady=false}if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}statusIsInSync(e){return(e===null||e===void 0?void 0:e.status)===K.IN_SYNC}slotHasBeenSynchronizedAtLeastOnce(e){return!e.lastSyncStatus}};__decorate([i.ViewChild("popupOverlayComponent"),__metadata("design:type",o.PopupOverlayComponent)],t.SlotSyncButtonComponent.prototype,"popupOverlay",void 0);t.SlotSyncButtonComponent=__decorate([i.Component({selector:"slot-sync-button",template:`<div class="se-slot-sync-button-template" *ngIf="isReady"><se-popup-overlay #popupOverlayComponent [popupOverlay]="popupConfig" [popupOverlayTrigger]="isPopupOpened" (popupOverlayOnHide)="onPopupHide()"><div><se-tooltip *ngIf="newSlotIsNotSynchronized && !slotIsShared" [triggers]="['mouseenter', 'mouseleave']" [placement]="'bottom'" [additionalClasses]="['se-slot-ctx-menu__tooltip-area']"><span class="se-slot-ctx-menu__popover-ancor" se-tooltip-trigger></span><div class="se-popover--inner-content" se-tooltip-body translate="se.cms.slot.sync.from.page.level"></div></se-tooltip><se-tooltip *ngIf="newSlotIsNotSynchronized && slotIsShared" [triggers]="['mouseenter', 'mouseleave']" [placement]="'bottom'" [additionalClasses]="['se-slot-ctx-menu__tooltip-area']"><span class="se-slot-ctx-menu__popover-ancor" se-tooltip-trigger></span><div se-tooltip-body class="se-popover--inner-content" translate="se.cms.slot.sync.from.catalog.level"></div></se-tooltip><button type="button" (click)="dropdownToggle()" class="se-slot-ctx-menu__dropdown-toggle" [ngClass]="{\n                'se-slot-ctx-menu__dropdown-toggle--open': isPopupOpened,\n                'se-slot-ctx-menu__dropdown-toggle--disabled': newSlotIsNotSynchronized\n            }" id="slot-sync-button-{{slotId}}"><span class="sap-icon--synchronize se-slot-ctx-menu__dropdown-toggle-icon" title="{{ 'se.cms.pagetree.slot.node.menu.icon.synchronize.title' | translate }}"></span> <span *ngIf="!isSlotInSync" class="sap-icon--alert se-slot-sync__btn-status se-slot-ctx-menu__dropdown-toggle-add-on"></span></button></div><div class="se-slot__dropdown-menu" se-popup-overlay-body><div class="se-toolbar-menu-content__wrapper" *ngIf="isPopupOpened"><div class="se-slot-contextual-menu__header" translate="se.cms.synchronization.slot.header"></div><div class="se-slot-sync__body"><se-slot-synchronization-panel-wrapper [slotId]="slotId" (slotSyncItemsUpdated)="updatePosition()"></se-slot-synchronization-panel-wrapper></div></div></div></se-popup-overlay></div>`,styles:[`slot-sync-button .se-slot-ctx-menu__tooltip-area{position:absolute}slot-sync-button .se-slot-ctx-menu__tooltip-area,slot-sync-button .se-slot-ctx-menu__tooltip-area .fd-popover__control,slot-sync-button .se-slot-ctx-menu__tooltip-area>div{width:100%;height:100%}`],encapsulation:i.ViewEncapsulation.None}),__param(0,i.Inject(o.CONTEXTUAL_MENU_ITEM_DATA)),__metadata("design:paramtypes",[Object,t.SlotSynchronizationService,o.IPageInfoService,o.CrossFrameEventService,i.ChangeDetectorRef])],t.SlotSyncButtonComponent);window.__smartedit__.addDecoratorPayload("Component","SlotSynchronizationPanelWrapperComponent",{selector:"se-slot-synchronization-panel-wrapper",template:`<se-synchronization-panel [itemId]="slotId" [getSyncStatus]="getSyncStatus" [performSync]="performSync" [selectAllLabel]="'se.cms.synchronization.slots.select.all.components'" (getApi)="getApi($event)" (syncItemsUpdated)="syncItemsUpdated()"></se-synchronization-panel>`});t.SlotSynchronizationPanelWrapperComponent=class SlotSynchronizationPanelWrapperComponent{constructor(e,t,n,o,s){this.pageService=e;this.pageInfoService=t;this.slotSynchronizationService=n;this.pageContentSlotsService=o;this.translateService=s;this.slotSyncItemsUpdated=new i.EventEmitter;this.getSyncStatus=()=>__awaiter(this,void 0,void 0,(function*(){const e=yield this.pageInfoService.getPageUID();const t=yield this.slotSynchronizationService.getSyncStatus(e,this.slotId);if(!this.slotSynchronizationService.syncStatusExists(t)){throw new Error("The SlotSynchronizationPanel must only be called for the slot whose sync status is available.")}const n=yield this.isSyncDisallowed();if(n){this.disableSync()}return t}));this.performSync=e=>this.slotSynchronizationService.performSync(e,null)}getApi(e){this.synchronizationPanelApi=e}syncItemsUpdated(){this.slotSyncItemsUpdated.emit()}isSyncDisallowed(){return __awaiter(this,void 0,void 0,(function*(){const[e,t]=yield Promise.all([this.isPageSlot(),this.isPageApproved()]);return e&&!t}))}isPageSlot(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.pageContentSlotsService.getSlotStatus(this.slotId);return e===t.SlotStatus.PAGE||e===t.SlotStatus.OVERRIDE}))}isPageApproved(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.pageInfoService.getPageUUID();return this.pageService.isPageApproved(e)}))}disableSync(){this.synchronizationPanelApi.setMessage({type:o.IAlertServiceType.WARNING,description:this.translateService.instant("se.cms.synchronization.slot.disabled.msg")});this.synchronizationPanelApi.disableItemList(true)}};__decorate([i.Input(),__metadata("design:type",String)],t.SlotSynchronizationPanelWrapperComponent.prototype,"slotId",void 0);__decorate([i.Output(),__metadata("design:type",i.EventEmitter)],t.SlotSynchronizationPanelWrapperComponent.prototype,"slotSyncItemsUpdated",void 0);t.SlotSynchronizationPanelWrapperComponent=__decorate([i.Component({selector:"se-slot-synchronization-panel-wrapper",template:`<se-synchronization-panel [itemId]="slotId" [getSyncStatus]="getSyncStatus" [performSync]="performSync" [selectAllLabel]="'se.cms.synchronization.slots.select.all.components'" (getApi)="getApi($event)" (syncItemsUpdated)="syncItemsUpdated()"></se-synchronization-panel>`}),__metadata("design:paramtypes",[o.IPageService,o.IPageInfoService,t.SlotSynchronizationService,o.PageContentSlotsService,s.TranslateService])],t.SlotSynchronizationPanelWrapperComponent);window.__smartedit__.addDecoratorPayload("Component","SlotSharedButtonComponent",{selector:"slot-shared-button",template:`<div class="se-shared-slot-button-template" *ngIf="isGlobalSlot || isSlotShared"><se-popup-overlay [popupOverlay]="popupConfig" [popupOverlayTrigger]="isPopupOpened" (popupOverlayOnHide)="hidePopup()"><button type="button" id="sharedSlotButton-{{ slotId }}" class="se-slot-ctx-menu__dropdown-toggle se-slot-ctx-menu__dropdown-toggle-icon" [ngClass]="{\n                'se-slot-ctx-menu__dropdown-toggle--open': isPopupOpened,\n                'sap-icon--chain-link': isSlotShared,\n                'sap-icon--globe': isGlobalSlot\n            }" (click)="onButtonClick()" title="{{ getSlotSharedButtonComponentIconTitle() | translate }}"></button><div class="se-slot__dropdown-menu" se-popup-overlay-body><div class="se-slot-contextual-menu__header" [translate]="labelL10nKey"></div><div class="se-shared-slot__body"><div class="se-shared-slot__description" translate="se.cms.slot.shared.popover.commonmessage"></div><div class="se-shared-slot__description" [translate]="descriptionL10nKey" [translateParams]="{ catalogVersion: componentAttributes.smarteditCatalogVersionUuid }"></div><div *seHasOperationPermission="'se.shared.slot.override.options'"><div class="se-shared-slot__option"><a href="#" class="se-shared-slot__link replace-slot-link fd-link" translate="se.cms.slot.shared.popover.button.replaceslot" (click)="replaceSlot($event)"></a></div></div></div></div></se-popup-overlay></div>`});t.SlotSharedButtonComponent=class SlotSharedButtonComponent{constructor(e,t,n,i,o,s,r){this.contextualMenuItem=e;this.catalogService=t;this.componentHandlerService=n;this.crossFrameEventService=i;this.pageInfoService=o;this.slotSharedService=s;this.cdr=r;this.popupConfig={halign:"left",valign:"bottom",additionalClasses:["se-slot-ctx-menu__divider","se-slot-ctx-menu__dropdown-toggle-wrapper"]};this.buttonName="slotSharedButton";this.isPopupOpened=false;this.isPopupOpenedPreviousValue=false}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.unRegOuterFrameClicked=this.crossFrameEventService.subscribe(o.EVENT_OUTER_FRAME_CLICKED,(()=>{if(this.crossFrameEventService.isIframe()){this.hidePopup()}}));this.unRegInnerFrameClicked=this.crossFrameEventService.subscribe(o.EVENT_INNER_FRAME_CLICKED,(()=>{if(!this.crossFrameEventService.isIframe()){this.hidePopup()}}));this.isExternalSlot=yield this.componentHandlerService.isExternalComponent(this.slotId,this.componentAttributes.smarteditComponentType);const[e,t,n,i]=yield Promise.all([this.slotSharedService.isSlotShared(this.slotId),this.catalogService.isCurrentCatalogMultiCountry(),this.slotSharedService.isGlobalSlot(this.slotId,this.componentAttributes.smarteditComponentType),this.pageInfoService.isSameCatalogVersionOfPageAndPageTemplate()]);const s=t;this.isSlotShared=(!s||s&&i)&&!this.isExternalSlot&&e;this.isGlobalSlot=n;this.labelL10nKey=this.isGlobalSlot?"se.parentslot.decorator.label":"se.sharedslot.decorator.label";this.descriptionL10nKey=this.isGlobalSlot?"se.cms.slot.shared.parent.popover.message":"se.cms.slot.shared.popover.message";if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}getSlotSharedButtonComponentIconTitle(){if(!this.isGlobalSlot){return this.isSlotShared?"se.cms.pagetree.slot.node.menu.icon.chain.link.title":"se.cms.pagetree.slot.node.menu.icon.chain.dislink.title"}return"se.cms.pagetree.slot.node.menu.icon.chain.globalicon.title"}ngOnDestroy(){if(this.unRegOuterFrameClicked){this.unRegOuterFrameClicked()}if(this.unRegInnerFrameClicked){this.unRegInnerFrameClicked()}}ngDoCheck(){if(this.isPopupOpenedPreviousValue!==this.isPopupOpened){this.contextualMenuItem.setRemainOpen(this.buttonName,this.isPopupOpened);this.isPopupOpenedPreviousValue=this.isPopupOpened}}get componentAttributes(){return this.contextualMenuItem.componentAttributes}get slotId(){return this.componentAttributes.smarteditComponentId}onButtonClick(){this.isPopupOpened=!this.isPopupOpened}hidePopup(){this.isPopupOpened=false;if(!this.cdr.destroyed){this.cdr.detectChanges()}}replaceSlot(e){return __awaiter(this,void 0,void 0,(function*(){e.preventDefault();this.hidePopup();let t;if(this.isGlobalSlot){t=this.slotSharedService.replaceGlobalSlot(this.componentAttributes)}else{t=this.slotSharedService.replaceSharedSlot(this.componentAttributes)}yield t;this.reload()}))}reload(){this.componentHandlerService.reloadInner()}};t.SlotSharedButtonComponent=__decorate([i.Component({selector:"slot-shared-button",template:`<div class="se-shared-slot-button-template" *ngIf="isGlobalSlot || isSlotShared"><se-popup-overlay [popupOverlay]="popupConfig" [popupOverlayTrigger]="isPopupOpened" (popupOverlayOnHide)="hidePopup()"><button type="button" id="sharedSlotButton-{{ slotId }}" class="se-slot-ctx-menu__dropdown-toggle se-slot-ctx-menu__dropdown-toggle-icon" [ngClass]="{\n                'se-slot-ctx-menu__dropdown-toggle--open': isPopupOpened,\n                'sap-icon--chain-link': isSlotShared,\n                'sap-icon--globe': isGlobalSlot\n            }" (click)="onButtonClick()" title="{{ getSlotSharedButtonComponentIconTitle() | translate }}"></button><div class="se-slot__dropdown-menu" se-popup-overlay-body><div class="se-slot-contextual-menu__header" [translate]="labelL10nKey"></div><div class="se-shared-slot__body"><div class="se-shared-slot__description" translate="se.cms.slot.shared.popover.commonmessage"></div><div class="se-shared-slot__description" [translate]="descriptionL10nKey" [translateParams]="{ catalogVersion: componentAttributes.smarteditCatalogVersionUuid }"></div><div *seHasOperationPermission="'se.shared.slot.override.options'"><div class="se-shared-slot__option"><a href="#" class="se-shared-slot__link replace-slot-link fd-link" translate="se.cms.slot.shared.popover.button.replaceslot" (click)="replaceSlot($event)"></a></div></div></div></div></se-popup-overlay></div>`}),__param(0,i.Inject(o.CONTEXTUAL_MENU_ITEM_DATA)),__metadata("design:paramtypes",[Object,o.ICatalogService,o.IComponentHandlerService,o.CrossFrameEventService,o.IPageInfoService,o.SlotSharedService,i.ChangeDetectorRef])],t.SlotSharedButtonComponent);window.__smartedit__.addDecoratorPayload("Component","SlotUnsharedButtonComponent",{selector:"slot-unshared-button",template:`<div class="slot-unshared-button-template" *ngIf="isLocalSlot || isNonSharedSlot"><se-popup-overlay [popupOverlay]="popupConfig" [popupOverlayTrigger]="isPopupOpened" (popupOverlayOnHide)="hidePopup()"><button type="button" id="slot-unshared-button-{{ slotId }}" class="se-slot-ctx-menu__dropdown-toggle se-slot-ctx-menu__dropdown-toggle-icon" [ngClass]="{\n                'se-slot-ctx-menu__dropdown-toggle--open': isPopupOpened,\n                'sap-icon--chain-link': isLocalSlot,\n                'sap-icon--broken-link': isNonSharedSlot\n            }" (click)="toggle()" title="{{ getSlotNotSharedButtonComponentIconTitle() | translate }}"></button><div class="se-toolbar-menu-content se-slot__dropdown-menu" se-popup-overlay-body><div class="se-slot-contextual-menu__header" [translate]="getHeader()"></div><div class="se-shared-slot__body"><div class="se-shared-slot__description" translate="se.cms.slot.unshared.popover.commonmessage"></div><div *seHasOperationPermission="'se.shared.slot.override.options'" class="se-shared-slot-replace__div"><div *ngIf="isLocalSlot" class="se-shared-slot__option"><a href="#" class="se-shared-slot__link replace-slot-link fd-link" translate="se.cms.slot.shared.popover.button.replaceslot" (click)="replaceSlot($event)"></a></div></div><div *seHasOperationPermission="'se.revert.to.global.or.shared.slot.link'" class="se-shared-slot__option"><a href="#" class="se-shared-slot__link revert-slot-link fd-link" [translate]="removeSlotLinkLabel" (click)="removeSlot($event)"></a></div></div></div></se-popup-overlay></div>`,changeDetection:i.ChangeDetectionStrategy.OnPush});t.SlotUnsharedButtonComponent=class SlotUnsharedButtonComponent{constructor(e,t,n,i,o,s,r,a,l,c,d,p,u){this.contextualMenuItem=e;this.catalogService=t;this.confirmationModalService=n;this.componentHandlerService=i;this.crossFrameEventService=o;this.slotUnsharedService=s;this.sharedDataService=r;this.slotSharedService=a;this.translateService=l;this.pageInfoService=c;this.logService=d;this.windowUtils=p;this.cdr=u;this.isPopupOpened=false;this.isPopupOpenedPreviousValue=this.isPopupOpened;this.popupConfig={halign:"left",valign:"bottom",additionalClasses:["se-slot-ctx-menu__dropdown-toggle-wrapper","se-slot-ctx-menu__divider"]};this.buttonName="slotUnsharedButton"}ngOnInit(){var e,t;return __awaiter(this,void 0,void 0,(function*(){this.unRegOuterFrameClicked=this.crossFrameEventService.subscribe(o.EVENT_OUTER_FRAME_CLICKED,(()=>{if(this.windowUtils.isIframe()){this.hidePopup()}}));this.unRegInnerFrameClicked=this.crossFrameEventService.subscribe(o.EVENT_INNER_FRAME_CLICKED,(()=>{if(!this.windowUtils.isIframe()){this.hidePopup()}}));this.isExternalSlot=yield this.componentHandlerService.isExternalComponent(this.slotId,this.componentAttributes.smarteditComponentType);const[n,i,s,r,a]=yield Promise.all([this.slotUnsharedService.isSlotShared(this.slotId),this.catalogService.isCurrentCatalogMultiCountry(),this.slotUnsharedService.isSlotUnshared(this.slotId),this.pageInfoService.isSameCatalogVersionOfPageAndPageTemplate(),this.sharedDataService.get("experience")]);this.isSlotShared=n;this.isMultiCountry=i;this.isSlotUnshared=s;const l=((e=a===null||a===void 0?void 0:a.pageContext)===null||e===void 0?void 0:e.catalogVersionUuid)||"";const c=((t=a===null||a===void 0?void 0:a.catalogDescriptor)===null||t===void 0?void 0:t.catalogVersionUuid)||"";this.isCurrentPageFromParent=c!==l;this.isLocalSlot=this.isMultiCountry&&!r&&!this.isExternalSlot&&!this.isCurrentPageFromParent&&this.isSlotShared;this.isNonSharedSlot=!this.isExternalSlot&&!this.isSlotShared&&this.isSlotUnshared;this.removeSlotLinkLabel=this.getRemoveSlotLinkLabel();if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}getSlotNotSharedButtonComponentIconTitle(){return this.isSlotShared?"se.cms.pagetree.slot.node.menu.icon.chain.link.title":"se.cms.pagetree.slot.node.menu.icon.chain.dislink.title"}ngOnDestroy(){if(this.unRegOuterFrameClicked){this.unRegOuterFrameClicked()}if(this.unRegInnerFrameClicked){this.unRegInnerFrameClicked()}}ngDoCheck(){if(this.isPopupOpenedPreviousValue!==this.isPopupOpened){this.isPopupOpenedPreviousValue=this.isPopupOpened;this.contextualMenuItem.setRemainOpen(this.buttonName,this.isPopupOpened)}}get componentAttributes(){return this.contextualMenuItem.componentAttributes}get slotId(){return this.componentAttributes.smarteditComponentId}getHeader(){return this.isLocalSlot?"se.localslot.decorator.label":"se.nonshared.decorator.label"}toggle(){this.isPopupOpened=!this.isPopupOpened}hidePopup(){this.isPopupOpened=false;if(!this.cdr.destroyed){this.cdr.detectChanges()}}removeSlot(e){return __awaiter(this,void 0,void 0,(function*(){e.preventDefault();this.hidePopup();const t=yield this.confirmationModalService.confirm({title:this.removeSlotLinkLabel,description:this.isLocalSlot?"se.cms.local.slot.remove.description":"se.cms.slot.remove.description",message:{id:"removeSlotYMessage",text:this.isLocalSlot?"se.cms.local.slot.remove.sync.ymessage":"se.cms.slot.remove.sync.ymessage",type:o.MessageType.info}}).catch((()=>{this.logService.log("Confirmation cancelled")}));if(!t){return}yield this.slotUnsharedService.revertToSharedSlot(this.componentAttributes.smarteditComponentUuid);this.reload()}))}replaceSlot(e){return __awaiter(this,void 0,void 0,(function*(){e.preventDefault();this.hidePopup();let t;if(this.isLocalSlot){t=this.slotSharedService.replaceSharedSlot(this.componentAttributes)}yield t;this.reload()}))}getRemoveSlotLinkLabel(){return this.isLocalSlot?"se.cms.slot.shared.remove.local.slot.title":"se.cms.slot.shared.remove.nonshard.slot.title"}reload(){this.componentHandlerService.reloadInner()}};t.SlotUnsharedButtonComponent=__decorate([i.Component({selector:"slot-unshared-button",template:`<div class="slot-unshared-button-template" *ngIf="isLocalSlot || isNonSharedSlot"><se-popup-overlay [popupOverlay]="popupConfig" [popupOverlayTrigger]="isPopupOpened" (popupOverlayOnHide)="hidePopup()"><button type="button" id="slot-unshared-button-{{ slotId }}" class="se-slot-ctx-menu__dropdown-toggle se-slot-ctx-menu__dropdown-toggle-icon" [ngClass]="{\n                'se-slot-ctx-menu__dropdown-toggle--open': isPopupOpened,\n                'sap-icon--chain-link': isLocalSlot,\n                'sap-icon--broken-link': isNonSharedSlot\n            }" (click)="toggle()" title="{{ getSlotNotSharedButtonComponentIconTitle() | translate }}"></button><div class="se-toolbar-menu-content se-slot__dropdown-menu" se-popup-overlay-body><div class="se-slot-contextual-menu__header" [translate]="getHeader()"></div><div class="se-shared-slot__body"><div class="se-shared-slot__description" translate="se.cms.slot.unshared.popover.commonmessage"></div><div *seHasOperationPermission="'se.shared.slot.override.options'" class="se-shared-slot-replace__div"><div *ngIf="isLocalSlot" class="se-shared-slot__option"><a href="#" class="se-shared-slot__link replace-slot-link fd-link" translate="se.cms.slot.shared.popover.button.replaceslot" (click)="replaceSlot($event)"></a></div></div><div *seHasOperationPermission="'se.revert.to.global.or.shared.slot.link'" class="se-shared-slot__option"><a href="#" class="se-shared-slot__link revert-slot-link fd-link" [translate]="removeSlotLinkLabel" (click)="removeSlot($event)"></a></div></div></div></se-popup-overlay></div>`,changeDetection:i.ChangeDetectionStrategy.OnPush}),__param(0,i.Inject(o.CONTEXTUAL_MENU_ITEM_DATA)),__metadata("design:paramtypes",[Object,o.ICatalogService,o.IConfirmationModalService,o.IComponentHandlerService,o.CrossFrameEventService,t.SlotUnsharedService,o.ISharedDataService,o.SlotSharedService,s.TranslateService,o.IPageInfoService,o.LogService,o.WindowUtils,i.ChangeDetectorRef])],t.SlotUnsharedButtonComponent);t.CmsCommonsModule=class CmsCommonsModule{};t.CmsCommonsModule=__decorate([i.NgModule({imports:[r.CommonModule,o.SpinnerModule,m.LinkModule,s.TranslateModule.forChild(),t.SynchronizationPanelModule,t.ComponentVisibilityAlertModule,o.TooltipModule,o.PopupOverlayModule,o.HasOperationPermissionDirectiveModule],providers:[t.AttributePermissionsRestService,t.CMSTimeService,t.SynchronizationService,t.TypePermissionsRestService,t.ComponentService,t.SynchronizationResourceService,t.AssetsService],declarations:[t.ActionableAlertComponent,t.SharedComponentButtonComponent,t.ExternalComponentButtonComponent,t.SlotSyncButtonComponent,t.SlotSynchronizationPanelWrapperComponent,t.SlotSharedButtonComponent,t.SlotUnsharedButtonComponent],entryComponents:[t.SharedComponentButtonComponent,t.ExternalComponentButtonComponent,t.SlotSyncButtonComponent,t.SlotSynchronizationPanelWrapperComponent,t.SlotSharedButtonComponent,t.SlotUnsharedButtonComponent],exports:[t.ActionableAlertComponent,t.SharedComponentButtonComponent,t.ExternalComponentButtonComponent,t.SlotSyncButtonComponent,t.SlotSharedButtonComponent,t.SlotUnsharedButtonComponent,t.SynchronizationPanelModule,t.ComponentVisibilityAlertModule]})],t.CmsCommonsModule);t.DRAG_AND_DROP_EVENTS=void 0;(function(e){e["DRAG_STARTED"]="CMS_DRAG_STARTED";e["DRAG_STOPPED"]="CMS_DRAG_STOPPED";e["DRAG_OVER"]="CMS_DRAG_OVER";e["DRAG_LEAVE"]="CMS_DRAG_LEAVE";e["SCROLL_TO_MODIFIED_SLOT"]="SCROLL_TO_MODIFIED_SLOT"})(t.DRAG_AND_DROP_EVENTS||(t.DRAG_AND_DROP_EVENTS={}));const ee="COMPONENT_CREATED_EVENT";const te="COMPONENT_REMOVED_EVENT";const ne="COMPONENT_UPDATED_EVENT";const ie="CMSITEMS_UPDATE";const oe="EVENT_PAGE_STATUS_UPDATED_IN_ACTIVE_CV";const se="CMSNavigationNode";const re="root";const ae="/cmssmartedit/images";t.CATALOG_SYNC_INTERVAL_IN_MILLISECONDS=Z;t.CMSITEMS_UPDATE_EVENT=ie;t.COMPONENT_CREATED_EVENT=ee;t.COMPONENT_REMOVED_EVENT=te;t.COMPONENT_UPDATED_EVENT=ne;t.CONTENT_SLOTS_TYPE_RESTRICTION_RESOURCE_URI=R;t.CONTENT_SLOT_TYPE_RESTRICTION_RESOURCE_URI=A;t.CONTEXTUAL_PAGES_RESTRICTIONS_RESOURCE_URI=j;t.CONTEXT_CATALOG=f;t.CONTEXT_CATALOG_VERSION=E;t.CONTEXT_SITE_ID=I;t.DEFAULT_SYNCHRONIZATION_EVENT=Y;t.DEFAULT_SYNCHRONIZATION_POLLING=q;t.DEFAULT_SYNCHRONIZATION_STATUSES=K;t.EVENT_PAGE_STATUS_UPDATED_IN_ACTIVE_CV=oe;t.GET_PAGE_SYNCHRONIZATION_RESOURCE_URI=W;t.IComponentEditingFacade=IComponentEditingFacade;t.IComponentMenuConditionAndCallbackService=IComponentMenuConditionAndCallbackService;t.IComponentSharedService=IComponentSharedService;t.IComponentVisibilityAlertService=IComponentVisibilityAlertService;t.IContextAwareEditableItemService=IContextAwareEditableItemService;t.IEditorEnablerService=IEditorEnablerService;t.IMAGES_URL=ae;t.IPageContentSlotsComponentsRestService=IPageContentSlotsComponentsRestService;t.IRemoveComponentService=IRemoveComponentService;t.ISlotVisibilityService=ISlotVisibilityService;t.ITEMS_RESOURCE_URI=P;t.NAVIGATION_MANAGEMENT_ENTRIES_RESOURCE_URI=k;t.NAVIGATION_MANAGEMENT_ENTRY_TYPES_RESOURCE_URI=V;t.NAVIGATION_MANAGEMENT_PAGE_PATH=L;t.NAVIGATION_MANAGEMENT_RESOURCE_URI=U;t.NAVIGATION_NODE_ROOT_NODE_UID=re;t.NAVIGATION_NODE_TYPECODE=se;t.PAGES_CONTENT_SLOT_COMPONENT_RESOURCE_URI=w;t.PAGES_CONTENT_SLOT_RESOURCE_URI=x;t.PAGES_LIST_RESOURCE_URI=D;t.PAGES_RESTRICTIONS_RESOURCE_URI=z;t.PAGE_CONTEXT_CATALOG=b;t.PAGE_CONTEXT_CATALOG_VERSION=T;t.PAGE_LIST_PATH=M;t.PAGE_TEMPLATES_URI=F;t.PAGE_TYPES_RESTRICTION_TYPES_URI=H;t.PAGE_TYPES_URI=G;t.POST_PAGE_SYNCHRONIZATION_RESOURCE_URI=$;t.RESTRICTION_TYPES_URI=B;t.SynchronizationUtils=SynchronizationUtils;t.TRASHED_PAGE_LIST_PATH=N;t.TYPES_RESOURCE_URI=O;t.WORKFLOW_CREATED_EVENT=g;t.WORKFLOW_FINISHED_EVENT=_;t.slotEvictionTag=C;t.synchronizationUtils=Q;t.workflowCompletedEvictionTag=S;t.workflowCreatedEvictionTag=v;t.workflowTasksMenuOpenedEvictionTag=y},1271:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=n(32709);var o=n(9501);var s=n(3490);var r=n(12549);var a=n(66791);var l=n(22630);var c=n(38102);var d=n(30178);var p=n(38788);function __decorate(e,t,n,i){var o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s;return o>3&&s&&Object.defineProperty(t,n,s),s}function __param(e,t){return function(n,i){t(n,i,e)}}function __metadata(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}function __awaiter(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))}window.__smartedit__.addDecoratorPayload("Component","ExternalComponentDecoratorComponent",{selector:"external-component-decorator",template:`<div [ngClass]="{\n        'cms-external-component-decorator': !isExternalSlot,\n        'cms-external-component-decorator--versioning': isVersioningPerspective,\n        'disabled-shared-slot-hovered': isActive && !isExternalSlot\n    }"><div class="se-ctx-menu__overlay" *ngIf="!isExternalSlot && isReady"><se-tooltip *ngIf="!isActive || isVersioningPerspective" [placement]="'bottom'" [isChevronVisible]="true" [triggers]="['mouseenter', 'mouseleave']"><span se-tooltip-trigger class="se-ctx-menu-element__btn sap-icon--globe"></span><div se-tooltip-body translate="se.cms.from.external.catalog.version" [translateParams]="{ catalogVersion: catalogVersionText }"></div></se-tooltip></div><div class="se-wrapper-data" [ngClass]="{ 'disabled-shared-slot-versioning-mode': isVersioningPerspective && !isExternalSlot }"><ng-content></ng-content></div></div>`,styles:[`.cms-external-component-decorator{border:1px solid #dbe3eb;height:100%}.cms-external-component-decorator>.se-ctx-menu__overlay{left:1px!important;top:1px!important}`],providers:[r.L10nPipe]});let u=class ExternalComponentDecoratorComponent{constructor(e,t,n,i,o,s){this.catalogService=e;this.cMSModesService=t;this.componentHandlerService=n;this.l10nPipe=i;this.logService=o;this.element=s;this.isActive=false;this.isExternalSlot=false;this.isReady=false;this.isVersioningPerspective=false}set active(e){this.isActive=e==="true"}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){const e=this.componentHandlerService.getParentSlotForComponent(this.element.nativeElement);this.isExternalSlot=yield this.componentHandlerService.isExternalComponent(e,r.CONTENT_SLOT_TYPE);this.isReady=false;this.isVersioningPerspective=yield this.cMSModesService.isVersioningPerspectiveActive();try{this.catalogVersionText=yield this.getCatalogVersionText(this.smarteditCatalogVersionUuid);this.isReady=true}catch(e){this.logService.error(`${this.constructor.name} - cannot find catalog version for uuid`,this.smarteditCatalogVersionUuid)}}))}getCatalogVersionText(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.catalogService.getCatalogVersionByUuid(e);const n=yield this.l10nPipe.transform(t.catalogName).pipe(a.take(1)).toPromise();return`${n} (${t.version})`}))}};__decorate([i.Input("data-smartedit-catalog-version-uuid"),__metadata("design:type",String)],u.prototype,"smarteditCatalogVersionUuid",void 0);__decorate([i.Input(),__metadata("design:type",String),__metadata("design:paramtypes",[String])],u.prototype,"active",null);u=__decorate([r.SeCustomComponent(),i.Component({selector:"external-component-decorator",template:`<div [ngClass]="{\n        'cms-external-component-decorator': !isExternalSlot,\n        'cms-external-component-decorator--versioning': isVersioningPerspective,\n        'disabled-shared-slot-hovered': isActive && !isExternalSlot\n    }"><div class="se-ctx-menu__overlay" *ngIf="!isExternalSlot && isReady"><se-tooltip *ngIf="!isActive || isVersioningPerspective" [placement]="'bottom'" [isChevronVisible]="true" [triggers]="['mouseenter', 'mouseleave']"><span se-tooltip-trigger class="se-ctx-menu-element__btn sap-icon--globe"></span><div se-tooltip-body translate="se.cms.from.external.catalog.version" [translateParams]="{ catalogVersion: catalogVersionText }"></div></se-tooltip></div><div class="se-wrapper-data" [ngClass]="{ 'disabled-shared-slot-versioning-mode': isVersioningPerspective && !isExternalSlot }"><ng-content></ng-content></div></div>`,styles:[`.cms-external-component-decorator{border:1px solid #dbe3eb;height:100%}.cms-external-component-decorator>.se-ctx-menu__overlay{left:1px!important;top:1px!important}`],providers:[r.L10nPipe]}),__metadata("design:paramtypes",[r.ICatalogService,r.CMSModesService,r.IComponentHandlerService,r.L10nPipe,r.LogService,i.ElementRef])],u);window.__smartedit__.addDecoratorPayload("Component","SyncIndicatorDecorator",{selector:"sync-indicator",template:`<div class="sync-indicator-decorator" [ngClass]="syncStatus.status" [attr.sync-status]="syncStatus.status"><ng-content class="se-wrapper-data"></ng-content></div>`,changeDetection:i.ChangeDetectionStrategy.OnPush});let m=class SyncIndicatorDecorator extends r.AbstractDecorator{constructor(e,t,n,i,o){super();this.catalogService=e;this.slotSynchronizationService=t;this.crossFrameEventService=n;this.pageInfoService=i;this.cdr=o;this.isVersionNonActive=false;this.syncStatus={status:s.DEFAULT_SYNCHRONIZATION_STATUSES.UNAVAILABLE}}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){yield Promise.all([this.getPageUuid(),this.getIsVersionNonActive()]);if(this.isVersionNonActive){yield this.fetchSyncStatus()}this.unRegisterSyncPolling=this.crossFrameEventService.subscribe(s.DEFAULT_SYNCHRONIZATION_POLLING.FAST_FETCH,(()=>__awaiter(this,void 0,void 0,(function*(){yield this.fetchSyncStatus();if(!this.cdr.destroyed){this.cdr.detectChanges()}}))));if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}ngOnDestroy(){if(this.unRegisterSyncPolling){this.unRegisterSyncPolling()}}getPageUuid(){return __awaiter(this,void 0,void 0,(function*(){this.pageUUID=yield this.pageInfoService.getPageUUID()}))}getIsVersionNonActive(){return __awaiter(this,void 0,void 0,(function*(){this.isVersionNonActive=yield this.catalogService.isContentCatalogVersionNonActive()}))}fetchSyncStatus(){return __awaiter(this,void 0,void 0,(function*(){if(!this.isVersionNonActive){return}try{const e=yield this.slotSynchronizationService.getSyncStatus(this.pageUUID,this.componentAttributes.smarteditComponentId);if(this.slotSynchronizationService.syncStatusExists(e)){this.syncStatus=e}}catch(e){this.syncStatus.status=s.DEFAULT_SYNCHRONIZATION_STATUSES.UNAVAILABLE}}))}};m=__decorate([i.Component({selector:"sync-indicator",template:`<div class="sync-indicator-decorator" [ngClass]="syncStatus.status" [attr.sync-status]="syncStatus.status"><ng-content class="se-wrapper-data"></ng-content></div>`,changeDetection:i.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[r.ICatalogService,s.SlotSynchronizationService,r.CrossFrameEventService,r.IPageInfoService,i.ChangeDetectorRef])],m);t.SlotContainerService=class SlotContainerService{constructor(e,t){this.experienceService=t;const n=`/cmswebservices/v1/sites/${r.PAGE_CONTEXT_SITE_ID}/catalogs/${r.PAGE_CONTEXT_CATALOG}/versions/${r.PAGE_CONTEXT_CATALOG_VERSION}/pagescontentslotscontainers?pageId=:pageId`;this.containersRestService=e.get(n)}getComponentContainer(e,t){return __awaiter(this,void 0,void 0,(function*(){const n=yield this.loadContainersInPageInfo();const i=n.filter((n=>n.slotId===e&&l.includes(n.components,t)));return i.length>0?i[0]:null}))}loadContainersInPageInfo(){return __awaiter(this,void 0,void 0,(function*(){if(this.containersInPage){return this.containersInPage}const e=yield this.experienceService.getCurrentExperience();const t=yield this.containersRestService.get({pageId:e.pageId});this.containersInPage=t.pageContentSlotContainerList;return this.containersInPage}))}};t.SlotContainerService=__decorate([i.Injectable(),__metadata("design:paramtypes",[r.IRestServiceFactory,r.IExperienceService])],t.SlotContainerService);t.HiddenComponentMenuService=class HiddenComponentMenuService{constructor(e,t){this.contextualMenuService=e;this.slotContainerService=t;this.MENU_ITEM_EXTERNAL="externalcomponentbutton";this.MENU_ITEM_CLONE="clonecomponentbutton";this.MENU_ITEM_REMOVE="se.cms.remove";this.allowedItems={};this.setDefaultItemsAllowed()}allowItemsInHiddenComponentMenu(e){e.forEach((e=>{this.allowedItems[e]=true}))}removeAllowedItemsInHiddenComponentMenu(e){e.forEach((e=>{delete this.allowedItems[e]}))}getAllowedItemsInHiddenComponentMenu(){return Object.keys(this.allowedItems)}getItemsForHiddenComponent(e,t){return __awaiter(this,void 0,void 0,(function*(){this.validateComponent(e);const n=yield this.buildComponentInfo(t,e);return this.getAllowedItemsForComponent(e,n)}))}validateComponent(e){if(!e){throw new Error("HiddenComponentMenuService - Component cannot be null.")}if(!e.uid){throw new Error("HiddenComponentMenuService - Component needs a uid.")}if(!e.typeCode){throw new Error("HiddenComponentMenuService - Component needs a type code.")}if(!e.uuid){throw new Error("HiddenComponentMenuService - Component needs a uuid.")}}setDefaultItemsAllowed(){this.allowItemsInHiddenComponentMenu([this.MENU_ITEM_EXTERNAL,this.MENU_ITEM_CLONE,this.MENU_ITEM_REMOVE])}buildComponentInfo(e,t){return __awaiter(this,void 0,void 0,(function*(){const n=yield this.slotContainerService.getComponentContainer(e,t.uuid);return{componentType:t.typeCode,componentId:t.uid,componentAttributes:{smarteditCatalogVersionUuid:t.catalogVersion,smarteditComponentId:t.uid,smarteditComponentType:t.componentType,smarteditComponentUuid:t.uuid,smarteditElementUuid:null},containerType:n?n.containerType:null,containerId:n?n.containerId:null,element:null,isComponentHidden:true,slotId:e,iLeftBtns:0}}))}getAllowedItemsForComponent(e,t){return __awaiter(this,void 0,void 0,(function*(){const n=this.contextualMenuService.getContextualMenuByType(e.typeCode);const i=n.filter((e=>this.allowedItems[e.key]&&!!e.condition)).map((e=>__awaiter(this,void 0,void 0,(function*(){let n;try{n=yield e.condition(t)}catch(e){n=false}return{isEnabled:n,item:e}}))));const o=(yield Promise.all(i)).filter((({isEnabled:e})=>e)).map((({item:e})=>e));return{buttons:o,configuration:t}}))}};t.HiddenComponentMenuService=__decorate([i.Injectable(),__metadata("design:paramtypes",[r.IContextualMenuService,t.SlotContainerService])],t.HiddenComponentMenuService);t.ComponentInfoService=class ComponentInfoService{constructor(e,t,n,i,o,a){this.yjQuery=e;this.logService=t;this.crossFrameEventService=n;this.cmsitemsRestService=i;this.promiseUtils=o;this.cMSModesService=a;this.cachedComponents={};this.promisesQueue={};this.crossFrameEventService.subscribe(r.OVERLAY_RERENDERED_EVENT,((e,t)=>{this.onOverlayReRendered(t)}));this.crossFrameEventService.subscribe(s.COMPONENT_CREATED_EVENT,((e,t)=>{this.onComponentAdded(t)}));this.crossFrameEventService.subscribe(s.COMPONENT_UPDATED_EVENT,((e,t)=>{this.onComponentAdded(t)}));this.crossFrameEventService.subscribe(s.COMPONENT_REMOVED_EVENT,((e,t)=>{this.onComponentRemoved(t)}));this.crossFrameEventService.subscribe(r.EVENTS.PAGE_CHANGE,(()=>this.clearCache()));this.crossFrameEventService.subscribe(r.EVENTS.USER_HAS_CHANGED,(()=>this.clearCache()))}getById(e,t){return __awaiter(this,void 0,void 0,(function*(){const n=`[${r.UUID_ATTRIBUTE}='${e}']`;if(!t&&!this.cachedComponents[e]&&!document.querySelectorAll(n).length){t=true}if(this.isComponentCached(e)){return this.cachedComponents[e]}else if(t){return this.getComponentDataByUUID(e)}else{const t=this.promisesQueue[e]||this.promiseUtils.defer();if(!this.promisesQueue[e]){this.promisesQueue[e]=t}return t.promise}}))}resolvePromises(e){(e.response?e.response:[e]).forEach((e=>{this.cachedComponents[e.uuid]=e;if(this.promisesQueue[e.uuid]){this.promisesQueue[e.uuid].resolve(e);delete this.promisesQueue[e.uuid]}}))}rejectPromises(e,t){this.logService.error("componentInfoService:: getById error:",t.message);e.forEach((e=>{if(this.promisesQueue[e]){this.promisesQueue[e].reject(t);delete this.promisesQueue[e]}}))}getComponentDataByUUID(e){return __awaiter(this,void 0,void 0,(function*(){try{const t=yield this.cmsitemsRestService.getById(e);this.resolvePromises(t);return this.cachedComponents[e]}catch(t){this.rejectPromises([e],t);throw t}}))}getComponentsDataByUUIDs(e){return __awaiter(this,void 0,void 0,(function*(){try{const t=yield this.cmsitemsRestService.getByIds(e,"DEFAULT");this.resolvePromises(t)}catch(t){this.rejectPromises(e,t)}}))}onComponentsAddedToOverlay(e){const t=e.map((e=>this.yjQuery(e).attr(r.UUID_ATTRIBUTE))).filter((e=>!Object.keys(this.cachedComponents).includes(e)));if(t.length){this.getComponentsDataByUUIDs(t)}}onComponentsRemovedFromOverlay(e){e.filter((e=>{const t=`[${r.UUID_ATTRIBUTE}='${this.yjQuery(e).attr(r.UUID_ATTRIBUTE)}']`;return!this.yjQuery(t).length})).filter((e=>Object.keys(this.cachedComponents).includes(this.yjQuery(e).attr(r.UUID_ATTRIBUTE)))).map((e=>this.yjQuery(e).attr(r.UUID_ATTRIBUTE))).forEach((e=>{delete this.cachedComponents[e]}))}forceAddComponent(e){this.resolvePromises({response:[e]})}forceRemoveComponent(e){delete this.cachedComponents[e.uuid]}isComponentCached(e){return!!this.cachedComponents[e]}clearCache(){this.cachedComponents={};this.promisesQueue={}}onOverlayReRendered(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.cMSModesService.isVersioningPerspectiveActive();if(e&&!t){if(e.addedComponents&&e.addedComponents.length){this.onComponentsAddedToOverlay(e.addedComponents)}if(e.removedComponents&&e.removedComponents.length){this.onComponentsRemovedFromOverlay(e.removedComponents)}}}))}onComponentAdded(e){this.forceAddComponent(e)}onComponentRemoved(e){this.forceRemoveComponent(e)}};t.ComponentInfoService=__decorate([i.Injectable(),__param(0,i.Inject(r.YJQUERY_TOKEN)),__metadata("design:paramtypes",[Function,r.LogService,r.CrossFrameEventService,r.CmsitemsRestService,r.PromiseUtils,r.CMSModesService])],t.ComponentInfoService);t.ComponentSharedService=class ComponentSharedService extends s.IComponentSharedService{constructor(e){super();this.componentInfoService=e}isComponentShared(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.determineComponent(e);if(!t.slots){throw new Error("ComponentSharedService::isComponentShared - Component must have slots property.")}return t.slots.length>1}))}determineComponent(e){if(typeof e==="string"){return this.componentInfoService.getById(e,true)}else if(e.uuid){return this.componentInfoService.getById(e.uuid,true)}return Promise.resolve(e)}};t.ComponentSharedService=__decorate([r.GatewayProxied(),i.Injectable(),__metadata("design:paramtypes",[t.ComponentInfoService])],t.ComponentSharedService);t.ComponentVisibilityAlertService=class ComponentVisibilityAlertService extends s.IComponentVisibilityAlertService{};t.ComponentVisibilityAlertService=__decorate([r.GatewayProxied("checkAndAlertOnComponentVisibility")],t.ComponentVisibilityAlertService);t.SlotRestrictionsService=class SlotRestrictionsService extends r.ISlotRestrictionsService{constructor(e,t,n,i,o,s,a,l,c,d){super();this.componentHandlerService=e;this.logService=t;this.pageContentSlotsComponentsRestService=n;this.pageInfoService=i;this.restServiceFactory=o;this.slotSharedService=s;this.typePermissionsRestService=a;this.yjQuery=l;this.cMSModesService=d;this.currentPageId=null;this.slotRestrictions={};this.CONTENT_SLOTS_TYPE_RESTRICTION_FETCH_LIMIT=100;c.subscribe(r.EVENTS.PAGE_CHANGE,(()=>__awaiter(this,void 0,void 0,(function*(){const e=yield this.cMSModesService.isVersioningPerspectiveActive();if(!e){this.emptyCache();this.cacheSlotsRestrictions()}}))))}getAllComponentTypesSupportedOnPage(){return __awaiter(this,void 0,void 0,(function*(){const e=this.yjQuery(this.componentHandlerService.getAllSlotsSelector());const t=e.get().map((e=>this.componentHandlerService.getId(e)));const n=t.map((e=>this.getSlotRestrictions(e)));try{const e=yield Promise.all(n);return l.flatten(e)}catch(e){this.logService.info(e);return Promise.reject()}}))}getSlotRestrictions(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.getPageUID(this.currentPageId);const n=yield this.isExternalSlot(e);this.currentPageId=t;const i=this.getEntryId(this.currentPageId,e);if(this.slotRestrictions[i]){return this.slotRestrictions[i]}else if(n){this.slotRestrictions[i]=[]}return[]}))}isComponentAllowedInSlot(e,t){return __awaiter(this,void 0,void 0,(function*(){return this.determineComponentStatusInSlot(e.id,t)}))}determineComponentStatusInSlot(e,t){return __awaiter(this,void 0,void 0,(function*(){const n=yield this.getSlotRestrictions(e);const i=yield this.pageContentSlotsComponentsRestService.getComponentsForSlot(e);const o=e===t.slotId||!i.some((e=>e.uid===t.componentId));if(o){if(n){return l.includes(n,t.componentType)?r.COMPONENT_IN_SLOT_STATUS.ALLOWED:r.COMPONENT_IN_SLOT_STATUS.DISALLOWED}return r.COMPONENT_IN_SLOT_STATUS.MAYBEALLOWED}return r.COMPONENT_IN_SLOT_STATUS.DISALLOWED}))}isSlotEditable(e){return __awaiter(this,void 0,void 0,(function*(){if(!e){return Promise.resolve(false)}const t=yield this.typePermissionsRestService.hasUpdatePermissionForTypes([r.CONTENT_SLOT_TYPE]);const n=yield this.slotSharedService.isSlotShared(e);let i=t[r.CONTENT_SLOT_TYPE];if(n){const t=yield this.isExternalSlot(e);i=i&&!t&&!this.slotSharedService.areSharedSlotsDisabled()}return i}))}emptyCache(){this.slotRestrictions={};this.currentPageId=null}cacheSlotsRestrictions(){return __awaiter(this,void 0,void 0,(function*(){const e=this.componentHandlerService.getAllSlotUids()||[];const t=[];yield Promise.all(e.map((e=>__awaiter(this,void 0,void 0,(function*(){const n=yield this.isExternalSlot(e);if(!n){t.push(e)}})))));const n=l.uniq(t);const i=l.chunk(n,this.CONTENT_SLOTS_TYPE_RESTRICTION_FETCH_LIMIT);return this.recursiveFetchSlotsRestrictions(i,0)}))}recursiveFetchSlotsRestrictions(e,t){return __awaiter(this,void 0,void 0,(function*(){if(t===e.length){return}yield this.fetchSlotsRestrictions(e[t]);this.recursiveFetchSlotsRestrictions(e,t+1)}))}fetchSlotsRestrictions(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.getPageUID(this.currentPageId);this.currentPageId=t;this.slotsRestrictionsRestService=this.slotsRestrictionsRestService||this.restServiceFactory.get(s.CONTENT_SLOTS_TYPE_RESTRICTION_RESOURCE_URI,this.currentPageId);try{const t=yield this.slotsRestrictionsRestService.save({slotIds:e,pageUid:this.currentPageId});const n=t||[];n.forEach((e=>{const t=this.getEntryId(this.currentPageId,e.contentSlotUid);this.slotRestrictions[t]=e.validComponentTypes}))}catch(e){this.logService.info(e);throw new Error(e)}}))}getPageUID(e){return!r.stringUtils.isBlank(e)?Promise.resolve(e):this.pageInfoService.getPageUID()}getEntryId(e,t){return`${e}_${t}`}isExternalSlot(e){return this.componentHandlerService.isExternalComponent(e,r.CONTENT_SLOT_TYPE)}};t.SlotRestrictionsService=__decorate([r.GatewayProxied("getAllComponentTypesSupportedOnPage","getSlotRestrictions","determineComponentStatusInSlot","isSlotEditable"),i.Injectable(),__param(7,i.Inject(r.YJQUERY_TOKEN)),__metadata("design:paramtypes",[r.IComponentHandlerService,r.LogService,s.IPageContentSlotsComponentsRestService,r.IPageInfoService,r.IRestServiceFactory,r.SlotSharedService,s.TypePermissionsRestService,Function,r.CrossFrameEventService,r.CMSModesService])],t.SlotRestrictionsService);t.EditorEnablerService=class EditorEnablerService extends s.IEditorEnablerService{constructor(e,t,n,i,o,s,r){super();this.componentHandlerService=e;this.componentVisibilityAlertService=t;this.editorModalService=n;this.featureService=i;this.slotRestrictionsService=o;this.crossFrameEventService=s;this.systemEventService=r;this.contextualMenuButton={key:"se.cms.edit",nameI18nKey:"se.cms.contextmenu.nameI18nKey.edit",i18nKey:"se.cms.contextmenu.title.edit",descriptionI18nKey:"se.cms.contextmenu.descriptionI18n.edit",displayClass:"editbutton",displayIconClass:"sap-icon--edit",displaySmallIconClass:"sap-icon--edit",priority:400,permissions:["se.context.menu.edit.component"],action:{callback:e=>this.onClickEditButton(e)},condition:e=>this.isSlotEditableForNonExternalComponent(e)}}enableForComponents(e){const t=Object.assign(Object.assign({},this.contextualMenuButton),{regexpKeys:e});this.featureService.addContextualMenuButton(t)}onClickEditButton({slotId:e,componentAttributes:t,isComponentHidden:n,componentType:i,componentUuid:o}){return __awaiter(this,void 0,void 0,(function*(){if(this.isEditorModalOpen){return}this.isEditorModalOpen=true;const r={dialogPanelClass:"modal-dialog"};try{let a;if(n){a=yield this.editorModalService.openAndRerenderSlot(i,o,"visible",r)}else{a=yield this.editorModalService.open(t,null,null,null,null,null,r)}this.isEditorModalOpen=false;this.systemEventService.publish(s.COMPONENT_UPDATED_EVENT,a);yield this.componentVisibilityAlertService.checkAndAlertOnComponentVisibility({itemId:a.uuid,itemType:a.itemtype,catalogVersion:a.catalogVersion,restricted:a.restricted,visible:a.visible,slotId:e})}catch(e){this.isEditorModalOpen=false}}))}isSlotEditableForNonExternalComponent(e){return __awaiter(this,void 0,void 0,(function*(){let t=null;if(!!e.element){t=this.componentHandlerService.getParentSlotForComponent(e.element)}else{t=e.slotId}const n=yield this.slotRestrictionsService.isSlotEditable(t);const i=yield this.componentHandlerService.isExternalComponent(e.componentId,e.componentType);return n&&!i}))}};t.EditorEnablerService=__decorate([r.GatewayProxied("onClickEditButton","isSlotEditableForNonExternalComponent"),i.Injectable(),__metadata("design:paramtypes",[r.IComponentHandlerService,s.IComponentVisibilityAlertService,r.IEditorModalService,r.IFeatureService,r.ISlotRestrictionsService,r.CrossFrameEventService,r.SystemEventService])],t.EditorEnablerService);var h;const g="data-component-id";t.CmsDragAndDropService=h=class CmsDragAndDropService{constructor(e,t,n,i,o,s,a,l,c,d,p,u,m,h,g){this.alertService=e;this.assetsService=t;this.browserService=n;this.componentEditingFacade=i;this.componentHandlerService=o;this.dragAndDropService=s;this.gatewayFactory=a;this.translateService=l;this.pageContentSlotsComponentsRestService=c;this.slotRestrictionsService=d;this.systemEventService=p;this.waitDialogService=u;this.yjQuery=m;this.domain=h;this.crossFrameEventService=g;this.cachedSlots={};this.highlightedSlot=null;this.highlightedComponent=null;this.highlightedHint=null;this.dragInfo=null;this.overlayRenderedUnSubscribeFn=null;this.componentRemovedUnSubscribeFn=null;this._window=r.windowUtils.getWindow();this.gateway=this.gatewayFactory.createGateway("cmsDragAndDrop")}register(){this.dragAndDropService.register({id:h.CMS_DRAG_AND_DROP_ID,sourceSelector:[h.SOURCE_SELECTOR,h.MORE_MENU_SOURCE_SELECTOR],targetSelector:h.TARGET_SELECTOR,startCallback:e=>this.onStart(e),dragEnterCallback:e=>this.onDragEnter(e),dragOverCallback:e=>this.onDragOver(e),dropCallback:e=>this.onDrop(e),outCallback:e=>this.onDragLeave(e),stopCallback:e=>this.onStop(e),enableScrolling:true})}unregister(){this.dragAndDropService.unregister([h.CMS_DRAG_AND_DROP_ID]);if(this.overlayRenderedUnSubscribeFn){this.overlayRenderedUnSubscribeFn()}if(this.componentRemovedUnSubscribeFn){this.componentRemovedUnSubscribeFn()}}apply(){this.dragAndDropService.apply(h.CMS_DRAG_AND_DROP_ID);this.addUIHelpers();this.overlayRenderedUnSubscribeFn=this.systemEventService.subscribe(r.OVERLAY_RERENDERED_EVENT,(()=>this.onOverlayUpdate()));this.componentRemovedUnSubscribeFn=this.systemEventService.subscribe(s.COMPONENT_REMOVED_EVENT,(()=>this.onOverlayUpdate()));this.gateway.subscribe(s.DRAG_AND_DROP_EVENTS.DRAG_STARTED,((e,t)=>{this.dragAndDropService.markDragStarted();this.initializeDragOperation(t)}));this.gateway.subscribe(s.DRAG_AND_DROP_EVENTS.DRAG_STOPPED,(()=>{this.dragAndDropService.markDragStopped();this.cleanDragOperation()}));this.gateway.subscribe(s.DRAG_AND_DROP_EVENTS.SCROLL_TO_MODIFIED_SLOT,((e,t)=>{const n=this.componentHandlerService.getComponent(t,r.CONTENT_SLOT_TYPE);if(n&&n.length>0){n[0].scrollIntoView()}}))}update(){this.dragAndDropService.update(h.CMS_DRAG_AND_DROP_ID);this.addUIHelpers();this.cacheElements()}onOverlayUpdate(){this.update();return Promise.resolve()}onStart(e){let t=this.getSelector(e.target);if(!t.attr(g)){t=this.yjQuery(t).closest("[data-component-id]")}const n=t.closest(h.COMPONENT_SELECTOR);const i=n.closest(h.SLOT_SELECTOR);const o=n.length>0?this.componentHandlerService.getId(n):t.attr(g);const s=n.length>0?this.componentHandlerService.getSlotOperationRelatedUuid(n):t.attr("data-component-uuid");const r=n.length>0?this.componentHandlerService.getType(n):t.attr("data-component-type");const a=n.length>0?this.componentHandlerService.getSlotOperationRelatedId(n):t.attr(g);const l=n.length>0?this.componentHandlerService.getSlotOperationRelatedType(n):t.attr("data-component-type");const c=n.length>0?this.componentHandlerService.getId(i):t.attr("data-slot-id");const d=n.length>0?this.componentHandlerService.getId(i):t.attr("data-slot-uuid");const p={componentId:o,componentUuid:s,componentType:r,slotUuid:d,slotId:c,slotOperationRelatedId:a,slotOperationRelatedType:l};n.addClass(h.CSS_CLASSES.COMPONENT_DRAGGED);this.initializeDragOperation(p);this.toggleKeepVisibleComponentAndSlot(true)}onDragEnter(e){return this.highlightSlot(e)}onDragOver(e){return __awaiter(this,void 0,void 0,(function*(){yield this.highlightSlot(e);if(!this.highlightedSlot||!this.highlightedSlot.isAllowed){return}if(this.highlightedHint){if(this.isMouseInRegion(e,this.highlightedHint)){return}else{this.clearHighlightedHint()}}this.highlightHoveredComponentsAndTheirHints(e);if(this.highlightedComponent&&this.highlightedComponent.id===this.dragInfo.slotOperationRelatedId){this.highlightedComponent.original.addClass(h.CSS_CLASSES.COMPONENT_DRAGGED_HOVERED)}else if(this.highlightedHint&&this.highlightedSlot.isAllowed){this.highlightedHint.original.addClass(h.CSS_CLASSES.DROPZONE_HOVERED);if(this.highlightedSlot.mayBeAllowed){this.highlightedHint.original.addClass(h.CSS_CLASSES.DROPZONE_MAY_BE_ALLOWED)}}}))}highlightHoveredComponentsAndTheirHints(e){var t;const n=this.cachedSlots[this.componentHandlerService.getId(this.highlightedSlot.original)];if(n.components.length>0){if(!this.highlightedComponent||!this.isMouseInRegion(e,this.highlightedComponent)){this.clearHighlightedComponent();const t=this.selectMouseOverElement(e,n.components);if(t){this.highlightedComponent=t}}if((t=this.highlightedComponent)===null||t===void 0?void 0:t.hints){const t=this.selectMouseOverElement(e,this.highlightedComponent.hints);if(t){this.highlightedHint=t}}}}selectMouseOverElement(e,t){return t.find((t=>this.isMouseInRegion(e,t)))}onDrop(e){return __awaiter(this,void 0,void 0,(function*(){if(!this.highlightedSlot){return}const t=this.dragInfo.slotId;const n=this.componentHandlerService.getId(this.highlightedSlot.original);const i=this.componentHandlerService.getUuid(this.highlightedSlot.original);const o=this.dragInfo.componentId;const r=this.getSlotOperationRelatedIdOrComponentId();const a=this.getSlotOperationRelatedTypeOrComponentType();if(!this.highlightedSlot.isAllowed){this.showNotValidComponentAlert(n,r);return}if(this.highlightedHint||this.highlightedSlot.components.length===0){const l=this.getHighlightedHintPosition();this.waitDialogService.showWaitModal();if(t&&!this.shouldPerformActionWithSourceSlotId(t,n,o,l)){this.waitDialogService.hideWaitModal();return}try{yield this.performActionToSlotAndHint(t,o,n,i,a,l,r);this.scrollToModifiedSlot(n);yield this.crossFrameEventService.publish(s.DRAG_AND_DROP_EVENTS.SCROLL_TO_MODIFIED_SLOT,n)}catch(t){this.onStop(e)}finally{this.waitDialogService.hideWaitModal()}}}))}performActionToSlotAndHint(e,t,n,i,o,s,r){if(!e){if(!t){return this.getPerformActionWithoutSourceSlotIdWithoutSourceComponentId(n,i,o,s)}else{return this.getPerformActionWithoutSourceSlotIdWithSourceComponentId(t,o,n,s)}}else{return this.getPerformActionWithSourceSlotId(e,n,t,s,r)}}getHighlightedHintPosition(){return this.highlightedHint?this.highlightedHint.position:0}getSlotOperationRelatedTypeOrComponentType(){return this.dragInfo.slotOperationRelatedType||this.dragInfo.componentType}getSlotOperationRelatedIdOrComponentId(){return this.dragInfo.slotOperationRelatedId||this.dragInfo.componentId}getPerformActionWithSourceSlotId(e,t,n,i,o){if(e===t&&this.getComponentPositionFromCachedSlot(e,n)<i){i--}return this.componentEditingFacade.moveComponent(e,t,o,i)}shouldPerformActionWithSourceSlotId(e,t,n,i){return e!==t||this.getComponentPositionFromCachedSlot(e,n)!==i}getPerformActionWithoutSourceSlotIdWithSourceComponentId(e,t,n,i){const o={componentId:e,componentUuid:this.dragInfo.componentUuid,componentType:t};const s={targetSlotId:n,dragInfo:o,position:i};return this.dragInfo.cloneOnDrop?this.componentEditingFacade.cloneExistingComponentToSlot(s):this.componentEditingFacade.addExistingComponentToSlot(n,o,i)}getPerformActionWithoutSourceSlotIdWithoutSourceComponentId(e,t,n,i){const o={targetSlotId:e,targetSlotUUId:t};const s=this.componentHandlerService.getCatalogVersionUuid(this.highlightedSlot.original);return this.componentEditingFacade.addNewComponentToSlot(o,s,n,i)}showNotValidComponentAlert(e,t){const n=this.translateService.instant("se.drag.and.drop.not.valid.component.type",{slotUID:e,componentUID:t});this.alertService.showDanger({message:n,minWidth:"",mousePersist:true,duration:1e3,dismissible:true,width:"300px"})}getComponentPositionFromCachedSlot(e,t){const n=this.cachedSlots[e];const i=(n===null||n===void 0?void 0:n.components)?n.components:[];const o=i.find((e=>this.componentHandlerService.getId(e.original)===t));return o?o.position:this.componentHandlerService.getComponentPositionInSlot(e,t)}onDragLeave(e){if(this.highlightedSlot){const t=this.componentHandlerService.getId(this.highlightedSlot.original);const n=this.cachedSlots[t];if(!this.isMouseInRegion(e,n)){this.clearHighlightedSlot()}}}onStop(e){const t=this.getSelector(e.target).closest(h.COMPONENT_SELECTOR);this.toggleKeepVisibleComponentAndSlot(false);this.cleanDragOperation(t);this.systemEventService.publish(r.CONTRACT_CHANGE_LISTENER_PROCESS_EVENTS.RESTART_PROCESS)}initializeDragOperation(e){this.dragInfo=e;this.cacheElements();const t=this.componentHandlerService.getOverlay();t.addClass(h.CSS_CLASSES.OVERLAY_IN_DRAG_DROP);this.systemEventService.publishAsync(s.DRAG_AND_DROP_EVENTS.DRAG_STARTED)}cleanDragOperation(e){this.clearHighlightedSlot();if(e){e.removeClass(h.CSS_CLASSES.COMPONENT_DRAGGED)}const t=this.componentHandlerService.getOverlay();t.removeClass(h.CSS_CLASSES.OVERLAY_IN_DRAG_DROP);this.systemEventService.publishAsync(s.DRAG_AND_DROP_EVENTS.DRAG_STOPPED);this.dragInfo=null;this.cachedSlots={};this.highlightedSlot=null}highlightSlot(e){return __awaiter(this,void 0,void 0,(function*(){const t=this.yjQuery(e.target).closest(h.SLOT_SELECTOR);const n=this.componentHandlerService.getId(t);const i=this.getOldSlotId(n);if(this.highlightedSlot&&this.highlightedSlot.isAllowed!==undefined){return}this.highlightedSlot=this.cachedSlots[n];const o=Object.assign({},this.dragInfo);o.componentId=this.getSlotOperationRelatedIdOrComponentId();o.componentType=this.getSlotOperationRelatedTypeOrComponentType();if(o.cloneOnDrop){delete o.componentId}const r=yield this.slotRestrictionsService.isComponentAllowedInSlot(this.highlightedSlot,o);const a=yield this.slotRestrictionsService.isSlotEditable(n);if(!this.highlightedSlot||this.highlightedSlot.id!==n){return}this.updateSlotStyle(r,a,t);if(this.isDragOverNewSlot(e,i,n)){this.systemEventService.publish(n+"_SHOW_SLOT_MENU");this.systemEventService.publish(s.DRAG_AND_DROP_EVENTS.DRAG_OVER,n)}}))}isDragOverNewSlot(e,t,n){return e.type==="dragenter"&&(!t||t!==n)&&this.highlightedSlot&&this.highlightedSlot.id===n}getOldSlotId(e){let t;if(this.highlightedSlot){t=this.componentHandlerService.getId(this.highlightedSlot.original);if(t!==e){this.clearHighlightedSlot()}}return t}updateSlotStyle(e,t,n){const i=e===r.COMPONENT_IN_SLOT_STATUS.ALLOWED&&t;const o=e===r.COMPONENT_IN_SLOT_STATUS.MAYBEALLOWED&&t;this.highlightedSlot.isAllowed=i||o;this.highlightedSlot.mayBeAllowed=o;n.addClass(this.highlightedSlot.isAllowed?h.CSS_CLASSES.SLOT_ALLOWED:h.CSS_CLASSES.SLOT_NOT_ALLOWED);if(o){n.addClass(h.CSS_CLASSES.SLOT_MAY_BE_ALLOWED)}}addUIHelpers(){const e=this.componentHandlerService.getOverlay();e.find("."+h.CSS_CLASSES.UI_HELPER_OVERLAY).remove();const t=this;e.find(h.SLOT_SELECTOR).each(((e,n)=>{const i=t.yjQuery(n);const o=i[0].offsetHeight;const s=i[0].offsetWidth;const r=i.find(h.COMPONENT_SELECTOR);const a="<div></div>";if(r.length===0){const e=t.yjQuery(a);e.addClass(h.CSS_CLASSES.UI_HELPER_OVERLAY);const n=t.yjQuery(a);n.addClass(h.CSS_CLASSES.DROPZONE);n.addClass(h.CSS_CLASSES.DROPZONE_FULL);e.height(o);e.width(s);e.append(n);i.append(e)}else{r.each(((e,n)=>{const i=t.yjQuery(n);const o=i[0].offsetHeight;const r=i[0].offsetWidth;const l=t.yjQuery(a);l.addClass(h.CSS_CLASSES.UI_HELPER_OVERLAY);l.height(o);l.width(r);const c=t.yjQuery(a);const d=t.yjQuery(a);c.addClass(h.CSS_CLASSES.DROPZONE);d.addClass(h.CSS_CLASSES.DROPZONE);if(r===s){c.addClass(h.CSS_CLASSES.DROPZONE_TOP);d.addClass(h.CSS_CLASSES.DROPZONE_BOTTOM)}else{c.addClass(h.CSS_CLASSES.DROPZONE_LEFT);d.addClass(h.CSS_CLASSES.DROPZONE_RIGHT)}l.append(c);l.append(d);i.append(l)}))}}))}cacheElements(){const e=this.componentHandlerService.getOverlay();if(!e){return}const t=this.getWindowScrolling();e.find(h.SLOT_SELECTOR).each(((e,n)=>{const i=this.yjQuery(n);const o=this.componentHandlerService.getId(i);const s=this.componentHandlerService.getUuid(i);this.pageContentSlotsComponentsRestService.getComponentsForSlot(o).then((e=>{const n={id:o,uuid:s,original:i,components:[],rect:this.getElementRects(i,t),hint:null};const r=i.children(h.COMPONENT_SELECTOR);if(r.length===0){const e=i.find(h.HINT_SELECTOR);n.hint=e.length>0?{original:e,rect:this.getElementRects(e,t)}:null}else{r.each(((i,o)=>{const s=this.yjQuery(o);let r=e.findIndex((e=>e.uuid===this.componentHandlerService.getUuid(s)));if(r===-1){r=i}const a={id:this.componentHandlerService.getSlotOperationRelatedId(s),type:this.componentHandlerService.getSlotOperationRelatedType(s),original:s,position:r,hints:[],rect:this.getElementRects(s,t)};let l=r++;s.find(h.HINT_SELECTOR).each(((e,n)=>{const i=this.yjQuery(n);const o={original:i,position:l++,rect:this.getElementRects(i,t)};a.hints.push(o)}));n.components.push(a)}))}this.cachedSlots[n.id]=n}))}))}clearHighlightedHint(){if(this.highlightedHint){this.highlightedHint.original.removeClass(h.CSS_CLASSES.DROPZONE_HOVERED);this.highlightedHint.original.removeClass(h.CSS_CLASSES.DROPZONE_MAY_BE_ALLOWED);this.highlightedHint=null}}clearHighlightedComponent(){this.clearHighlightedHint();if(this.highlightedComponent){this.highlightedComponent.original.removeClass(h.CSS_CLASSES.COMPONENT_DRAGGED_HOVERED);this.highlightedComponent=null}}clearHighlightedSlot(){this.clearHighlightedComponent();if(this.highlightedSlot){this.highlightedSlot.original.removeClass(h.CSS_CLASSES.SLOT_ALLOWED);this.highlightedSlot.original.removeClass(h.CSS_CLASSES.SLOT_NOT_ALLOWED);this.highlightedSlot.original.removeClass(h.CSS_CLASSES.SLOT_MAY_BE_ALLOWED);this.systemEventService.publish("HIDE_SLOT_MENU");this.systemEventService.publish(s.DRAG_AND_DROP_EVENTS.DRAG_LEAVE)}this.highlightedSlot=null}isMouseInRegion(e,t){const n=t.rect;return e.pageX>=n.left&&e.pageX<=n.right&&e.pageY>=n.top&&e.pageY<=n.bottom}getElementRects(e,t){const n=e[0].getBoundingClientRect();return{left:n.left,right:n.right,bottom:n.bottom+t,top:n.top+t}}getWindowScrolling(){return this._window.pageYOffset}scrollToModifiedSlot(e){const t=this.componentHandlerService.getComponentInOverlay(e,r.CONTENT_SLOT_TYPE);if(t&&t.length>0){t[0].scrollIntoView()}}getSelector(e){return this.yjQuery(e)}toggleKeepVisibleComponentAndSlot(e){if(this.dragInfo){const t=e?r.CONTRACT_CHANGE_LISTENER_COMPONENT_PROCESS_STATUS.KEEP_VISIBLE:r.CONTRACT_CHANGE_LISTENER_COMPONENT_PROCESS_STATUS.PROCESS;this.yjQuery.each(this.componentHandlerService.getComponentUnderSlot(this.dragInfo.componentId,this.dragInfo.componentType,this.dragInfo.slotId),((e,n)=>{n.dataset[r.SMARTEDIT_COMPONENT_PROCESS_STATUS]=t}));this.yjQuery.each(this.componentHandlerService.getComponent(this.dragInfo.slotId,r.CONTENT_SLOT_TYPE),((e,n)=>{n.dataset[r.SMARTEDIT_COMPONENT_PROCESS_STATUS]=t}))}}};t.CmsDragAndDropService.CMS_DRAG_AND_DROP_ID="se.cms.dragAndDrop";t.CmsDragAndDropService.TARGET_SELECTOR="#smarteditoverlay .smartEditComponentX[data-smartedit-component-type='ContentSlot']";t.CmsDragAndDropService.SOURCE_SELECTOR="#smarteditoverlay .smartEditComponentX[data-smartedit-component-type!='ContentSlot'] .movebutton";t.CmsDragAndDropService.MORE_MENU_SOURCE_SELECTOR=".movebutton";t.CmsDragAndDropService.SLOT_SELECTOR=".smartEditComponentX[data-smartedit-component-type='ContentSlot']";t.CmsDragAndDropService.COMPONENT_SELECTOR=".smartEditComponentX[data-smartedit-component-type!='ContentSlot']";t.CmsDragAndDropService.HINT_SELECTOR=".overlayDropzone";t.CmsDragAndDropService.CSS_CLASSES={UI_HELPER_OVERLAY:"overlayDnd",DROPZONE:"overlayDropzone",DROPZONE_FULL:"overlayDropzone--full",DROPZONE_TOP:"overlayDropzone--top",DROPZONE_BOTTOM:"overlayDropzone--bottom",DROPZONE_LEFT:"overlayDropzone--left",DROPZONE_RIGHT:"overlayDropzone--right",DROPZONE_HOVERED:"overlayDropzone--hovered",DROPZONE_MAY_BE_ALLOWED:"overlayDropzone--mayBeAllowed",OVERLAY_IN_DRAG_DROP:"smarteditoverlay_dndRendering",COMPONENT_DRAGGED:"component_dragged",COMPONENT_DRAGGED_HOVERED:"component_dragged_hovered",SLOTS_MARKED:"slot-marked",SLOT_ALLOWED:"over-slot-enabled",SLOT_NOT_ALLOWED:"over-slot-disabled",SLOT_MAY_BE_ALLOWED:"over-slot-maybeenabled"};t.CmsDragAndDropService=h=__decorate([i.Injectable(),__param(12,i.Inject(r.YJQUERY_TOKEN)),__param(13,i.Inject(r.DOMAIN_TOKEN)),__metadata("design:paramtypes",[r.IAlertService,s.AssetsService,r.IBrowserService,s.IComponentEditingFacade,r.IComponentHandlerService,r.DragAndDropService,r.GatewayFactory,c.TranslateService,s.IPageContentSlotsComponentsRestService,r.ISlotRestrictionsService,r.SystemEventService,r.IWaitDialogService,Function,String,r.CrossFrameEventService])],t.CmsDragAndDropService);const _=`${s.PAGES_CONTENT_SLOT_COMPONENT_RESOURCE_URI}/pages/:pageId/contentslots/:currentSlotId/components/:componentId`;t.ComponentEditingFacade=class ComponentEditingFacade extends s.IComponentEditingFacade{constructor(e,t,n,i,o,s,r,a,l,c,d,p,u){super();this.alertService=e;this.componentService=t;this.componentVisibilityAlertService=n;this.crossFrameEventService=i;this.editorModalService=o;this.logService=s;this.pageInfoService=r;this.renderService=a;this.restServiceFactory=l;this.slotVisibilityService=c;this.sharedDataService=d;this.systemEventService=p;this.translateService=u}addNewComponentToSlot(e,t,n,i){return __awaiter(this,void 0,void 0,(function*(){const o={smarteditComponentType:n,catalogVersionUuid:t};const r=yield this.editorModalService.open(o,e.targetSlotUUId,i);this.componentVisibilityAlertService.checkAndAlertOnComponentVisibility({itemId:r.uuid,itemType:r.itemtype,catalogVersion:r.catalogVersion,restricted:r.restricted,slotId:e.targetSlotId,visible:r.visible});this.crossFrameEventService.publish(s.COMPONENT_CREATED_EVENT,r);return this.renderSlots([e.targetSlotId],r.uid,e.targetSlotId,true)}))}addExistingComponentToSlot(e,t,n){return __awaiter(this,void 0,void 0,(function*(){const i=yield this.pageInfoService.getPageUID();let o;try{yield this.componentService.addExistingComponent(i,t.componentId,e,n);o=yield this.componentService.loadComponentItem(t.componentUuid)}catch(n){this.generateAndAlertErrorMessage(t.componentId,e,n);return Promise.reject()}this.componentVisibilityAlertService.checkAndAlertOnComponentVisibility({itemId:t.componentUuid,itemType:t.componentType,catalogVersion:o.catalogVersion,restricted:o.restricted,slotId:e,visible:o.visible});this.systemEventService.publish(s.COMPONENT_UPDATED_EVENT,o);this.crossFrameEventService.publish(r.EVENT_SMARTEDIT_COMPONENT_UPDATED,{componentId:t.componentId,componentType:t.componentType,componentUuid:t.componentUuid,requiresReplayingDecorators:true});return this.renderSlots(e,t.componentId,e,true)}))}cloneExistingComponentToSlot(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.componentService.loadComponentItem(e.dragInfo.componentUuid).catch((t=>{this.generateAndAlertErrorMessage(e.dragInfo.componentId,e.targetSlotId,t);return Promise.reject()}));const n=yield this.sharedDataService.get(r.EXPERIENCE_STORAGE_KEY);const i=r.objectUtils.copy(t);i.componentUuid=i.uuid;i.cloneComponent=true;i.catalogVersion=n.pageContext.catalogVersionUuid;i.name=`${this.translateService.instant("se.cms.component.name.clone.of.prefix")} ${i.name}`;delete i.uuid;delete i.uid;delete i.slots;delete i.restrictions;delete i.creationtime;delete i.modifiedtime;const o={smarteditComponentType:e.dragInfo.componentType,catalogVersionUuid:n.pageContext.catalogVersionUuid,content:r.objectUtils.copy(i),initialDirty:true};const a=yield this.editorModalService.open(o,e.targetSlotId,e.position);this.componentVisibilityAlertService.checkAndAlertOnComponentVisibility({itemId:a.uuid,itemType:a.itemtype,catalogVersion:a.catalogVersion,restricted:a.restricted,slotId:e.targetSlotId,visible:a.visible});this.crossFrameEventService.publish(s.COMPONENT_CREATED_EVENT,a);return this.renderSlots(e.targetSlotId,a.uid,e.targetSlotId,true)}))}moveComponent(e,t,n,i){return __awaiter(this,void 0,void 0,(function*(){this.contentSlotComponentsRestService=this.contentSlotComponentsRestService||this.restServiceFactory.get(_,"componentId");const o=yield this.pageInfoService.getPageUID();try{yield this.contentSlotComponentsRestService.update({pageId:o,currentSlotId:e,componentId:n,slotId:t,position:i})}catch(e){this.generateAndAlertErrorMessage(n,t,e,{message:"se.cms.draganddrop.move.failed",messagePlaceholders:{slotID:t,componentID:n},minWidth:"",mousePersist:true,duration:1e3,dismissible:true,width:"300px"});return Promise.reject()}return this.renderSlots([e,t],n,t)}))}generateAndAlertSuccessMessage(e,t){this.alertService.showSuccess({message:"se.cms.draganddrop.success",messagePlaceholders:{sourceComponentId:e,targetSlotId:t},minWidth:"",mousePersist:true,duration:1e3,dismissible:true,width:"300px"})}generateAndAlertErrorMessage(e,t,n,i){if(this.hasErrorResponseErrors(n)){this.alertService.showDanger({message:"se.cms.draganddrop.error",messagePlaceholders:{sourceComponentId:e,targetSlotId:t,detailedError:n.error.errors[0].message},minWidth:"",mousePersist:true,duration:1e3,dismissible:true,width:"300px"})}else if(i){this.alertService.showDanger(i)}}hasErrorResponseErrors(e){var t,n;return!!(((n=(t=e===null||e===void 0?void 0:e.error)===null||t===void 0?void 0:t.errors)===null||n===void 0?void 0:n.length)>0)}renderSlots(e,t,n,i){return __awaiter(this,void 0,void 0,(function*(){try{yield this.renderService.renderSlots(e)}catch(e){this.logService.error(`${this.constructor.name}.renderSlots::renderService.renderSlots - targetSlotId:`,n);this.logService.error(e);this.generateAndAlertErrorMessage(t,n,e);return Promise.reject(e)}try{yield this.slotVisibilityService.reloadSlotsInfo();if(i){this.generateAndAlertSuccessMessage(t,n)}}catch(e){this.logService.error(`${this.constructor.name}.renderSlots::slotVisibilityService.reloadSlotsInfo`);this.logService.error(e);return Promise.reject(e)}return Promise.resolve()}))}};t.ComponentEditingFacade=__decorate([r.GatewayProxied("addNewComponentToSlot","addExistingComponentToSlot","cloneExistingComponentToSlot","moveComponent"),i.Injectable(),__metadata("design:paramtypes",[r.IAlertService,s.ComponentService,s.IComponentVisibilityAlertService,r.CrossFrameEventService,r.IEditorModalService,r.LogService,r.IPageInfoService,r.IRenderService,r.IRestServiceFactory,s.ISlotVisibilityService,r.ISharedDataService,r.SystemEventService,c.TranslateService])],t.ComponentEditingFacade);t.ContextAwareEditableItemService=class ContextAwareEditableItemService extends s.IContextAwareEditableItemService{constructor(){super()}};t.ContextAwareEditableItemService=__decorate([r.GatewayProxied(),__metadata("design:paramtypes",[])],t.ContextAwareEditableItemService);t.ContextualMenuDropdownService=class ContextualMenuDropdownService{constructor(e){this.systemEventService=e}registerIsOpenEvent(){this.systemEventService.subscribe(r.CTX_MENU_DROPDOWN_IS_OPEN,(()=>{this.registerDragStarted()}))}registerDragStarted(){this.unsubscribeFn=this.systemEventService.subscribe(s.DRAG_AND_DROP_EVENTS.DRAG_STARTED,(()=>{this.triggerCloseOperation()}))}triggerCloseOperation(){this.systemEventService.publishAsync(r.CLOSE_CTX_MENU);if(this.unsubscribeFn){this.unsubscribeFn()}}};t.ContextualMenuDropdownService=__decorate([i.Injectable(),__metadata("design:paramtypes",[r.SystemEventService])],t.ContextualMenuDropdownService);t.EditorModalService=class EditorModalService extends r.IEditorModalService{};t.EditorModalService=__decorate([r.GatewayProxied("open","openAndRerenderSlot","openGenericEditor"),i.Injectable()],t.EditorModalService);t.RemoveComponentService=class RemoveComponentService{constructor(e,t,n,i,o){this.alertService=t;this.componentInfoService=n;this.renderService=i;this.systemEventService=o;this.resource=e.get(`${s.PAGES_CONTENT_SLOT_COMPONENT_RESOURCE_URI}/contentslots/:slotId/components/:componentId`,"componentId")}removeComponent(e){return __awaiter(this,void 0,void 0,(function*(){try{yield this.resource.remove({slotId:e.slotId,componentId:e.slotOperationRelatedId})}catch(t){this.alertService.showDanger({message:"se.cms.remove.component.failed",messagePlaceholders:{slotID:e.slotId,componentID:e.slotOperationRelatedId},minWidth:"",mousePersist:true,duration:1e3,dismissible:true,width:"300px"});return Promise.reject()}const t=yield this.componentInfoService.getById(e.componentUuid);this.systemEventService.publish(s.COMPONENT_REMOVED_EVENT,t);this.renderService.renderSlots(e.slotId);return this.componentInfoService.getById(e.componentUuid,true)}))}};t.RemoveComponentService=__decorate([r.GatewayProxied("removeComponent"),i.Injectable(),__metadata("design:paramtypes",[r.IRestServiceFactory,r.IAlertService,t.ComponentInfoService,r.IRenderService,r.SystemEventService])],t.RemoveComponentService);t.SlotVisibilityService=class SlotVisibilityService extends s.ISlotVisibilityService{constructor(e,t,n,i,o){super();this.crossFrameEventService=e;this.componentHandlerService=t;this.logService=n;this.pageInfoService=i;this.pageContentSlotsComponentsRestService=o;this.crossFrameEventService.subscribe(s.COMPONENT_CREATED_EVENT,(()=>this.clearComponentsCache()));this.crossFrameEventService.subscribe(s.COMPONENT_UPDATED_EVENT,(()=>this.clearComponentsCache()));this.crossFrameEventService.subscribe(s.COMPONENT_REMOVED_EVENT,(()=>this.clearComponentsCache()))}getHiddenComponents(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.getSlotToComponentsMap();const n=this.filterVisibleComponents(t);return n[e]||[]}))}reloadSlotsInfo(){return __awaiter(this,void 0,void 0,(function*(){try{const e=yield this.pageInfoService.getPageUID();this.pageContentSlotsComponentsRestService.clearCache();return this.pageContentSlotsComponentsRestService.getSlotsToComponentsMapForPageUid(e)}catch(e){this.logService.error("SlotVisibilityService::reloadSlotsInfo - failed call to pageInfoService.getPageUID");throw e}}))}filterVisibleComponents(e){Object.keys(e).forEach((t=>{const n=this.componentHandlerService.getOriginalComponentsWithinSlot(t);const i=n.get().map((e=>this.componentHandlerService.getId(e)));const o=e[t].filter((e=>!i.includes(e.uid)));e[t]=o}));return e}getSlotToComponentsMap(){return __awaiter(this,void 0,void 0,(function*(){try{const e=yield this.pageInfoService.getPageUID();return this.pageContentSlotsComponentsRestService.getSlotsToComponentsMapForPageUid(e)}catch(e){this.logService.error("SlotVisibilityService::getSlotToComponentsMap - failed call to pageInfoService.getPageUID");throw e}}))}clearComponentsCache(){this.pageContentSlotsComponentsRestService.clearCache()}};t.SlotVisibilityService=__decorate([r.GatewayProxied("getHiddenComponents"),i.Injectable(),__metadata("design:paramtypes",[r.CrossFrameEventService,r.IComponentHandlerService,r.LogService,r.IPageInfoService,s.IPageContentSlotsComponentsRestService])],t.SlotVisibilityService);t.SyncPollingService=class SyncPollingService extends r.ISyncPollingService{constructor(e){super();this.systemEventService=e;this.registerSyncPollingEvents()}registerSyncPollingEvents(){this.systemEventService.subscribe(s.DEFAULT_SYNCHRONIZATION_POLLING.SPEED_UP,this.changePollingSpeed.bind(this));this.systemEventService.subscribe(s.DEFAULT_SYNCHRONIZATION_POLLING.SLOW_DOWN,this.changePollingSpeed.bind(this))}};t.SyncPollingService=__decorate([r.GatewayProxied("getSyncStatus","fetchSyncStatus","changePollingSpeed","registerSyncPollingEvents","performSync"),i.Injectable(),__metadata("design:paramtypes",[r.SystemEventService])],t.SyncPollingService);t.PageContentSlotsComponentsRestService=class PageContentSlotsComponentsRestService extends s.IPageContentSlotsComponentsRestService{constructor(e,t,n){super();this.pageInfoService=t;this.cmsitemsRestService=n;const i=`/cmswebservices/v1/sites/${r.PAGE_CONTEXT_SITE_ID}/catalogs/${s.PAGE_CONTEXT_CATALOG}/versions/${s.PAGE_CONTEXT_CATALOG_VERSION}/pagescontentslotscomponents?pageId=:pageId`;this.pagesContentSlotsComponentsRestService=e.get(i)}clearCache(){return}getComponentsForSlot(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.pageInfoService.getPageUID();const n=yield this.getSlotsToComponentsMapForPageUid(t);return n[e]||[]}))}getSlotsToComponentsMapForPageUid(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.getCachedSlotsToComponentsMapForPageUid(e);return l.cloneDeep(t)}))}getCachedSlotsToComponentsMapForPageUid(e){return __awaiter(this,void 0,void 0,(function*(){const{pageContentSlotComponentList:t}=yield this.pagesContentSlotsComponentsRestService.get({pageId:e});const n=this.mapPageContentSlotComponentListToComponentUuids(t);const{response:i}=yield this.cmsitemsRestService.getByIds(n,"DEFAULT");const o=this.createUuidToComponentMap(i);const s=this.createSlotUuidToComponentMap(t,o);return s}))}createSlotUuidToComponentMap(e,t){return e.reduce(((e,n)=>{e[n.slotId]=e[n.slotId]||[];if(t[n.componentUuid]){e[n.slotId].push(t[n.componentUuid])}return e}),{})}mapPageContentSlotComponentListToComponentUuids(e){let t=e.map((e=>e.componentUuid));t=Array.from(new Set(t));return t}createUuidToComponentMap(e){return(e||[]).reduce(((e,t)=>{e[t.uuid]=t;return e}),{})}};__decorate([r.InvalidateCache(s.slotEvictionTag),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],t.PageContentSlotsComponentsRestService.prototype,"clearCache",null);__decorate([r.Cached({actions:[r.rarelyChangingContent],tags:[r.cmsitemsEvictionTag,r.pageChangeEvictionTag,s.slotEvictionTag]}),__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",Promise)],t.PageContentSlotsComponentsRestService.prototype,"getCachedSlotsToComponentsMapForPageUid",null);t.PageContentSlotsComponentsRestService=__decorate([r.GatewayProxied("clearCache","getSlotsToComponentsMapForPageUid","getComponentsForSlot"),i.Injectable(),__metadata("design:paramtypes",[r.IRestServiceFactory,r.IPageInfoService,r.CmsitemsRestService])],t.PageContentSlotsComponentsRestService);t.PageService=class PageService extends r.IPageService{constructor(){super()}};t.PageService=__decorate([r.GatewayProxied(),i.Injectable(),__metadata("design:paramtypes",[])],t.PageService);t.OpenNodeInPageTreeService=class OpenNodeInPageTreeService{constructor(e){this.crossFrameEventService=e;this.timeout=null}publishOpenEvent(e){this.timeout&&clearTimeout(this.timeout);this.crossFrameEventService.publish(r.EVENT_OPEN_IN_PAGE_TREE,e);this.timeout=setTimeout((()=>{this.crossFrameEventService.publish(r.EVENT_OPEN_IN_PAGE_TREE,e)}),1e3)}};t.OpenNodeInPageTreeService=__decorate([i.Injectable(),__metadata("design:paramtypes",[r.CrossFrameEventService])],t.OpenNodeInPageTreeService);t.ComponentMenuConditionAndCallbackService=class ComponentMenuConditionAndCallbackService extends s.IComponentMenuConditionAndCallbackService{constructor(e,t,n,i,o,s,r,a,l,c,d,p,u,m,h,g,_,v,S,y){super();this.componentHandlerService=e;this.typePermissionsRestService=t;this.componentVisibilityAlertService=n;this.editorModalService=i;this.featureService=o;this.slotRestrictionsService=s;this.confirmationModalService=r;this.logService=a;this.alertService=l;this.removeComponentService=c;this.slotVisibilityService=d;this.crossFrameEventService=p;this.translateService=u;this.componentInfoService=m;this.cmsitemsRestService=h;this.componentEditingFacade=g;this.componentSharedService=_;this.pageInfoService=v;this.catalogService=S;this.catalogVersionPermissionService=y}editConditionForHiddenComponent(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.slotRestrictionsService.isSlotEditable(e.slotId);if(!t){return false}const n=e.componentAttributes&&e.componentAttributes.smarteditCatalogVersionUuid;if(n){const e=yield this.pageInfoService.getCatalogVersionUUIDFromPage();const t=n!==e;const{catalogId:i,version:o}=yield this.catalogService.getCatalogVersionByUuid(n);const s=yield this.catalogVersionPermissionService.hasWritePermission(i,o);return s&&!t}return false}))}sharedCondition(e){return __awaiter(this,void 0,void 0,(function*(){let t=null;if(e.element){t=this.componentHandlerService.getParentSlotForComponent(e.element)}else{t=e.slotId}if(e.isComponentHidden){const t=yield this.pageInfoService.getCatalogVersionUUIDFromPage();if(e.componentAttributes.smarteditCatalogVersionUuid!==t){return false}}else{const[n,i]=yield Promise.all([this.componentHandlerService.isExternalComponent(e.componentId,e.componentType),this.slotRestrictionsService.isSlotEditable(t)]);if(n||!i){return false}}return this.componentSharedService.isComponentShared(e.componentAttributes.smarteditComponentUuid)}))}externalCondition(e){return __awaiter(this,void 0,void 0,(function*(){let t=null;if(!!e.element){t=this.componentHandlerService.getParentSlotForComponent(e.element)}else{t=e.slotId}const n=yield this.slotRestrictionsService.isSlotEditable(t);if(!n){return false}const i=e.componentAttributes&&e.componentAttributes.smarteditCatalogVersionUuid;if(i){const e=yield this.pageInfoService.getCatalogVersionUUIDFromPage();return i!==e}return this.componentHandlerService.isExternalComponent(e.componentId,e.componentType)}))}removeCondition(e){return __awaiter(this,void 0,void 0,(function*(){if(!e.isComponentHidden){let t=null;if(!!e.element){t=this.componentHandlerService.getParentSlotForComponent(e.element)}else{t=e.slotId}const n=yield this.slotRestrictionsService.isSlotEditable(t);if(n){const t=yield this.typePermissionsRestService.hasDeletePermissionForTypes([e.componentType]);return t[e.componentType]}return false}const t=yield this.typePermissionsRestService.hasDeletePermissionForTypes([e.componentType]);return t[e.componentType]}))}removeCallback(e,t){return __awaiter(this,void 0,void 0,(function*(){let n;let i;if(e.element){n=this.componentHandlerService.getSlotOperationRelatedId(e.element);i=this.componentHandlerService.getSlotOperationRelatedType(e.element)}else{n=e.containerId?e.containerId:e.componentId;i=e.containerId&&e.containerType?e.containerType:e.componentType}const o=yield this.confirmationModalService.confirm({description:"se.cms.contextmenu.removecomponent.confirmation.message",title:"se.cms.contextmenu.removecomponent.confirmation.title"}).catch((()=>this.logService.log("Confirmation cancelled")));if(!o){return}yield this.removeComponentService.removeComponent({slotId:e.slotId,slotUuid:e.slotUuid,componentId:e.componentId,componentType:e.componentType,componentUuid:e.componentAttributes.smarteditComponentUuid,slotOperationRelatedId:n,slotOperationRelatedType:i});this.slotVisibilityService.reloadSlotsInfo();this.crossFrameEventService.publish(r.EVENT_SMARTEDIT_COMPONENT_UPDATED,{componentId:e.componentId,componentType:e.componentType,requiresReplayingDecorators:true});const s=this.translateService.instant("se.cms.alert.component.removed.from.slot",{componentID:n,slotID:e.slotId});this.alertService.showSuccess({message:s,minWidth:"",mousePersist:true,duration:1e3,dismissible:true,width:"300px"});if(e.isComponentHidden){yield this.crossFrameEventService.publish(r.EVENT_PAGE_TREE_SLOT_NEED_UPDATE,e.slotId)}t.preventDefault();t.stopPropagation()}))}cloneCondition(e){return __awaiter(this,void 0,void 0,(function*(){const t=e.componentAttributes.smarteditComponentUuid;if(!e.isComponentHidden){let n=null;if(!!e.element){n=this.componentHandlerService.getParentSlotForComponent(e.element)}else{n=e.slotId}const i=yield this.slotRestrictionsService.isSlotEditable(n);if(i){const n=yield this.typePermissionsRestService.hasCreatePermissionForTypes([e.componentType]);if(n[e.componentType]){const e=yield this.componentInfoService.getById(t,true);return e.cloneable}else{return false}}return false}const n=yield this.cmsitemsRestService.getById(t);return n.cloneable}))}cloneCallback(e){return __awaiter(this,void 0,void 0,(function*(){const t=this.componentHandlerService.getComponentPositionInSlot(e.slotId,e.componentAttributes.smarteditComponentId);yield this.componentEditingFacade.cloneExistingComponentToSlot({targetSlotId:e.slotId,dragInfo:{componentId:e.componentAttributes.smarteditComponentId,componentType:e.componentType,componentUuid:e.componentAttributes.smarteditComponentUuid},position:t+1});return null}))}dragCondition(e){return __awaiter(this,void 0,void 0,(function*(){let t=null;if(!!e.element){t=this.componentHandlerService.getParentSlotForComponent(e.element)}else{t=e.slotId}const n=yield this.slotRestrictionsService.isSlotEditable(t);if(n){const t=yield this.typePermissionsRestService.hasUpdatePermissionForTypes([e.componentType]);return t[e.componentType]}return false}))}};t.ComponentMenuConditionAndCallbackService=__decorate([r.GatewayProxied("externalCondition","removeCondition","removeCallback","cloneCondition","cloneCallback","sharedCondition","editConditionForHiddenComponent","dragCondition"),__metadata("design:paramtypes",[r.IComponentHandlerService,s.TypePermissionsRestService,s.IComponentVisibilityAlertService,r.IEditorModalService,r.IFeatureService,r.ISlotRestrictionsService,r.IConfirmationModalService,r.LogService,r.IAlertService,s.IRemoveComponentService,s.ISlotVisibilityService,r.CrossFrameEventService,c.TranslateService,t.ComponentInfoService,r.CmsitemsRestService,s.IComponentEditingFacade,s.IComponentSharedService,r.IPageInfoService,r.ICatalogService,r.ICatalogVersionPermissionService])],t.ComponentMenuConditionAndCallbackService);window.__smartedit__.addDecoratorPayload("Component","HiddenComponentMenuComponent",{selector:"se-hidden-component-menu",template:`<se-popup-overlay class="se-hidden-component-menu__popup-anchor" [popupOverlay]="popupConfig" [popupOverlayTrigger]="isMenuOpen" (popupOverlayOnHide)="hideMenu()"><span *ngIf="menuItems.length > 0" class="sap-icon--overflow se-hidden-component-menu__toggle" (click)="toggle($event)"></span><div se-popup-overlay-body class="se-hidden-component-menu fd-menu__list"><div class="se-hidden-component-menu__item fd-menu__item" *ngFor="let item of menuItems" (click)="executeMenuItemCallback(item, $event)"><span class="se-hidden-component-menu__item-icon" [ngClass]="item.displayIconClass"></span> <span class="se-hidden-component-menu__item-link" [translate]="item.i18nKey"></span></div></div></se-popup-overlay>`,styles:[`.se-hidden-component-menu{box-shadow:0 6px 12px rgba(0,0,0,.175);background-color:var(--sapBaseColor);border-radius:var(--sapElement_BorderCornerRadius);min-width:100px;width:fit-content;position:absolute;border:1px solid var(--sapGroup_ContentBorderColor);z-index:2000;top:96%;left:initial!important;right:0}.se-hidden-component-menu::before{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:var(--sapGroup_ContentBorderColor);border-bottom-color:var(var(--sapField_BorderColor));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-8px}.se-hidden-component-menu::after{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:var(--sapBaseColor);border-bottom-color:var(var(--sapButton_Attention_Hover_Background));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-7px}.se-hidden-component-menu::after,.se-hidden-component-menu::before{right:10px}.se-hidden-component-menu::after,.se-hidden-component-menu::before{display:none}.se-hidden-component-menu__toggle{cursor:pointer;color:var(--sapIndicationColor_5)}.se-hidden-component-menu__item{display:flex;flex-direction:row;align-items:center;display:block;padding:10px 24px}.se-hidden-component-menu__item-icon{font-size:.75rem!important;line-height:1.3333333333;font-weight:400;margin-right:8px}`],changeDetection:i.ChangeDetectionStrategy.OnPush});let v=class HiddenComponentMenuComponent{constructor(e,t,n){this.componentHandlerService=e;this.hiddenComponentMenuService=t;this.cdr=n;this.isMenuOpen=false;this.menuItems=[];this.popupConfig={halign:"left",valign:"bottom"}}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){const e=this.componentHandlerService.getOriginalComponent(this.slotId,r.CONTENT_SLOT_TYPE);this.slotUuid=this.componentHandlerService.getUuid(e);const t=yield this.hiddenComponentMenuService.getItemsForHiddenComponent(this.component,this.slotId);this.configuration=l.cloneDeep(t.configuration);this.configuration.slotUuid=this.slotUuid;this.menuItems=l.cloneDeep(t.buttons);if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}toggle(e){e.stopPropagation();this.isMenuOpen=!this.isMenuOpen}hideMenu(){this.isMenuOpen=false}executeMenuItemCallback(e,t){e.action.callback(this.configuration,t);this.isMenuOpen=false}};__decorate([i.Input(),__metadata("design:type",Object)],v.prototype,"component",void 0);__decorate([i.Input(),__metadata("design:type",String)],v.prototype,"slotId",void 0);v=__decorate([i.Component({selector:"se-hidden-component-menu",template:`<se-popup-overlay class="se-hidden-component-menu__popup-anchor" [popupOverlay]="popupConfig" [popupOverlayTrigger]="isMenuOpen" (popupOverlayOnHide)="hideMenu()"><span *ngIf="menuItems.length > 0" class="sap-icon--overflow se-hidden-component-menu__toggle" (click)="toggle($event)"></span><div se-popup-overlay-body class="se-hidden-component-menu fd-menu__list"><div class="se-hidden-component-menu__item fd-menu__item" *ngFor="let item of menuItems" (click)="executeMenuItemCallback(item, $event)"><span class="se-hidden-component-menu__item-icon" [ngClass]="item.displayIconClass"></span> <span class="se-hidden-component-menu__item-link" [translate]="item.i18nKey"></span></div></div></se-popup-overlay>`,styles:[`.se-hidden-component-menu{box-shadow:0 6px 12px rgba(0,0,0,.175);background-color:var(--sapBaseColor);border-radius:var(--sapElement_BorderCornerRadius);min-width:100px;width:fit-content;position:absolute;border:1px solid var(--sapGroup_ContentBorderColor);z-index:2000;top:96%;left:initial!important;right:0}.se-hidden-component-menu::before{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:var(--sapGroup_ContentBorderColor);border-bottom-color:var(var(--sapField_BorderColor));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-8px}.se-hidden-component-menu::after{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:var(--sapBaseColor);border-bottom-color:var(var(--sapButton_Attention_Hover_Background));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-7px}.se-hidden-component-menu::after,.se-hidden-component-menu::before{right:10px}.se-hidden-component-menu::after,.se-hidden-component-menu::before{display:none}.se-hidden-component-menu__toggle{cursor:pointer;color:var(--sapIndicationColor_5)}.se-hidden-component-menu__item{display:flex;flex-direction:row;align-items:center;display:block;padding:10px 24px}.se-hidden-component-menu__item-icon{font-size:.75rem!important;line-height:1.3333333333;font-weight:400;margin-right:8px}`],changeDetection:i.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[r.IComponentHandlerService,t.HiddenComponentMenuService,i.ChangeDetectorRef])],v);window.__smartedit__.addDecoratorPayload("Component","SlotVisibilityComponent",{selector:"se-slot-visibility-component",template:`<div class="se-slot-visibility-wrapper"><div *ngIf="isReady" class="se-slot-visiblity-component__content"><div class="se-slot-visibility__icon-wrapper"><div class="se-slot-visibility__icon sap-icon--home-share"></div><div *ngIf="isSharedComponent" class="se-slot-visibility__icon--shared sap-icon--chain-link"></div></div><div class="se-slot-visiblity-component__description"><div *ngIf="readOnly" class="se-slot-visiblity-component__name">{{ component.name }}</div><div *ngIf="!readOnly" class="se-slot-visiblity-component__name--link" (click)="openEditorModal()">{{ component.name }}</div><div class="se-slot-visiblity-component__type">{{ component.typeCode }}</div><div class="se-slot-visiblity-component__visibility">{{ 'se.genericeditor.tab.visibility.title' | translate }} {{ componentVisibilitySwitch | translate }} / {{ componentRestrictionsCount }} {{ 'se.cms.restrictions.editor.tab' | translate }}</div><div *ngIf="component.isExternal" class="sap-icon--globe se-slot-visiblity-component--globe-icon"></div></div></div><se-hidden-component-menu [slotId]="slotId" [component]="component"></se-hidden-component-menu></div>`,styles:[`.se-slot-visiblity-component--globe-icon{margin-left:4px}.se-slot-visiblity-component__content{display:flex;flex-direction:row;align-items:center;flex-grow:1}.se-slot-visiblity-component__description{margin-right:16px}.se-slot-visiblity-component__name,.se-slot-visiblity-component__visibility{color:var(--sapTextColor)}.se-slot-visiblity-component__name--link{cursor:pointer;color:var(--sapLinkColor)}.se-slot-visiblity-component__type{color:var(--sapNeutralColor)}`],changeDetection:i.ChangeDetectionStrategy.OnPush});let S=class SlotVisibilityComponent{constructor(e,t,n,i,o,s,r,a){this.catalogService=e;this.componentSharedService=t;this.editorModalService=n;this.componentVisibilityAlertService=i;this.catalogVersionPermissionService=o;this.logService=s;this.cdr=r;this.userTrackingService=a;this.isReady=false;this.isSharedComponent=false;this.readOnly=false}ngOnInit(){var e;return __awaiter(this,void 0,void 0,(function*(){this.isSharedComponent=yield this.componentSharedService.isComponentShared(this.component);const{catalogId:t,version:n}=yield this.catalogService.getCatalogVersionByUuid(this.component.catalogVersion);const i=yield this.catalogVersionPermissionService.hasWritePermission(t,n);this.readOnly=!i||this.component.isExternal;this.componentVisibilitySwitch=this.component.visible?"se.cms.component.visibility.status.on":"se.cms.component.visibility.status.off";const o=((e=this.component.restrictions)===null||e===void 0?void 0:e.length)||0;this.componentRestrictionsCount=`(${o})`;this.isReady=true;if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}ngOnChanges(e){const t=e.component;if(t){this.componentId=this.component.uid}}openEditorModal(){return __awaiter(this,void 0,void 0,(function*(){this.userTrackingService.trackingUserAction(r.USER_TRACKING_FUNCTIONALITY.CONTEXT_MENU,"Slot Visibility");try{const e=yield this.editorModalService.openAndRerenderSlot(this.component.typeCode,this.component.uuid,"visible");this.componentVisibilityAlertService.checkAndAlertOnComponentVisibility({itemId:e.uuid,itemType:e.itemtype,catalogVersion:e.catalogVersion,restricted:e.restricted,slotId:this.slotId,visible:e.visible})}catch(e){if(e!==undefined){this.logService.warn("Something went wrong with openAndRerenderSlot method.",e)}}}))}};__decorate([i.Input(),__metadata("design:type",Object)],S.prototype,"component",void 0);__decorate([i.HostBinding("attr.data-component-id"),__metadata("design:type",String)],S.prototype,"componentId",void 0);__decorate([i.Input(),__metadata("design:type",String)],S.prototype,"slotId",void 0);S=__decorate([i.Component({selector:"se-slot-visibility-component",template:`<div class="se-slot-visibility-wrapper"><div *ngIf="isReady" class="se-slot-visiblity-component__content"><div class="se-slot-visibility__icon-wrapper"><div class="se-slot-visibility__icon sap-icon--home-share"></div><div *ngIf="isSharedComponent" class="se-slot-visibility__icon--shared sap-icon--chain-link"></div></div><div class="se-slot-visiblity-component__description"><div *ngIf="readOnly" class="se-slot-visiblity-component__name">{{ component.name }}</div><div *ngIf="!readOnly" class="se-slot-visiblity-component__name--link" (click)="openEditorModal()">{{ component.name }}</div><div class="se-slot-visiblity-component__type">{{ component.typeCode }}</div><div class="se-slot-visiblity-component__visibility">{{ 'se.genericeditor.tab.visibility.title' | translate }} {{ componentVisibilitySwitch | translate }} / {{ componentRestrictionsCount }} {{ 'se.cms.restrictions.editor.tab' | translate }}</div><div *ngIf="component.isExternal" class="sap-icon--globe se-slot-visiblity-component--globe-icon"></div></div></div><se-hidden-component-menu [slotId]="slotId" [component]="component"></se-hidden-component-menu></div>`,styles:[`.se-slot-visiblity-component--globe-icon{margin-left:4px}.se-slot-visiblity-component__content{display:flex;flex-direction:row;align-items:center;flex-grow:1}.se-slot-visiblity-component__description{margin-right:16px}.se-slot-visiblity-component__name,.se-slot-visiblity-component__visibility{color:var(--sapTextColor)}.se-slot-visiblity-component__name--link{cursor:pointer;color:var(--sapLinkColor)}.se-slot-visiblity-component__type{color:var(--sapNeutralColor)}`],changeDetection:i.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[r.ICatalogService,s.IComponentSharedService,r.IEditorModalService,s.IComponentVisibilityAlertService,r.ICatalogVersionPermissionService,r.LogService,i.ChangeDetectorRef,r.IUserTrackingService])],S);window.__smartedit__.addDecoratorPayload("Component","SlotVisibilityButtonComponent",{selector:"se-slot-visibility-button",template:`<se-popup-overlay *ngIf="buttonVisible" class="se-slot-visibility" [popupOverlay]="popupConfig" [popupOverlayTrigger]="isPopupOpened" (popupOverlayOnHide)="hideMenu()"><button type="button" id="slot-visibility-button-{{ slotId }}" class="se-slot-ctx-menu__dropdown-toggle se-slot-ctx-menu__dropdown-toggle--slot-visibility" [ngClass]="{\n            'se-slot-ctx-menu__dropdown-toggle--open': isPopupOpened\n        }" (click)="toggleMenu()" title="{{ getSlotVisibilityButtonTitle() | translate }}"><span class="se-slot-ctx-menu__dropdown-toggle-icon sap-icon--hide"></span> <span class="se-slot-ctx-menu__dropdown-toggle-add-on">{{ hiddenComponentCount }}</span></button><div se-popup-overlay-body id="slot-visibility-list-{{ slotId }}" class="se-slot__dropdown-menu" (click)="onInsideClick($event)"><div class="se-slot-contextual-menu__header" translate="se.cms.slotvisibility.list.title"></div><ul class="se-slot-visibility__component-list"><li *ngFor="let component of hiddenComponents; trackBy: hiddenComponentTrackBy" class="se-slot-visibility__component-list-item"><se-tooltip *ngIf="component.isExternal" [placement]="'top'" [triggers]="['mouseenter', 'mouseleave']"><se-slot-visibility-component se-tooltip-trigger [component]="component" [slotId]="slotId"></se-slot-visibility-component><span se-tooltip-body translate="se.cms.slotvisibility.external.component"></span></se-tooltip><se-slot-visibility-component *ngIf="!component.isExternal" [component]="component" [slotId]="slotId"></se-slot-visibility-component></li></ul></div></se-popup-overlay>`,styles:[`#smarteditoverlay .se-slot-visibility__component-list,.cdk-overlay-container .se-slot-visibility__component-list{padding:16px 20px;list-style:none}#smarteditoverlay .se-slot-visibility__component-list-item,.cdk-overlay-container .se-slot-visibility__component-list-item{margin-bottom:16px}#smarteditoverlay .se-slot-visibility__component-list-item:last-child,.cdk-overlay-container .se-slot-visibility__component-list-item:last-child{margin-bottom:0}`],encapsulation:i.ViewEncapsulation.None,changeDetection:i.ChangeDetectionStrategy.OnPush});let y=class SlotVisibilityButtonComponent{constructor(e,t,n,i,o){this.contextualMenuItem=e;this.slotVisibilityService=t;this.sharedDataService=n;this.crossFrameEventService=i;this.cdr=o;this.isPopupOpened=false;this.isPopupOpenedPreviousValue=this.isPopupOpened;this.buttonVisible=false;this.hiddenComponents=[];this.popupConfig={halign:"left",valign:"bottom",additionalClasses:["se-slot-ctx-menu__dropdown-toggle-wrapper","se-slot-ctx-menu__dropdown-toggle-wrapper--slot-visibility","se-slot-ctx-menu__divider"]};this.buttonName="slotVisibilityButton"}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.unRegOuterFrameClicked=this.crossFrameEventService.subscribe(r.EVENT_OUTER_FRAME_CLICKED,(()=>{this.isPopupOpened=false}));const e=yield this.slotVisibilityService.getHiddenComponents(this.slotId);const t=yield this.sharedDataService.get("experience");this.hiddenComponents=this.markExternalComponents(t,e);this.hiddenComponentCount=e.length;if(this.hiddenComponentCount>0){this.buttonVisible=true}if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}ngOnDestroy(){if(this.unRegOuterFrameClicked){this.unRegOuterFrameClicked()}}ngDoCheck(){if(this.isPopupOpenedPreviousValue!==this.isPopupOpened){this.isPopupOpenedPreviousValue=this.isPopupOpened;this.contextualMenuItem.setRemainOpen(this.buttonName,this.isPopupOpened)}}get slotId(){return this.contextualMenuItem.componentAttributes.smarteditComponentId}hiddenComponentTrackBy(e,t){return e}toggleMenu(){this.isPopupOpened=!this.isPopupOpened}hideMenu(){this.isPopupOpened=false}onInsideClick(e){e.stopPropagation()}getSlotVisibilityButtonTitle(){return this.buttonVisible?"se.cms.pagetree.component.menu.icon.hide.title":"se.cms.pagetree.component.menu.icon.visible.title"}markExternalComponents(e,t){return t.map((t=>Object.assign(Object.assign({},t),{isExternal:t.catalogVersion!==e.pageContext.catalogVersionUuid})))}};y=__decorate([i.Component({selector:"se-slot-visibility-button",template:`<se-popup-overlay *ngIf="buttonVisible" class="se-slot-visibility" [popupOverlay]="popupConfig" [popupOverlayTrigger]="isPopupOpened" (popupOverlayOnHide)="hideMenu()"><button type="button" id="slot-visibility-button-{{ slotId }}" class="se-slot-ctx-menu__dropdown-toggle se-slot-ctx-menu__dropdown-toggle--slot-visibility" [ngClass]="{\n            'se-slot-ctx-menu__dropdown-toggle--open': isPopupOpened\n        }" (click)="toggleMenu()" title="{{ getSlotVisibilityButtonTitle() | translate }}"><span class="se-slot-ctx-menu__dropdown-toggle-icon sap-icon--hide"></span> <span class="se-slot-ctx-menu__dropdown-toggle-add-on">{{ hiddenComponentCount }}</span></button><div se-popup-overlay-body id="slot-visibility-list-{{ slotId }}" class="se-slot__dropdown-menu" (click)="onInsideClick($event)"><div class="se-slot-contextual-menu__header" translate="se.cms.slotvisibility.list.title"></div><ul class="se-slot-visibility__component-list"><li *ngFor="let component of hiddenComponents; trackBy: hiddenComponentTrackBy" class="se-slot-visibility__component-list-item"><se-tooltip *ngIf="component.isExternal" [placement]="'top'" [triggers]="['mouseenter', 'mouseleave']"><se-slot-visibility-component se-tooltip-trigger [component]="component" [slotId]="slotId"></se-slot-visibility-component><span se-tooltip-body translate="se.cms.slotvisibility.external.component"></span></se-tooltip><se-slot-visibility-component *ngIf="!component.isExternal" [component]="component" [slotId]="slotId"></se-slot-visibility-component></li></ul></div></se-popup-overlay>`,styles:[`#smarteditoverlay .se-slot-visibility__component-list,.cdk-overlay-container .se-slot-visibility__component-list{padding:16px 20px;list-style:none}#smarteditoverlay .se-slot-visibility__component-list-item,.cdk-overlay-container .se-slot-visibility__component-list-item{margin-bottom:16px}#smarteditoverlay .se-slot-visibility__component-list-item:last-child,.cdk-overlay-container .se-slot-visibility__component-list-item:last-child{margin-bottom:0}`],encapsulation:i.ViewEncapsulation.None,changeDetection:i.ChangeDetectionStrategy.OnPush}),__param(0,i.Inject(r.CONTEXTUAL_MENU_ITEM_DATA)),__metadata("design:paramtypes",[Object,s.ISlotVisibilityService,r.ISharedDataService,r.CrossFrameEventService,i.ChangeDetectorRef])],y);window.__smartedit__.addDecoratorPayload("Component","ExternalSlotDisabledDecoratorComponent",{selector:"external-slot-disabled-decorator",template:`<div class="se-decorator-wrap"><slot-disabled-component [active]="active" [componentAttributes]="componentAttributes"></slot-disabled-component></div>`});let C=class ExternalSlotDisabledDecoratorComponent extends r.AbstractDecorator{constructor(){super()}};C=__decorate([r.SeCustomComponent(),i.Component({selector:"external-slot-disabled-decorator",template:`<div class="se-decorator-wrap"><slot-disabled-component [active]="active" [componentAttributes]="componentAttributes"></slot-disabled-component></div>`}),__metadata("design:paramtypes",[])],C);window.__smartedit__.addDecoratorPayload("Component","SharedSlotDisabledDecoratorComponent",{selector:"shared-slot-disabled-decorator",template:`<div class="se-decorator-wrap"><slot-disabled-component [active]="active" [componentAttributes]="componentAttributes"></slot-disabled-component><div><ng-content></ng-content></div></div>`});let f=class SharedSlotDisabledDecoratorComponent extends r.AbstractDecorator{constructor(){super()}};f=__decorate([r.SeCustomComponent(),i.Component({selector:"shared-slot-disabled-decorator",template:`<div class="se-decorator-wrap"><slot-disabled-component [active]="active" [componentAttributes]="componentAttributes"></slot-disabled-component><div><ng-content></ng-content></div></div>`}),__metadata("design:paramtypes",[])],f);var E;(function(e){e["GLOBE"]="sap-icon--globe";e["HOVERED"]="sap-icon--chain-link"})(E||(E={}));window.__smartedit__.addDecoratorPayload("Component","SlotDisabledComponent",{selector:"slot-disabled-component",template:`<div class="se-slot-popover" [ngClass]="{ \n        'disabled-shared-slot': !isVersioningPerspective,\n        'disabled-shared-slot-hovered': active, \n        'disabled-shared-slot-versioning-mode': isVersioningPerspective, \n        'external-shared-slot': isGlobalSlot\n    }" [attr.data-popover-content]="popoverMessage?.translate | translate: popoverMessage?.translateParams"><div class="se-slot-popover__arrow"><div class="se-slot-popover__arrow--fill"></div></div><div class="disabled-shared-slot__icon--outer disabled-shared-slot__icon--outer-linked" [ngClass]="outerSlotClass"><span class="shared_slot_disabled_icon disabled-shared-slot__icon--inner" [ngClass]="iconClass"></span></div></div>`,styles:[`#smarteditoverlay .se-slot-popover{align-items:center;display:flex;flex-direction:column-reverse;justify-content:center}#smarteditoverlay .se-slot-popover__arrow{opacity:0;margin-top:15px;position:relative;width:0;border-bottom:12px solid var(--sapGroup_ContentBorderColor);border-right:12px solid transparent;border-left:12px solid transparent;z-index:9999}#smarteditoverlay .se-slot-popover__arrow--fill{position:absolute;top:1px;left:-11px;width:0;border-bottom:11px solid var(--sapBaseColor);border-right:11px solid transparent;border-left:11px solid transparent}#smarteditoverlay .se-slot-popover:before{opacity:0;box-shadow:0 0 4px 0 var(--sapGroup_ContentBorderColor);z-index:9999;background-color:var(--sapBaseColor);color:var(--sapTextColor);border:1px solid var(--sapGroup_ContentBorderColor);border-radius:4px;content:attr(data-popover-content);margin-bottom:-78px;padding:10px;white-space:nowrap}#smarteditoverlay [data-smartedit-component-type=ContentSlot]:hover .se-slot-popover:before{opacity:1;margin-top:-1px}#smarteditoverlay [data-smartedit-component-type=ContentSlot]:hover .se-slot-popover__arrow{opacity:1}`],encapsulation:i.ViewEncapsulation.None,providers:[r.L10nPipe],changeDetection:i.ChangeDetectionStrategy.OnPush});let I=class SlotDisabledComponent{constructor(e,t,n,i,o){this.catalogService=e;this.cMSModesService=t;this.l10nPipe=n;this.slotSharedService=i;this.cdr=o;this.DEFAULT_DECORATOR_MSG="se.cms.sharedslot.decorator.label";this.GLOBAL_SLOT_DECORATOR_MSG="se.cms.parentsharedslot.decorator.label";this.DEFAULT_DECORATOR_MSG_VERSIONING_MODE="se.cms.versioning.shared.slot.from.label";this.GLOBAL_SLOT_DECORATOR_MSG_VERSIONING_MODE="se.cms.versioning.parent.shared.slot.from.label";this.isGlobalSlot=false;this.isVersioningPerspective=false}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){const[e,t]=yield Promise.all([this.catalogService.getCatalogVersionByUuid(this.componentAttributes.smarteditCatalogVersionUuid),this.cMSModesService.isVersioningPerspectiveActive()]);this.isVersioningPerspective=t;this.isGlobalSlot=yield this.slotSharedService.isGlobalSlot(this.componentAttributes.smarteditComponentId,this.componentAttributes.smarteditComponentType);this.popoverMessage=yield this.getPopoverMessage(e.catalogName);this.setIconAndOuterSlotClassName();if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}ngOnChanges(e){const t=e.active;if(t&&!t.firstChange){this.setIconAndOuterSlotClassName()}}getPopoverMessage(e){return __awaiter(this,void 0,void 0,(function*(){let t;if(this.isVersioningPerspective){t=this.isGlobalSlot?this.GLOBAL_SLOT_DECORATOR_MSG_VERSIONING_MODE:this.DEFAULT_DECORATOR_MSG_VERSIONING_MODE}else{t=this.isGlobalSlot?this.GLOBAL_SLOT_DECORATOR_MSG:this.DEFAULT_DECORATOR_MSG}const n=yield this.l10nPipe.transform(e).pipe(a.take(1)).toPromise();const i={slotId:this.componentAttributes.smarteditComponentId,catalogName:n};return{translate:t,translateParams:i}}))}setIconAndOuterSlotClassName(){this.iconClass=this.isGlobalSlot?E.GLOBE:E.HOVERED;this.outerSlotClass=this.getOuterSlotClass(this.active,this.iconClass)}getOuterSlotClass(e,t){return{"disabled-shared-slot__icon--outer-hovered":e&&!this.isVersioningPerspective,"disabled-shared-slot__icon--outer-globe":t===E.GLOBE}}};__decorate([i.Input(),__metadata("design:type",Object)],I.prototype,"componentAttributes",void 0);__decorate([i.Input(),__metadata("design:type",Boolean)],I.prototype,"active",void 0);I=__decorate([i.Component({selector:"slot-disabled-component",template:`<div class="se-slot-popover" [ngClass]="{ \n        'disabled-shared-slot': !isVersioningPerspective,\n        'disabled-shared-slot-hovered': active, \n        'disabled-shared-slot-versioning-mode': isVersioningPerspective, \n        'external-shared-slot': isGlobalSlot\n    }" [attr.data-popover-content]="popoverMessage?.translate | translate: popoverMessage?.translateParams"><div class="se-slot-popover__arrow"><div class="se-slot-popover__arrow--fill"></div></div><div class="disabled-shared-slot__icon--outer disabled-shared-slot__icon--outer-linked" [ngClass]="outerSlotClass"><span class="shared_slot_disabled_icon disabled-shared-slot__icon--inner" [ngClass]="iconClass"></span></div></div>`,styles:[`#smarteditoverlay .se-slot-popover{align-items:center;display:flex;flex-direction:column-reverse;justify-content:center}#smarteditoverlay .se-slot-popover__arrow{opacity:0;margin-top:15px;position:relative;width:0;border-bottom:12px solid var(--sapGroup_ContentBorderColor);border-right:12px solid transparent;border-left:12px solid transparent;z-index:9999}#smarteditoverlay .se-slot-popover__arrow--fill{position:absolute;top:1px;left:-11px;width:0;border-bottom:11px solid var(--sapBaseColor);border-right:11px solid transparent;border-left:11px solid transparent}#smarteditoverlay .se-slot-popover:before{opacity:0;box-shadow:0 0 4px 0 var(--sapGroup_ContentBorderColor);z-index:9999;background-color:var(--sapBaseColor);color:var(--sapTextColor);border:1px solid var(--sapGroup_ContentBorderColor);border-radius:4px;content:attr(data-popover-content);margin-bottom:-78px;padding:10px;white-space:nowrap}#smarteditoverlay [data-smartedit-component-type=ContentSlot]:hover .se-slot-popover:before{opacity:1;margin-top:-1px}#smarteditoverlay [data-smartedit-component-type=ContentSlot]:hover .se-slot-popover__arrow{opacity:1}`],encapsulation:i.ViewEncapsulation.None,providers:[r.L10nPipe],changeDetection:i.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[r.ICatalogService,r.CMSModesService,r.L10nPipe,r.SlotSharedService,i.ChangeDetectorRef])],I);let b=class CmsComponentsModule{};b=__decorate([i.NgModule({imports:[d.CommonModule,r.TooltipModule,r.TranslationModule.forChild(),r.PopupOverlayModule,p.ButtonModule],declarations:[u,I,C,f,v,S,y,m],entryComponents:[u,I,C,f,v,S,y,m]})],b);const T="^((?!Slot).)*$";t.CmssmarteditModule=class CmssmarteditModule{};t.CmssmarteditModule=__decorate([r.SeEntryModule("cmssmartedit"),i.NgModule({imports:[o.BrowserModule,r.SeTranslationModule.forChild(),b,s.CmsCommonsModule],providers:[t.ContextualMenuDropdownService,r.PageContentSlotsService,s.SlotUnsharedService,t.SlotContainerService,t.HiddenComponentMenuService,t.ComponentInfoService,s.SlotSynchronizationService,r.SlotSharedService,{provide:s.IEditorEnablerService,useClass:t.EditorEnablerService},{provide:s.IComponentEditingFacade,useClass:t.ComponentEditingFacade},t.CmsDragAndDropService,t.OpenNodeInPageTreeService,{provide:s.IPageContentSlotsComponentsRestService,useClass:t.PageContentSlotsComponentsRestService},{provide:r.ISyncPollingService,useClass:t.SyncPollingService},{provide:s.IRemoveComponentService,useClass:t.RemoveComponentService},{provide:r.IPageService,useClass:t.PageService},{provide:s.IContextAwareEditableItemService,useClass:t.ContextAwareEditableItemService},{provide:r.IEditorModalService,useClass:t.EditorModalService},{provide:s.IComponentVisibilityAlertService,useClass:t.ComponentVisibilityAlertService},{provide:s.IComponentSharedService,useClass:t.ComponentSharedService},{provide:r.ISlotRestrictionsService,useClass:t.SlotRestrictionsService},{provide:s.ISlotVisibilityService,useClass:t.SlotVisibilityService},{provide:s.IComponentMenuConditionAndCallbackService,useClass:t.ComponentMenuConditionAndCallbackService},r.moduleUtils.bootstrap(((e,t,n,i,o,s,r,a,l,c,d,p,u)=>{e.registerIsOpenEvent();t.enableForComponents([T]);n.addMappings({"^((?!Slot).)*$":["se.contextualMenu","externalComponentDecorator"],"^.*Slot$":["se.slotContextualMenu","se.basicSlotContextualMenu","syncIndicator","sharedSlotDisabledDecorator","externalSlotDisabledDecorator"]});addContextualMenuButtonForFeature(i,{componentMenuConditionAndCallbackService:u,cmsDragAndDropService:l,openNodeInPageTreeService:p});registerForFeature(i,{cmsDragAndDropService:l,slotSharedService:c});addDecoratorForFeature(i,{slotRestrictionsService:s,componentHandlerService:o,slotSharedService:c})}),[t.ContextualMenuDropdownService,s.IEditorEnablerService,r.IDecoratorService,r.IFeatureService,r.IComponentHandlerService,r.ISlotRestrictionsService,r.IPageInfoService,s.TypePermissionsRestService,t.CmsDragAndDropService,r.SlotSharedService,r.ISettingsService,t.OpenNodeInPageTreeService,s.IComponentMenuConditionAndCallbackService])]})],t.CmssmarteditModule);function addDecoratorForFeature(e,t){const{slotRestrictionsService:n,componentHandlerService:i,slotSharedService:o}=t;e.addDecorator({key:"syncIndicator",nameI18nKey:"syncIndicator",permissions:["se.sync.slot.indicator"]});e.addDecorator({key:"sharedSlotDisabledDecorator",nameI18nKey:"se.cms.shared.slot.disabled.decorator",displayCondition:(e,t)=>__awaiter(this,void 0,void 0,(function*(){const[s,r,a]=yield Promise.all([n.isSlotEditable(t),i.isExternalComponent(t,e),o.isSlotShared(t)]);return!s&&!r&&a}))});e.addDecorator({key:"externalSlotDisabledDecorator",nameI18nKey:"se.cms.external.slot.disabled.decorator",displayCondition:(e,t)=>Promise.resolve(o.isGlobalSlot(t,e))});e.addDecorator({key:"externalComponentDecorator",nameI18nKey:"se.cms.external.component.decorator",displayCondition:(e,t)=>i.isExternalComponent(t,e)})}function registerForFeature(e,t){const{cmsDragAndDropService:n,slotSharedService:i}=t;e.register({key:"se.cms.html5DragAndDrop",nameI18nKey:"se.cms.dragAndDrop.name",descriptionI18nKey:"se.cms.dragAndDrop.description",enablingCallback:()=>{n.register();n.apply()},disablingCallback:()=>{n.unregister()}});e.register({key:"disableSharedSlotEditing",nameI18nKey:"se.cms.disableSharedSlotEditing",descriptionI18nKey:"se.cms.disableSharedSlotEditing.description",enablingCallback:()=>{i.setSharedSlotEnablementStatus(true)},disablingCallback:()=>{i.setSharedSlotEnablementStatus(false)}})}function addContextualMenuButtonForFeature(e,t){const{componentMenuConditionAndCallbackService:n,cmsDragAndDropService:i,openNodeInPageTreeService:o}=t;e.addContextualMenuButton({key:"externalcomponentbutton",priority:100,nameI18nKey:"se.cms.contextmenu.title.externalcomponent",i18nKey:"se.cms.contextmenu.title.externalcomponentbutton",regexpKeys:[T],condition:n.externalCondition,action:{component:s.ExternalComponentButtonComponent},displayClass:"externalcomponentbutton",displayIconClass:"sap-icon--globe",displaySmallIconClass:"sap-icon--globe"});e.addContextualMenuButton({key:"se.cms.dragandropbutton",priority:200,nameI18nKey:"se.cms.contextmenu.title.dragndrop",i18nKey:"se.cms.contextmenu.title.dragndrop",regexpKeys:[T],condition:n.dragCondition,action:{callbacks:{mousedown:()=>{i.update()}}},displayClass:"movebutton",displayIconClass:"sap-icon--move",displaySmallIconClass:"sap-icon--move",permissions:["se.context.menu.drag.and.drop.component"]});e.addContextualMenuButton({key:"se.cms.sharedcomponentbutton",priority:300,nameI18nKey:"se.cms.contextmenu.title.shared.component",i18nKey:"se.cms.contextmenu.title.shared.component",regexpKeys:[T],condition:n.sharedCondition,action:{component:s.SharedComponentButtonComponent},displayClass:"shared-component-button",displayIconClass:"sap-icon--chain-link",displaySmallIconClass:"sap-icon--chain-link",permissions:[]});e.addContextualMenuButton({key:"se.cms.remove",priority:500,customCss:"se-contextual-more-menu__item--delete",i18nKey:"se.cms.contextmenu.title.remove",nameI18nKey:"se.cms.contextmenu.title.remove",regexpKeys:[T],condition:n.removeCondition,action:{callback:n.removeCallback},displayClass:"removebutton",displayIconClass:"sap-icon--decline",displaySmallIconClass:"sap-icon--decline",permissions:["se.context.menu.remove.component"]});e.addContextualMenuButton({key:"se.slotContextualMenuVisibility",nameI18nKey:"slotcontextmenu.title.visibility",regexpKeys:["^.*ContentSlot$"],action:{component:y},permissions:["se.slot.context.menu.visibility"]});e.addContextualMenuButton({key:"se.slotSharedButton",nameI18nKey:"slotcontextmenu.title.shared.button",regexpKeys:["^.*Slot$"],action:{component:s.SlotSharedButtonComponent},permissions:["se.slot.context.menu.shared.icon"]});e.addContextualMenuButton({key:"slotUnsharedButton",nameI18nKey:"slotcontextmenu.title.unshared.button",regexpKeys:["^.*Slot$"],action:{component:s.SlotUnsharedButtonComponent},permissions:["se.slot.context.menu.unshared.icon"]});e.addContextualMenuButton({key:"se.slotSyncButton",nameI18nKey:"slotcontextmenu.title.sync.button",regexpKeys:["^.*Slot$"],action:{component:s.SlotSyncButtonComponent},permissions:["se.sync.slot.context.menu"]});e.addContextualMenuButton({key:"clonecomponentbutton",priority:600,nameI18nKey:"se.cms.contextmenu.title.clone.component",i18nKey:"se.cms.contextmenu.title.clone.component",regexpKeys:[T],condition:n.cloneCondition,action:{callback:n.cloneCallback},displayClass:"clonebutton",displayIconClass:"sap-icon--duplicate",displaySmallIconClass:"sap-icon--duplicate",permissions:["se.clone.component"]});e.addContextualMenuButton({key:"se.cms.openInPageTreeButton",priority:700,nameI18nKey:"se.cms.contextmenu.title.open.in.page.tree",i18nKey:"se.cms.contextmenu.title.open.in.page.tree",regexpKeys:[T],action:{callback:e=>{const t=e.componentAttributes.smarteditElementUuid;o.publishOpenEvent(t)}},displayIconClass:"sap-icon--tree",displaySmallIconClass:"sap-icon--tree"})}},20410:(e,t,n)=>{"use strict";var i=n(43412)["lW"];Object.defineProperty(t,"__esModule",{value:true});var o=n(22630);var s=n(50185);var r=n(32709);var a=n(54526);var l=n(67564);var c=n(66791);var d=n(38102);var p=n(19662);var u=n(38788);var m=n(30178);var h=n(37100);var g=n(84359);function _interopNamespace(e){if(e&&e.__esModule)return e;var t=Object.create(null);if(e){Object.keys(e).forEach((function(n){if(n!=="default"){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:true,get:function(){return e[n]}})}}))}t["default"]=e;return Object.freeze(t)}var _=_interopNamespace(o);var v=_interopNamespace(s);class CloneableUtils{makeCloneable(e){const t=_.cloneDeepWith(e,(t=>{if(this._isValueCloneable(t,e)){return this._getCloneableValue(t)}return t}));if(t===undefined||t===null||this.isPrimitive(t)){return t}if(t.hasOwnProperty("length")||t.forEach){return t.map((e=>this.makeCloneable(e)))}return Object.keys(t).reduce(((e,n)=>{if(n.indexOf("$")!==0){e[n]=this.makeCloneable(t[n])}return e}),{})}_isValueCloneable(e,t){return e!==undefined&&e!==null&&!this.isPrimitive(t)}_getCloneableValue(e){if(typeof e==="function"){return null}if(e.then){return null}if(_.isElement(e)){return null}if(typeof e!=="string"&&e.hasOwnProperty("length")&&!e.forEach){return null}return e}isPrimitive(e){return typeof e==="number"||typeof e==="string"||typeof e==="boolean"}}const S=new CloneableUtils;class StringUtils{constructor(){this.sanitize=e=>!this.isBlank(e)?e.split("").reverse().join("").replace(/(?:(([()])(?!\\)))/g,"$1\\").split("").reverse().join(""):e;this.encode=e=>i.from(encodeURIComponent(JSON.stringify(e)).replace(/%([0-9A-F]{2})/g,(function toSolidBytes(e,t){return String.fromCharCode(parseInt(t,16))}))).toString("base64");this.replaceAll=(e,t)=>{const n=new RegExp(Object.keys(t).join("|"),"g");return e.replace(n,(function(e){return t[e]}))}}isBlank(e){return typeof e==="undefined"||e===null||e==="null"||e.toString().trim().length===0}regExpFactory(e){const t=new RegExp(/^[a-zA-Z\d]+$/i);const n=new RegExp(/^[a-zA-Z\d\*]+$/i);let i;if(t.test(e)){i=["^","$"].join(e)}else if(n.test(e)){i=["^","$"].join(e.replace(/\*/g,".*"))}else{i=e}return new RegExp(i,"g")}formatHTML(e){return e.replace(/^\s*\n/gm,"").replace(/\>[\t\s]+\</g,"><").replace(/[\r\n\t\s]+/g," ")}}const y=new StringUtils;class URIBuilder{constructor(e){this.uri=e;this.wholeWordMatch="[\\w]+"}build(){return this.uri}replaceParams(e){const t=_.cloneDeep(this);if(e){t.uri=Object.keys(e).sort((function(e,t){return t.length-e.length})).reduce(((t,n)=>this.substituteKeyForValue(t,n,e[n])),t.uri)}return t}sanitize(){const e=_.cloneDeep(this);const t=/(https?:\/\/[^\/]*)(\/.*)/.exec(e.uri);e.uri=t==null?e.uri:t[2];e.uri=this.substituteKeyForValue(e.uri,this.wholeWordMatch,"").replace(/\/\//,"/").replace(/\/\?/,"?").replace(/\/$/,"");e.uri=t==null?e.uri:t[1]+e.uri;return e}substituteKeyForValue(e,t,n){e=e.replace(new RegExp(":"+t+"/"),`${n||""}/`).replace(new RegExp(":"+t+"$"),`${n||""}`).replace(new RegExp(":"+t+"\\?"),`${n||""}?`).replace(new RegExp(":"+t+"&"),`${n||""}&`);if(t!==this.wholeWordMatch&&t.includes("_")){const i=e.includes("?")?e.substr(0,e.indexOf("?")):e;const o=i.replace(new RegExp("\\b"+t+"\\b"),`${n||""}`);e=e.includes("?")?o+e.substr(e.indexOf("?")):o}return e}}class UrlUtils{getOrigin(e){if(!!e){let t=document.createElement("a");t.setAttribute("href",e);const n=t.protocol+"//"+t.hostname+(t.port?":"+t.port:"");t=null;return n}return window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}getURI(e){return e&&e.indexOf("?")>-1?e.split("?")[0]:e}updateUrlParameter(e,t,n){const i=e.indexOf("#");const o=i===-1?"":e.substr(i);e=i===-1?e:e.substr(0,i);const s=new RegExp("([?&])"+t+"=.*?(&|$)","i");const r=e.indexOf("?")!==-1?"&":"?";if(e.match(s)){e=e.replace(s,"$1"+t+"="+n+"$2")}else{e=e+r+t+"="+n}return e+o}getQueryString(e){let t="";if(e){for(const n in e){if(e.hasOwnProperty(n)){(_.isArray(e[n])?e[n]:[e[n]]).forEach((e=>{t+="&"+encodeURIComponent(n)+"="+encodeURIComponent(e)}))}}}return"?"+(!y.isBlank(t)?t.substring(1):t)}parseQuery(e){const t={};e.replace(/([^?=&]+)(=([^&]*))?/g,(function(e,n,i,o){t[n]=o}));return t}getAbsoluteURL(e,t){const n=new RegExp("([a-zA-Z0-9]+://)"+"([a-zA-Z0-9_]+:[a-zA-Z0-9_]+@)?"+"([a-zA-Z0-9.-]+)"+"|([0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+)"+"(:[0-9]+)?"+"(/.*)?");return n.exec(t)?t:e+t}}const C=new UrlUtils;class CryptographicUtils{sha1Hash(e){return v.SHA1(e).toString()}aesBase64Encrypt(e,t){return v.AES.encrypt(v.enc.Base64.parse(e),t).toString()}aesDecrypt(e,t){return v.AES.decrypt(e,t).toString(v.enc.Utf8)}}class FunctionsUtils{constructor(){this.signatureArgsRegexp=/function[\s\w]*\(([\w\s\$,]*)\)[\s]*{/}isEmpty(e){const t=e.toString().match(/\{([\s\S]*)\}/m);return!t||t[1].trim()===""||/(proxyFunction)/g.test(e.toString().replace(/\s/g,""))}getArguments(e){const t=this.signatureArgsRegexp.exec(e.toString());if(t){return t[1].replace(/\s/g,"").split(",")}else{throw new Error(`failed to retrieve arguments list of ${e}`)}}hasArguments(e){const t=this.signatureArgsRegexp.exec(e.toString());if(t){return!_.isEmpty(t[1])}else{throw new Error(`failed to retrieve arguments list of ${e}`)}}getConstructorName(e){let t=e.name;if(!t){const n=/function (\$?\w+)\s*\(/.exec(e.toString());if(n){t=n[1]}else{throw new Error("[FunctionsUtils] - Cannot get name from invalid constructor.")}}return t}getInstanceConstructorName(e){return this.getConstructorName(Object.getPrototypeOf(e).constructor)}extendsConstructor(e,t){const newConstructor=function(...e){return new t(...e)};newConstructor.prototype=e.prototype;Object.entries(Object.getOwnPropertyDescriptors(e)).filter((([,e])=>e.writable)).forEach((([t])=>{newConstructor[t]=e[t]}));return newConstructor}getInstanceMethods(e){const isGetter=(e,t)=>!!e.__lookupGetter__(t);let t=[];const n=e;const onlyOriginalMethods=(e,i,o)=>!isGetter(n,e)&&typeof n[e]==="function"&&e!=="constructor"&&(i===0||e!==o[i-1])&&t.indexOf(e)===-1;do{const n=Object.getOwnPropertyNames(e).sort().filter(onlyOriginalMethods);t=t.concat(n);e=Object.getPrototypeOf(e)}while(e&&Object.getPrototypeOf(e));return t}isUnitTestMode(){return typeof window.__karma__!=="undefined"}assertFail(){const e=jasmine.createSpy("TestShouldNotReachThatPart-CheckYourTryCatchBlock");expect(e).toHaveBeenCalled()}convertToArray(e){return Object.keys(e).reduce(((t,n)=>[...t||[],{key:n,value:e[n]}]),[])}}const f=new FunctionsUtils;const E=new r.NgZone({enableLongStackTrace:false});class WindowUtils{constructor(e){this.ngZone=e;this.isIframe=()=>this.getWindow().top!==this.getWindow();this.ngZone=this.ngZone||E}getWindow(){return window}runTimeoutOutsideAngular(e,t){const n=this.ngZone;if(n!==undefined){return n.runOutsideAngular((()=>setTimeout((()=>n.run(e)),t)))}else{throw new Error("this instance of WindowUtils has not been instantiated through Angular 7 DI")}}runIntervalOutsideAngular(e,t){const n=this.ngZone;if(n===undefined){throw new Error("this instance of WindowUtils has not been instantiated through Angular 7 DI")}return n.runOutsideAngular((()=>setInterval((()=>n.run(e)),t)))}}WindowUtils.SMARTEDIT_IFRAME_ID="ySmartEditFrame";const I=new WindowUtils;function __decorate(e,t,n,i){var o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s;return o>3&&s&&Object.defineProperty(t,n,s),s}function __param(e,t){return function(n,i){t(n,i,e)}}function __metadata(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}function __awaiter(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))}t.ModuleUtils=class ModuleUtils{initialize(e,t=[]){return{provide:r.APP_INITIALIZER,useFactory(...t){e.apply(undefined,t);return e=>{}},deps:t,multi:true}}bootstrap(e,t=[]){return{provide:r.APP_BOOTSTRAP_LISTENER,useFactory(...t){e.apply(undefined,t);return e=>{}},deps:t,multi:true}}provideValues(e){const t=e||{};return Object.keys(t).map((e=>({provide:e,useValue:t[e]})))}};t.ModuleUtils=__decorate([r.Injectable()],t.ModuleUtils);const b=new t.ModuleUtils;t.LogLevel=void 0;(function(e){e[e["log"]=0]="log";e[e["debug"]=1]="debug";e[e["info"]=2]="info";e[e["warn"]=3]="warn";e[e["error"]=4]="error"})(t.LogLevel||(t.LogLevel={}));class LogService{constructor(){this.logLevel=t.LogLevel.info}log(...e){this._log(t.LogLevel.log,e)}debug(...e){this._log(t.LogLevel.debug,e)}info(...e){this._log(t.LogLevel.info,e)}warn(...e){this._log(t.LogLevel.warn,e)}error(...e){this._log(t.LogLevel.error,e)}setLogLevel(e){this.logLevel=e}_log(e,n){if(e>=this.logLevel){const i=t.LogLevel[e];if(this._console()&&this._console()[i]){this._console()[i](...n)}}}_console(){return console}}var T;t.PromiseUtils=T=class PromiseUtils{constructor(){this.WAIT_TIMEOUT=4;this.FAILURE_TIMEOUT=2e3;this.handlePromiseRejections=e=>{const t=e.then;const n=this.defaultFailureCallback;e.then=function(e,i){const o=i?i:n;return t.call(this,e,o)};return e};this.defaultFailureCallback=e=>{if(undefined!==e&&null!==e&&"canceled"!==e){if(_.isPlainObject(e)){if(!this.isAjaxError(e)){T.logService.error(`exception caught in promise: ${JSON.stringify(e)}`)}}else if(!_.isBoolean(e)){T.logService.error(e)}}T.logService.error(`defaultFailureCallback:`,e);return Promise.reject(e)}}toPromise(e,t){return function(...n){try{return Promise.resolve(e.apply(t,n))}catch(e){T.logService.error("execution of a method that was turned into a promise failed");T.logService.error(e);return Promise.reject(e)}}}promise(e){return this.handlePromiseRejections(new Promise(e))}defer(){let e;let t;const n={promise:this.promise(((n,i)=>{e=n;t=i})),resolve(t){e(t)},reject(e,n){if(n===undefined){t(e)}else{t("")}}};return n}sleep(e){return __awaiter(this,void 0,void 0,(function*(){return new Promise((t=>setTimeout(t,e)))}))}isAjaxError(e){return e.hasOwnProperty("headers")}waitOnCondition(e,t,n,i=0){setTimeout((()=>{if(e()){t()}else if(i<this.FAILURE_TIMEOUT){this.waitOnCondition(e,t,n,i+this.WAIT_TIMEOUT)}else{throw new Error(`PromiseUtils: ${n}`)}}),this.WAIT_TIMEOUT)}resolveToCallbackWhenCondition(e,t,n){return __awaiter(this,void 0,void 0,(function*(){return new Promise((i=>{this.waitOnCondition(e,(()=>i(t())),n?n:"condition for promise resolution was never met")}))}))}attempt(e){return e.then((e=>({error:null,data:e}))).catch((e=>({error:e,data:null})))}};t.PromiseUtils.logService=new LogService;t.PromiseUtils=T=__decorate([r.Injectable()],t.PromiseUtils);const O=new t.PromiseUtils;class BooleanUtils{areAllTruthy(...e){return function(...t){return e.every((e=>e&&e.apply(e,t)))}}isAnyTruthy(...e){return function(...t){return e.some((e=>e&&e.apply(e,t)))}}}const P=new BooleanUtils;class HttpUtils{isGET(e){return e.method==="GET"}isRequestOfAccept(e,t){return!!e.headers&&!!e.headers.get("Accept")&&(e.headers.get("Accept")||"").includes(t)}isResponseOfContentType(e,t){return!!e.headers&&!!e.headers.get("Content-type")&&(e.headers.get("Content-type")||"").indexOf(t)===0}isHTMLRequest(e,t){return this.isGET(e)&&(this.isRequestOfAccept(e,"text/html")||/.+\.html$/.test(e.url)||/.+\.html\?/.test(e.url))}isJSONRequest(e,t){return this.isGET(e)&&(t&&this.isResponseOfContentType(t,"json")||/.+\.json$/.test(e.url))}isJSRequest(e){return this.isGET(e)&&/.+\.js$/.test(e.url)}isCRUDRequest(e,t){return!this.isHTMLRequest(e,t)&&!this.isJSONRequest(e,t)&&!this.isJSRequest(e)}transformHttpParams(e,t){return new a.HttpParams({fromObject:JSON.parse(y.replaceAll(JSON.stringify(this.copyHttpParamsOrHeaders(e)),t))})}copyHttpParamsOrHeaders(e){const t={};e.keys().forEach((n=>{const i=e.getAll(n);if(i!==null){t[n]=i.length>1?i:i[0]}}));return t}buildHttpResponse(e,t){const n=Promise.resolve(t);return l.from(n).pipe(c.switchMap((t=>{const n=t[0];const i=t[1];const o=e.clone({body:i});_.merge(o,{status:n});if(200<=n&&n<300){return new l.Observable((e=>{e.next(new a.HttpResponse(o))}))}else{return l.throwError(new a.HttpErrorResponse(_.merge(o,{error:i})))}})))}}const w=new HttpUtils;class BaseValueAccessor{constructor(){this.disabled=false;this.value=null}onChange(e){}onTouched(){}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled=e}writeValue(e){this.value=e}}var A;(function(e){e["ClassAnnotation"]="ClassAnnotation";e["MethodAnnotation"]="MethodAnnotation"})(A||(A={}));class AnnotationService{constructor(){this.INJECTABLE_NAME_KEY="getInjectableName";this.ORIGINAL_CONSTRUCTOR_KEY="originalConstructor";this.getClassAnnotations=_.memoize(this.getClassAnnotationsLogic);this.getMethodAnnotations=_.memoize(this.getMethodAnnotationsLogic,(function(e,t){return JSON.stringify(e.prototype)+t}));this.functionsUtils=new FunctionsUtils;this.annotationFactoryMap={}}getClassAnnotation(e,t){const n=this.getClassAnnotations(e);const i=t.annotationName;if(n&&i in n){return n[i]}else{return null}}getMethodAnnotation(e,t,n){const i=this.getMethodAnnotations(e,t);const o=n.annotationName;if(i&&o in i){return i[o]}else{return null}}hasClassAnnotation(e,t){const n=this.getClassAnnotations(e);return t.annotationName in n?true:false}hasMethodAnnotation(e,t,n){const i=this.getMethodAnnotations(e,t);return n.annotationName in i?true:false}setClassAnnotationFactory(e,t){this.annotationFactoryMap[e]=t;return t}getClassAnnotationFactory(e){const t=this;const classAnnotationFactory=function(...n){return function(i){const o=t.functionsUtils.extendsConstructor(i,(function(...o){const s=t.annotationFactoryMap[e];if(s){const e=s(n)(this,i,o);if(e){return e}else{return null}}else{throw new Error(`annotation '${e}' is used on '${i.name}' but its ClassAnnotationFactory may not have been added to the dependency injection`)}}));_.merge(o,i);o.__annotations__=i.__annotations__;o.__parameters__=i.__parameters__;o.__prop__metadata__=i.__prop__metadata__;Reflect.getMetadataKeys(i).forEach((e=>{Reflect.defineMetadata(e,Reflect.getMetadata(e,i),o)}));const s=t.getOriginalConstructor(i);Reflect.defineMetadata(t.ORIGINAL_CONSTRUCTOR_KEY,s,o);Reflect.defineMetadata(`${A.ClassAnnotation}:${e}`,n,s);return o}};classAnnotationFactory.annotationName=e;return classAnnotationFactory}setMethodAnnotationFactory(e,t){this.annotationFactoryMap[e]=t;return t}getMethodAnnotationFactory(e){const t=this;const methodAnnotationFactory=function(...n){return(i,o,s)=>{const r=s.value;s.value=function(...i){const s=t.annotationFactoryMap[e];if(s){return r?s(n)(this,o,r.bind(this),i):undefined}else{throw new Error(`annotation '${e}' is used but its MethodAnnotationFactory may not have been added to the dependency injection`)}};Reflect.defineMetadata(`${A.MethodAnnotation}:${e}`,n,i,o)}};methodAnnotationFactory.annotationName=e;return methodAnnotationFactory}getOriginalConstructor(e){return Reflect.getMetadata(this.ORIGINAL_CONSTRUCTOR_KEY,e)||e}getClassAnnotationsLogic(e){const t=this.getOriginalConstructor(e);const n={};Reflect.getMetadataKeys(t).filter((e=>e.toString().startsWith(A.ClassAnnotation))).forEach((e=>{n[e.split(":")[1]]=Reflect.getMetadata(e,t)}));return n}getMethodAnnotationsLogic(e,t){const n={};Reflect.getMetadataKeys(e.prototype,t).filter((e=>e.toString().startsWith(A.MethodAnnotation))).forEach((i=>{n[i.split(":")[1]]=Reflect.getMetadata(i,e.prototype,t)}));return n}}const R=new AnnotationService;const D="CacheConfig";const M=R.getClassAnnotationFactory(D);function CacheConfigAnnotationFactory(e){"ngInject";return R.setClassAnnotationFactory(D,(t=>function(n,i,o){n=new(i.bind(n))(...o);n.cacheConfig=t[0];e.debug(`adding cache config ${JSON.stringify(n.cacheConfig)} to class ${f.getInstanceConstructorName(n)}`,n);return n}))}const N="Cached";const x=R.getMethodAnnotationFactory(N);function CachedAnnotationFactory(e){"ngInject";const t=R.setMethodAnnotationFactory(N,(t=>function(n,i,o,s){let r=[];let a=[];if(t[0]){r=t[0].actions;a=t[0].tags}if(n.cacheConfig){if(n.cacheConfig.actions){r=_.uniq(r.concat(n.cacheConfig.actions))}if(n.cacheConfig.tags){a=_.uniq(a.concat(n.cacheConfig.tags))}}if(!r.length){const e=f.getInstanceConstructorName(n);throw new Error(`method ${i} of ${e} is @Cached annotated but no CacheAction is specified either through @Cached or through class level @CacheConfig annotation`)}return e.handle(n,i,o,Array.prototype.slice.apply(s),r,a)}));return t}const F="InvalidateCache";const InvalidateCache=function(e){return R.getMethodAnnotationFactory(F)(e)};function InvalidateCacheAnnotationFactory(e){"ngInject";return R.setMethodAnnotationFactory(F,(t=>function(n,i,o,s){let r=[];const a=t[0];if(!a){if(n.cacheConfig&&n.cacheConfig.tags){r=n.cacheConfig.tags}}else{r=[a]}if(!r.length){throw new Error(`method ${i} of ${n.constructor.name} is @InvalidateCache annotated but no EvictionTag is specified either through @InvalidateCache or through class level @CacheConfig annotation`)}const l=o.apply(undefined,Array.prototype.slice.call(s));if(l&&l.then){return l.then((t=>{e.evict(...r);return t}))}else{e.evict(...r);return l}}))}class CacheAction{constructor(e){this.name=e}}const L="@smart/utils";const U=`${L}_WHO_AM_I_RESOURCE_URI`;const k=`${L}_I18N_RESOURCE_URI`;const V=`${L}_EVENTSERVICE`;const j="REAUTH_STARTED";const z="/authorizationserver/oauth/token";const B="/smarteditwebservices/v1/i18n";const H="smartedit";const G={["^(?!"+B+"/.*$).*$"]:z};const W={[z]:{client_id:H}};const $="/";const K="SWITCH_LANGUAGE_EVENT";const q="SELECTED_LANGUAGE";const Y={TOKEN_STORED:"TOKEN_STORED",AUTHORIZATION_SUCCESS:"AUTHORIZATION_SUCCESS",USER_HAS_CHANGED:"USER_HAS_CHANGED",LOGOUT:"SE_LOGOUT_EVENT",CLEAR_PERSPECTIVE_FEATURES:"CLEAR_PERSPECTIVE_FEATURES",EXPERIENCE_UPDATE:"experienceUpdate",PERMISSION_CACHE_CLEANED:"PERMISSION_CACHE_CLEANED",PAGE_CHANGE:"PAGE_CHANGE",PAGE_CREATED:"PAGE_CREATED_EVENT",PAGE_UPDATED:"PAGE_UPDATED_EVENT",PAGE_DELETED:"PAGE_DELETED_EVENT",PAGE_SELECTED:"PAGE_SELECTED_EVENT",PAGE_RESTORED:"PAGE_RESTORED_EVENT",REAUTH_STARTED:"REAUTH_STARTED"};const Q="en";const Z=new r.InjectionToken("LANGUAGE_SERVICE_CONSTANTS");const X=new r.InjectionToken("LANGUAGE_SERVICE");const J="yjQuery";var ee;t.CacheEngine=ee=class CacheEngine{constructor(e,t,n){this.windowUtils=e;this.promiseUtils=t;this.logService=n;this.cachedItemsRegistry=[];this.startBackgroundMonitoringJob()}addItem(e,t,n){if(this.getItemIndex(e)===-1){this.cachedItemsRegistry.push({item:e,cacheTiming:t,refresh:n,completed:false,processing:false,defer:this.promiseUtils.defer()})}else{this.logService.warn(`CacheEngine - item already exist for id: ${e.id}`)}}getItemById(e){const t=this.cachedItemsRegistry.find((t=>t.item.id===e));return t?t.item:null}handle(e){const t=this.cachedItemsRegistry[this.getItemIndex(e)];if(t.completed&&!this.hasExpired(e)){t.defer.resolve(e.cache)}else if(!t.processing){t.processing=true;this.refreshCache(t)}return t.defer.promise}evict(...e){e.forEach((e=>{this.cachedItemsRegistry.filter((t=>t.item.evictionTags.indexOf(e)>-1)).forEach((e=>this.cachedItemsRegistry.splice(this.getItemIndex(e.item),1)))}))}startBackgroundMonitoringJob(){this.windowUtils.runIntervalOutsideAngular((()=>Promise.all(this.cachedItemsRegistry.filter((e=>this.needRefresh(e.item))).map((e=>this.refreshCache(e))))),ee.BACKGROUND_REFRESH_INTERVAL)}refreshCache(e){return e.refresh().then((t=>{e.cacheTiming.setAge(e.item);e.item.cache=t;e.item.timestamp=(new Date).getTime();e.completed=true;e.processing=false;e.defer.resolve(t)}),(t=>{this.logService.debug(`CacheEngine - unable to refresh cache for id: ${e.item.id}`,t);delete e.item.cache;e.defer.reject(t)}))}hasExpired(e){return e.timestamp+e.expirationAge<=(new Date).getTime()}needRefresh(e){return e.timestamp+e.refreshAge<=(new Date).getTime()}getItemIndex(e){return this.cachedItemsRegistry.findIndex((t=>t.item.id===e.id))}};t.CacheEngine.BACKGROUND_REFRESH_INTERVAL=1e4;t.CacheEngine=ee=__decorate([r.Injectable(),__metadata("design:paramtypes",[WindowUtils,t.PromiseUtils,LogService])],t.CacheEngine);class DefaultCacheTiming{constructor(e,t){this.expirationAge=e;this.refreshAge=t}setAge(e){const t=Object.assign(Object.assign({},e),{expirationAge:this.expirationAge,refreshAge:this.refreshAge});return t}}t.CacheService=class CacheService{constructor(e,t,n,i,o){this.logService=e;this.stringUtils=t;this.functionsUtils=n;this.eventService=i;this.cacheEngine=o;this.predicatesRegistry=[];this.eventListeners=[];this.defaultCacheTiming=new DefaultCacheTiming(24*60*60*1e3,12*60*60*1e3)}register(e,t){this.predicatesRegistry.unshift({test:e,cacheTiming:t});return this}handle(e,t,n,i,o,s){const r=this.functionsUtils.getInstanceConstructorName(e);const a=window.btoa(r+t)+this.stringUtils.encode(i);const l=this.cacheEngine.getItemById(a);let c;if(!l){const e=l||{id:a,timestamp:(new Date).getTime(),evictionTags:this.collectEventNamesFromTags(s),cache:null};const t=this.findCacheTimingByCacheActions(o);if(!t){throw new Error("CacheService::handle - No predicate match.")}c=t.setAge(e);this.cacheEngine.addItem(c,t,n.bind(undefined,...Array.prototype.slice.call(i)));this.listenForEvictionByTags(s)}else{c=l}return this.cacheEngine.handle(c)}evict(...e){const t=this.collectEventNamesFromTags(e);this.cacheEngine.evict(...t);t.forEach((e=>this.eventService.publish(e)))}listenForEvictionByTags(e){this.collectEventNamesFromTags(e).filter((e=>this.eventListeners.indexOf(e)===-1)).forEach((e=>{this.logService.debug(`registering event listener ${e}`);this.eventListeners.push(e);this.eventService.subscribe(e,((t,n)=>{this.logService.debug(`cleaning cache on event ${e}`);this.cacheEngine.evict(e);return Promise.resolve({})}))}))}collectEventNamesFromTags(e){if(e&&e.length){return _.union(...e.map((e=>this.collectEventNamesFromTag(e))))}else{return[]}}collectEventNamesFromTag(e){return _.union([e.event],...e.relatedTags?e.relatedTags.map((e=>this.collectEventNamesFromTag(e))):[])}findCacheTimingByCacheActions(e){const t=this.predicatesRegistry.find((t=>t.test(e)));return t?t.cacheTiming:this.defaultCacheTiming}};t.CacheService=__decorate([r.Injectable(),__param(3,r.Inject(V)),__metadata("design:paramtypes",[LogService,StringUtils,FunctionsUtils,Object,t.CacheEngine])],t.CacheService);class EvictionTag{constructor(e){this.event=e.event;this.relatedTags=e.relatedTags}}const te="RarelyChangingContent";const ne=new CacheAction(te);class BackendEntry{constructor(e,t){this.pattern=e;this.matchingPayload=t}respond(e){this.mock=e;return this}passThrough(){}}t.HttpBackendService=class HttpBackendService{constructor(){this.matchLatestDefinition=false;this.backends={GET:[],POST:[],PUT:[],PATCH:[],DELETE:[]}}whenGET(e){return this._whenMethod("GET",e)}whenPOST(e,t){return this._whenMethod("POST",e,t)}whenPUT(e,t){return this._whenMethod("PUT",e,t)}whenPATCH(e,t){return this._whenMethod("PATCH",e,t)}whenDELETE(e){return this._whenMethod("DELETE",e)}when(e,t,n){return this._whenMethod(e,t,n)}whenAsync(e,t,n){return this._whenMethod(e,t,n)}matchLatestDefinitionEnabled(e){this.matchLatestDefinition=e}findMatchingMock(e){const t=(this.matchLatestDefinition?this.backends[e.method].slice().reverse():this.backends[e.method]).find((t=>{if(typeof t.pattern==="string"){return e.urlWithParams.endsWith(t.pattern)&&this.matchingPayloadRestriction(t,e)}else{const n=t.pattern.test(e.urlWithParams)&&this.matchingPayloadRestriction(t,e);t.pattern.lastIndex=0;return n}}));return t?t.mock:undefined}_whenMethod(e,t,n){const i=new BackendEntry(t,n);this.backends[e].push(i);return i}matchingPayloadRestriction(e,t){return e.matchingPayload?_.isEqual(e.matchingPayload,t.body):true}};t.HttpBackendService=__decorate([r.Injectable()],t.HttpBackendService);t.BackendInterceptor=class BackendInterceptor{constructor(e,t,n,i){this.httpBackendService=e;this.httpUtils=t;this.urlUtils=n;this.logService=i}intercept(e,t){const n=this.httpBackendService.findMatchingMock(e);if(!n){return t.handle(e)}let i;if(typeof n==="object"){i=[200,_.cloneDeep(n)]}else{let t=null;if(e.method==="GET"){t=decodeURIComponent(this.urlUtils.getQueryString(this.httpUtils.copyHttpParamsOrHeaders(e.params)))}else if(e.headers.get("Content-Type")==="application/x-www-form-urlencoded"){t=e.body}else if(e.method==="POST"||e.method==="PUT"){t=JSON.stringify(e.body)}const o=this.httpUtils.copyHttpParamsOrHeaders(e.headers);i=n(e.method,decodeURIComponent(e.urlWithParams),t,o)}this.logService.debug(`backend ${status} response for ${e.url}: `);return this.httpUtils.buildHttpResponse(e,i).pipe(c.take(1))}};t.BackendInterceptor=__decorate([r.Injectable(),__metadata("design:paramtypes",[t.HttpBackendService,HttpUtils,UrlUtils,LogService])],t.BackendInterceptor);var ie;let oe=ie=class FlawInjectionInterceptor{constructor(e,t){this.httpUtils=e;this.logService=t;this.flawWindow=window;this.flawWindow.allRequests=0;this.flawWindow.flawedRequests=0;this.flawWindow.allResponses=0;this.flawWindow.flawedResponses=0}static registerRequestFlaw(e){this.requestMutations.push(e)}static registerResponseFlaw(e){this.responseMutations.push(e)}intercept(e,t){if(ie.PROBABILITY!==0&&this.httpUtils.isCRUDRequest(e)&&!this._isGET(e)){return this._handleFlawWindow(e,t)}return t.handle(e)}_isGET(e){return e.method==="GET"}_activateWithProbability(e){return Math.random()>=1-e}_generateResultResponse(e,t){return t.pipe(c.map((t=>{if(t instanceof a.HttpResponse&&this._activateWithProbability(ie.PROBABILITY)){this.flawWindow.flawedResponses++;const n=ie.responseMutations.find((t=>t.test(e)));if(n&&t instanceof a.HttpResponse){this.logService.error(`FLAWED RESPONSE-"${e.url}`);return n.mutate(t)}}return t})))}_handleFlawWindow(e,t){let n;this.flawWindow.allRequests++;if(this._activateWithProbability(ie.PROBABILITY)){this.flawWindow.flawedRequests++;const i=ie.requestMutations.find((t=>t.test(e)));if(i){this.logService.error(`FLAWED REQUEST-"${e.url}`);n=t.handle(i.mutate(e))}}n=t.handle(e);return this._generateResultResponse(e,n)}};oe.requestMutations=[];oe.responseMutations=[];oe.PROBABILITY=0;oe=ie=__decorate([r.Injectable(),__metadata("design:paramtypes",[HttpUtils,LogService])],oe);t.FlawInjectionInterceptorModule=class FlawInjectionInterceptorModule{};t.FlawInjectionInterceptorModule=__decorate([r.NgModule({imports:[],providers:[{provide:a.HTTP_INTERCEPTORS,useClass:oe,multi:true},{provide:r.APP_INITIALIZER,useFactory(){oe.registerRequestFlaw({test:e=>/sites\/[\w-]+\//.test(e.url),mutate:e=>e.clone({url:e.url.replace(/sites\/([\w-]+)\//,"sites/"+Math.random()+"/")})});return e=>{}},multi:true}]})],t.FlawInjectionInterceptorModule);t.IAlertServiceType=void 0;(function(e){e["INFO"]="information";e["SUCCESS"]="success";e["WARNING"]="warning";e["DANGER"]="error"})(t.IAlertServiceType||(t.IAlertServiceType={}));class IAlertService{showAlert(e){"proxyFunction";return}showInfo(e){"proxyFunction";return}showDanger(e){"proxyFunction";return}showWarning(e){"proxyFunction";return}showSuccess(e){"proxyFunction";return}}class IAuthenticationService{constructor(){this.reauthInProgress={};this.initialized=false}authenticate(e){"proxyFunction";return Promise.resolve()}logout(){"proxyFunction";return Promise.resolve()}isReAuthInProgress(e){"proxyFunction";return Promise.resolve(false)}setReAuthInProgress(e){"proxyFunction";return Promise.resolve()}filterEntryPoints(e){"proxyFunction";return Promise.resolve([])}isAuthEntryPoint(e){"proxyFunction";return Promise.resolve(false)}isAuthenticated(e){"proxyFunction";return Promise.resolve(false)}}class IStorageService{isInitialized(){"proxyFunction";return Promise.resolve(false)}storeAuthToken(e,t){"proxyFunction";return Promise.resolve()}getAuthToken(e){"proxyFunction";return Promise.resolve(undefined)}removeAuthToken(e){"proxyFunction";return Promise.resolve()}removeAllAuthTokens(){"proxyFunction";return Promise.resolve()}getValueFromLocalStorage(e,t){"proxyFunction";return Promise.resolve()}setValueInLocalStorage(e,t,n){"proxyFunction";return Promise.resolve()}setItem(e,t){"proxyFunction";return Promise.resolve()}getItem(e){"proxyFunction";return Promise.resolve()}}t.ModalButtonStyle=void 0;(function(e){e["Default"]="transparent";e["Primary"]="emphasized"})(t.ModalButtonStyle||(t.ModalButtonStyle={}));t.ModalButtonAction=void 0;(function(e){e["Close"]="close";e["Dismiss"]="dismiss";e["None"]="none"})(t.ModalButtonAction||(t.ModalButtonAction={}));class ISharedDataService{get(e){"proxyFunction";return Promise.resolve({})}set(e,t){"proxyFunction";return Promise.resolve()}update(e,t){"proxyFunction";return Promise.resolve()}remove(e){"proxyFunction";return Promise.resolve({})}containsKey(e){"proxyFunction";return Promise.resolve(true)}}class ISettingsService{load(){"proxyFunction";return Promise.resolve({key:""})}get(e){"proxyFunction";return Promise.resolve("")}getBoolean(e){"proxyFunction";return Promise.resolve(true)}getStringList(e){"proxyFunction";return Promise.resolve([])}}class IModalService{dismissAll(){"proxyFunction"}open(e){"proxyFunction";return{}}hasOpenModals(){"proxyFunction";return null}}class ISessionService{getCurrentUsername(){"proxyFunction";return Promise.resolve("")}getCurrentUserDisplayName(){"proxyFunction";return Promise.resolve("")}getCurrentUser(){"proxyFunction";return Promise.resolve({})}hasUserChanged(){"proxyFunction";return Promise.resolve(true)}resetCurrentUserData(){"proxyFunction";return Promise.resolve()}setCurrentUsername(){"proxyFunction";return Promise.resolve()}}class IAuthenticationManagerService{}const se=[500,502,503,504];const re=[429];const ae=[408];function serverErrorPredicate(e,t){return t&&_.includes(se,t.status)}function clientErrorPredicate(e,t){return t&&_.includes(re,t.status)}function timeoutErrorPredicate(e,t){return t&&_.includes(ae,t.status)}function retriableErrorPredicate(e,t){return t&&P.isAnyTruthy(serverErrorPredicate,clientErrorPredicate,timeoutErrorPredicate)(e,t)}function noInternetConnectionErrorPredicate(e,t){return t&&t.status===0}const le=["PUT","POST","DELETE","PATCH"];const ce=["GET","OPTIONS","HEAD"];function updatePredicate(e,t){return _.includes(le,e.method)}function readPredicate(e,t){return _.includes(ce,e.method)}const de={MAX_BACKOFF:64e3,MAX_ATTEMPT:5,MIN_BACKOFF:0};class ExponentialRetry{calculateNextDelay(e,t,n){t=t||de.MAX_BACKOFF;n=n||de.MIN_BACKOFF;const i=n+Math.random();return Math.min(Math.pow(2,e)*1e3+i,t)}canRetry(e,t){t=t||de.MAX_ATTEMPT;return e<=t}}const pe={MAX_ATTEMPT:5,MAX_BACKOFF:32e3,MIN_BACKOFF:0,RETRY_INTERVAL:500};class LinearRetry{calculateNextDelay(e,t,n,i){n=n||pe.MAX_BACKOFF;i=i||pe.MIN_BACKOFF;t=t||pe.RETRY_INTERVAL;const o=i+Math.random();return Math.min(e*t+o,n)}canRetry(e,t){t=t||pe.MAX_ATTEMPT;return e<=t}}const ue={MAX_ATTEMPT:5,MIN_BACKOFF:0,RETRY_INTERVAL:500};class SimpleRetry{calculateNextDelay(e,t){t=t||ue.MIN_BACKOFF;e=e||ue.RETRY_INTERVAL;const n=t+Math.random();return e+n}canRetry(e,t){const n=t||ue.MAX_ATTEMPT;return e<=n}}const me=new r.InjectionToken("DefaultRetryStrategy");function defaultRetryStrategyFactory(e){return class{constructor(){this.firstFastRetry=true;this.attemptCount=0}canRetry(){return e.canRetry(this.attemptCount)}calculateNextDelay(){return e.calculateNextDelay()}}}const he=new r.InjectionToken("ExponentialRetryStrategy");function exponentialRetryStrategyFactory(e){return class{constructor(){this.firstFastRetry=true;this.attemptCount=0}canRetry(){return e.canRetry(this.attemptCount)}calculateNextDelay(){return e.calculateNextDelay(this.attemptCount)}}}const ge=new r.InjectionToken("LinearRetryStrategy");function linearRetryStrategyFactory(e){return class{constructor(){this.firstFastRetry=true;this.attemptCount=0}canRetry(){return e.canRetry(this.attemptCount)}calculateNextDelay(){return e.calculateNextDelay(this.attemptCount)}}}t.OperationContextService=class OperationContextService{constructor(){this.store=[]}register(e,t){if(typeof e!=="string"||_.isEmpty(e)){throw new Error("operationContextService.register error: url is invalid")}if(typeof t!=="string"||_.isEmpty(t)){throw new Error("operationContextService.register error: operationContext is invalid")}const n=this.store.findIndex((n=>n.urlRegex.test(e)===true&&n.operationContext===t));if(n!==-1){return this}const i=new RegExp(e.replace(/\/:[^\/]*/g,"/.*"));this.store.push({urlRegex:i,operationContext:t});return this}findOperationContext(e){const t=this.store.findIndex((t=>t.urlRegex.test(e)===true));return~t?this.store[t].operationContext:null}};t.OperationContextService=__decorate([r.Injectable(),__metadata("design:paramtypes",[])],t.OperationContextService);const _e="OperationContextRegistered";const ve=R.getClassAnnotationFactory(_e);function OperationContextAnnotationFactory(e,t,n){"ngInject";return R.setClassAnnotationFactory(_e,(function(i){return function(o,s,r){o=new(s.bind(o))(...r);const a=e.get(i[0],i[0]);if(typeof i[1]==="string"){const e=n[i[1]];t.register(a,e)}else if(Array.isArray(i[1])&&i[1].length>0){i[1].forEach((e=>{t.register(a,n[e])}))}return o}}))}const Se=`${L}_OPERATION_CONTEXT`;t.RetryInterceptor=class RetryInterceptor{constructor(e,t,n,i,o,s,r,a,l){this.httpClient=e;this.translate=t;this.operationContextService=n;this.alertService=i;this.OPERATION_CONTEXT=l;this.TRANSLATE_NAMESPACE="se.gracefuldegradation.";this.predicatesRegistry=[];this.requestToRetryTegistry={};this.register(noInternetConnectionErrorPredicate,r).register(o.isAnyTruthy(clientErrorPredicate,timeoutErrorPredicate),s).register(o.areAllTruthy(readPredicate,retriableErrorPredicate),s).register(serverErrorPredicate,r)}predicate(e,t){return this.findMatchingStrategy(e,t)!==null}responseError(e,t){let n=this.retrieveRetryStrategy(e);if(!n){const i=this.findMatchingStrategy(e,t);if(i){this.alertService.showWarning({message:this.translate.instant(this.TRANSLATE_NAMESPACE+"stillworking"),minWidth:"",mousePersist:true,duration:1e3,dismissible:true,width:"300px"});n=new i;n.attemptCount=0;this.storeRetryStrategy(e,n)}else{return Promise.reject(t)}}return this.handleRetry(n,e,t)}register(e,t){if(typeof e!=="function"){throw new Error("retryInterceptor.register error: predicate must be a function")}if(typeof t!=="function"){throw new Error("retryInterceptor.register error: retryStrategy must be a function")}this.predicatesRegistry.unshift({predicate:e,retryStrategy:t});return this}findMatchingStrategy(e,t){const n=this.operationContextService.findOperationContext(e.url)||this.OPERATION_CONTEXT.INTERACTIVE;const i=this.predicatesRegistry.find((i=>i.predicate(e,t,n)));return i?i.retryStrategy:null}handleRetry(e,t,n){e.attemptCount++;if(e.canRetry()){const n=e.firstFastRetry?0:e.calculateNextDelay();e.firstFastRetry=false;return new Promise(((e,i)=>{setTimeout((()=>{this.httpClient.request(t).toPromise().then((n=>{this.removeRetryStrategy(t);return e(n)}),(e=>i(e)))}),n)}))}else{this.alertService.showDanger({message:this.translate.instant(this.TRANSLATE_NAMESPACE+"somethingwrong"),minWidth:"",mousePersist:true,duration:1e3,dismissible:true,width:"300px"});return Promise.reject(n)}}storeRetryStrategy(e,t){this.requestToRetryTegistry[this.getRequestUUID(e)]=t}removeRetryStrategy(e){delete this.requestToRetryTegistry[this.getRequestUUID(e)]}retrieveRetryStrategy(e){return this.requestToRetryTegistry[this.getRequestUUID(e)]}getRequestUUID(e){return e.clone().toString()}};t.RetryInterceptor=__decorate([r.Injectable(),__param(5,r.Inject(me)),__param(6,r.Inject(he)),__param(7,r.Inject(ge)),__param(8,r.Inject(Se)),__metadata("design:paramtypes",[a.HttpClient,d.TranslateService,t.OperationContextService,IAlertService,BooleanUtils,Object,Object,Object,Object])],t.RetryInterceptor);t.PermissionErrorInterceptor=class PermissionErrorInterceptor{constructor(e){this.alertService=e}predicate(e,t){return t.status===403}responseError(e,t){if(t.error&&t.error.errors){t.error.errors.filter((e=>e.type==="TypePermissionError")).forEach((e=>{this.alertService.showDanger({message:e.message,duration:1e4,minWidth:"",mousePersist:true,dismissible:true,width:"300px"})}))}return Promise.reject(t)}};t.PermissionErrorInterceptor=__decorate([r.Injectable(),__metadata("design:paramtypes",[IAlertService])],t.PermissionErrorInterceptor);const ye={};t.UnauthorizedErrorInterceptor=class UnauthorizedErrorInterceptor{constructor(e,t,n,i,o,s,r){this.httpClient=e;this.authenticationService=t;this.promiseUtils=n;this.httpUtils=i;this.eventService=s;this.logService=r;this.promisesToResolve={};this.rejectedUrls=[/authenticate/];this.rejectedUrls.push(o)}predicate(e,t){return t.status===401&&(e.url?this.httpUtils.isCRUDRequest(e,t)&&this.isUrlNotRejected(e.url):true)}responseError(e,t){const n=this.promiseUtils.defer();const i=n.promise.then((()=>this.httpClient.request(e).toPromise()));this.authenticationService.isAuthEntryPoint(e.url).then((o=>{if(!o){this.authenticationService.filterEntryPoints(e.url).then((t=>{const o=t[0];this.promisesToResolve[o]=this.promisesToResolve[o]||[];this.promisesToResolve[o].push({requestIdentifier:e.url,deferred:n});if(this.httpUtils.isGET(e)){ye[e.url]=i}this.authenticationService.isReAuthInProgress(o).then((t=>{if(!t){this.authenticationService.setReAuthInProgress(o).then((()=>{const t=this.promisesToResolve;this.eventService.publish(j).catch((e=>{this.logService.debug(`UnauthorizedErrorInterceptor - responseError: ${e}`)}));this.authenticationService.authenticate(e.url).then(function(){t[this].forEach((e=>{delete ye[e.requestIdentifier];e.deferred.resolve()}));t[this]=[]}.bind(o),function(){t[this].forEach((e=>{delete ye[e.requestIdentifier];e.deferred.reject()}));t[this]=[]}.bind(o))}))}}))}))}else{n.reject(t)}}));return i}isUrlNotRejected(e){return!this.rejectedUrls.some((t=>typeof t==="string"?e.indexOf(t)===0:t.test(e)))}};t.UnauthorizedErrorInterceptor=__decorate([r.Injectable(),__param(4,r.Inject(U)),__param(5,r.Inject(V)),__metadata("design:paramtypes",[a.HttpClient,IAuthenticationService,t.PromiseUtils,HttpUtils,String,Object,LogService])],t.UnauthorizedErrorInterceptor);let Ce=class HttpAuthInterceptor{constructor(e,t,n,i){this.authenticationService=e;this.injector=t;this.httpUtils=n;this.I18N_RESOURCE_URI=i}intercept(e,t){if(!this._isCRUDRequest(e)){return t.handle(e)}if(this._isGetRequest(e)){return this._handleGetRequest(e)}return this._handleCUDRequest(e,t)}_isCRUDRequest(e){return!e.url.includes(this.I18N_RESOURCE_URI)&&this.httpUtils.isCRUDRequest(e)}_isGetRequest(e){return this.httpUtils.isGET(e)&&!!ye[e.url]}_handleGetRequest(e){return new l.Observable((t=>{ye[e.url].then((e=>{t.next(new a.HttpResponse({status:200,body:e}))}))}))}_addAuthToResponse(e,t,n){return l.from(this.injector.get(IStorageService).getAuthToken(n[0])).pipe(c.switchMap((n=>{if(!n){return t.handle(e)}const i=e.clone({headers:e.headers.set("Authorization",n.token_type+" "+n.access_token)});return t.handle(i)})))}_handleCUDRequest(e,t){return l.from(this.authenticationService.filterEntryPoints(e.url)).pipe(c.switchMap((n=>{if(!(n&&n.length)){return t.handle(e)}return this._addAuthToResponse(e,t,n)})))}};Ce=__decorate([r.Injectable(),__param(3,r.Inject(k)),__metadata("design:paramtypes",[IAuthenticationService,r.Injector,HttpUtils,String])],Ce);t.HttpErrorInterceptorService=class HttpErrorInterceptorService{constructor(e,t){this.injector=e;this.promiseUtils=t;this._errorInterceptors=[]}addInterceptors(e){e.forEach((e=>{this.addInterceptor(e)}))}addInterceptor(e){let t;if(e.predicate||e.responseError){t=e}else{t=this.injector.get(e)}this._validateInterceptor(t);this._errorInterceptors.unshift(t);return()=>{this._errorInterceptors.splice(this._errorInterceptors.indexOf(t),1)}}responseError(e,t){const n=this._errorInterceptors.filter((n=>n.predicate(e,t)===true));const i=this.promiseUtils.defer();if(n.length){this._iterateErrorInterceptors(e.clone(),_.cloneDeep(t),n,i)}else{i.reject(t)}return l.from(i.promise)}_iterateErrorInterceptors(e,t,n,i,o=0){if(o===n.length){i.reject(t)}else{const s=this._iterateErrorInterceptors.bind(this);Promise.resolve(n[o].responseError(e,t)).then((e=>{i.resolve(e)}),(t=>{s(e,t,n,i,++o)}))}}_validateInterceptor(e){if(!e.predicate||typeof e.predicate!=="function"){throw new Error("httpErrorInterceptorService.addInterceptor.error.interceptor.has.no.predicate")}if(!e.responseError||typeof e.responseError!=="function"){throw new Error("httpErrorInterceptorService.addInterceptor.error.interceptor.has.no.responseError")}}};t.HttpErrorInterceptorService=__decorate([r.Injectable(),__metadata("design:paramtypes",[r.Injector,t.PromiseUtils])],t.HttpErrorInterceptorService);let fe=class HttpErrorInterceptor{constructor(e,t){this.httpErrorInterceptorService=e;this.httpUtils=t}intercept(e,t){return t.handle(e).pipe(c.catchError(((t,n)=>{if(!this.httpUtils.isHTMLRequest(e,t)){return this.httpErrorInterceptorService.responseError(e,t)}else{return l.throwError(t)}})))}};fe=__decorate([r.Injectable(),__metadata("design:paramtypes",[t.HttpErrorInterceptorService,HttpUtils])],fe);var Ee;t.HttpInterceptorModule=Ee=class HttpInterceptorModule{static forRoot(...e){return{ngModule:Ee,providers:[...e,{provide:a.HTTP_INTERCEPTORS,useClass:Ce,multi:true},{provide:a.HTTP_INTERCEPTORS,useClass:fe,multi:true},{provide:a.HTTP_INTERCEPTORS,useClass:t.BackendInterceptor,multi:true},{provide:r.APP_BOOTSTRAP_LISTENER,useFactory(t){t.addInterceptors(e);return e=>{}},deps:[t.HttpErrorInterceptorService],multi:true}]}}};t.HttpInterceptorModule=Ee=__decorate([r.NgModule({imports:[t.FlawInjectionInterceptorModule],providers:[SimpleRetry,LinearRetry,ExponentialRetry,{provide:me,useFactory:defaultRetryStrategyFactory,deps:[SimpleRetry]},{provide:he,useFactory:exponentialRetryStrategyFactory,deps:[ExponentialRetry]},{provide:ge,useFactory:linearRetryStrategyFactory,deps:[SimpleRetry]},t.HttpErrorInterceptorService,t.HttpBackendService]})],t.HttpInterceptorModule);t.StatusText=void 0;(function(e){e["UNKNOW_ERROR"]="Unknown Error"})(t.StatusText||(t.StatusText={}));class HttpPaginationResponseAdapter{static transform(e){const t=e;const n=t&&t.body&&t.body.pagination;if(!n){return t}const i=Object.keys(t.body).find((e=>e!=="pagination"&&Array.isArray(t.body[e])));return i?t.clone({body:Object.assign(Object.assign({},t.body),{results:t.body[i]})}):t}}t.ResponseAdapterInterceptor=class ResponseAdapterInterceptor{intercept(e,t){return t.handle(e).pipe(c.map(HttpPaginationResponseAdapter.transform))}};t.ResponseAdapterInterceptor=__decorate([r.Injectable()],t.ResponseAdapterInterceptor);class RestClient{constructor(e,t,n){this.httpClient=e;this.url=t;this.identifierName=n;this.DEFAULT_HEADERS={"x-requested-with":"Angular"};this.DEFAULT_OPTIONS={headers:{}};this.metadataActivated=false;this.getMethodForSingleInstance=e=>{switch(e){case"getById":return(e,t=this.DEFAULT_OPTIONS)=>this.getById(e,t);case"get":return(e,t=this.DEFAULT_OPTIONS)=>this.get(e,t);case"update":return(e,t=this.DEFAULT_OPTIONS)=>this.update(e,t);case"save":return(e,t=this.DEFAULT_OPTIONS)=>this.save(e,t);case"patch":return(e,t=this.DEFAULT_OPTIONS)=>this.patch(e,t);case"remove":return(e,t=this.DEFAULT_OPTIONS)=>this.remove(e,t);default:return()=>Promise.reject()}};this.getMethodForArray=e=>{switch(e){case"query":return(e,t=this.DEFAULT_OPTIONS)=>this.query(e,t);default:return()=>Promise.reject()}}}getById(e,t=this.DEFAULT_OPTIONS){return this.addHeadersToBody(this.httpClient.get(`${this.url}/${e}`,{headers:this.buildRequestHeaders(t.headers||{}),observe:"response"})).toPromise()}get(e,t=this.DEFAULT_OPTIONS){const n=this.convertToTypeMapOfString(e);return this.addHeadersToBody(this.httpClient.get(this.interpolateParamsInURL(this.url,n),{params:this.formatQueryString(this.determineTrueQueryStringParams(this.url,e)),headers:this.buildRequestHeaders(t.headers||{}),observe:"response"})).toPromise()}query(e,t=this.DEFAULT_OPTIONS){const n=e?this.convertToTypeMapOfString(e):e;return this.addHeadersToBody(this.httpClient.get(this.interpolateParamsInURL(this.url,n),{params:this.formatQueryString(this.determineTrueQueryStringParams(this.url,e)),headers:this.buildRequestHeaders(t.headers||{}),observe:"response"})).pipe(c.map((e=>e||[]))).toPromise()}page(e,t=this.DEFAULT_OPTIONS){return this.addHeadersToBody(this.httpClient.get(this.interpolateParamsInURL(this.url,e),{params:this.formatQueryString(this.determineTrueQueryStringParams(this.url,e)),headers:this.buildRequestHeaders(t.headers||{}),observe:"response"})).pipe(c.map((e=>e))).toPromise()}update(e,t=this.DEFAULT_OPTIONS){return this.performIdentifierCheck(e).then((()=>this.buildUrlWithIdentifier(e))).then((n=>this.httpClient.put(n,e,{headers:this.buildRequestHeaders(t.headers||{})}).toPromise()))}save(e,t=this.DEFAULT_OPTIONS){return this.httpClient.post(this.interpolateParamsInURL(this.url,e),e,{headers:this.buildRequestHeaders(t.headers||{})}).toPromise()}patch(e,t=this.DEFAULT_OPTIONS){return this.performIdentifierCheck(e).then((()=>this.buildUrlWithIdentifier(e))).then((n=>this.httpClient.patch(n,e,{headers:this.buildRequestHeaders(t.headers||{})}).toPromise()))}remove(e,t=this.DEFAULT_OPTIONS){return this.performIdentifierCheck(e).then((()=>this.buildUrlWithIdentifier(e))).then((e=>this.httpClient.delete(e,{headers:this.buildRequestHeaders(t.headers||{})}).toPromise()))}queryByPost(e,t,n=this.DEFAULT_OPTIONS){const i=this.convertToTypeMapOfString(t);return this.httpClient.post(this.interpolateParamsInURL(this.url,i),e,{params:this.formatQueryString(this.determineTrueQueryStringParams(this.url,t)),headers:this.buildRequestHeaders(n.headers||{})}).toPromise()}activateMetadata(){this.metadataActivated=true}convertToTypeMapOfString(e){return _.mapValues(e,(e=>String(e)))}formatQueryString(e){return this.sortByKeys(e)}addHeadersToBody(e){return e.pipe(c.map((e=>{const t=e.body;if(this.metadataActivated&&t){t.headers=e.headers}return t})))}interpolateParamsInURL(e,t){if(t&&typeof t!=="string"){return new URIBuilder(e).replaceParams(t).sanitize().build()}else{return e}}determineTrueQueryStringParams(e,t){return typeof t==="object"?Object.keys(t).reduce(((n,i)=>{if(!new RegExp(":"+i+"/").test(e)&&!new RegExp(":"+i+"$").test(e)&&!new RegExp(":"+i+"&").test(e)&&!_.isNil(t[i])){n[i]=t[i]}return n}),{}):{}}sortByKeys(e){const t=_.sortBy(_.keys(e),(e=>e));return _.zipObject(t,_.map(t,(t=>e[t])))}performIdentifierCheck(e){const t=typeof e==="string"?e:e[this.identifierName];if(!t){return Promise.reject("no data was found under the "+t+" field of object "+JSON.stringify(e)+", it is necessary for update and remove operations")}return Promise.resolve()}buildUrlWithIdentifier(e){const t=typeof e==="string"?e:e[this.identifierName];let n=this.interpolateParamsInURL(`${this.url}`,e);n=n.includes("?")||this.url.includes(":"+this.identifierName)?n:`${n}/${t}`;return Promise.resolve(n)}buildRequestHeaders(e){return new a.HttpHeaders(Object.assign(Object.assign({},this.DEFAULT_HEADERS),e))}}var Ie;t.RestServiceFactory=Ie=class RestServiceFactory{constructor(e){this.httpClient=e;this.map=new Map;this.basePath=null;this.DOMAIN=null;this.IDENTIFIER="identifier"}static setGlobalBasePath(e){if(!Ie.globalBasePath){Ie.globalBasePath=e}else{Ie.logService.warn("The value of a global base path was already set. "+"Update is not possible, the value remained unchanged!")}}static getGlobalBasePath(){return Ie.globalBasePath?Ie.globalBasePath:""}setDomain(e){this.DOMAIN=e}setBasePath(e){this.basePath=e}get(e,t=this.IDENTIFIER){if(this.map.has(e+t)){return this.map.get(e+t)}if(!/^https?\:\/\//.test(e)){const t=this.getNewBasePath();const n=_.isEmpty(t)?e:t+(/^\//.test(e)?e:`/${e}`);e=this.shouldAppendDomain(e)?`${this.DOMAIN}/${e}`:n}const n=new RestClient(this.httpClient,e,t);this.map.set(e+t,n);return n}shouldAppendDomain(e){return!!this.DOMAIN&&!/^\//.test(e)}getNewBasePath(){return this.basePath?this.basePath:Ie.globalBasePath}};t.RestServiceFactory.globalBasePath=null;t.RestServiceFactory.logService=new LogService;t.RestServiceFactory=Ie=__decorate([r.Injectable(),__metadata("design:paramtypes",[a.HttpClient])],t.RestServiceFactory);class AbstractCachedRestService{constructor(e,t,n){this.innerRestService=e.get(t,n);this.innerRestService.activateMetadata&&this.innerRestService.activateMetadata()}getById(e,t){return this.innerRestService.getById(e,t)}get(e,t){return this.innerRestService.get(e,t)}query(e,t){return this.innerRestService.query(e,t)}page(e,t){return this.innerRestService.page(e,t)}update(e,t){return this.innerRestService.update(e,t)}patch(e,t){return this.innerRestService.patch(e,t)}remove(e,t){return this.innerRestService.remove(e,t)}save(e,t){return this.innerRestService.save(e,t)}queryByPost(e,t,n){return this.innerRestService.queryByPost(e,t,n)}}__decorate([StripResponseHeaders,x(),__metadata("design:type",Function),__metadata("design:paramtypes",[String,Object]),__metadata("design:returntype",Promise)],AbstractCachedRestService.prototype,"getById",null);__decorate([StripResponseHeaders,x(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object]),__metadata("design:returntype",Promise)],AbstractCachedRestService.prototype,"get",null);__decorate([StripResponseHeaders,x(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object]),__metadata("design:returntype",Promise)],AbstractCachedRestService.prototype,"query",null);__decorate([StripResponseHeaders,x(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object]),__metadata("design:returntype",Promise)],AbstractCachedRestService.prototype,"page",null);__decorate([StripResponseHeaders,InvalidateCache(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object]),__metadata("design:returntype",Promise)],AbstractCachedRestService.prototype,"update",null);__decorate([StripResponseHeaders,InvalidateCache(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object]),__metadata("design:returntype",Promise)],AbstractCachedRestService.prototype,"patch",null);__decorate([InvalidateCache(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object]),__metadata("design:returntype",Promise)],AbstractCachedRestService.prototype,"remove",null);__decorate([StripResponseHeaders,__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object]),__metadata("design:returntype",Promise)],AbstractCachedRestService.prototype,"save",null);__decorate([StripResponseHeaders,x(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object,Object]),__metadata("design:returntype",Promise)],AbstractCachedRestService.prototype,"queryByPost",null);function StripResponseHeaders(e,t,n){const i=n.value;if(i){n.value=function(...e){return i.apply(this,e).then((e=>{delete e.headers;return e}))}}}var be;const Te="sso";var Oe;(function(e){e["SSO_CLIENT_ID"]="SSO_CLIENT_ID";e["SSO_AUTHENTICATION_ENTRY_POINT"]="SSO_AUTHENTICATION_ENTRY_POINT";e["SSO_LOGOUT_ENTRY_POINT"]="SSO_LOGOUT_ENTRY_POINT";e["SSO_OAUTH2_AUTHENTICATION_ENTRY_POINT"]="SSO_OAUTH2_AUTHENTICATION_ENTRY_POINT"})(Oe||(Oe={}));const Pe="ssoAuthenticate";const we="ssoAuthenticateError";const Ae="SSODIALOG_WINDOW";t.SSOAuthenticationHelper=be=class SSOAuthenticationHelper{constructor(e,t,n,i){this.windowUtils=e;this.promiseUtils=t;this.httpClient=n;this.injector=i;this.logoutIframeId="logoutIframe";this.deferred=null;this.listenForAuthTokenBeingSentBack()}launchSSODialog(){this.deferred=this.promiseUtils.defer();const e=this.injector.get(Oe.SSO_AUTHENTICATION_ENTRY_POINT)+this.getSSOContextPath();this.window.open(e,Ae,"toolbar=no,scrollbars=no,resizable=no,top=200,left=200,width=1000,height=800");return this.deferred.promise}completeDialog(){return new Promise(((e,t)=>{this.httpClient.post(this.injector.get(Oe.SSO_OAUTH2_AUTHENTICATION_ENTRY_POINT),{client_id:this.injector.get(Oe.SSO_CLIENT_ID)}).subscribe((t=>{this.window.opener.postMessage({eventId:Pe,authToken:t},this.document.location.origin);this.window.close();e()}),(e=>{const n={error:e.error,status:e.status};this.window.opener.postMessage({eventId:we,error:n},this.document.location.origin);this.window.close();t()}))}))}isSSODialog(){return this.window.name===Ae&&new RegExp(`[?&]${Te}`).test(location.search)}isAutoSSOMain(){return be.lastAuthenticatedWithSSO||this.window.name!==Ae&&new RegExp(`[?&]${Te}`).test(location.search)}logout(){let e=this.logoutIframe;if(!e){e=this.document.createElement("iframe");e.id=this.logoutIframeId;e.style.display="none";this.document.body.appendChild(e)}e.src=this.injector.get(Oe.SSO_LOGOUT_ENTRY_POINT);be.lastAuthenticatedWithSSO=false;this.document.location.href=this.document.location.href.replace(this.getSSOContextPath(),this.document.location.pathname)}getSSOContextPath(){return`${this.document.location.pathname}?${Te}`}listenForAuthTokenBeingSentBack(){this.window.addEventListener("message",(e=>{if(e.origin!==document.location.origin){return}this.logoutIframe&&this.logoutIframe.remove();if(e.data.eventId===Pe){be.lastAuthenticatedWithSSO=true;this.deferred&&this.deferred.resolve(e.data.authToken)}else if(e.data.eventId===we){this.deferred&&this.deferred.reject(e.data.error)}}),false)}get window(){return this.windowUtils.getWindow()}get document(){return this.window.document}get logoutIframe(){return this.document.querySelector(`iframe#${this.logoutIframeId}`)}};t.SSOAuthenticationHelper.lastAuthenticatedWithSSO=false;t.SSOAuthenticationHelper=be=__decorate([r.Injectable(),__metadata("design:paramtypes",[WindowUtils,t.PromiseUtils,a.HttpClient,r.Injector])],t.SSOAuthenticationHelper);const Re=new r.InjectionToken("LoginDialogResourceProvider");t.LoginDialogComponent=class LoginDialogComponent{constructor(e,t,n,i,o,s,r,l,c){this.modalRef=e;this.logService=t;this.httpClient=n;this.sessionService=i;this.storageService=o;this.urlUtils=s;this.ssoAuthenticationHelper=r;this.resource=l;this.eventService=c;this.hostClass=true;this.data=null;this.authURIKey="";this.authURI="";this.isFullScreen=false;this.ssoEnabled=false;this.form=new p.FormGroup({username:new p.FormControl("",p.Validators.required),password:new p.FormControl("",p.Validators.required)});this.signinWithSSO=()=>{this.form.setErrors(null);return this.ssoAuthenticationHelper.launchSSODialog().then((e=>this.storeAccessToken(e)),(e=>this.apiAuthenticationFailureReportFactory(e))).then((e=>this.acceptUser(e))).catch((e=>{this.logService.debug(`LoginDialogComponent - signinWithSSO: ${JSON.stringify(e)}`)}))};this.sendCredentials=e=>this.httpClient.request("POST",this.authURI,{headers:(new a.HttpHeaders).set("Content-Type","application/x-www-form-urlencoded"),body:this.urlUtils.getQueryString(e).replace("?",""),observe:"response"}).toPromise()}ngOnInit(){this.data=this.modalRef.data||{};this.authURI=this.data.authURI;this.isFullScreen=this.data.isFullScreen;this.ssoEnabled=this.data.ssoEnabled&&this.isMainEndPoint();this.storageService.removeAuthToken(this.authURI);this.authURIKey=i.from(this.authURI).toString("base64").replace(/=/g,"");if(this.ssoAuthenticationHelper.isAutoSSOMain()){this.signinWithSSO()}}signinWithCredentials(){this.form.setErrors(null);if(this.hasRequiredCredentialsError()){this.form.setErrors({credentialsRequiredError:"se.logindialogform.username.and.password.required"});this.logService.debug(`LoginDialogComponent - signinWithCredentials: hasRequiredCredentialsError`);return Promise.resolve()}const e=Object.assign(Object.assign({},this.data.clientCredentials||{}),{username:this.form.get("username").value,password:this.form.get("password").value,grant_type:"password"});return this.sendCredentials(e).then((e=>this.storeAccessToken(e)),(e=>this.apiAuthenticationFailureReportFactory(e))).then((e=>this.acceptUser(e))).catch((e=>{this.logService.debug(`LoginDialogComponent - signinWithCredentials: ${JSON.stringify(e)}`)}))}isMainEndPoint(){return z===this.authURI}storeAccessToken(e){const t=e instanceof a.HttpResponse?e.body:e;this.storageService.storeAuthToken(this.authURI,t);this.eventService.publish(Y.TOKEN_STORED);this.logService.debug(`API Authentication Success: ${this.authURI}`);return this.isMainEndPoint()?this.sessionService.hasUserChanged():Promise.resolve(false)}apiAuthenticationFailureReportFactory(e){this.logService.debug(`API Authentication Failure: ${this.authURI} status: ${e.status}`);this.form.setErrors({asyncValidationError:e.error&&e.error.error_description||"se.logindialogform.oauth.error.default"});return Promise.reject(e)}acceptUser(e){this.modalRef.close({userHasChanged:e});if(this.isMainEndPoint()){this.sessionService.setCurrentUsername()}return Promise.resolve({userHasChanged:e})}hasRequiredCredentialsError(){const e=this.form.get("username");const t=this.form.get("password");return e.errors&&e.errors.required||t.errors&&t.errors.required}};__decorate([r.HostBinding("class.su-login-dialog"),__metadata("design:type",Object)],t.LoginDialogComponent.prototype,"hostClass",void 0);t.LoginDialogComponent=__decorate([r.Component({selector:"su-login-dialog",styles:[`.su-login{width:500px;min-height:440px;box-shadow:0 1px 4px 0 rgba(var(--sapBlockLayer_Background) .1);background-color:var(--sapBaseColor);border-radius:4px;border:1px solid rgba(var(--sapContent_ShadowColor),.2);padding:20px;margin:120px auto 0 auto}.su-login--wrapper{padding:40px 100px;width:100%}.su-login--form-group{margin-bottom:20px}.su-login--form-sso{margin-top:20px}.su-login--logo-wrapper{display:flex;justify-content:flex-start;align-items:center}.su-login--logo-wrapper.su-login--logo-wrapper_full{padding-bottom:45px}.su-login--logo{height:44px}.su-login--logo-text{font-family:"72","72full",Arial,Helvetica,sans-serif;font-size:1.5rem;line-height:1.3333333333;font-weight:400;padding-left:16px;color:var(--sapTextColor);font-weight:700}.su-login--logo__best-run{position:absolute;bottom:30px;left:30px}.su-login--btn{font-size:.875rem;line-height:1.4285714286;font-weight:400;width:100%}.su-login--auth-message{padding-top:20px;padding-bottom:20px;font-size:.875rem;line-height:1.4285714286;font-weight:400}.su-login--alert-error{margin-bottom:0;box-shadow:none}`],template:`<div class="su-login-dialog-container"><div class="fd-dialog__content fd-dialog__content--overrides" role="document"><div class="su-login"><div class="su-login--wrapper"><div class="su-login--logo-wrapper" [ngClass]="{ 'su-login--logo-wrapper_full': !isFullScreen }"><img *ngIf="resource?.topLogoURL" [src]="resource?.topLogoURL" class="su-login--logo" title="{{ 'se.logo.title' | translate }}"/> <span class="su-login--logo-text" translate="se.application.name"></span></div><form autocomplete="off" novalidate [formGroup]="form" (submit)="signinWithCredentials()" class="su-login--form"><div class="su-login--auth-message" *ngIf="isFullScreen"><div translate="se.logindialogform.reauth.message1"></div><div translate="se.logindialogform.reauth.message2"></div></div><div *ngIf="form.errors" class="su-login--form-group"><fd-message-strip type="error" class="su-login--alert-error" id="invalidError" [dismissible]="false"><ng-container *ngIf="form.errors?.credentialsRequiredError">{{ form.errors.credentialsRequiredError | translate }}</ng-container><ng-container *ngIf="form.errors?.asyncValidationError">{{ form.errors.asyncValidationError | translate }}</ng-container></fd-message-strip></div><div class="su-login--form-group"><input fd-form-control type="text" id="username_{{ authURIKey }}" name="username" formControlName="username" placeholder="{{ 'se.authentication.form.input.username' | translate }}" autofocus autocomplete="off" class="fd-input"/></div><div class="su-login--form-group"><input fd-form-control type="password" id="password_{{ authURIKey }}" name="password" placeholder="{{ 'se.authentication.form.input.password' | translate }}" formControlName="password" autocomplete="off" required class="fd-input"/></div><div class="su-login--form-group"><su-language-dropdown class="su-login-language"></su-language-dropdown></div><button fd-button options="emphasized" class="fd-button--emphasized su-login--btn" id="submit_{{ authURIKey }}" name="submit" type="submit" label="{{ 'se.authentication.form.button.submit' | translate }}"></button></form><form *ngIf="ssoEnabled" class="su-login--form-sso" name="loginDialogFormSSO" novalidate (submit)="signinWithSSO()"><button fd-button options="emphasized" class="fd-button--emphasized su-login--btn" id="submitSSO_{{ authURIKey }}" name="submitSSO" type="submit" label="{{ 'se.authentication.form.button.submit.sso' | translate }}"></button></form></div></div><img *ngIf="resource?.bottomLogoURL" [src]="resource?.bottomLogoURL" class="su-login--logo__best-run" title="{{ 'se.logo.title' | translate }}"/></div></div>`}),__param(7,r.Optional()),__param(7,r.Inject(Re)),__param(8,r.Inject(V)),__metadata("design:paramtypes",[u.DialogRef,LogService,a.HttpClient,ISessionService,IStorageService,UrlUtils,t.SSOAuthenticationHelper,Object,Object])],t.LoginDialogComponent);class ITranslationsFetchService{}t.SUPPORTED_BROWSERS=void 0;(function(e){e[e["IE"]=0]="IE";e[e["CHROME"]=1]="CHROME";e[e["FIREFOX"]=2]="FIREFOX";e[e["EDGE"]=3]="EDGE";e[e["SAFARI"]=4]="SAFARI";e[e["UNKNOWN"]=5]="UNKNOWN"})(t.SUPPORTED_BROWSERS||(t.SUPPORTED_BROWSERS={}));class BrowserService{constructor(){this._isSafari=()=>{const{userAgent:e}=window.navigator;const t=window.navigator.vendor;return t&&t.indexOf("Apple")>-1&&e&&e.indexOf("Safari")>-1};this.isIE=()=>this.getCurrentBrowser()===t.SUPPORTED_BROWSERS.IE;this.isFF=()=>this.getCurrentBrowser()===t.SUPPORTED_BROWSERS.FIREFOX;this.isSafari=()=>this.getCurrentBrowser()===t.SUPPORTED_BROWSERS.SAFARI}getCurrentBrowser(){const e=window;let n=t.SUPPORTED_BROWSERS.UNKNOWN;if(typeof e.InstallTrigger!=="undefined"){n=t.SUPPORTED_BROWSERS.FIREFOX}else if(!!document.documentMode){n=t.SUPPORTED_BROWSERS.IE}else if(!!e.StyleMedia){n=t.SUPPORTED_BROWSERS.EDGE}else if(!!e.chrome&&!!e.chrome.webstore){n=t.SUPPORTED_BROWSERS.CHROME}else if(this._isSafari()){n=t.SUPPORTED_BROWSERS.SAFARI}return n}getBrowserLocale(){const e=window.navigator.language.split("-");return e.length===1?e[0]:`${e[0]}_${e[1].toUpperCase()}`}}class FingerPrintingService{constructor(){this._fingerprint=y.encode(this.getUserAgent()+this.getPlugins()+this.hasJava()+this.hasFlash()+this.hasLocalStorage()+this.hasSessionStorage()+this.hasCookie()+this.getTimeZone()+this.getLanguage()+this.getSystemLanguage()+this.hasCanvas())}getFingerprint(){return this._fingerprint}getUserAgent(){return navigator.userAgent}getPlugins(){const e=[];for(let t=0,n=navigator.plugins.length;t<n;t++){if(navigator.plugins[t]){e.push(navigator.plugins[t].name)}}return e.join(",")}hasJava(){return navigator.javaEnabled()}hasFlash(){return!!navigator.plugins.namedItem("Shockwave Flash")}hasLocalStorage(){try{const e="test-has-ls";localStorage.setItem(e,e);localStorage.removeItem(e);return true}catch(e){return false}}hasSessionStorage(){try{const e="test-has-ss";sessionStorage.setItem(e,e);sessionStorage.removeItem(e);return true}catch(e){return false}}hasCookie(){return navigator.cookieEnabled}getTimeZone(){return String(String(new Date).split("(")[1]).split(")")[0]}getLanguage(){return navigator.language}getSystemLanguage(){return window.navigator.language}hasCanvas(){try{const e=document.createElement("canvas");return!!(e.getContext&&e.getContext("2d"))}catch(e){return false}}}let De=class TranslateHttpLoader{constructor(e){this.translationsFetchService=e}getTranslation(e){return l.from(this.translationsFetchService.get(e))}};De=__decorate([r.Injectable(),__metadata("design:paramtypes",[ITranslationsFetchService])],De);var Me;t.TranslationModule=Me=class TranslationModule{static forChild(){return d.TranslateModule.forChild({isolate:false,loader:{provide:d.TranslateLoader,useClass:De}})}static forRoot(e){return{ngModule:Me,providers:[{provide:ITranslationsFetchService,useClass:e},{provide:r.APP_INITIALIZER,useFactory(e,t,n){t.getValueFromLocalStorage("SELECTED_LANGUAGE",false).then((e=>e?e.isoCode:n.getBrowserLocale()),(()=>n.getBrowserLocale())).then((t=>{e.setDefaultLang(t);e.use(t)}));return e=>{}},deps:[d.TranslateService,IStorageService,BrowserService],multi:true}]}}};t.TranslationModule=Me=__decorate([r.NgModule({imports:[d.TranslateModule.forRoot({isolate:false,loader:{provide:d.TranslateLoader,useClass:De}})],exports:[d.TranslateModule]})],t.TranslationModule);class LanguageDropdownAdapter{static transform(e,t){return{id:t,label:e.name,value:e}}}t.LanguageService=class LanguageService{constructor(e,t,n,i,o,s,r,a){this.logService=e;this.translateService=t;this.promiseUtils=n;this.eventService=i;this.browserService=o;this.storageService=s;this.injector=r;this.languageServiceConstants=a}getToolingLanguages(){return this.i18nLanguageRestService.get({}).then((e=>e.languages)).catch((e=>{this.logService.error("LanguageService.getToolingLanguages() - Error loading tooling languages");return Promise.reject(e)}))}getBrowserLanguageIsoCode(){return window.navigator.language.split("-")[0]}getBrowserLocale(){return this.browserService.getBrowserLocale()}getResolveLocale(){return this._getDefaultLanguage()}getResolveLocaleIsoCode(){return this.getResolveLocale().then((e=>this.convertBCP47TagToJavaTag(e).split("_")[0]))}setSelectedToolingLanguage(e){this.storageService.setValueInLocalStorage(q,e,false);this.translateService.use(e.isoCode);this.setApplicationTitle();this.eventService.publish(K,{isoCode:e.isoCode})}registerSwitchLanguage(){this.eventService.subscribe(K,((e,t)=>{if(this.translateService.currentLang!==t.isoCode){this.translateService.use(t.isoCode)}}))}convertBCP47TagToJavaTag(e){return!!e?e.replace(/-/g,"_"):e}convertJavaTagToBCP47Tag(e){return!!e?e.replace(/_/g,"-"):e}_getDefaultLanguage(){return this.storageService.getValueFromLocalStorage(q,false).then((e=>e?e.isoCode:this.browserService.getBrowserLocale()),(()=>this.browserService.getBrowserLocale()))}setApplicationTitle(){this.translateService.get("se.application.name").subscribe((e=>{document.title=e}))}get i18nLanguageRestService(){return this.injector.get(t.RestServiceFactory).get(this.languageServiceConstants.I18N_LANGUAGES_RESOURCE_URI)}};__decorate([x({actions:[ne]}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],t.LanguageService.prototype,"getToolingLanguages",null);t.LanguageService=__decorate([r.Injectable(),__param(3,r.Inject(V)),__param(7,r.Inject(Z)),__metadata("design:paramtypes",[LogService,d.TranslateService,t.PromiseUtils,Object,BrowserService,IStorageService,r.Injector,Object])],t.LanguageService);var Ne;(function(e){e["Default"]="default";e["None"]="none"})(Ne||(Ne={}));class LanguageDropdownHelper{static findSelectLanguageWithIsoCodePredicate(e){return t=>t.value.isoCode===e}static findLanguageWithIsoCode(e,t){return t.find((t=>t.isoCode===e))}static order(e,t,n={strategy:Ne.Default}){switch(n.strategy){case Ne.Default:const n=t.filter((t=>t.isoCode!==e.isoCode)).sort(((e,t)=>e.isoCode.localeCompare(t.isoCode)));return[e,...n];case Ne.None:default:return t}}}class LanguageDropdown{constructor(e,t,n){this.languageService=e;this.eventService=t;this.logService=n;this.languageSortStrategy=Ne.Default;this.selectedLanguage=null;this.items=[];this.initialLanguage=null;this.languages=[];this.unRegisterEventService=null}ngOnInit(){Promise.all([this.languageService.getResolveLocale(),this.languageService.getToolingLanguages()]).then((([e,t])=>{this.items=t.map(LanguageDropdownAdapter.transform);this.languages=t;this.setSelectedLanguage(e);this.setInitialLanguage(e)}));this.unRegisterEventService=this.eventService.subscribe(K,(()=>this.handleLanguageChange()))}ngOnDestroy(){this.unRegisterEventService()}onSelectedLanguage(e){this.languageService.setSelectedToolingLanguage(e.value)}setInitialLanguage(e){this.initialLanguage=this.items.find(LanguageDropdownHelper.findSelectLanguageWithIsoCodePredicate(e))||this.items.find(LanguageDropdownHelper.findSelectLanguageWithIsoCodePredicate(Q))}setSelectedLanguage(e){this.selectedLanguage=LanguageDropdownHelper.findLanguageWithIsoCode(e,this.languages);if(this.selectedLanguage){const e=LanguageDropdownHelper.order(this.selectedLanguage,this.languages,{strategy:this.languageSortStrategy});this.items=e.map(LanguageDropdownAdapter.transform);return}this.languageService.getResolveLocaleIsoCode().then((e=>{this.selectedLanguage=LanguageDropdownHelper.findLanguageWithIsoCode(e,this.languages);const t=LanguageDropdownHelper.order(this.selectedLanguage,this.languages,{strategy:this.languageSortStrategy});this.items=t.map(LanguageDropdownAdapter.transform)})).catch((e=>{this.logService.debug(`LanguageDropdown - can't set the language: ${e}`)}))}handleLanguageChange(){this.languageService.getResolveLocale().then((e=>{this.setSelectedLanguage(e)}))}}__decorate([r.Input(),__metadata("design:type",String)],LanguageDropdown.prototype,"languageSortStrategy",void 0);t.LanguageDropdownComponent=class LanguageDropdownComponent extends LanguageDropdown{constructor(e,t,n,i){super(e,t,i);this.eventService=t;this.yjQuery=n;this.logService=i;this.CDKOverlayContainer=".cdk-overlay-container"}ngOnInit(){super.ngOnInit();this.removeAllPopovers()}ngAfterViewChecked(){this.yjQuery(this.CDKOverlayContainer).addClass("cdk-overlay-container-language")}ngOnDestroy(){super.ngOnDestroy();this.yjQuery(this.CDKOverlayContainer).removeClass("cdk-overlay-container-language")}removeAllPopovers(){const e=this.yjQuery(this.CDKOverlayContainer).toArray();if(e.length===0){return}this.yjQuery(".cdk-overlay-connected-position-bounding-box").toArray().forEach((t=>{e[0].removeChild(t)}))}};t.LanguageDropdownComponent=__decorate([r.Component({selector:"su-language-dropdown",template:`\n        <su-select\n            class="su-language-selector"\n            [items]="items"\n            [initialValue]="initialLanguage"\n            (onItemSelected)="onSelectedLanguage($event)">\n        </su-select>\n    `}),__param(0,r.Inject(X)),__param(1,r.Inject(V)),__param(2,r.Inject(J)),__metadata("design:paramtypes",[t.LanguageService,Object,Function,LogService])],t.LanguageDropdownComponent);class ISelectAdapter{static transform(e,t){return{}}}t.ListItemKeyboardControlDirective=class ListItemKeyboardControlDirective{constructor(e,t){this.hostElement=e;this.renderer=t;this.activeClassName="is-active"}ngOnInit(){this.setTabIndex()}getElement(){return this.hostElement.nativeElement}setActive(){const e=this.getElement();this.renderer.addClass(e,this.activeClassName);e.scrollIntoView({block:"nearest"})}setInactive(){this.renderer.removeClass(this.getElement(),this.activeClassName)}setTabIndex(){this.renderer.setAttribute(this.getElement(),"tabindex","-1")}};t.ListItemKeyboardControlDirective=__decorate([r.Directive({selector:"[suListItemKeyboardControl]"}),__metadata("design:paramtypes",[r.ElementRef,r.Renderer2])],t.ListItemKeyboardControlDirective);var xe;(function(e){e["ArrowDown"]="ArrowDown";e["ArrowUp"]="ArrowUp";e["Enter"]="Enter";e["Esc"]="Escape"})(xe||(xe={}));t.ListKeyboardControlDirective=class ListKeyboardControlDirective{constructor(){this.suListKeyboardControlEnabled=true;this.suListKeyboardControlEnterKeydown=new r.EventEmitter;this.suListKeyboardControlEscKeydown=new r.EventEmitter;this.didNgAfterContentInit=false;this.activeItem=null;this.activeItemIndex=null}onKeyDown(e){if(!this.suListKeyboardControlEnabled||this.items.length===0){return}switch(e.key){case xe.ArrowDown:e.preventDefault();this.handleArrowDown();return;case xe.ArrowUp:e.preventDefault();this.handleArrowUp();return;case xe.Enter:e.preventDefault();this.handleEnter();return;case xe.Esc:this.handleEsc();return}}ngAfterContentInit(){this.items.changes.subscribe((()=>this.onItemsChange()));this.items.notifyOnChanges();this.didNgAfterContentInit=true}ngOnChanges(e){if(!this.didNgAfterContentInit){return}const t=e.suListKeyboardControlEnabled;const n=e.suListKeyboardControlDisabledPredicate;const i=t&&t.currentValue&&!t.previousValue;const o=t&&!t.currentValue&&t.previousValue;const s=n&&n.currentValue&&!!this.suListKeyboardControlEnabled;const r=n&&!n.currentValue&&n.previousValue&&!!this.suListKeyboardControlEnabled;if(this.items.length===0){return}if(i||s){this.setFirstItemActive()}if(o||r){this.unsetActiveItem()}}onItemsChange(){if(this.items.length===0){this.clearActiveItem();return}if(this.suListKeyboardControlEnabled){if(!this.isActiveItemSet()){this.setActiveItemByIndex(0,1)}else if(!this.itemExistsByIndex(this.activeItemIndex)){this.clearActiveItem()}}else{this.clearActiveItem()}}handleArrowUp(){this.setPreviousItemActive()}handleArrowDown(){this.setNextItemActive()}handleEnter(){this.suListKeyboardControlEnterKeydown.emit(this.activeItemIndex)}handleEsc(){this.suListKeyboardControlEscKeydown.emit()}getItemByIndex(e){const t=this.getItemsArray();return t[e]}getItemsArray(){return this.items.toArray()}setActiveItemByIndex(e,t){const n=this.getItemsArray();if(this.suListKeyboardControlDisabledPredicate){while(this.suListKeyboardControlDisabledPredicate(n[e],e)){e+=t;if(!n[e]){return}}}const i=this.getItemByIndex(e);this.setActiveItem(i)}setActiveItem(e){const t=this.getItemsArray();const n=t.indexOf(e);if(this.activeItem){this.activeItem.setInactive()}if(t.length>0){this.activeItem=t[n];this.activeItem.setActive();this.activeItemIndex=n}}unsetActiveItem(){if(!this.activeItem){return}this.activeItem.setInactive();this.activeItemIndex=null}setFirstItemActive(){this.setActiveItemByIndex(0,1)}setNextItemActive(){if(this.activeItemIndex===null){this.setFirstItemActive();return}if(this.activeItemIndex<this.items.length-1){this.setActiveItemByIndex(this.activeItemIndex+1,1)}}setPreviousItemActive(){if(this.activeItemIndex===null){this.setFirstItemActive();return}if(this.activeItemIndex>0){this.setActiveItemByIndex(this.activeItemIndex-1,-1)}}itemExistsByIndex(e){if(e===null){return false}return!!this.getItemByIndex(e)}clearActiveItem(){this.activeItem=null;this.activeItemIndex=null}isActiveItemSet(){return!!this.activeItem}};__decorate([r.Input(),__metadata("design:type",Object)],t.ListKeyboardControlDirective.prototype,"suListKeyboardControlEnabled",void 0);__decorate([r.Input(),__metadata("design:type",Function)],t.ListKeyboardControlDirective.prototype,"suListKeyboardControlDisabledPredicate",void 0);__decorate([r.Output(),__metadata("design:type",Object)],t.ListKeyboardControlDirective.prototype,"suListKeyboardControlEnterKeydown",void 0);__decorate([r.Output(),__metadata("design:type",Object)],t.ListKeyboardControlDirective.prototype,"suListKeyboardControlEscKeydown",void 0);__decorate([r.ContentChildren(t.ListItemKeyboardControlDirective),__metadata("design:type",r.QueryList)],t.ListKeyboardControlDirective.prototype,"items",void 0);__decorate([r.HostListener("document:keydown",["$event"]),__metadata("design:type",Function),__metadata("design:paramtypes",[KeyboardEvent]),__metadata("design:returntype",void 0)],t.ListKeyboardControlDirective.prototype,"onKeyDown",null);t.ListKeyboardControlDirective=__decorate([r.Directive({selector:"[suListKeyboardControl]"})],t.ListKeyboardControlDirective);t.ListKeyboardControlModule=class ListKeyboardControlModule{};t.ListKeyboardControlModule=__decorate([r.NgModule({declarations:[t.ListKeyboardControlDirective,t.ListItemKeyboardControlDirective],exports:[t.ListKeyboardControlDirective,t.ListItemKeyboardControlDirective]})],t.ListKeyboardControlModule);var Fe;t.SelectComponent=Fe=class SelectComponent extends BaseValueAccessor{constructor(){super(...arguments);this.items=[];this.initialValue=null;this.placeholder="";this.isKeyboardControlEnabled=true;this.hasCustomTrigger=false;this.onItemSelected=new r.EventEmitter;this.isOpen=false}selectItem(e){const t=this.items.find((t=>t.id===e));this.setValue(t);this.isOpen=false;this.onItemSelected.emit(t)}ngOnChanges(e){if(e.initialValue&&e.initialValue.currentValue&&!this.value){this.setInitialValue(e.initialValue.currentValue)}}setInitialValue(e){if(typeof e==="number"){this.setValueById(e)}else{this.setValue(e)}}setValue(e){this.writeValue(e);this.onChange(e)}setValueById(e){this.setValue(this.items.find((t=>t.id===e)))}};__decorate([r.Input(),__metadata("design:type",Array)],t.SelectComponent.prototype,"items",void 0);__decorate([r.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"initialValue",void 0);__decorate([r.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"placeholder",void 0);__decorate([r.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"isKeyboardControlEnabled",void 0);__decorate([r.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"hasCustomTrigger",void 0);__decorate([r.Output(),__metadata("design:type",r.EventEmitter)],t.SelectComponent.prototype,"onItemSelected",void 0);t.SelectComponent=Fe=__decorate([r.Component({selector:"su-select",encapsulation:r.ViewEncapsulation.None,providers:[{provide:p.NG_VALUE_ACCESSOR,useExisting:r.forwardRef((()=>Fe)),multi:true}],styles:[`.su-select,.su-select__popover-control,.su-select__popover-control .fd-dropdown{width:100%}.su-select__popover-control .fd-dropdown__control{overflow:hidden;color:var(--sapNeutralColor);text-align:left;padding:0 .625rem;justify-content:space-between}.su-select__popover-control .fd-dropdown__control:focus{outline:0!important}.su-select__popover-control .fd-dropdown__control:focus:after{border-style:none}.su-select__popover-control .fd-dropdown__control::after{position:absolute;top:0;right:0;display:flex;justify-content:center;align-items:center;padding:0;height:36px;width:36px;margin-top:0;font-size:14px}.su-select__menu .fd-list{max-height:200px;overflow:auto}.su-select__menu .fd-list .fd-list__title{padding:.5rem}.su-select__menu .fd-list__item[select-highlighted]{background:se-color-state("selected")}.su-select__menu .fd-list__item[select-highlighted]:focus{outline:0}.su-select__popover-control .se-select-arrow{position:absolute;right:0;border-left-color:inherit;border-left-style:solid;border-left-width:1px;border-top-left-radius:unset;border-bottom-left-radius:unset}`],template:`\n        <fd-popover [(isOpen)]="isOpen" fillControlMode="equal" class="su-select">\n            <fd-popover-control class="su-select__popover-control">\n                <button\n                    fd-button\n                    aria-expanded="true"\n                    class="fd-dropdown__control fd-button fd-select__control"\n                    type="button"\n                    *ngIf="!hasCustomTrigger; else customTrigger"\n                    label="{{ (value && value.label) || placeholder | translate }}">\n                    <span class="fd-button fd-button--transparent se-select-arrow">\n                        <i class="sap-icon--slim-arrow-down"></i>\n                    </span>\n                </button>\n                <ng-template #customTrigger>\n                    <ng-content select="[su-select-custom-trigger]"></ng-content>\n                </ng-template>\n            </fd-popover-control>\n            <fd-popover-body>\n                <div class="su-select__menu">\n                    <ul\n                        fd-list\n                        suListKeyboardControl\n                        [suListKeyboardControlEnabled]="isKeyboardControlEnabled && isOpen"\n                        (suListKeyboardControlEnterKeydown)="selectItem($event)"\n                        class="fd-list--dropdown">\n                        <li\n                            fd-list-item\n                            suListItemKeyboardControl\n                            [ngClass]="item.listItemClassName"\n                            *ngFor="let item of items"\n                            (click)="selectItem(item.id)"\n                            [attr.tabindex]="-1"\n                            [attr.data-select-id]="item.id"\n                            role="option">\n                            <a fd-list-link>\n                                <span fd-list-title> {{ item.label | translate }} </span>\n                            </a>\n                        </li>\n                    </ul>\n                </div>\n            </fd-popover-body>\n        </fd-popover>\n    `})],t.SelectComponent);t.SelectModule=class SelectModule{};t.SelectModule=__decorate([r.NgModule({imports:[u.FundamentalNgxCoreModule,m.CommonModule,t.ListKeyboardControlModule,t.TranslationModule.forChild(),h.ListModule],declarations:[t.SelectComponent],entryComponents:[t.SelectComponent],exports:[t.SelectComponent]})],t.SelectModule);t.LanguageDropdownModule=class LanguageDropdownModule{};t.LanguageDropdownModule=__decorate([r.NgModule({imports:[m.CommonModule,t.SelectModule],declarations:[t.LanguageDropdownComponent],entryComponents:[t.LanguageDropdownComponent],exports:[t.LanguageDropdownComponent]})],t.LanguageDropdownModule);t.LoginDialogModule=class LoginDialogModule{};t.LoginDialogModule=__decorate([r.NgModule({imports:[m.CommonModule,t.LanguageDropdownModule,p.FormsModule,p.ReactiveFormsModule,u.MessageStripModule,t.TranslationModule.forChild(),u.ButtonModule,u.FormModule],declarations:[t.LoginDialogComponent],entryComponents:[t.LoginDialogComponent],exports:[t.LanguageDropdownModule]})],t.LoginDialogModule);t.AuthenticationService=class AuthenticationService extends IAuthenticationService{constructor(e,t,n,i,o,s,r,a,l){super();this.translationsFetchService=e;this.modalService=t;this.sharedDataService=n;this.storageService=i;this.eventService=o;this.ssoAuthenticationHelper=s;this.settingsService=r;this.authenticationManager=a;this.logService=l}filterEntryPoints(e){return this.sharedDataService.get("authenticationMap").then((t=>f.convertToArray(Object.assign(Object.assign({},t||{}),G)).filter((t=>new RegExp(t.key,"g").test(e))).map((e=>e.value))))}isAuthEntryPoint(e){return this.sharedDataService.get("authenticationMap").then((t=>{const n=f.convertToArray(t||{}).map((e=>e.value));return n.indexOf(e)>-1||e===z}))}authenticate(e){return this._findLoginData(e).then((e=>this._launchAuth(e).then((t=>{Promise.resolve(this.eventService.publish(Y.AUTHORIZATION_SUCCESS,{userHasChanged:t.userHasChanged})).then((()=>{if(t.userHasChanged){this.eventService.publish(Y.USER_HAS_CHANGED)}const e=_.values(this.reauthInProgress).some((e=>e));if(t.userHasChanged&&!e&&this.authenticationManager&&this.authenticationManager.onUserHasChanged){this.authenticationManager.onUserHasChanged()}})).catch((e=>{this.logService.debug(`AuthenticationService - authenticate: ${JSON.stringify(e)}`)}));this.reauthInProgress[e.authURI]=false}))))}logout(){return this.eventService.publish(Y.LOGOUT).then((()=>{this.storageService.removeAllAuthTokens();if(this.ssoAuthenticationHelper.isAutoSSOMain()){this.ssoAuthenticationHelper.logout()}else if(this.authenticationManager&&this.authenticationManager.onLogout){this.authenticationManager.onLogout()}}))}isReAuthInProgress(e){return Promise.resolve(this.reauthInProgress[e]===true)}setReAuthInProgress(e){this.reauthInProgress[e]=true;return Promise.resolve()}isAuthenticated(e){return this.filterEntryPoints(e).then((e=>{const t=e&&e[0];return Promise.resolve(this.storageService.getAuthToken(t)).then((e=>!!e))}))}_findLoginData(e){return this.filterEntryPoints(e).then((e=>Promise.resolve(this.sharedDataService.get("credentialsMap").then((t=>{const n=Object.assign(Object.assign({},t||{}),W);const i=e[0];return{authURI:i,clientCredentials:n[i]}})))))}_launchAuth(e){return this.translationsFetchService.waitToBeReady().then((()=>Promise.all([this.storageService.isInitialized(),this.settingsService.getBoolean("smartedit.sso.enabled")]))).then((([n,i])=>{const o=this.modalService.open({component:t.LoginDialogComponent,data:Object.assign(Object.assign({},e),{isFullScreen:n,ssoEnabled:i}),config:{hasBackdrop:false}});return new Promise(((e,t)=>{o.afterClosed.subscribe(e,t)}))}))}};t.AuthenticationService=__decorate([__param(4,r.Inject(V)),__param(7,r.Optional()),__metadata("design:paramtypes",[ITranslationsFetchService,IModalService,ISharedDataService,IStorageService,Object,t.SSOAuthenticationHelper,ISettingsService,IAuthenticationManagerService,LogService])],t.AuthenticationService);t.ModalManagerService=class ModalManagerService{constructor(e){this.modalRef=e;this.title=new l.BehaviorSubject("");this.titleSuffix=new l.BehaviorSubject("");this.modalData=new l.BehaviorSubject({});this.component=new l.BehaviorSubject(undefined);this.isDismissButtonVisible=new l.BehaviorSubject(false);this.buttons=new l.BehaviorSubject([])}init(){this.modalData.next(this.modalRef.data.modalData);this.component.next(this.modalRef.data.component);this.buttons.next(this.modalRef.data.templateConfig.buttons||[]);this.title.next(this.modalRef.data.templateConfig.title||"");this.titleSuffix.next(this.modalRef.data.templateConfig.titleSuffix||"");this.isDismissButtonVisible.next(this.modalRef.data.templateConfig.isDismissButtonVisible)}getComponent(){return this.component.asObservable()}getTitle(){return this.title.asObservable()}getTitleSuffix(){return this.titleSuffix.asObservable()}getButtons(){return this.buttons.asObservable()}getModalData(){return this.modalData.asObservable()}getIsDismissButtonVisible(){return this.isDismissButtonVisible.asObservable()}setDismissButtonVisibility(e){this.isDismissButtonVisible.next(e)}setTitle(e){this.title.next(e)}addButton(e){this.getButtonsValue().subscribe((t=>{const n=[...t,e];this.buttons.next(n)}))}addButtons(e){this.getButtonsValue().subscribe((t=>{const n=[...t,...e];this.buttons.next(n)}))}removeButton(e){this.getButtonsValue().subscribe((t=>{const n=t.filter((t=>t.id!==e));this.buttons.next(n)}))}removeAllButtons(){this.buttons.next([])}disableButton(e){this.getButtonsValue().subscribe((t=>{const n=t.map((t=>t.id===e?Object.assign(Object.assign({},t),{disabled:true}):t));this.buttons.next(n)}))}setDismissCallback(e){this.dismissCallback=e}enableButton(e){this.getButtonsValue().subscribe((t=>{const n=t.map((t=>t.id===e?Object.assign(Object.assign({},t),{disabled:false}):t));this.buttons.next(n)}))}onButtonClicked(e){const n=e.callback?e.callback():l.of(null);if(e.action!==t.ModalButtonAction.None){n.subscribe((n=>e.action===t.ModalButtonAction.Close?this.close(n):this.dismiss(n)))}}close(e){this.modalRef.close(e)}dismiss(e){this.dismissCallback().then((()=>this.modalRef.dismiss(e))).catch(o.noop)}getButtonsValue(){return this.buttons.pipe(c.take(1))}dismissCallback(){return Promise.resolve()}};t.ModalManagerService=__decorate([r.Injectable(),__metadata("design:paramtypes",[u.DialogRef])],t.ModalManagerService);t.ModalTemplateComponent=class ModalTemplateComponent{constructor(e,t){this.modalManager=e;this.cdr=t;this.component$=this.modalManager.getComponent();this.title$=this.modalManager.getTitle();this.titleSuffix$=this.modalManager.getTitleSuffix();this.isDismissButtonVisible$=this.modalManager.getIsDismissButtonVisible();this.buttons$=this.modalManager.getButtons()}ngOnInit(){this.modalManager.init();this.buttonsSubscription=this.buttons$.subscribe((e=>{this.buttons=e;if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}ngOnDestroy(){if(this.buttonsSubscription){this.buttonsSubscription.unsubscribe()}}onButtonClicked(e){this.modalManager.onButtonClicked(e)}dismiss(){this.modalManager.dismiss()}};t.ModalTemplateComponent=__decorate([r.Component({selector:"fundamental-modal-template",encapsulation:r.ViewEncapsulation.None,providers:[t.ModalManagerService],styles:[`\n            .fd-dialog__title {\n                min-height: 20px;\n            }\n        `],template:`\n        <fd-dialog>\n            <fd-dialog-header>\n                <h1 fd-title id="fd-title-{{ (title$ | async) || '' }}">\n                    {{ (title$ | async) || '' | translate }}\n                    {{ (titleSuffix$ | async) || '' | translate }}\n                </h1>\n                <button\n                    fd-dialog-close-button\n                    *ngIf="isDismissButtonVisible$ | async"\n                    (click)="dismiss()"\n                    class="fd-button fd-button--transparent fd-dialog__close"\n                    title="{{ 'se.btn.close.title' | translate }}"></button>\n            </fd-dialog-header>\n            <fd-dialog-body>\n                <ng-container *ngIf="component$ | async as component">\n                    <ng-container *ngComponentOutlet="component"></ng-container>\n                </ng-container>\n            </fd-dialog-body>\n            <fd-dialog-footer *ngIf="buttons && buttons.length > 0">\n                <button\n                    *ngFor="let button of buttons"\n                    [disabled]="button.disabledFn ? button.disabledFn!() : button.disabled"\n                    [fdType]="button.style"\n                    [attr.id]="button.id"\n                    [label]="button.label | translate"\n                    (click)="onButtonClicked(button)"\n                    fd-button></button>\n            </fd-dialog-footer>\n        </fd-dialog>\n    `}),__metadata("design:paramtypes",[t.ModalManagerService,r.ChangeDetectorRef])],t.ModalTemplateComponent);t.FundamentalModalTemplateModule=class FundamentalModalTemplateModule{};t.FundamentalModalTemplateModule=__decorate([r.NgModule({imports:[m.CommonModule,g.DialogModule,u.ButtonModule,t.TranslationModule.forChild()],declarations:[t.ModalTemplateComponent],entryComponents:[t.ModalTemplateComponent],exports:[t.ModalTemplateComponent]})],t.FundamentalModalTemplateModule);t.ModalService=class ModalService{constructor(e){this.fundamentalModalService=e}open(e){const{templateConfig:t}=e;return!!t?this.openWithTemplate(e):this.openStandalone(e)}hasOpenModals(){return this.fundamentalModalService.hasOpenDialogs()}dismissAll(){this.fundamentalModalService.dismissAll()}openStandalone(e){const{config:t={},component:n,data:i}=e;return this.fundamentalModalService.open(n,Object.assign(Object.assign({},t),{data:i}))}openWithTemplate(e){const{config:n={},templateConfig:i={},component:o,data:s}=e;const r=Object.assign(Object.assign({},n),{data:{templateConfig:i,component:o,modalData:s}});return this.fundamentalModalService.open(t.ModalTemplateComponent,r)}};t.ModalService=__decorate([r.Injectable(),__metadata("design:paramtypes",[u.DialogService])],t.ModalService);class Alert{constructor(e,t,n,i){this._alertConf=e;this.fundamentalAlertService=n;this.translateService=i;this._displayed=false;_.defaultsDeep(this._alertConf,_.cloneDeep(t))}get alertConf(){return this._alertConf}get message(){return this._alertConf.message}get type(){return this._alertConf.type}show(){return __awaiter(this,void 0,void 0,(function*(){if(this.isDisplayed()){return}if(this._alertConf.message){this._alertConf.message=yield this.translateService.get(this._alertConf.message,this._alertConf.messagePlaceholders).toPromise()}const e=typeof this._alertConf.message!=="undefined"?this._alertConf.message:this._alertConf.component||"";this._alertRef=this.fundamentalAlertService.open(e,this._alertConf);this._alertRef.afterDismissed.subscribe((()=>this._displayed=false));this._displayed=true}))}hide(){if(!this.isDisplayed()){return}this._alertRef.dismiss()}isDisplayed(){return this._displayed}}const Le=new r.InjectionToken("alertConfigToken");const Ue={data:{},type:t.IAlertServiceType.INFO,dismissible:true,duration:1e3,width:"300px",minWidth:"",mousePersist:true};t.AlertFactory=class AlertFactory{constructor(e,t,n){this.fundamentalAlertService=e;this.translateService=t;this.ALERT_CONFIG_DEFAULTS=n}createAlert(e){const t=this.getAlertConfig(e);return this.createAlertObject(t)}createInfo(e){const n=this.getAlertConfig(e,t.IAlertServiceType.INFO);return this.createAlertObject(n)}createDanger(e){const n=this.getAlertConfig(e,t.IAlertServiceType.DANGER);return this.createAlertObject(n)}createWarning(e){const n=this.getAlertConfig(e,t.IAlertServiceType.WARNING);return this.createAlertObject(n)}createSuccess(e){const n=this.getAlertConfig(e,t.IAlertServiceType.SUCCESS);return this.createAlertObject(n)}getAlertConfig(e,n){if(typeof e==="string"){return{message:e,type:n||t.IAlertServiceType.INFO,minWidth:"",mousePersist:true,duration:1e3,dismissible:true,width:"300px"}}if(!e.type){e.type=n||t.IAlertServiceType.INFO}return e}createAlertObject(e){return new Alert(e,this.ALERT_CONFIG_DEFAULTS,this.fundamentalAlertService,this.translateService)}};t.AlertFactory=__decorate([r.Injectable(),__param(2,r.Inject(Le)),__metadata("design:paramtypes",[u.AlertService,d.TranslateService,u.AlertConfig])],t.AlertFactory);t.AlertService=class AlertService{constructor(e){this.alertFactory=e}showAlert(e){const t=this.alertFactory.createAlert(e);t.show()}showInfo(e){const t=this.alertFactory.createInfo(e);t.show()}showDanger(e){const t=this.alertFactory.createDanger(e);t.show()}showWarning(e){const t=this.alertFactory.createWarning(e);t.show()}showSuccess(e){const t=this.alertFactory.createSuccess(e);t.show()}};t.AlertService=__decorate([r.Injectable(),__metadata("design:paramtypes",[t.AlertFactory])],t.AlertService);t.AlertModule=class AlertModule{};t.AlertModule=__decorate([r.NgModule({imports:[u.AlertModule,t.TranslationModule],providers:[{provide:Le,useValue:Ue},t.AlertService,t.AlertFactory]})],t.AlertModule);t.FileReaderService=class FileReaderService{read(e,t){const n=new FileReader;if(t===null||t===void 0?void 0:t.onError){n.onerror=t.onError}if(t===null||t===void 0?void 0:t.onLoadEnd){n.onloadend=t.onLoadEnd}n.readAsArrayBuffer(e);return n}};t.FileReaderService=__decorate([r.Injectable()],t.FileReaderService);t.FileMimeTypeService=class FileMimeTypeService{constructor(e,t){this.fileReaderService=e;this.settingsService=t}isFileMimeTypeValid(e){return new Promise(((t,n)=>__awaiter(this,void 0,void 0,(function*(){const{error:i,data:o}=yield O.attempt(this.settingsService.getStringList("smartedit.validFileMimeTypeCodes"));if(i){n(false);return}this.fileReaderService.read(e,{onLoadEnd:e=>{if(!this.validateMimeTypeFromFile(e.target.result,o)){n();return}t(true)},onError:()=>{n()}})}))))}validateMimeTypeFromFile(e,t){const n=new Uint8Array(e).subarray(0,32);const i=n.reduce(((e,t)=>{let n=t.toString(16);if(n.length===1){n="0"+n}e+=n;return e}),"");return t.some((e=>i.toLowerCase().includes(e.toLowerCase())))}};t.FileMimeTypeService=__decorate([r.Injectable(),__metadata("design:paramtypes",[t.FileReaderService,ISettingsService])],t.FileMimeTypeService);class FileValidatorFactory{build(e){return{validate:(t,n,i)=>this.validate(e,t,n,i)}}validate(e,t,n,i){i=i||[];e.forEach((e=>{const o=t[e.subject];if(!e.validate(o,n)){i.push({subject:e.subject,message:e.message})}}));return i.length===0}}class InputPropertyChange{constructor(e,t){this.key=e;this.value=t}}class InputProperties{constructor(e={}){this.changes=new l.Subject;this._map=new Map(o.toPairs(e))}get(e){return this._map.get(e)}set(e,t,n=true){this._map.set(e,t);if(n){this.changes.next(new InputPropertyChange(e,t))}}}class ValidatorParameters{constructor(e={},t={}){this.validators={};this.asyncValidators={};this.validators=this._omitUndefinedValues(e);this.asyncValidators=this._omitUndefinedValues(t)}has(e){return this.validators.hasOwnProperty(e)}get(e){if(!this.has(e)){return null}return this.validators[e]}hasAsync(e){return this.asyncValidators.hasOwnProperty(e)}getAsync(e){if(!this.hasAsync(e)){return null}return this.asyncValidators[e]}_omitUndefinedValues(e){return o.omitBy(e,o.isUndefined)}}class FormField extends p.FormControl{constructor(e={},t={},{component:n,inputs:i=new InputProperties,validatorParams:o=new ValidatorParameters,persist:s=true}){super(e,t);this.component=n;this.inputs=i;this.inputChanges=i.changes;this.validatorParams=o;this.persist=s}setInput(e,t){this.inputs.set(e,t)}getInput(e){return this.inputs.get(e)}getPersistedValue(){if(!this.persist){return undefined}return this.value===undefined?null:this.value}}class FormGrouping extends p.FormGroup{constructor(e,t={},{component:n,inputs:i=new InputProperties,validatorParams:o=new ValidatorParameters,persist:s=true}){super(e,t);this.component=n;this.inputs=i;this.inputChanges=i.changes;this.validatorParams=o;this.persist=s}setInput(e,t){this.inputs.set(e,t)}getInput(e){return this.inputs.get(e)}setNestedErrors(e=[]){e.forEach((([e,t])=>{const n=this.get(e);if(!n){throw new Error(`FormGrouping - Path not found when setting nested error: ${e}`)}n.setErrors(t)}))}getPersistedValue(){return Object.keys(this.controls).reduce(((e,t)=>{const n=this.controls[t];if(!n.persist){return Object.assign(Object.assign({},e),n.getPersistedValue())}e[t]=n.getPersistedValue();return e}),{})}}class FormList extends p.FormArray{constructor(e,t={},{component:n,inputs:i=new InputProperties,validatorParams:o=new ValidatorParameters,persist:s=true}){super(e,t);this.component=n;this.inputs=i;this.inputChanges=i.changes;this.validatorParams=o;this.persist=s}setInput(e,t){this.inputs.set(e,t)}getInput(e){return this.inputs.get(e)}getPersistedValue(){return this.controls.reduce(((e,t)=>{if(!t.persist){return e.concat(o.values(t.getPersistedValue()))}e.push(t.getPersistedValue());return e}),[])}size(){return this.controls.length}swapFormElements(e,t){if(!this._isInBounds(e)||!this._isInBounds(t)||e===t){return}const n=this.at(e);this.insert(e,this.at(t));this.insert(t,n)}moveFormElement(e,t){if(!this._isInBounds(e)||!this._isInBounds(t)||e===t){return}const n=t<e?-1:1;const i=this.at(e);for(let i=e;(i-t)*n<0;i+=n){const e=i+n;this.setControl(i,this.at(e))}this.setControl(t,i)}_isInBounds(e){return e<this.controls.length&&e>=0}}const ke=Symbol("_form_prop_");class PropDecorator{constructor(e){this.property=e}}class InputPropDecorator extends PropDecorator{constructor(e,t){super(e);this.alias=t?t:this.property}}class FormPropDecorator extends PropDecorator{}function makePropertyDecorator(e){return(t,n)=>{const i=t.constructor;if(!i[ke]){i[ke]=[]}i[ke].push(e(n))}}function DynamicForm(){return makePropertyDecorator((e=>new FormPropDecorator(e)))}const DynamicInput=(e=null)=>makePropertyDecorator((t=>new InputPropDecorator(t,e)));t.FormListerComponent=class FormListerComponent{get forms(){return o.values(this.form.controls)}};__decorate([DynamicForm(),__metadata("design:type",FormGrouping)],t.FormListerComponent.prototype,"form",void 0);t.FormListerComponent=__decorate([r.Component({selector:"form-lister",styles:[`\n            :host {\n                display: block;\n            }\n        `],template:`<ng-template [formRenderer]="form" *ngFor="let form of forms"></ng-template>`})],t.FormListerComponent);const onChange=({changeDetectorRef:e,instance:t})=>{t.onDynamicInputChange&&t.onDynamicInputChange();e.markForCheck()};const decorate=(e,t)=>{const n=e.instance;const i=n.constructor[ke];if(!Array.isArray(i)){return new l.Subscription}const o=new Map;i.forEach((e=>{const i=e.property;if(e instanceof InputPropDecorator){const s=e.alias;if(t.getInput(s)===undefined&&n[i]!==undefined){t.setInput(s,n[i])}n[i]=t.getInput(s);o.set(s,e)}else if(e instanceof FormPropDecorator){n[i]=t}}));onChange(e);return t.inputChanges.subscribe((({key:t,value:i})=>{const s=o.get(t);if(!s){return}n[s.property]=i;onChange(e)}))};t.FormRendererDirective=class FormRendererDirective{constructor(e,t){this.componentFactoryResolver=e;this.viewContainerRef=t}set form(e){this._dispose();const t=this.componentFactoryResolver.resolveComponentFactory(e.component);const n=this.viewContainerRef.createComponent(t);this._subscription=decorate(n,e)}ngOnDestroy(){this._dispose()}_dispose(){this._subscription&&this._subscription.unsubscribe();this.viewContainerRef.clear()}};__decorate([r.Input("formRenderer"),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],t.FormRendererDirective.prototype,"form",null);t.FormRendererDirective=__decorate([r.Directive({selector:"[formRenderer]"}),__metadata("design:paramtypes",[r.ComponentFactoryResolver,r.ViewContainerRef])],t.FormRendererDirective);const Ve=new r.InjectionToken("COMPONENT_MAP");const je=new r.InjectionToken("ASYNC_VALIDATOR_MAP");const ze=new r.InjectionToken("VALIDATOR_MAP");var Be;t.FormBuilderModule=Be=class FormBuilderModule{static forRoot(e){return{ngModule:Be,providers:[{provide:r.ANALYZE_FOR_ENTRY_COMPONENTS,useValue:[e.types],multi:true},{provide:Ve,useValue:e.types},{provide:ze,useValue:e.validators},{provide:je,useValue:e.asyncValidators}]}}};t.FormBuilderModule=Be=__decorate([r.NgModule({imports:[m.CommonModule,p.ReactiveFormsModule],declarations:[t.FormRendererDirective,t.FormListerComponent],entryComponents:[t.FormListerComponent],exports:[t.FormRendererDirective]})],t.FormBuilderModule);class Registry{constructor(e={}){this._map=new Map(o.toPairs(e))}add(e,t){if(this._map.has(e)){throw new Error(`${this._service}: is overriding an element named '${e}' in its registry.`)}this._map.set(e,t)}get(e){if(!this._map.has(e)){throw new Error(`${this._service}: does not have '${e}' in its registry.`)}return this._map.get(e)}get _service(){return this.constructor.name}}t.ComponentRegistryService=class ComponentRegistryService extends Registry{constructor(e){super(e)}};t.ComponentRegistryService=__decorate([r.Injectable({providedIn:"root"}),__param(0,r.Optional()),__param(0,r.Inject(Ve)),__metadata("design:paramtypes",[Object])],t.ComponentRegistryService);t.AsyncValidatorRegistryService=class AsyncValidatorRegistryService extends Registry{constructor(e){super(e)}};t.AsyncValidatorRegistryService=__decorate([r.Injectable({providedIn:"root"}),__param(0,r.Optional()),__param(0,r.Inject(je)),__metadata("design:paramtypes",[Object])],t.AsyncValidatorRegistryService);t.ValidatorRegistryService=class ValidatorRegistryService extends Registry{constructor(e){super(e)}};t.ValidatorRegistryService=__decorate([r.Injectable({providedIn:"root"}),__param(0,r.Optional()),__param(0,r.Inject(ze)),__metadata("design:paramtypes",[Object])],t.ValidatorRegistryService);t.SchemaCompilerService=class SchemaCompilerService{constructor(e,t,n){this.types=e;this.validators=t;this.asyncValidators=n}compileGroup(e,n,i={}){const o=Object.keys(n.schemas).reduce(((t,o)=>{t[o]=this._toAbstractForm(e?e[o]:null,n.schemas[o],i);return t}),{});return new FormGrouping(o,this._getValidators(n,i),{component:n.component?this._getComponent(n.component,i.components):t.FormListerComponent,inputs:new InputProperties(n.inputs),validatorParams:new ValidatorParameters(n.validators,n.asyncValidators),persist:this._toPersist(n.persist)})}compileList(e,t,n={}){const i=Array.isArray(t.schema)?t.schema:[t.schema];if(!i.length){throw Error("SchemaCompilerService - One or more schemas must be provided to compile a form list.")}const o=(Array.isArray(e)?e:[]).map(((e,t)=>{const o=i[t]?i[t]:i[i.length-1];return this._toAbstractForm(e,o,n)}));return new FormList(o,this._getValidators(t,n),{component:this._getComponent(t.component,n.components),inputs:new InputProperties(t.inputs),validatorParams:new ValidatorParameters(t.validators,t.asyncValidators),persist:this._toPersist(t.persist)})}compileField(e,t,n={}){return new FormField({value:e,disabled:t.disabled},this._getValidators(t,n),{component:this._getComponent(t.component,n.components),inputs:new InputProperties(t.inputs),validatorParams:new ValidatorParameters(t.validators,t.asyncValidators),persist:this._toPersist(t.persist)})}_getValidators(e,t={}){let n=[];let i=[];if(e.validators){n=this._mapValidator(e.validators,this.validators,t.validators)}if(e.asyncValidators){i=this._mapValidator(e.asyncValidators,this.asyncValidators,t.asyncValidators)}return{validators:n,asyncValidators:i}}_toAbstractForm(e,t,n){if(t.type==="field"){return this.compileField(e,t,n)}if(t.type==="group"){return this.compileGroup(e,t,n)}return this.compileList(e,t,n)}_mapValidator(e,t,n={}){return Object.keys(e).reduce(((i,o)=>{const s=e[o];if(s!==undefined){const e=n[o]?n[o]:t.get(o);if(!e){throw new Error(`SchemaCompilerService - Validator not found in ${this.validators.constructor.name} for: ${o}.`)}i.push(e(s))}return i}),[])}_toPersist(e=true){return e}_getComponent(e,t={}){const n=t[e]?t[e]:this.types.get(e);if(!n){throw new Error(`SchemaCompilerService - Did not find component for: ${e}.`)}return n}};t.SchemaCompilerService=__decorate([r.Injectable({providedIn:t.FormBuilderModule}),__metadata("design:paramtypes",[t.ComponentRegistryService,t.ValidatorRegistryService,t.AsyncValidatorRegistryService])],t.SchemaCompilerService);const getPersistenceMap=(e,t={},n=[],i=[])=>{if(e instanceof FormField){if(e.persist){t[n.join(".")]=i}return t}if(e instanceof FormList||e instanceof FormGrouping){if(e.persist&&n.length){t[n.join(".")]=i}Object.keys(e.controls).forEach((o=>{const s=e.controls[o];const r=[...i,o];if(s.persist){return getPersistenceMap(s,t,[...n,o],r)}return getPersistenceMap(s,t,n,r)}))}return t};const toFormValue=(e,t)=>{if(t.type==="field"){return e}if(t.type==="group"){return processGroupSchema(e,t)}return processListSchema(e,t)};const processGroupSchema=(e,t)=>{const n={};Object.keys(t.schemas).forEach((i=>{const o=getInnerData(e,i,t.schemas[i].type);n[i]=toFormValue(o,t.schemas[i])}));return n};const processListSchema=(e,t)=>{const n=t;const i=[];const o=Array.isArray(e)?e:[];const s=Array.isArray(n.schema)?n.schema:[n.schema];o.forEach(((e,t)=>{if(t>s.length-1){t=s.length-1}i.push(toFormValue(e,s[t]))}));return i};const getInnerData=(e,t,n)=>{if(e==null){return null}const i=e[t];if(i!==undefined){return i}else if(n==="field"){return null}return e};t.ALERT_CONFIG_DEFAULTS=Ue;t.ALERT_CONFIG_DEFAULTS_TOKEN=Le;t.AbstractCachedRestService=AbstractCachedRestService;t.Alert=Alert;t.AnnotationService=AnnotationService;t.BackendEntry=BackendEntry;t.BaseValueAccessor=BaseValueAccessor;t.BooleanUtils=BooleanUtils;t.BrowserService=BrowserService;t.CacheAction=CacheAction;t.CacheConfig=M;t.CacheConfigAnnotationFactory=CacheConfigAnnotationFactory;t.Cached=x;t.CachedAnnotationFactory=CachedAnnotationFactory;t.CloneableUtils=CloneableUtils;t.CryptographicUtils=CryptographicUtils;t.DEFAULT_AUTHENTICATION_CLIENT_ID=H;t.DEFAULT_AUTHENTICATION_ENTRY_POINT=z;t.DEFAULT_AUTH_MAP=G;t.DEFAULT_CREDENTIALS_MAP=W;t.DEFAULT_LANGUAGE_ISO=Q;t.DefaultCacheTiming=DefaultCacheTiming;t.DefaultRetryStrategy=me;t.DynamicForm=DynamicForm;t.DynamicInput=DynamicInput;t.EVENTS=Y;t.EVENT_SERVICE=V;t.EXPONENTIAL_RETRY_DEFAULT_SETTING=de;t.EvictionTag=EvictionTag;t.ExponentialRetry=ExponentialRetry;t.ExponentialRetryStrategy=he;t.FORM_PROP=ke;t.FileValidatorFactory=FileValidatorFactory;t.FingerPrintingService=FingerPrintingService;t.FormField=FormField;t.FormGrouping=FormGrouping;t.FormList=FormList;t.FormPropDecorator=FormPropDecorator;t.FunctionsUtils=FunctionsUtils;t.GET_REQUESTS_ON_HOLD_MAP=ye;t.HTTP_METHODS_READ=ce;t.HTTP_METHODS_UPDATE=le;t.HttpUtils=HttpUtils;t.I18N_RESOURCE_URI_TOKEN=k;t.I18N_ROOT_RESOURCE_URI=B;t.IAlertService=IAlertService;t.IAuthenticationManagerService=IAuthenticationManagerService;t.IAuthenticationService=IAuthenticationService;t.IModalService=IModalService;t.ISelectAdapter=ISelectAdapter;t.ISessionService=ISessionService;t.ISettingsService=ISettingsService;t.ISharedDataService=ISharedDataService;t.IStorageService=IStorageService;t.ITranslationsFetchService=ITranslationsFetchService;t.InputPropDecorator=InputPropDecorator;t.InputProperties=InputProperties;t.InputPropertyChange=InputPropertyChange;t.InvalidateCache=InvalidateCache;t.InvalidateCacheAnnotationFactory=InvalidateCacheAnnotationFactory;t.LANDING_PAGE_PATH=$;t.LANGUAGE_SERVICE=X;t.LANGUAGE_SERVICE_CONSTANTS=Z;t.LIBRARY_NAME=L;t.LINEAR_RETRY_DEFAULT_SETTING=pe;t.LanguageDropdown=LanguageDropdown;t.LanguageDropdownAdapter=LanguageDropdownAdapter;t.LanguageDropdownHelper=LanguageDropdownHelper;t.LinearRetry=LinearRetry;t.LinearRetryStrategy=ge;t.LogService=LogService;t.LoginDialogResourceProvider=Re;t.OPERATION_CONTEXT_TOKEN=Se;t.OperationContextAnnotationFactory=OperationContextAnnotationFactory;t.OperationContextRegistered=ve;t.PropDecorator=PropDecorator;t.REAUTH_STARTED=j;t.RarelyChangingContentName=te;t.RestClient=RestClient;t.SELECTED_LANGUAGE=q;t.SIMPLE_RETRY_DEFAULT_SETTING=ue;t.SWITCH_LANGUAGE_EVENT=K;t.SimpleRetry=SimpleRetry;t.StringUtils=StringUtils;t.StripResponseHeaders=StripResponseHeaders;t.URIBuilder=URIBuilder;t.UrlUtils=UrlUtils;t.ValidatorParameters=ValidatorParameters;t.WHO_AM_I_RESOURCE_URI_TOKEN=U;t.WindowUtils=WindowUtils;t.YJQUERY_TOKEN=J;t.annotationService=R;t.booleanUtils=P;t.clientErrorPredicate=clientErrorPredicate;t.cloneableUtils=S;t.commonNgZone=E;t.defaultRetryStrategyFactory=defaultRetryStrategyFactory;t.exponentialRetryStrategyFactory=exponentialRetryStrategyFactory;t.functionsUtils=f;t.getPersistenceMap=getPersistenceMap;t.httpUtils=w;t.linearRetryStrategyFactory=linearRetryStrategyFactory;t.moduleUtils=b;t.noInternetConnectionErrorPredicate=noInternetConnectionErrorPredicate;t.promiseUtils=O;t.rarelyChangingContent=ne;t.readPredicate=readPredicate;t.retriableErrorPredicate=retriableErrorPredicate;t.serverErrorPredicate=serverErrorPredicate;t.stringUtils=y;t.timeoutErrorPredicate=timeoutErrorPredicate;t.toFormValue=toFormValue;t.updatePredicate=updatePredicate;t.urlUtils=C;t.windowUtils=I},2928:(e,t,n)=>{"use strict";var i=n(36092);var o=n(68403);var s=n(12549);class BootstrapService{constructor(){this.logService=new s.LogService}bootstrap(){const e=window.smartedit;const t=(e.applications||[]).map((e=>({application:e,module:s.moduleUtils.getNgModule(e)}))).filter((e=>{if(!e.module){this.logService.info(`WARNING: Unable to find @NgModule for application ${e.application}`);this.logService.info("Here is the list of registered @NgModule:");this.logService.info(window.__smartedit__.modules)}return!!e.module})).map((e=>e.module));const n={[s.DOMAIN_TOKEN]:e.domain,smarteditroot:e.smarteditroot};document.body.appendChild(document.createElement(s.SMARTEDIT_COMPONENT_NAME));o.platformBrowserDynamic().bootstrapModule(window.__smartedit__.SmarteditFactory({modules:t,constants:n})).then((()=>{delete window.__smartedit__.SmarteditFactory})).catch((e=>this.logService.info(e)))}}const r=new BootstrapService;i((function(){r.bootstrap()}))},12549:(e,t,n)=>{"use strict";var i=n(36092);Object.defineProperty(t,"__esModule",{value:true});var o=n(32709);var s=n(22630);var r=n(43874);var a=n(20410);var l=n(12133);var c=n(54526);var d=n(51132);var p=n(67564);var u=n(30178);var m=n(48896);var h=n(38102);var g=n(93620);var _=n(66791);var v=n(9501);var S=n(38788);var y=n(37100);var C=n(64097);var f=n(19662);var E=n(70658);var I=n(84359);var b=n(94312);var O=n(26404);var P=n(67827);var w=n(20290);var A=n(47692);var R=n(39837);var D=n(78471);var M=n(10349);var N=n(12666);function _interopDefaultLegacy(e){return e&&typeof e==="object"&&"default"in e?e:{default:e}}function _interopNamespace(e){if(e&&e.__esModule)return e;var t=Object.create(null);if(e){Object.keys(e).forEach((function(n){if(n!=="default"){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:true,get:function(){return e[n]}})}}))}t["default"]=e;return Object.freeze(t)}var x=_interopNamespace(s);var F=_interopDefaultLegacy(r);var L=_interopDefaultLegacy(d);const SeEntryModule=function(e){return function(t){window.__smartedit__.modules[e]=t;return t}};function __decorate(e,t,n,i){var o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s;return o>3&&s&&Object.defineProperty(t,n,s),s}function __param(e,t){return function(n,i){t(n,i,e)}}function __metadata(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}function __awaiter(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))}class NodeUtils{collectSmarteditAttributesByElementUuid(e){const t=document.querySelector(`.smartEditComponent[data-smartedit-element-uuid='${e}']`);if(!t){throw new Error(`could not find element with uuid ${e}`)}return Array.from(t.attributes).reduce(((e,t)=>{let n=t.name;if(n.indexOf("smartedit-")>-1){n=s.camelCase(n.replace("data-",""));e[n]=t.value}return e}),{})}compareHTMLElementsPosition(e){return function(t,n){if(e){t=t[e];n=n[e]}if(t===n){return 0}if(!t.compareDocumentPosition){return t.sourceIndex-n.sourceIndex}if(t.compareDocumentPosition(n)&2){return 1}return-1}}isPointOverElement(e,t){const n=t.getBoundingClientRect();return e.x>=n.left&&e.x<=n.right&&e.y>=n.top&&e.y<=n.bottom}areIntersecting(e,t){return!(t.left>e.left+e.width||t.left+t.width<e.left||t.top>e.top+e.height||t.top+t.height<e.top)}injectJS(){function getInjector(){return F["default"]}return{getInjector,execute(e){const t=e.srcs;let n=e.index;const i=e.callback;if(!t.length){i();return}if(n===undefined){n=0}if(t[n]!==undefined){this.getInjector()(t[n],(()=>{if(n+1<t.length){this.execute({srcs:t,index:n+1,callback:i})}else if(typeof i==="function"){i()}}))}}}}}const U=new NodeUtils;const k=[];class AbstractDecorator{constructor(){k.push(this.smarteditElementuuid);const e=this.ngOnDestroy.bind(this);this.ngOnDestroy=()=>{e();k.splice(k.indexOf(this.smarteditElementuuid),1)}}set active(e){this._active=e==="true"}get active(){return this._active}static getScopes(){return k}get componentAttributes(){if(!this._cachedCcomponentAttributes){try{this._cachedCcomponentAttributes=U.collectSmarteditAttributesByElementUuid(this.smarteditElementuuid)}catch(e){console.log(`AbstratcDecorator failed to find original element with uuid ${this.smarteditElementuuid}`)}}return this._cachedCcomponentAttributes}ngOnDestroy(){}}__decorate([o.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],AbstractDecorator.prototype,"active",null);__decorate([o.Input("data-smartedit-element-uuid"),__metadata("design:type",String)],AbstractDecorator.prototype,"smarteditElementuuid",void 0);__decorate([o.Input("data-smartedit-component-id"),__metadata("design:type",String)],AbstractDecorator.prototype,"smarteditComponentId",void 0);__decorate([o.Input("data-smartedit-component-uuid"),__metadata("design:type",String)],AbstractDecorator.prototype,"smarteditComponentUuid",void 0);__decorate([o.Input("data-smartedit-component-type"),__metadata("design:type",String)],AbstractDecorator.prototype,"smarteditComponentType",void 0);__decorate([o.Input("data-smartedit-catalog-version-uuid"),__metadata("design:type",String)],AbstractDecorator.prototype,"smarteditCatalogVersionUuid",void 0);__decorate([o.Input("data-smartedit-container-id"),__metadata("design:type",String)],AbstractDecorator.prototype,"smarteditContainerId",void 0);__decorate([o.Input("data-smartedit-container-uuid"),__metadata("design:type",String)],AbstractDecorator.prototype,"smarteditContainerUuid",void 0);__decorate([o.Input("data-smartedit-container-type"),__metadata("design:type",String)],AbstractDecorator.prototype,"smarteditContainerType",void 0);class DINameUtils{buildComponentName(e){return this.buildName(e).replace(/Component$/,"").replace(/Directive$/,"")}buildServiceName(e){return this.buildName(e)}buildModuleName(e){return this.buildName(e).replace(/Module$/,"")}buildName(e){const t=a.annotationService.getOriginalConstructor(e);const n=a.functionsUtils.getConstructorName(t);return this.convertNameCasing(n)}convertNameCasing(e){const t=e.substring(0,1).toLowerCase()+e.substring(1);return t}}const V=new DINameUtils;const SeCustomComponent=function(){return function(e){const t=a.functionsUtils.getConstructorName(e);const n=window.__smartedit__.getDecoratorPayload("Component",e);if(!n){throw new Error(`@SeCustomComponent ${t} should only be used on a @Component decorated class`)}const i=parseComponentSelector(n.selector,e);e.selector=i;j.unshift(e);return e}};const parseComponentSelector=function(e,t){if(!e){return window.smarteditLodash.kebabCase(V.buildComponentName(t))}else{return e}};const j=[];function registerCustomComponents(e){j.forEach((t=>{if(!customElements.get(t.selector)){const n=l.createCustomElement(t,{injector:e});customElements.define(t.selector,n)}}))}const z=new o.InjectionToken("CONTEXTUAL_MENU_ITEM_DATA");class TruncatedText{constructor(e="",t="",n,i=""){this.text=e;this.truncatedText=t;this.truncated=n;this.ellipsis=i;this.text=this.text||"";this.truncatedText=this.truncatedText||""}getUntruncatedText(){return this.text}getTruncatedText(){return this.truncatedText+this.ellipsis}isTruncated(){return this.truncated}}var B;window.__smartedit__=window.__smartedit__||{};function getDecoratorKey(e,t){return`${e}-${t}:definition`}x.merge(window.__smartedit__,{modules:{},pushedModules:[],smarteditDecoratorPayloads:{},addDecoratorPayload(e,t,n){const i=getDecoratorKey(e,t);if(window.__smartedit__.smarteditDecoratorPayloads[i]){throw new Error("Duplicate class/decorator pair")}window.__smartedit__.smarteditDecoratorPayloads[i]=n},getDecoratorPayload(e,t){const n=a.functionsUtils.getConstructorName(a.annotationService.getOriginalConstructor(t));return window.__smartedit__.smarteditDecoratorPayloads[getDecoratorKey(e,n)]},getComponentDecoratorPayload(e){return window.__smartedit__.smarteditDecoratorPayloads[getDecoratorKey("Component",e)]},downgradedService:{}});window.pushModules=(...e)=>{window.__smartedit__.pushedModules=window.__smartedit__.pushedModules.concat(e)};t.WindowUtils=B=class WindowUtils extends a.WindowUtils{constructor(e){super(e);this.getGatewayTargetFrame=()=>{if(this._isInCypressIframe()){return this._getCypressFrame()}if(this.isIframe()){return this.getWindow().parent}if(this._isParentOfIframe()){return this._getSmarteditIframeFromWindow()}return null}}getSmarteditIframe(){return document.querySelector("iframe#"+B.SMARTEDIT_IFRAME_ID)}setTrustedIframeDomain(e){this.trustedIframeDomain=a.urlUtils.getOrigin(e)}getTrustedIframeDomain(){return this.trustedIframeDomain}isCrossOrigin(e){return a.urlUtils.getOrigin()!==a.urlUtils.getOrigin(e)}customTimeout(e,t){setTimeout((function(){e()}),t)}_getCypressFrame(){if(this.getWindow().parent.document.querySelector("iframe#"+B.SMARTEDIT_IFRAME_ID)){return this.getWindow().parent}return this._getSmarteditIframeFromWindow()}_getSmarteditIframeFromWindow(){const e=this.getWindow().document.getElementById(B.SMARTEDIT_IFRAME_ID);if(!!e){return e.contentWindow}return null}_isInCypressIframe(){try{const e=this.getWindow().top.document.querySelector("iframe");return e&&(e.id.includes(B.CYPRESS_IFRAME_ID_9)||e.id.includes(B.CYPRESS_IFRAME_ID_10))}catch(e){return false}}_isParentOfIframe(){return!!this._getSmarteditIframeFromWindow()}};t.WindowUtils.SMARTEDIT_IFRAME_ID="ySmartEditFrame";t.WindowUtils.CYPRESS_IFRAME_ID_9="Your App";t.WindowUtils.CYPRESS_IFRAME_ID_10="Your project: 'Test Project'";t.WindowUtils=B=__decorate([o.Injectable(),__metadata("design:paramtypes",[o.NgZone])],t.WindowUtils);const H=new t.WindowUtils;window.__smartedit__.addDecoratorPayload("Injectable","ModuleUtils",{providedIn:"root"});t.ModuleUtils=class ModuleUtils extends a.ModuleUtils{constructor(){super()}getNgModule(e){if(window.__smartedit__.modules){const t=Object.keys(window.__smartedit__.modules).find((t=>t.toLowerCase().endsWith(e.toLowerCase())||t.toLowerCase().endsWith(e.toLowerCase()+"module")));if(!t){return null}return window.__smartedit__.modules[t]}return null}};t.ModuleUtils=__decorate([o.Injectable({providedIn:"root"}),__metadata("design:paramtypes",[])],t.ModuleUtils);const G=new t.ModuleUtils;class StringUtils extends a.StringUtils{sanitizeHTML(e){if(W.isBlank(e)){return e}return e.replace(/(\r\n|\n|\r)/gm,"").replace(/>\s+</g,"><").replace(/<\/br\>/g,"")}generateIdentifier(){let e=(new Date).getTime();if(window.performance&&typeof window.performance.now==="function"){e+=window.performance.now()}const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const n=(e+Math.random()*16)%16|0;e=Math.floor(e/16);return(t==="x"?n:n&3|8).toString(16)}));return t}getEncodedString(e){return this.encode(e)}trim(e){return e.trim()}escapeHtml(e){if(typeof e==="string"){return e.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}return e}resourceLocationToRegex(e){return new RegExp(e.replace(/\/:[^\/]*/g,"/.*"))}}const W=new StringUtils;t.DiscardablePromiseUtils=class DiscardablePromiseUtils{constructor(e){this.logService=e;this._map={}}apply(e,t,n,i){if(!this._map[e]){this._map[e]={promise:t,successCallback:n,failureCallback:i}}else{this.logService.debug(`competing promise for key ${e}`);delete this._map[e].discardableHolder.successCallback;delete this._map[e].discardableHolder.failureCallback;this._map[e].promise=t}this._map[e].discardableHolder={successCallback:this._map[e].successCallback,failureCallback:this._map[e].failureCallback};const o=this;const s=this._map[e].promise;s.then(function(t){if(this.successCallback){delete o._map[e];this.successCallback.apply(undefined,[t])}else{o.logService.debug(`aborted successCallback for promise identified by ${e}`)}}.bind(this._map[e].discardableHolder),function(t){if(this.failureCallback){delete o._map[e];this.failureCallback.apply(undefined,[t])}else{o.logService.debug(`aborted failureCallback for promise identified by ${e}`)}}.bind(this._map[e].discardableHolder))}clear(e){if(this.exists(e)){delete this._map[e].discardableHolder.successCallback;delete this._map[e].discardableHolder.failureCallback}}exists(e){return this._map[e]?true:false}};t.DiscardablePromiseUtils=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.LogService])],t.DiscardablePromiseUtils);class SmarteditErrorHandler extends o.ErrorHandler{constructor(){super();this.ignorePatterns=[/Uncaught[\s]*\(in[\s]*promise\)/,/Unhandled[\s]*Promise[\s]*rejection/]}handleError(e){if(!e){return}if(false){}const t=e&&e.message?e.message:e;if(t&&this.ignorePatterns.some((e=>e.test(t.toString())))){return}if(e instanceof c.HttpErrorResponse&&e.status===401){return}super.handleError(e)}}const $="domain";const K="smarteditloader-component";const q="smarteditcontainer-component";const Y="smartedit-component";const Q="data-smartedit-element-uuid";const Z="data-smartedit-component-id";const X="data-smartedit-component-type";const J="ng";const ee="**";const te="logout";const ne=1e3;const ie="CURRENT_CONTEXT_CATALOG";const oe="CURRENT_CONTEXT_CATALOG_VERSION";const se="CURRENT_CONTEXT_SITE_ID";const re="CURRENT_PAGE_CONTEXT_CATALOG";const ae="CURRENT_PAGE_CONTEXT_CATALOG_VERSION";const le="CURRENT_PAGE_CONTEXT_SITE_ID";const ce="_SHOW_SLOT_MENU";const de="HIDE_SLOT_MENU";const pe="OVERLAY_DISABLED";const ue="en_US";const me="CLOSE_CTX_MENU";const he="CTX_MENU_DROPDOWN_IS_OPEN";t.MUTATION_CHILD_TYPES=void 0;(function(e){e["ADD_OPERATION"]="addedNodes";e["REMOVE_OPERATION"]="removedNodes"})(t.MUTATION_CHILD_TYPES||(t.MUTATION_CHILD_TYPES={}));const ge={CHILD_LIST:{NAME:"childList",ADD_OPERATION:t.MUTATION_CHILD_TYPES.ADD_OPERATION,REMOVE_OPERATION:t.MUTATION_CHILD_TYPES.REMOVE_OPERATION},ATTRIBUTES:{NAME:"attributes"}};const _e="/permissionswebservices/v1/permissions/catalogs/search";const ve={BACKGROUND_TASKS:"Background Tasks",INTERACTIVE:"Interactive",NON_INTERACTIVE:"Non-Interactive",BATCH_OPERATIONS:"Batch Operations",TOOLING:"Tooling",CMS:"CMS"};const Se="/smarteditwebservices/v1/i18n/translations";const ye="/authorizationserver/oauth/whoami";const Ce="smartedit";const fe="/samlsinglesignon/saml";const Ee="/smartedit/authenticate";const Ie="/samlsinglesignon/saml/logout";const be="/previewwebservices/v1/preview";const Te=/\/cmssmarteditwebservices|\/cmswebservices/;const Oe=/^(.*)\/smartedit/;const Pe="smartedit";const we="/smartedit/configuration";const Ae="/smartedit/settings";const Re="EVENT_NOTIFICATION_CHANGED";t.SortDirections=void 0;(function(e){e["Ascending"]="asc";e["Descending"]="desc"})(t.SortDirections||(t.SortDirections={}));const De="REFRESH_CONTEXTUAL_MENU_ITEMS_EVENT";const Me="previousUsername";const Ne={topLogoURL:"static-resources/images/SAP_R_grad.svg",bottomLogoURL:"static-resources/images/best-run-sap-logo.svg"};const xe="EVENT_PERSPECTIVE_CHANGED";const Fe="EVENT_PERSPECTIVE_UNLOADING";const Le="EVENT_PERSPECTIVE_REFRESHED";const Ue="EVENT_PERSPECTIVE_ADDED";const ke="EVENT_PERSPECTIVE_UPDATED";const Ve="EVENT_THEME_SAVED";const je="EVENT_THEME_CHANGED";const ze="EVENT_STRICT_PREVIEW_MODE_REQUESTED";const Be="perspectiveToolbar.perspectiveSelectorTemplate";const He="EVENT_SMARTEDIT_COMPONENT_UPDATED";const Ge="smarteditoverlay";const We="EVENT_OUTER_FRAME_CLICKED";const $e="EVENT_INNER_FRAME_CLICKED";const Ke="data-smartedit-catalog-version-uuid";const qe="smartEditComponent";const Ye="data-smartedit-container-id";const Qe={PROCESS:"processComponent",REMOVE:"removeComponent",KEEP_VISIBLE:"keepComponentVisible"};const Ze={PROCESS_COMPONENTS:"contractChangeListenerProcessComponents",RESTART_PROCESS:"contractChangeListenerRestartProcess"};const Xe="overlayRerendered";const Je="data-smartedit-";const et="smartEditComponentProcessStatus";const tt="data-smartedit-component-uuid";const nt="smartEditComponentX";const it="ContentSlot";const ot="data-smartedit-container-type";const st="/cmswebservices/v1/sites/:siteUID/languages";const rt="/smarteditwebservices/v1/i18n/languages";const at="genericEditorLoadedEvent";const lt="UnrelatedValidationMessagesEvent";const ct={VALIDATION_ERROR:"ValidationError",WARNING:"Warning"};const dt="/cmswebservices/v1/enums";const pt="DROPDOWN_IMPLEMENTATION_SUFFIX";const ut="LinkedDropdown";const mt="ClickDropdown";const ht="DropdownPopulator";const gt="/cmswebservices/v1/sites";const _t={ANGULAR_FORMAT:"short",MOMENT_FORMAT:"M/D/YY h:mm A",MOMENT_ISO:"YYYY-MM-DDTHH:mm:00ZZ",ISO:"yyyy-MM-ddTHH:mm:00Z",ANGULAR_SHORT:"M/d/yy h:mm a"};const vt={LEFT:"left",RIGHT:"right"};const St="/cmswebservices/v1/types";const yt="/storefront";const Ct="/cmssmarteditwebservices/v1/sites/:siteUID/products/:productUID";const ft="/cmssmarteditwebservices/v1/productcatalogs/:catalogId/versions/:catalogVersion/products";const Et="HIDE_TOOLBAR_ITEM_CONTEXT";const It="SHOW_TOOLBAR_ITEM_CONTEXT";const bt={DRAG_DROP_CROSS_ORIGIN_START:"DRAG_DROP_CROSS_ORIGIN_START",DRAG_DROP_START:"EVENT_DRAG_DROP_START",DRAG_DROP_END:"EVENT_DRAG_DROP_END",TRACK_MOUSE_POSITION:"EVENT_TRACK_MOUSE_POSITION",DROP_ELEMENT:"EVENT_DROP_ELEMENT"};const Tt="se.none";const Ot="se.all";const Pt=100;const wt=70;const At="smartedit-element-hovered";const Rt="ySECmsScrollArea";const Dt="ySmartEditFrameDragArea";const Mt={START:"START",END:"END"};const Nt="#js_iFrameWrapper";const xt=1e4;const Ft="EVENT_CONTENT_CATALOG_UPDATE";const Lt=[];const Ut=[];const kt=`/cmswebservices/v1/catalogs/${ie}/versions/${oe}/media`;const Vt=`/cmswebservices/v1/media`;const jt=`/cmswebservices/v1/catalogs/${ie}/versions/${oe}/medias`;const zt="experience";const Bt=`/cmswebservices/v1/mediafolders`;const Ht="OPEN_PAGE_WORKFLOW_MENU";const Gt="CMS_EVENT_OPEN_PAGE_WORKFLOW_MENU";const Wt="CMSITEMS_UPDATE";const $t=`/cmswebservices/v1/sites/${le}/catalogs/${re}/versions/${ae}/pagescontentslots`;const Kt="EVENT_PAGE_TREE_PANEL_SWITCH";const qt="EVENT_PAGE_TREE_SLOT_SELECTED";const Yt="EVENT_PAGE_TREE_COMPONENT_SELECTED";const Qt="EVENT_OPEN_IN_PAGE_TREE";const Zt="EVENT_PART_REFRESH_TREE_NODE";const Xt="EVENT_OVERALL_REFRESH_TREE_NODE";const Jt="EVENT_PAGE_TREE_SLOT_NEED_UPDATE";const en="PAGE_TREE_PANEL_WIDTH_COOKIE_NAME";const tn="PAGE_TREE_SLOT_EXPANDED_EVENT";const nn="se-page-tree-component-node";const on="/smarteditwebservices/v1/themes/currentUser/theme";const sn="/smarteditwebservices/v1/themes";const rn={NAVIGATION:"Function Navigation",PAGE_MANAGEMENT:"Page Management",NAVIGATION_MANAGEMENT:"Navigation Management",HEADER_TOOL:"Header Tool Bar",SELECT_PERSPECTIVE:"Perspective Select",TOOL_BAR:"Tool Bar",VERSION_OPERATION:"Version Operation",INFLECTION:"Inflection Select",ADD_COMPONENT:"Add Component",VERSION_MANAGEMENT:"Version Management",CONTEXT_MENU:"Contextual Menu",PAGE_STRUCTURE:"Page Structure"};const an=new Map([["se.cms.toolbaritem.navigationmenu.name","Navigation"],["se.cms.pagelist.title","Pages"],["se.route.storefront.title","Storefront"],["headerToolbar.configurationTemplate","Configuration"],["headerToolbar.languageSelectorTemplate","Language Select"],["headerToolbar.userAccountTemplate","User Account"],["se.cms.perspective.basic","Basic Edit"],["se.cms.perspective.versioning","Versioning"],["personalizationsmartedit.perspective","Personalization"],["se.cms.perspective.advanced","Advanced Edit"],["se.none","Preview"],["se.cms.componentMenuTemplate","Component"],["se.cms.pageTreeMenu",rn.PAGE_STRUCTURE],["personalizationsmartedit.container.pagecustomizations.toolbar","Personalize - Customization"],["personalizationsmartedit.container.combinedview.toolbar","Personlization - CombinedView"],["personalizationsmartedit.container.manager.toolbar","Personlization - Library"],["se.cms.createVersionMenu","Add Version"],["se.cms.clonePageMenu","Clone"],["se.cms.compomentmenu.tabs.componenttypes","Component Types"],["se.cms.compomentmenu.tabs.customizedcomp","Saved Components"],["se.cms.contextmenu.title.dragndrop","Drag and Drop"],["se.cms.contextmenu.title.edit","Edit"],["se.cms.contextmenu.title.remove","Remove"],["se.cms.contextmenu.title.clone.component","Clone"],["se.cms.pageVersionsMenu","Versions"],["se.cms.contextmenu.title.open.in.page.tree","Open In Page Tree"],["se.cms.version.item.menu.view.label","View"],["se.cms.version.item.menu.edit.label","Edit Details"],["se.cms.version.item.menu.rollback.label","Rollback To This Version"],["se.cms.version.item.menu.delete.label","Delete"],["se.cms.rollbackVersionMenu","Version Rollback"]]);function objectToArray(e){return Object.keys(e).reduce(((t,n)=>[...t||[],{key:n,value:e[n]}]),[])}class ObjectUtils{constructor(){this.isObjectEmptyDeep=e=>{if(x.isObject(e)){for(const t in e){if(e.hasOwnProperty(t)){if(!x.isEmpty(e[t])){return false}}}return true}return x.isString(e)?x.isEmpty(e):x.isNil(e)};this.resetObject=(e,t)=>{if(!e){e=this.copy(t)}else{for(const t in e){if(e.hasOwnProperty(t)){delete e[t]}}x.extend(e,this.copy(t))}return e};this.deepIterateOverObjectWith=(e,t)=>x.reduce(e,((e,n,i)=>{if(x.isPlainObject(n)){e[i]=this.deepIterateOverObjectWith(n,t)}else{e[i]=t(n)}return e}),{});this.deepObjectPropertyDiff=(e,t)=>{const n="CHANGED_PROPERTY";const i="NON_CHANGED_PROPERTY";const o=x.mergeWith(x.cloneDeep(e),t,(function(e,t){if(!x.isPlainObject(e)){return!x.isEqual(e,t)?n:i}return undefined}));const s=this.deepIterateOverObjectWith(o,(e=>{if(e!==n&&e!==i){return n}else{return e}}));return this.deepIterateOverObjectWith(s,(e=>e===n?true:false))};this.readObjectStructure=(e,t=0)=>{if(t>25){return this.getClassName(e)}if(e===undefined||e===null||e.then){return e}switch(typeof e){case"function":return"FUNCTION";case"string":return"STRING";case"number":return"NUMBER";case"boolean":return"BOOLEAN";default:return this._getOtherObjectType(e,t)}}}copy(e){return JSON.parse(JSON.stringify(e))}merge(e,t){return Object.assign(e,t)}convertToArray(e){const t=[];for(const n in e){if(!n.startsWith("$")&&!n.startsWith("toJSON")){t.push({key:n,value:e[n]})}}return t}uniqueArray(e,t){const n=new Set(e);t.forEach((t=>{if(!n.has(t)){e.push(t)}}));return e}isFunction(e){return typeof e==="function"}isObject(e){const t={boolean:false,function:true,object:true,number:false,string:false,undefined:false};return!!(e&&t[typeof e])}isTypedMap(e){return e&&this.isObject(e)&&e.constructor===Object}sortBy(e,t,n=false){const i=[...e];const o=n?-1:1;i.sort(((e,n)=>{const i=this.isTypedMap(e)?e[t]:e;const s=this.isTypedMap(n)?n[t]:n;const r=String(i).localeCompare(String(s),undefined,{numeric:true,sensitivity:"base"});return r*o}));return i}extend(e,t){if(!t){t=function(){return}}t.prototype=Object.create(e.prototype);return t}getClassName(e){return e&&e.constructor&&e.constructor.name&&e.constructor.name!=="Object"?e.constructor.name:null}_getOtherObjectType(e,t){if(x.isElement(e)){return"ELEMENT"}if(e.hasOwnProperty&&e.hasOwnProperty("length")){if(e.forEach){const n=[];e.forEach((e=>{t++;n.push(this.readObjectStructure(e,t))}));return n}else{return"JQUERY"}}if(e.constructor&&e.constructor.name&&e.constructor.name!=="Object"){return e.constructor.name}const n={};Object.keys(e).forEach((i=>{if(!i.startsWith("$")){t++;n[i]=this.readObjectStructure(e[i],t)}}));return n}}const ln=new ObjectUtils;class ApiUtils{getDataFromResponse(e){const t=Object.keys(e).filter((function(t){return e[t]instanceof Array}))[0];return e[t]}getKeyHoldingDataFromResponse(e){const t=Object.keys(e).filter((function(t){return e[t]instanceof Array}))[0];return t}}const cn=new ApiUtils;class DateUtils{formatDateAsUtc(e){return L["default"](e).utc().format(_t.MOMENT_ISO)}}const dn=new DateUtils;class ScriptUtils{injectJS(){function getInjector(){return F["default"]}return{getInjector,execute(e){const t=e.srcs;let n=e.index;const i=e.callback;if(!t.length){i();return}if(n===undefined){n=0}if(t[n]!==undefined){this.getInjector()(t[n],(()=>{if(n+1<t.length){this.execute({srcs:t,index:n+1,callback:i})}else if(typeof i==="function"){i()}}))}}}}}const pn=new ScriptUtils;t.Errors=void 0;(function(e){class ParseError{constructor(e){this.value=e}}e.ParseError=ParseError})(t.Errors||(t.Errors={}));const un=new o.InjectionToken("EXTENDED_VIEW_PORT_MARGIN");const mn=new o.InjectionToken("HEART_BEAT_TIMEOUT_THRESHOLD_MS");t.SystemEventService=class SystemEventService{constructor(e,t){this.logService=e;this.promiseUtils=t;this._eventHandlers={}}publish(e,t){if(!e){this.logService.error("Failed to send event. No event ID provided for data: "+t)}else{if(this._eventHandlers[e]&&this._eventHandlers[e].length>0){return this._invokeEventHandlers(e,t)}}return Promise.resolve()}publishAsync(e,t){return new Promise(((n,i)=>{setTimeout((()=>{this.publish(e,t).then((e=>n(e)),(e=>i(e)))}),0)}))}subscribe(e,t){let n;if(!e||!t){this.logService.error("Failed to subscribe event handler for event: "+e)}else{if(this._eventHandlers[e]===undefined){this._eventHandlers[e]=[]}this._eventHandlers[e].push(t);n=()=>{this._unsubscribe(e,t)}}return n}_unsubscribe(e,t){const n=this._eventHandlers[e];const i=n?this._eventHandlers[e].indexOf(t):-1;if(i>=0){this._eventHandlers[e].splice(i,1)}else{this.logService.warn(`Attempting to remove event handler for ${e} but handler not found.`)}}_invokeEventHandlers(e,t){return Promise.all(this._eventHandlers[e].map((n=>{const i=this.promiseUtils.toPromise(n);return i(e,t)}))).then((e=>Promise.resolve(e.pop())),(t=>Promise.reject(`eventId: ${e}, reason: ${t}`)))}};t.SystemEventService=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.LogService,a.PromiseUtils])],t.SystemEventService);class MessageGateway{constructor(e,t,n,i,o,s,r){this.logService=e;this.systemEventService=t;this.cloneableUtils=n;this.windowUtils=i;this.promiseUtils=o;this.TIMEOUT_TO_RETRY_PUBLISHING=s;this.gatewayId=r;this.PROMISE_ACKNOWLEDGEMENT_EVENT_ID="promiseAcknowledgement";this.PROMISE_RETURN_EVENT_ID="promiseReturn";this.SUCCESS="success";this.FAILURE="failure";this.MAX_RETRIES=5;this.promisesToResolve={}}publish(e,t,n=0,i){if(!e){return Promise.reject(`MessageGateway: Failed to send event. No event ID provided for _data: ${t}`)}const o=this.cloneableUtils.makeCloneable(t);if(!x.isEqual(o,t)){this.logService.debug(`MessageGateway.publish - Non cloneable payload has been sanitized for gateway ${this.gatewayId}, event ${e}:`,o)}const s=this.promisesToResolve[i]||this.promiseUtils.defer();const r=this.windowUtils.getGatewayTargetFrame();if(!r){s.reject("It is standalone. There is no iframe");return s.promise}i=i||this._generateIdentifier();try{r.postMessage({pk:i,eventId:e,data:o,gatewayId:this.gatewayId},"*")}catch(t){this.logService.error(t);this.logService.error(`MessageGateway.publish - postMessage has failed for gateway ${this.gatewayId} event ${e} and data `,o)}this.promisesToResolve[i]=s;this._setTimeout((()=>{if(!s.acknowledged&&e!==this.PROMISE_RETURN_EVENT_ID&&e!==this.PROMISE_ACKNOWLEDGEMENT_EVENT_ID){if(n<this.MAX_RETRIES){this.logService.debug(`${document.location.href} is retrying to publish event ${e}`);++n;this.publish(e,o,n,i).catch((e=>{}))}else{const t=`MessageGateway.publish - Not able to publish event ${e} after max retries for gateway ${this.gatewayId} and data ${JSON.stringify(o)}`;s.reject(t)}}}),this.TIMEOUT_TO_RETRY_PUBLISHING);return s.promise}subscribe(e,t){let n;if(!e){this.logService.error("MessageGateway: Failed to subscribe event handler for event: "+e)}else{const i=this._getSystemEventId(e);n=this.systemEventService.subscribe(i,t)}return n}processEvent(e){if(e.eventId!==this.PROMISE_RETURN_EVENT_ID&&e.eventId!==this.PROMISE_ACKNOWLEDGEMENT_EVENT_ID){return this._processEvent(e)}const t=e.data;if(e.eventId===this.PROMISE_RETURN_EVENT_ID){this._processPromiseReturnEvent(t)}else if(e.eventId===this.PROMISE_ACKNOWLEDGEMENT_EVENT_ID&&this.promisesToResolve[t.pk]){this.logService.debug(document.location.href,"received acknowledgement",e);this.promisesToResolve[t.pk].acknowledged=true}return Promise.resolve()}_processEvent(e){this.logService.debug(document.location.href,"sending acknowledgement for",e);this.publish(this.PROMISE_ACKNOWLEDGEMENT_EVENT_ID,{pk:e.pk});const t=this._getSystemEventId(e.eventId);return this.systemEventService.publishAsync(t,e.data).then((t=>{this.logService.debug(document.location.href,"sending promise resolve",e);return this.publish(this.PROMISE_RETURN_EVENT_ID,{pk:e.pk,type:this.SUCCESS,resolvedDataOfLastSubscriber:t})}),(t=>{this.logService.debug(document.location.href,"sending promise reject",e);return this.publish(this.PROMISE_RETURN_EVENT_ID,{pk:e.pk,type:this.FAILURE,rejectedDataOfLastSubscriber:t})}))}_processPromiseReturnEvent(e){if(this.promisesToResolve[e.pk]){if(e.type===this.SUCCESS){this.logService.debug(document.location.href,"received promise resolve");this.promisesToResolve[e.pk].resolve(e.resolvedDataOfLastSubscriber)}else if(e.type===this.FAILURE){this.logService.debug(document.location.href,"received promise reject");this.promisesToResolve[e.pk].reject(e.rejectedDataOfLastSubscriber)}delete this.promisesToResolve[e.pk]}}_setTimeout(e,t){if(a.functionsUtils.isUnitTestMode()){setTimeout(e,t)}else{this.windowUtils.runTimeoutOutsideAngular(e,t)}}_generateIdentifier(){return(new Date).getTime().toString()+Math.random().toString()}_getSystemEventId(e){return`${this.gatewayId}:${e}`}}var hn;t.GatewayFactory=hn=class GatewayFactory{constructor(e,t,n,i,o,s){this.logService=e;this.systemEventService=t;this.cloneableUtils=n;this.windowUtils=i;this.promiseUtils=o;this.functionsUtils=s;this.messageGatewayMap={}}initListener(){const e=[];this.windowUtils.getWindow().addEventListener("message",(t=>{if(t.origin==="https://sapinsights.eu.qualtrics.com"){this.logService.debug("qualtrics url "+t.origin+" should be allowed");return}if(this._isAllowed(t.origin)){const n=t.data;if(e.indexOf(n.pk)>-1){return}e.push(n.pk);this.logService.debug("message event handler called",n.eventId);const i=n.gatewayId;const o=this.messageGatewayMap[i];if(!o){this.logService.debug("Incoming message on gateway "+i+", but no destination exists.");return}o.processEvent(n)}else{this.logService.error("disallowed storefront is trying to communicate with smarteditcontainer")}}),false)}createGateway(e){if(this.messageGatewayMap[e]&&!this.functionsUtils.isUnitTestMode()){this.logService.error("Message Gateway for "+e+" already reserved");return null}this.messageGatewayMap[e]=new MessageGateway(this.logService,this.systemEventService,this.cloneableUtils,this.windowUtils,this.promiseUtils,hn.TIMEOUT_TO_RETRY_PUBLISHING,e);return this.messageGatewayMap[e]}_isAllowed(e){return this.windowUtils.isIframe()||this.windowUtils.getTrustedIframeDomain()===e}};t.GatewayFactory.TIMEOUT_TO_RETRY_PUBLISHING=500;t.GatewayFactory=hn=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.LogService,t.SystemEventService,a.CloneableUtils,t.WindowUtils,a.PromiseUtils,a.FunctionsUtils])],t.GatewayFactory);t.GatewayProxy=class GatewayProxy{constructor(e,t,n,i,o){this.logService=e;this.promiseUtils=t;this.stringUtils=n;this.functionsUtils=i;this.gatewayFactory=o;this.nonProxiableMethods=["getMethodForVoid","getMethodForSingleInstance","getMethodForArray"]}initForService(e,t,n){const i=n||e.gatewayId;if(!i){this.logService.error(`initForService() - service expected to have an associated gatewayId - methodsSubset: ${t&&t.length?t.join(","):[]}`);return null}const o=this.gatewayFactory.createGateway(i);let s=t;if(!s){s=this.functionsUtils.getInstanceMethods(e).filter((e=>!this._isNonProxiableMethod(e)))}s.forEach((t=>{if(typeof e[t]==="function"){if(this.functionsUtils.isEmpty(e[t])){this._turnToProxy(t,e,o)}else{e[t]=this.promiseUtils.toPromise(e[t],e);o.subscribe(t,this._onGatewayEvent.bind(null,t,e))}}}))}_isNonProxiableMethod(e){return this.nonProxiableMethods.indexOf(e)>-1||e.startsWith("$")||e==="lodash"||e==="jQuery"}_onGatewayEvent(e,t,n,i){return t[e].apply(t,i.arguments)}_turnToProxy(e,t,n){delete t[e];t[e]=(...t)=>n.publish(e,{arguments:t}).then((e=>{if(!this.stringUtils.isBlank(e)){delete e.$resolved;delete e.$promise}return e}),(i=>{if(i){this.logService.debug(`gatewayProxy - publish failed for gateway ${n.gatewayId} method ${e} and arguments ${t}`)}return Promise.reject(i)}))}};t.GatewayProxy=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.LogService,a.PromiseUtils,a.StringUtils,a.FunctionsUtils,t.GatewayFactory])],t.GatewayProxy);const gn=new o.InjectionToken("ANNOUNCEMENT_DATA");class IAnnouncementService{showAnnouncement(e){"proxyFunction";return null}closeAnnouncement(e){"proxyFunction";return null}}class ICatalogService{retrieveUriContext(e){"proxyFunction";return null}getContentCatalogsForSite(e){"proxyFunction";return null}getAllContentCatalogsGroupedById(){"proxyFunction";return null}getCatalogByVersion(e,t){"proxyFunction";return null}isContentCatalogVersionNonActive(e){"proxyFunction";return null}getContentCatalogActiveVersion(e){"proxyFunction";return null}getActiveContentCatalogVersionByCatalogId(e){"proxyFunction";return null}getCurrentSiteID(){"proxyFunction";return null}getDefaultSiteForContentCatalog(e){"proxyFunction";return null}getContentCatalogVersion(e){"proxyFunction";return null}getCatalogVersionByUuid(e,t){"proxyFunction";return null}getCatalogVersionUUid(e){"proxyFunction";return null}getProductCatalogsBySiteKey(e){"proxyFunction";return null}getProductCatalogsForSite(e){"proxyFunction";return null}getActiveProductCatalogVersionByCatalogId(e){"proxyFunction";return null}returnActiveCatalogVersionUIDs(e){"proxyFunction";return null}isCurrentCatalogMultiCountry(){"proxyFunction";return null}}class IExperienceService{updateExperiencePageContext(e,t){"proxyFunction";return null}getCurrentExperience(){"proxyFunction";return null}setCurrentExperience(e){"proxyFunction";return null}hasCatalogVersionChanged(){"proxyFunction";return null}buildRefreshedPreviewUrl(){"proxyFunction";return null}updateExperience(e){"proxyFunction";return null}loadExperience(e){"proxyFunction";return null}compareWithCurrentExperience(e){"proxyFunction";return null}_convertExperienceToPreviewData(e,t){const n=x.cloneDeep(e);const i=[];delete n.catalogDescriptor;delete n.siteDescriptor;delete n.languageDescriptor;delete n.pageContext;delete n.productCatalogVersions;if(e.productCatalogVersions&&e.productCatalogVersions.length){e.productCatalogVersions.forEach((e=>{i.push({catalog:e.catalog,catalogVersion:e.catalogVersion})}))}i.push({catalog:e.catalogDescriptor.catalogId,catalogVersion:e.catalogDescriptor.catalogVersion});n.catalogVersions=i;n.language=e.languageDescriptor.isocode;n.resourcePath=t;n.siteId=e.siteDescriptor.uid;return n}initializeExperience(){"proxyFunction";return null}buildAndSetExperience(e){"proxyFunction";return null}}class IFeatureService{constructor(e,t){this.cloneableUtils=e;this.logService=t}register(e){this._validate(e);this._featuresToAlias=this._featuresToAlias||{};this._featuresToAlias[e.key]={enablingCallback:e.enablingCallback,disablingCallback:e.disablingCallback};delete e.enablingCallback;delete e.disablingCallback;return this._registerAliases(this.cloneableUtils.makeCloneable(e))}enable(e){if(this._featuresToAlias&&this._featuresToAlias[e]){this._featuresToAlias[e].enablingCallback()}else{this._remoteEnablingFromInner(e)}}disable(e){if(this._featuresToAlias&&this._featuresToAlias[e]){this._featuresToAlias[e].disablingCallback()}else{this._remoteDisablingFromInner(e).catch((e=>{this.logService.debug(`IFeatureService - disable: ${JSON.stringify(e)}`)}))}}getFeatureProperty(e,t){"proxyFunction";return null}addToolbarItem(e){"proxyFunction";return null}addDecorator(e){"proxyFunction";return null}addContextualMenuButton(e){"proxyFunction";return null}getFeatureKeys(){"proxyFunction";return null}_remoteEnablingFromInner(e){"proxyFunction";return null}_remoteDisablingFromInner(e){"proxyFunction";return null}_registerAliases(e){"proxyFunction";return null}_validate(e){if(x.isEmpty(e.key)){throw new Error("featureService.configuration.key.error.required")}if(x.isEmpty(e.nameI18nKey)){throw new Error("featureService.configuration.nameI18nKey.error.required")}if(!x.isFunction(e.enablingCallback)){throw new Error("featureService.configuration.enablingCallback.error.not.function")}if(!x.isFunction(e.disablingCallback)){throw new Error("featureService.configuration.disablingCallback.error.not.function")}}}class INotificationMouseLeaveDetectionService{startDetection(e,t,n){"proxyFunction";return null}stopDetection(){"proxyFunction";return null}_remoteStartDetection(e){"proxyFunction";return null}_remoteStopDetection(){"proxyFunction";return null}_callCallback(){"proxyFunction";return null}_onMouseMove(e){this._getBounds().then((t=>{const n=t&&e&&(e.clientX<t.x||e.clientX>t.x+t.width);const i=t&&e&&(e.clientY<t.y||e.clientY>t.y+t.height);if(n||i){this._onMouseLeave()}}))}_getBounds(){"proxyFunction";return null}_getCallback(){"proxyFunction";return null}_onMouseLeave(){this._getCallback().then((e=>{if(e){e();this.stopDetection()}else{this._callCallback().then((()=>{this.stopDetection()}))}}))}}class INotificationService{pushNotification(e){"proxyFunction";return null}removeNotification(e){"proxyFunction";return null}removeAllNotifications(){"proxyFunction";return null}}class IPageInfoService{getPageUID(){"proxyFunction";return null}getPageUUID(){"proxyFunction";return null}getCatalogVersionUUIDFromPage(){"proxyFunction";return null}isSameCatalogVersionOfPageAndPageTemplate(){"proxyFunction";return null}}class IPreviewService{constructor(e){this.urlUtils=e}createPreview(e){"proxyFunction";return null}updatePreview(e){"proxyFunction";return null}getResourcePathFromPreviewUrl(e){"proxyFunction";return null}updateUrlWithNewPreviewTicketId(e,t){return this.createPreview(t).then((t=>this.urlUtils.updateUrlParameter(e,"cmsTicketId",t.ticketId)))}}class IUrlService{openUrlInPopup(e){"proxyFunction";return null}path(e){"proxyFunction";return null}buildUriContext(e,t,n){const i={};i[se]=e;i[ie]=t;i[oe]=n;return i}buildPageUriContext(e,t,n){const i={};i[le]=e;i[re]=t;i[ae]=n;return i}}class IWaitDialogService{showWaitModal(e){"proxyFunction";return null}hideWaitModal(){"proxyFunction";return null}}class IIframeClickDetectionService{onIframeClick(){"proxyFunction";return null}registerCallback(e,t){"proxyFunction";return null}removeCallback(e){"proxyFunction"}}const prepareRuleConfiguration=function(e){this.ruleVerifyFunctions=this.ruleVerifyFunctions||{};this.ruleVerifyFunctions[e.names.join("-")]={verify:e.verify};delete e.verify;return e};const validateRule=function(e){if(!(e.names instanceof Array)){throw Error("Rule names must be array")}if(e.names.length<1){throw Error("Rule requires at least one name")}if(!e.verify){throw Error("Rule requires a verify function")}if(typeof e.verify!=="function"){throw Error("Rule verify must be a function")}};class IPermissionService{clearCache(){"proxyFunction";return}getPermission(e){"proxyFunction";return null}isPermitted(e){"proxyFunction";return null}registerPermission(e){"proxyFunction";return}registerRule(e){validateRule(e);e=prepareRuleConfiguration.bind(this)(e);this._registerRule(e)}registerDefaultRule(e){e=prepareRuleConfiguration.bind(this)(e);this._registerDefaultRule(e)}unregisterDefaultRule(){"proxyFunction";return}_registerRule(e){"proxyFunction";return}_registerDefaultRule(e){"proxyFunction";return}}class IResizeListener{unregister(e){"proxyFunction"}fix(e){"proxyFunction"}register(e,t){"proxyFunction"}init(){"proxyFunction"}dispose(){"proxyFunction"}}class IPositionRegistry{register(e){"proxyFunction"}unregister(e){"proxyFunction"}getRepositionedComponents(){"proxyFunction";return null}dispose(){"proxyFunction"}}class IRenderService{constructor(e,t,n,i,o,s,r,a,l){this.yjQuery=e;this.systemEventService=t;this.notificationService=n;this.pageInfoService=i;this.perspectiveService=o;this.crossFrameEventService=s;this.windowUtils=r;this.modalService=a;this.logService=l;this.KEY_CODES={ESC:27};this.HOTKEY_NOTIFICATION_CONFIGURATION={id:"HOTKEY_NOTIFICATION_ID",componentName:"PerspectiveSelectorHotkeyNotificationComponent"};this._bindEvents()}renderSlots(e){"proxyFunction";return null}renderComponent(e,t){"proxyFunction";return null}renderRemoval(e,t,n){"proxyFunction";return null}renderPage(e){"proxyFunction";return null}toggleOverlay(e){"proxyFunction";return null}refreshOverlayDimensions(){"proxyFunction";return null}blockRendering(e){"proxyFunction";return null}isRenderingBlocked(){"proxyFunction";return null}createComponent(e){"proxyFunction";return null}destroyComponent(e,t,n){"proxyFunction";return null}updateComponentSizeAndPosition(e,t){"proxyFunction";return null}_getDocument(){return document}_bindEvents(){this._getDocument().addEventListener("keyup",(e=>this._keyUpEventHandler(e)));this._getDocument().addEventListener("click",(()=>this._clickEvent()))}_keyUpEventHandler(e){if(!this._areAllModalWindowsClosed()){return Promise.resolve()}return this._shouldEnableKeyPressEvent(e).then((e=>{if(e){this._keyPressEvent()}}))}_shouldEnableKeyPressEvent(e){return new Promise((t=>this.pageInfoService.getPageUUID().then((n=>{if(n){return this.perspectiveService.isHotkeyEnabledForActivePerspective().then((n=>t(e.which===this.KEY_CODES.ESC&&n)))}return t(false)})).catch((()=>t(false)))))}_keyPressEvent(){this.isRenderingBlocked().then((e=>{if(!e){this.blockRendering(true);this.renderPage(false);this.notificationService.pushNotification(this.HOTKEY_NOTIFICATION_CONFIGURATION);this.systemEventService.publishAsync("OVERLAY_DISABLED")}else{this.blockRendering(false);this.renderPage(true);this.notificationService.removeNotification(this.HOTKEY_NOTIFICATION_CONFIGURATION.id)}}))}_clickEvent(){if(!this.windowUtils.isIframe()){this.crossFrameEventService.publish(We).catch((e=>{this.logService.debug(`IRenderService - _clickEvent: ${e}`)}))}else if(this.windowUtils.isIframe()){this.crossFrameEventService.publish($e).catch((e=>{this.logService.debug(`IRenderService - _clickEvent: ${e}`)}))}return this.isRenderingBlocked().then((e=>{if(e&&!this.windowUtils.isIframe()){this.blockRendering(false);this.renderPage(true);return this.notificationService.removeNotification(this.HOTKEY_NOTIFICATION_CONFIGURATION.id)}return null}))}_areAllModalWindowsClosed(){return!this.modalService.hasOpenModals()}}class IToolbarServiceFactory{getToolbarService(e){"proxyFunction";return null}}class IConfirmationModalService{confirm(e){"proxyFunction";return Promise.resolve(true)}}class ICatalogVersionPermissionService{hasWritePermission(e,t){"proxyFunction";return null}hasReadPermission(e,t){"proxyFunction";return null}hasWritePermissionOnCurrent(){"proxyFunction";return null}hasReadPermissionOnCurrent(){"proxyFunction";return null}hasSyncPermission(e,t,n){"proxyFunction";return null}hasSyncPermissionFromCurrentToActiveCatalogVersion(){"proxyFunction";return null}hasSyncPermissionToActiveCatalogVersion(e,t){"proxyFunction";return null}}class IDecoratorService{addMappings(e){"proxyFunction"}enable(e,t){"proxyFunction"}disable(e){"proxyFunction"}getDecoratorsForComponent(e,t){"proxyFunction";return null}}class IRestServiceFactory{get(e,t){"proxyFunction";return null}setDomain(e){"proxyFunction"}setBasePath(e){"proxyFunction"}setGlobalBasePath(e){"proxyFunction"}}class IDragAndDropCrossOrigin{initialize(){"proxyFunction"}}class IContextualMenuService{addItems(e){"proxyFunction"}removeItemByKey(e){"proxyFunction"}containsItem(e){"proxyFunction";return null}getContextualMenuByType(e){"proxyFunction";return null}refreshMenuItems(){"proxyFunction"}getContextualMenuItems(e){return null}}class ICatalogDetailsService{addItems(e,t){"proxyFunction"}getItems(){"proxyFunction";return null}}class ISmartEditContractChangeListener{_newMutationObserver(e){return null}_newIntersectionObserver(e){return null}_addToComponentQueue(e){return null}_componentsQueueLength(){return null}isExtendedViewEnabled(){return null}setEconomyMode(e){return null}initListener(){return null}_processQueue(){return null}isIntersecting(e){return null}_rawProcessQueue(){return null}_addComponents(e){return null}_removeComponents(e,t=false){return null}_registerSizeAndPositionListeners(e){return null}_unregisterSizeAndPositionListeners(e){return null}stopListener(){return null}_stopExpendableListeners(){return null}_startExpendableListeners(){return null}onComponentsAdded(e){return null}onComponentsRemoved(e){return null}onComponentChanged(e){return null}onComponentResized(e){return null}onComponentRepositioned(e){return null}onPageChanged(e){return null}}t.COMPONENT_IN_SLOT_STATUS=void 0;(function(e){e["ALLOWED"]="allowed";e["DISALLOWED"]="disallowed";e["MAYBEALLOWED"]="mayBeAllowed"})(t.COMPONENT_IN_SLOT_STATUS||(t.COMPONENT_IN_SLOT_STATUS={}));class ISlotRestrictionsService{getAllComponentTypesSupportedOnPage(){"proxyFunction";return null}getSlotRestrictions(e){"proxyFunction";return null}isSlotEditable(e){"proxyFunction";return null}isComponentAllowedInSlot(e,t){"proxyFunction";return null}determineComponentStatusInSlot(e,t){"proxyFunction";return null}}t.CMSPageTypes=void 0;(function(e){e["ContentPage"]="ContentPage";e["CategoryPage"]="CategoryPage";e["ProductPage"]="ProductPage";e["EmailPage"]="EmailPage"})(t.CMSPageTypes||(t.CMSPageTypes={}));t.CMSPageStatus=void 0;(function(e){e["ACTIVE"]="ACTIVE";e["DELETED"]="DELETED"})(t.CMSPageStatus||(t.CMSPageStatus={}));t.CmsApprovalStatus=void 0;(function(e){e["APPROVED"]="APPROVED";e["CHECK"]="CHECK";e["UNAPPROVED"]="UNAPPROVED"})(t.CmsApprovalStatus||(t.CmsApprovalStatus={}));class IPageService{getPageById(e){"proxyFunction";return null}getPageByUuid(e){"proxyFunction";return null}getCurrentPageInfo(){"proxyFunction";return null}getCurrentPageInfoByVersion(e){"proxyFunction";return null}isPagePrimary(e){"proxyFunction";return null}isPagePrimaryWithContext(e,t){"proxyFunction";return null}getPrimaryPage(e){"proxyFunction";return null}primaryPageForPageTypeExists(e,t){"proxyFunction";return null}getPaginatedPrimaryPagesForPageType(e,t,n){"proxyFunction";return null}getVariationPages(e){"proxyFunction";return null}updatePageById(e,t){"proxyFunction";return null}forcePageApprovalStatus(e){"proxyFunction";return null}isPageApproved(e){"proxyFunction";return null}buildUriContextForCurrentPage(e,t,n){"proxyFunction";return null}}t.JOB_STATUS=void 0;(function(e){e["RUNNING"]="RUNNING";e["ERROR"]="ERROR";e["FAILURE"]="FAILURE";e["FINISHED"]="FINISHED";e["UNKNOWN"]="UNKNOWN";e["ABORTED"]="ABORTED";e["PENDING"]="PENDING"})(t.JOB_STATUS||(t.JOB_STATUS={}));class ISyncPollingService{registerSyncPollingEvents(){"proxyFunction";return null}changePollingSpeed(e,t){"proxyFunction";return null}fetchSyncStatus(e,t){"proxyFunction";return null}performSync(e,t){"proxyFunction";return null}getSyncStatus(e,t,n){"proxyFunction";return null}}class IEditorModalService{open(e,t,n,i,o,s,r){"proxyFunction";return null}openAndRerenderSlot(e,t,n,i,o,s){"proxyFunction";return null}openGenericEditor(e,t,n,i){"proxyFunction";return null}}class IPageTreeNodeService{constructor(){this.slotNodes=[]}buildSlotNodes(){"proxyFunction"}updateSlotNodes(e){"proxyFunction"}getSlotNodes(){"proxyFunction";return null}scrollToElement(e){"proxyFunction";return null}existedSmartEditElement(e){"proxyFunction";return null}handleBodyWidthChange(){"proxyFunction";return null}_buildSlotNode(e){"proxyFunction";return null}_isValidElement(e){"proxyFunction";return true}}class IPageTreeService{registerTreeComponent(e){"proxyFunction";return null}getTreeComponent(){"proxyFunction";return null}}class IFileValidation{buildAcceptedFileTypesList(){"proxyFunction";return null}validate(e,t,n){"proxyFunction";return null}}class IUserTrackingService{initConfiguration(){"proxyFunction";return null}trackingUserAction(e,t){"proxyFunction"}}class IMediaToUpload{uploadMedia(e){return null}}class IMediaService{getPage(e,t,n,i){return null}getMedia(e){return null}}const _n=new o.InjectionToken("WIZARD_MANAGER");const vn=new o.InjectionToken("WIZARD_API");class WizardService{constructor(e,t){this.defaultWizardActionStrategy=e;this.stringUtils=t;this.onLoadStep=function(e,t){return};this.onClose=function(e){return};this.onCancel=function(){return};this.onStepsUpdated=function(e){return}}initialize(e){this.validateConfig(e);this._actionStrategy=e.actionStrategy||this.defaultWizardActionStrategy;this._actionStrategy.applyStrategy(this,e);this._currentIndex=0;this._conf=Object.assign({},e);this._steps=this._conf.steps;this._getResult=e.resultFn;this.validateStepUids(this._steps);this.goToStepWithIndex(0)}executeAction(e){if(e.executeIfCondition){const t=e.executeIfCondition();return(t instanceof Promise?t:Promise.resolve(t)).then((()=>e.execute(this)))}return Promise.resolve(e.execute(this))}goToStepWithIndex(e){const t=this.getStepWithIndex(e);if(t){this.onLoadStep(e,t);this._currentIndex=e}}goToStepWithId(e){this.goToStepWithIndex(this.getStepIndexFromId(e))}addStep(e,t){if(parseInt(e.id,10)!==0&&!e.id){e.id=this.stringUtils.generateIdentifier()}if(!t){t=0}if(this._currentIndex>=t){this._currentIndex++}this._steps.splice(t,0,e);this.validateStepUids(this._steps);this._actionStrategy.applyStrategy(this,this._conf);this.onStepsUpdated(this._steps)}removeStepById(e){this.removeStepByIndex(this.getStepIndexFromId(e))}removeStepByIndex(e){if(e>=0&&e<this.getStepsCount()){this._steps.splice(e,1);if(e===this._currentIndex){this.goToStepWithIndex(0)}this._actionStrategy.applyStrategy(this,this._conf);this.onStepsUpdated(this._steps)}}close(){let e;if(typeof this._getResult==="function"){e=this._getResult()}this.onClose(e)}cancel(){this.onCancel()}getSteps(){return this._steps}getStepIndexFromId(e){const t=this._steps.findIndex((t=>t.id===e));return t}containsStep(e){return this.getStepIndexFromId(e)>=0}getCurrentStepId(){return this.getCurrentStep().id}getCurrentStepIndex(){return this._currentIndex}getCurrentStep(){return this.getStepWithIndex(this._currentIndex)}getStepsCount(){return this._steps.length}getStepWithId(e){const t=this.getStepIndexFromId(e);if(t>=0){return this.getStepWithIndex(t)}return null}getStepWithIndex(e){if(e>=0&&e<this.getStepsCount()){return this._steps[e]}throw new Error("wizardService.getStepForIndex - Index out of bounds: "+e)}validateConfig(e){if(!e.steps||e.steps.length<=0){throw new Error("Invalid WizardService configuration - no steps provided")}}validateStepUids(e){const t={};e.forEach((e=>{if(!e.id){e.id=this.stringUtils.generateIdentifier()}else if(t[e.id]){throw new Error(`Invalid (Duplicate) step id: ${e.id}`)}else{t[e.id]=e.id}}))}}const Sn={id:"wizard_action_id",i18n:"wizard_action_label",isMainAction:true,enableIfCondition(){return true},executeIfCondition(){return true},execute(e){return}};class WizardActions{customAction(e){return this.createNewAction(e)}done(e){const t={id:"ACTION_SAVE",i18n:"se.action.save",execute:e=>{e.close()}};return this.createNewAction(e,t)}next(e){const t={id:"ACTION_NEXT",i18n:"se.action.next",execute(e){e.goToStepWithIndex(e.getCurrentStepIndex()+1)}};return this.createNewAction(e,t)}navBarAction(e){if(!e.wizardService||e.destinationIndex===null){throw new Error("Error initializating navBarAction, must provide the wizardService and destinationIndex fields")}const t={id:"ACTION_GOTO",i18n:"action.goto",enableIfCondition:()=>e.wizardService.getCurrentStepIndex()>=e.destinationIndex,execute:t=>{t.goToStepWithIndex(e.destinationIndex)}};return this.createNewAction(e,t)}back(e){const t={id:"ACTION_PREVIOUS",i18n:"se.action.previous",isMainAction:false,execute(e){const t=e.getCurrentStepIndex();if(t<=0){throw new Error("Failure to execute BACK action, no previous index exists!")}e.goToStepWithIndex(t-1)}};return this.createNewAction(e,t)}cancel(){return this.createNewAction({id:"ACTION_CANCEL",i18n:"se.action.cancel",isMainAction:false,execute(e){e.cancel()}})}createNewAction(e=null,t=null){return Object.assign(Object.assign(Object.assign({},Sn),t),e)}}let yn=class DefaultWizardActionStrategy{constructor(e){this.wizardActions=e}applyStrategy(e,t){const n=this.applyOverrides(e,this.wizardActions.next(),t.nextLabel,t.onNext,t.isFormValid);const i=this.applyOverrides(e,this.wizardActions.done(),t.doneLabel,t.onDone,t.isFormValid);const o=t.backLabel?{i18n:t.backLabel}:null;const s=this.wizardActions.back(o);t.steps.forEach(((e,o)=>{e.actions=[];if(o>0){e.actions.push(s)}if(o===t.steps.length-1){e.actions.push(i)}else{e.actions.push(n)}}));t.cancelAction=this.applyOverrides(e,this.wizardActions.cancel(),t.cancelLabel,t.onCancel,null);t.templateOverride="modalWizardNavBarTemplate.html"}applyOverrides(e,t,n,i,o){if(n){t.i18n=n}if(i){t.executeIfCondition=function(){return i(e.getCurrentStepId())}}if(o){t.enableIfCondition=function(){return o(e.getCurrentStepId())}}return t}};yn=__decorate([o.Injectable(),__metadata("design:paramtypes",[WizardActions])],yn);window.__smartedit__.addDecoratorPayload("Component","ModalWizardTemplateComponent",{selector:"se-modal-wizard-template",template:`\n        <div id="yModalWizard">\n            <div class="se-modal-wizard-template">\n                <se-modal-wizard-nav-bar\n                    [navActions]="_wizardContext?.navActions"\n                    (executeAction)="executeAction($event)"></se-modal-wizard-nav-bar>\n                <se-modal-wizard-step-outlet\n                    [steps]="_wizardContext?._steps"\n                    [wizardService]="wizardService"\n                    [wizardApiInjector]="wizardInjector"></se-modal-wizard-step-outlet>\n            </div>\n        </div>\n    `});t.ModalWizardTemplateComponent=class ModalWizardTemplateComponent{constructor(e,t,n,i,o){this.modalManager=e;this.wizardActions=t;this.defaultWizardActionStrategy=n;this.componentFactoryResolver=i;this.injector=o}ngOnInit(){this.modalManager.getModalData().subscribe((e=>{this.wizardService=new WizardService(this.defaultWizardActionStrategy,W);this.wizardService.properties=e.properties;if(e.component){this.createWizardApiInjector(e)}if(typeof this.getWizardConfig!=="function"){throw new Error("The provided controller must provide a getWizardConfig() function.")}const t=this.getWizardConfig();this._wizardContext={_steps:t.steps};this.executeAction=e=>{this.wizardService.executeAction(e)};this.wizardService.onLoadStep=(e,t)=>{this.modalManager.setTitle(t.title);if(t.component){this._wizardContext.component=t.component}this.modalManager.removeAllButtons();const n=(t.actions||[]).map((e=>this.convertActionToButtonConf(e)));this.modalManager.addButtons(n)};this.wizardService.onClose=e=>{this.modalManager.close(e)};this.wizardService.onCancel=()=>{this.modalManager.close()};this.wizardService.onStepsUpdated=e=>{this.setupNavBar(e);this._wizardContext._steps=e};this.wizardService.initialize(t);this.setupModal(t)}))}setupNavBar(e){this._wizardContext.navActions=e.map(((e,t)=>{const n=this.wizardActions.navBarAction({id:"NAV-"+e.id,stepIndex:t,wizardService:this.wizardService,destinationIndex:t,i18n:e.name,isCurrentStep:()=>n.stepIndex===this.wizardService.getCurrentStepIndex()});return n}))}setupModal(e){this._wizardContext.templateOverride=e.templateOverride;if(e.cancelAction){this.modalManager.setDismissCallback((()=>this.wizardService.executeAction(e.cancelAction)))}this.setupNavBar(e.steps)}convertActionToButtonConf(e){return{id:e.id,style:e.isMainAction?a.ModalButtonStyle.Primary:a.ModalButtonStyle.Default,label:e.i18n,action:a.ModalButtonAction.None,disabledFn:()=>!e.enableIfCondition(),callback:()=>{this.wizardService.executeAction(e);return p.of(null)}}}createWizardApiInjector(e){const t=o.Injector.create({providers:[{provide:_n,useValue:this.wizardService}],parent:this.injector});const n=this.componentFactoryResolver.resolveComponentFactory(e.component);const i=n.create(t).instance;x.assign(this,i);this.wizardInjector=o.Injector.create({providers:[{provide:vn,useValue:i}],parent:this.injector})}};t.ModalWizardTemplateComponent=__decorate([o.Component({selector:"se-modal-wizard-template",template:`\n        <div id="yModalWizard">\n            <div class="se-modal-wizard-template">\n                <se-modal-wizard-nav-bar\n                    [navActions]="_wizardContext?.navActions"\n                    (executeAction)="executeAction($event)"></se-modal-wizard-nav-bar>\n                <se-modal-wizard-step-outlet\n                    [steps]="_wizardContext?._steps"\n                    [wizardService]="wizardService"\n                    [wizardApiInjector]="wizardInjector"></se-modal-wizard-step-outlet>\n            </div>\n        </div>\n    `}),__metadata("design:paramtypes",[a.ModalManagerService,WizardActions,yn,o.ComponentFactoryResolver,o.Injector])],t.ModalWizardTemplateComponent);t.ModalWizard=class ModalWizard{constructor(e){this.modalService=e}open(e){this.validateConfig(e);return new Promise(((n,i)=>{const o=this.modalService.open({component:t.ModalWizardTemplateComponent,templateConfig:{isDismissButtonVisible:true},data:e,config:{focusTrapped:false,backdropClickCloseable:false,dialogPanelClass:"se-wizard-dialog"}});o.afterClosed.subscribe(n,i)}))}validateConfig(e){if(!e.controller&&!e.component){throw new Error("WizardService - initialization exception. No controller nor component provided")}if(e.controller&&e.component){throw new Error("WizardService - initialization exception. Provide either controller or component")}}};t.ModalWizard=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.IModalService])],t.ModalWizard);window.__smartedit__.addDecoratorPayload("Component","ModalWizardNavBarComponent",{selector:"se-modal-wizard-nav-bar",template:`\n        <div class="se-modal-wizard__steps-container" *ngIf="navActions">\n            <fd-wizard [appendToWizard]="false" [displaySummaryStep]="true">\n                <fd-wizard-navigation>\n                    <ul fd-wizard-progress-bar size="md">\n                        <li\n                            [attr.id]="action.id"\n                            fd-wizard-step\n                            *ngFor="let action of navActions; let i = index"\n                            [status]="\n                                action.isCurrentStep()\n                                    ? 'current'\n                                    : action.enableIfCondition()\n                                    ? 'completed'\n                                    : 'upcoming'\n                            "\n                            [ngClass]="{ 'se-none-cursor': !action.enableIfCondition() }"\n                            [label]="action.i18n | translate"\n                            (click)="onClickAction(action)">\n                            <fd-wizard-step-indicator>{{ i + 1 }}</fd-wizard-step-indicator>\n                            <fd-wizard-content size="md"> </fd-wizard-content>\n                        </li>\n                    </ul>\n                </fd-wizard-navigation>\n            </fd-wizard>\n        </div>\n    `});t.ModalWizardNavBarComponent=class ModalWizardNavBarComponent{constructor(){this.executeAction=new o.EventEmitter}onClickAction(e){this.executeAction.emit(e)}};__decorate([o.Input(),__metadata("design:type",Array)],t.ModalWizardNavBarComponent.prototype,"navActions",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.ModalWizardNavBarComponent.prototype,"executeAction",void 0);t.ModalWizardNavBarComponent=__decorate([o.Component({selector:"se-modal-wizard-nav-bar",template:`\n        <div class="se-modal-wizard__steps-container" *ngIf="navActions">\n            <fd-wizard [appendToWizard]="false" [displaySummaryStep]="true">\n                <fd-wizard-navigation>\n                    <ul fd-wizard-progress-bar size="md">\n                        <li\n                            [attr.id]="action.id"\n                            fd-wizard-step\n                            *ngFor="let action of navActions; let i = index"\n                            [status]="\n                                action.isCurrentStep()\n                                    ? 'current'\n                                    : action.enableIfCondition()\n                                    ? 'completed'\n                                    : 'upcoming'\n                            "\n                            [ngClass]="{ 'se-none-cursor': !action.enableIfCondition() }"\n                            [label]="action.i18n | translate"\n                            (click)="onClickAction(action)">\n                            <fd-wizard-step-indicator>{{ i + 1 }}</fd-wizard-step-indicator>\n                            <fd-wizard-content size="md"> </fd-wizard-content>\n                        </li>\n                    </ul>\n                </fd-wizard-navigation>\n            </fd-wizard>\n        </div>\n    `})],t.ModalWizardNavBarComponent);window.__smartedit__.addDecoratorPayload("Component","ModalWizardStepOutletComponent",{selector:"se-modal-wizard-step-outlet",template:`\n        <ng-container *ngIf="steps && steps.length > 0">\n            <ng-container *ngFor="let step of steps">\n                <div\n                    [ngClass]="{\n                        'se-modal-wizard__content--visible': isActive(step)\n                    }"\n                    class="se-modal-wizard__content">\n                    <div *ngIf="step.component">\n                        <ng-container\n                            *ngComponentOutlet="\n                                step.component;\n                                injector: wizardApiInjector\n                            "></ng-container>\n                    </div>\n                </div>\n            </ng-container>\n        </ng-container>\n    `});t.ModalWizardStepOutletComponent=class ModalWizardStepOutletComponent{isActive(e){return this.wizardService.getCurrentStepId()===e.id}};__decorate([o.Input(),__metadata("design:type",Array)],t.ModalWizardStepOutletComponent.prototype,"steps",void 0);__decorate([o.Input(),__metadata("design:type",WizardService)],t.ModalWizardStepOutletComponent.prototype,"wizardService",void 0);__decorate([o.Input(),__metadata("design:type",o.Injector)],t.ModalWizardStepOutletComponent.prototype,"wizardApiInjector",void 0);t.ModalWizardStepOutletComponent=__decorate([o.Component({selector:"se-modal-wizard-step-outlet",template:`\n        <ng-container *ngIf="steps && steps.length > 0">\n            <ng-container *ngFor="let step of steps">\n                <div\n                    [ngClass]="{\n                        'se-modal-wizard__content--visible': isActive(step)\n                    }"\n                    class="se-modal-wizard__content">\n                    <div *ngIf="step.component">\n                        <ng-container\n                            *ngComponentOutlet="\n                                step.component;\n                                injector: wizardApiInjector\n                            "></ng-container>\n                    </div>\n                </div>\n            </ng-container>\n        </ng-container>\n    `})],t.ModalWizardStepOutletComponent);t.WizardModule=class WizardModule{};t.WizardModule=__decorate([o.NgModule({imports:[u.CommonModule,h.TranslateModule,m.WizardModule],providers:[t.ModalWizard,WizardActions,yn],declarations:[t.ModalWizardTemplateComponent,t.ModalWizardNavBarComponent,t.ModalWizardStepOutletComponent],entryComponents:[t.ModalWizardTemplateComponent,t.ModalWizardNavBarComponent,t.ModalWizardStepOutletComponent]})],t.WizardModule);const Cn=new o.InjectionToken("TOOLBAR_ITEM");t.ToolbarItemType=void 0;(function(e){e["TEMPLATE"]="TEMPLATE";e["ACTION"]="ACTION";e["HYBRID_ACTION"]="HYBRID_ACTION"})(t.ToolbarItemType||(t.ToolbarItemType={}));t.ToolbarSection=void 0;(function(e){e["left"]="left";e["middle"]="middle";e["right"]="right"})(t.ToolbarSection||(t.ToolbarSection={}));t.ToolbarDropDownPosition=void 0;(function(e){e["left"]="left";e["center"]="center";e["right"]="right"})(t.ToolbarDropDownPosition||(t.ToolbarDropDownPosition={}));class IToolbarService{constructor(e,t){this.logService=e;this.permissionService=t;this.aliases=[];this.actions={}}getActions(){return this.actions}getAliases(){return this.aliases}addItems(e){const t=e.filter((e=>{let t=true;if(!e.key){this.logService.error("addItems() - Cannot add item without key.");t=false}return t})).map((e=>{const t=e.key;this.actions[t]=e.callback;const n={key:t,name:e.nameI18nKey,iconClassName:e.iconClassName,description:e.descriptionI18nKey,icons:e.icons,type:e.type,priority:e.priority||500,section:e.section||"left",isOpen:false,component:e.component,actionButtonFormat:e.actionButtonFormat,keepAliveOnClose:e.keepAliveOnClose||false,contextComponent:e.contextComponent,dropdownPosition:e.dropdownPosition,permissions:e.permissions};return this._populateIsPermissionGranted(n)}));return Promise.all(t).then((e=>{if(e.length>0){this.addAliases(e)}}))}_populateIsPermissionGranted(e){if(e.permissions){return Promise.resolve(this.permissionService.isPermitted([{names:e.permissions}]).then((t=>{e.isPermissionGranted=t;return e})))}else{e.isPermissionGranted=true;return Promise.resolve(e)}}addAliases(e){"proxyFunction"}removeItemByKey(e){"proxyFunction"}_removeItemOnInner(e){"proxyFunction"}removeAliasByKey(e){"proxyFunction"}triggerActionOnInner(e){"proxyFunction"}}class TextTruncateService{truncateToNearestWord(e,t,n=""){if(x.isNil(t)||e>t.length){return new TruncatedText(t,t,false)}const i=/(\s)/g;const o=t.match(i);let s=0;if(!o){s=e}else{for(let n=0;n<o.length;n++){const i=this.getPositionOfCharacters(t,o[n],n+1);if(i>e){break}s=i}}const r=t.substr(0,s);return new TruncatedText(t,r,true,n)}getPositionOfCharacters(e,t,n){return e.split(t,n).join(t).length}}const fn="FrequentlyChangingContent";const En=new a.CacheAction(fn);const In="RarelyChangingContent";const bn=new a.CacheAction(In);const Tn=new a.EvictionTag({event:"AUTHORIZATION_SUCCESS"});const On=new a.EvictionTag({event:"USER_HAS_CHANGED"});const Pn=new a.EvictionTag({event:"CATALOG_SYNCHRONIZED_EVENT"});const wn=new a.EvictionTag({event:"CATALOG_EVENT",relatedTags:[Pn,On]});const An=new a.EvictionTag({event:"PAGE_CREATED_EVENT"});const Rn=new a.EvictionTag({event:"PAGE_DELETED_EVENT"});const Dn=new a.EvictionTag({event:"PAGE_UPDATED_EVENT"});const Mn=new a.EvictionTag({event:"PAGE_RESTORED_EVENT"});const Nn=new a.EvictionTag({event:"PAGE_CHANGE"});const xn=new a.EvictionTag({event:"pageEvictionTag",relatedTags:[An,Rn,Dn]});const Fn=new a.EvictionTag({event:"EVENT_CONTENT_CATALOG_UPDATE"});const Ln=new a.EvictionTag({event:"EVENT_PERSPECTIVE_CHANGED"});const Un="/cmssmarteditwebservices/v1/sites/:siteUID/contentcatalogs";t.ContentCatalogRestService=class ContentCatalogRestService extends a.AbstractCachedRestService{constructor(e){super(e,Un)}};t.ContentCatalogRestService=__decorate([a.CacheConfig({actions:[bn],tags:[On,xn,Fn]}),a.OperationContextRegistered(Un,["CMS","INTERACTIVE"]),o.Injectable(),__metadata("design:paramtypes",[a.RestServiceFactory])],t.ContentCatalogRestService);t.ProductCatalogRestService=class ProductCatalogRestService extends a.AbstractCachedRestService{constructor(e){super(e,"/cmssmarteditwebservices/v1/sites/:siteUID/productcatalogs")}};t.ProductCatalogRestService=__decorate([a.CacheConfig({actions:[bn],tags:[On]}),o.Injectable(),__metadata("design:paramtypes",[a.RestServiceFactory])],t.ProductCatalogRestService);t.PermissionsRestService=class PermissionsRestService{constructor(e){this.URI="/permissionswebservices/v1/permissions/global/search";this.resource=e.get(this.URI)}get(e){return this.resource.queryByPost({principalUid:e.user},{permissionNames:e.permissionNames}).then((e=>({permissions:e.permissions})))}};t.PermissionsRestService=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.RestServiceFactory])],t.PermissionsRestService);t.AuthorizationService=class AuthorizationService{constructor(e,t,n){this.logService=e;this.sessionService=t;this.permissionsRestService=n}hasGlobalPermissions(e){if(!e.length||e.length<1){throw new Error("permissionNames must be a non-empty array")}const onSuccess=t=>this.mergePermissionResults(t,e);const onError=()=>{this.logService.error("AuthorizationService - Failed to determine authorization for the following permissions: "+e.toString());return false};return this.getPermissions(e).then(onSuccess,onError)}getPermissionResult(e,t){const n=e.permissions.find((e=>e.key.toLowerCase()===t.toLowerCase()));return!!n&&n.value==="true"}mergePermissionResults(e,t){let n=!!t&&t.length>0;let i=0;while(n&&i<t.length){n=n&&this.getPermissionResult(e,t[i++])}return n}getPermissions(e){return this.sessionService.getCurrentUsername().then((t=>{if(!t){return{permissions:[]}}return this.permissionsRestService.get({user:t,permissionNames:e.join(",")})}))}};t.AuthorizationService=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.LogService,a.ISessionService,t.PermissionsRestService])],t.AuthorizationService);t.CrossFrameEventServiceGateway=class CrossFrameEventServiceGateway{constructor(e){return e.createGateway("CROSS_FRAME_EVENT")}};t.CrossFrameEventServiceGateway.crossFrameEventServiceGatewayToken=new o.InjectionToken("crossFrameEventServiceGatewayToken");t.CrossFrameEventServiceGateway=__decorate([o.Injectable(),__metadata("design:paramtypes",[t.GatewayFactory])],t.CrossFrameEventServiceGateway);window.__smartedit__.addDecoratorPayload("Injectable","CrossFrameEventService",{providedIn:"root"});t.CrossFrameEventService=class CrossFrameEventService{constructor(e,t,n){this.systemEventService=e;this.crossFrameEventServiceGateway=t;this.windowUtils=n}publish(e,t){const n=[this.systemEventService.publishAsync(e,t)];if(this.windowUtils.getGatewayTargetFrame()){n.push(this.crossFrameEventServiceGateway.publish(e,t))}return Promise.all(n)}subscribe(e,t){const n=this.systemEventService.subscribe(e,t);const i=this.crossFrameEventServiceGateway.subscribe(e,t);const unsubscribeFn=function(){n();i()};return unsubscribeFn}isIframe(){return this.windowUtils.isIframe()}};t.CrossFrameEventService=__decorate([o.Injectable({providedIn:"root"}),__param(1,o.Inject(t.CrossFrameEventServiceGateway.crossFrameEventServiceGatewayToken)),__metadata("design:paramtypes",[t.SystemEventService,MessageGateway,t.WindowUtils])],t.CrossFrameEventService);const kn="GatewayProxied";const Vn=a.annotationService.getClassAnnotationFactory(kn);function GatewayProxiedAnnotationFactory(e){"ngInject";return a.annotationService.setClassAnnotationFactory(kn,(function(t){return function(n,i,o){n=new(i.bind(n))(...o);n.gatewayId=V.buildServiceName(i);e.initForService(n,t.length>0?t:null);return n}}))}t.LanguageService=class LanguageService extends a.LanguageService{constructor(e,t,n,i,o,s,r,a){super(e,t,n,i,o,s,r,a);this.logService=e;this.translateService=t;this.promiseUtils=n;this.eventService=i;this.browserService=o;this.storageService=s;this.injector=r;this.languageServiceConstants=a}getLanguagesForSite(e){return this.languageRestService.get({siteUID:e}).then((e=>e.languages),(e=>{this.logService.error("LanguageService.getLanguagesForSite() - Error loading languages");return Promise.reject(e)}))}get languageRestService(){return this.injector.get(a.RestServiceFactory).get(this.languageServiceConstants.LANGUAGE_RESOURCE_URI)}};__decorate([a.Cached({actions:[a.rarelyChangingContent]}),__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",Promise)],t.LanguageService.prototype,"getLanguagesForSite",null);t.LanguageService=__decorate([o.Injectable(),__param(3,o.Inject(a.EVENT_SERVICE)),__param(7,o.Inject(a.LANGUAGE_SERVICE_CONSTANTS)),__metadata("design:paramtypes",[a.LogService,h.TranslateService,a.PromiseUtils,Object,a.BrowserService,a.IStorageService,o.Injector,Object])],t.LanguageService);var jn;t.LanguageServiceGateway=jn=class LanguageServiceGateway{constructor(e){jn.instance=jn.instance||e.createGateway("languageSwitch")}getInstance(){return jn.instance}};t.LanguageServiceGateway=jn=__decorate([o.Injectable(),__metadata("design:paramtypes",[t.GatewayFactory])],t.LanguageServiceGateway);class IPerspectiveService{register(e){"proxyFunction";return null}switchTo(e){"proxyFunction";return null}hasActivePerspective(){"proxyFunction";return null}selectDefault(){"proxyFunction";return null}isEmptyPerspectiveActive(){"proxyFunction";return null}refreshPerspective(){"proxyFunction";return null}getActivePerspectiveKey(){"proxyFunction";return null}isHotkeyEnabledForActivePerspective(){"proxyFunction";return null}getActivePerspective(){"proxyFunction";return null}getPerspectives(){"proxyFunction";return null}}var zn;t.GenericEditorStackService=zn=class GenericEditorStackService{constructor(e,t){this.systemEventService=e;this.logService=t;this._editorsStacks={};this.systemEventService.subscribe(zn.EDITOR_PUSH_TO_STACK_EVENT,this.pushEditorEventHandler.bind(this));this.systemEventService.subscribe(zn.EDITOR_POP_FROM_STACK_EVENT,this.popEditorEventHandler.bind(this))}isAnyGenericEditorOpened(){return x.size(this._editorsStacks)>=1}areMultipleGenericEditorsOpened(){return x.size(this._editorsStacks)>1||x.some(this._editorsStacks,(e=>e.length>1))}getEditorsStack(e){return this._editorsStacks[e]||null}isTopEditorInStack(e,t){let n=false;const i=this._editorsStacks[e];if(i){const e=i[i.length-1];n=e&&e.editorId===t}return n}pushEditorEventHandler(e,t){this.validateId(t);const n=t.editorStackId;if(!this._editorsStacks[n]){this._editorsStacks[n]=[]}this._editorsStacks[n].push({component:t.component,componentType:t.componentType,editorId:t.editorId})}popEditorEventHandler(e,t){this.validateId(t);const n=t.editorStackId;const i=this._editorsStacks[n];if(!i){this.logService.warn("genericEditorStackService - Stack of editors not found. Cannot pop editor.");return}i.pop();if(i.length===0){delete this._editorsStacks[n]}}validateId(e){if(!e.editorStackId){throw new Error("genericEditorStackService - Must provide a stack id.")}}};t.GenericEditorStackService.EDITOR_PUSH_TO_STACK_EVENT="EDITOR_PUSH_TO_STACK_EVENT";t.GenericEditorStackService.EDITOR_POP_FROM_STACK_EVENT="EDITOR_POP_FROM_STACK_EVENT";t.GenericEditorStackService=zn=__decorate([o.Injectable(),__metadata("design:paramtypes",[t.SystemEventService,a.LogService])],t.GenericEditorStackService);t.NonValidationErrorInterceptor=class NonValidationErrorInterceptor{constructor(e,t){this.alertService=e;this.genericEditorStackService=t}predicate(e,t){return t.status===400}responseError(e,t){if(t.error&&t.error.errors){t.error.errors.filter((e=>{const t=e.type==="ValidationError";return!t||t&&!this.genericEditorStackService.isAnyGenericEditorOpened()})).forEach((e=>{this.alertService.showDanger({message:e.message||"se.unknown.request.error",duration:1e4,minWidth:"",mousePersist:true,dismissible:true,width:"300px"})}))}return Promise.reject(t)}};t.NonValidationErrorInterceptor=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.IAlertService,t.GenericEditorStackService])],t.NonValidationErrorInterceptor);t.PreviewErrorInterceptor=class PreviewErrorInterceptor{constructor(e,t,n){this.injector=e;this.logService=t;this.sharedDataService=n}predicate(e,t){return t.status===400&&e.url.indexOf(be)>-1&&!a.stringUtils.isBlank(e.body.pageId)&&this._hasUnknownIdentifierError(t.error.errors)}responseError(e,t){this.logService.info("The error 400 above on preview is expected in some scenarios, typically when switching catalogs from experience selector.");this.logService.info("Removing the pageId ["+e.body.pageId+"] and creating a preview for homepage");delete e.body.pageId;this.sharedDataService.update(zt,(function(e){delete e.pageId;return e}));this.injector.get("iframeManagerService").setCurrentLocation(null);return this.injector.get(c.HttpClient).request(e).toPromise()}_hasUnknownIdentifierError(e){const t=e.filter((function(e){return e.type==="UnknownIdentifierError"}));return!!t.length}};t.PreviewErrorInterceptor=__decorate([o.Injectable(),__metadata("design:paramtypes",[o.Injector,a.LogService,a.ISharedDataService])],t.PreviewErrorInterceptor);t.ResourceNotFoundErrorInterceptor=class ResourceNotFoundErrorInterceptor{constructor(e,t){this.alertService=e;this.httpUtils=t}predicate(e,t){return t.status===404&&!this.httpUtils.isHTMLRequest(e,t)&&!this._isLanguageResourceRequest(e.url)}responseError(e,t){this.alertService.showDanger({message:t.statusText===a.StatusText.UNKNOW_ERROR?"se.unknown.request.error":t.message,duration:1e3,minWidth:"",mousePersist:true,dismissible:true,width:"300px"});return Promise.reject(t)}_isLanguageResourceRequest(e){const t=new RegExp(st.replace(/\:.*\//g,".*/"));return t.test(e)}};t.ResourceNotFoundErrorInterceptor=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.IAlertService,a.HttpUtils])],t.ResourceNotFoundErrorInterceptor);function operationContextInteractivePredicate(e,t){return t===ve.INTERACTIVE}function operationContextNonInteractivePredicate(e,t){return x.includes([ve.BACKGROUND_TASKS,ve.NON_INTERACTIVE,ve.BATCH_OPERATIONS],t)}function operationContextCMSPredicate(e,t){return t===ve.CMS}function operationContextToolingPredicate(e,t){return t===ve.TOOLING}t.InterceptorHelper=class InterceptorHelper{constructor(e){this.logService=e}handleRequest(e,t){return this._handle(e,e,t,false)}handleResponse(e,t){return this._handle(e,e.config,t,false)}handleResponseError(e,t){return this._handle(e,e.config,t,true)}_isEligibleForInterceptors(e){return e&&e.url&&!/.+\.html$/.test(e.url)}_handle(e,t,n,i){try{if(this._isEligibleForInterceptors(t)){return n()}else{if(i){return Promise.reject(e)}else{return e}}}catch(t){this.logService.error("caught error in one of the interceptors",t);if(i){return Promise.reject(e)}else{return e}}}};t.InterceptorHelper=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.LogService])],t.InterceptorHelper);t.PolyfillService=class PolyfillService{constructor(e){this.browserService=e}isEligibleForEconomyMode(){return this.browserService.isIE()}isEligibleForExtendedView(){return this.browserService.isIE()||this.browserService.isFF()}isEligibleForThrottledScrolling(){return this.browserService.isIE()}};t.PolyfillService=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.BrowserService])],t.PolyfillService);t.PriorityService=class PriorityService{constructor(e){this.stringUtils=e}sort(e,t=true){return e.sort(((e,t)=>{let n=e.priority-t.priority;if(n===0){n=this.stringUtils.encode(e).localeCompare(this.stringUtils.encode(t))}return n}))}};t.PriorityService=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.StringUtils])],t.PriorityService);t.SmarteditBootstrapGateway=class SmarteditBootstrapGateway{constructor(e){this.instance=this.instance||e.createGateway("smartEditBootstrap")}getInstance(){return this.instance}subscribe(e,t){return this.getInstance().subscribe(e,t)}publish(e,t,n=0,i){return this.getInstance().publish(e,t,n,i)}processEvent(e){return this.getInstance().processEvent(e)}};t.SmarteditBootstrapGateway=__decorate([o.Injectable(),__metadata("design:paramtypes",[t.GatewayFactory])],t.SmarteditBootstrapGateway);t.NavigationEventSource=void 0;(function(e){e["SRC_URL"]="/"})(t.NavigationEventSource||(t.NavigationEventSource={}));t.SmarteditRoutingService=class SmarteditRoutingService{constructor(e,t,n){this.router=e;this.document=t;this.logService=n;this.listenersInitialized=false;this.routeChangeError$=new p.ReplaySubject;this.routeChangeStart$=new p.ReplaySubject;this.routeChangeSuccess$=new p.ReplaySubject;this.previousRouterUrl=""}init(){if(!this.listenersInitialized){this.notifyOnAngularRouteEvents();this.listenersInitialized=true}}go(e){return this.router.navigateByUrl(e)}path(){return this.router.url}absUrl(){return this.document.location.href}routeChangeStart(){this.warnAboutListenersNotInitialized();return this.routeChangeStart$.pipe(_.filter((e=>!!e.url&&e.url!==this.previousRouterUrl)),_.map((e=>e.routeData)))}routeChangeSuccess(){this.warnAboutListenersNotInitialized();return this.routeChangeSuccess$.pipe(_.filter((e=>!!e.url&&e.url!==this.previousRouterUrl)),_.map((e=>e.routeData)))}routeChangeError(){this.warnAboutListenersNotInitialized();return this.routeChangeError$.pipe(_.map((e=>e.routeData)))}reload(e=this.router.url){return this.router.navigateByUrl("/nulldummy",{skipLocationChange:true}).then((()=>this.router.navigateByUrl(e)))}getCurrentUrlFromEvent(e){if(e instanceof g.NavigationStart||e instanceof g.NavigationEnd||e instanceof g.NavigationError){return e.url}return null}warnAboutListenersNotInitialized(){if(!this.listenersInitialized){this.logService.warn("Listeners not initialized, run `init()` first.")}}notifyOnAngularRouteEvents(){this.router.events.subscribe((e=>{if(!e.url){return}switch(true){case e instanceof g.NavigationStart:{this.routeChangeStart$.next({from:t.NavigationEventSource.SRC_URL,url:e.url,routeData:e});break}case e instanceof g.NavigationError:{this.routeChangeError$.next({from:t.NavigationEventSource.SRC_URL,url:e.url,routeData:e});break}case e instanceof g.NavigationEnd:{this.routeChangeSuccess$.next({from:t.NavigationEventSource.SRC_URL,url:e.url,routeData:e});this.previousRouterUrl=e&&e.url;break}}}))}};t.SmarteditRoutingService=__decorate([__param(0,o.Optional()),__param(1,o.Inject(u.DOCUMENT)),__metadata("design:paramtypes",[g.Router,Document,a.LogService])],t.SmarteditRoutingService);t.AuthenticationManager=class AuthenticationManager extends a.IAuthenticationManagerService{constructor(e){super();this.routing=e}onLogout(){const e=this.routing.path();if(a.stringUtils.isBlank(e)||e==="/"){this.routing.reload()}else{this.routing.go("/")}}onUserHasChanged(){this.routing.reload()}};t.AuthenticationManager=__decorate([o.Injectable(),__metadata("design:paramtypes",[t.SmarteditRoutingService])],t.AuthenticationManager);t.SettingsService=class SettingsService{constructor(e){this.restService=e.get(Ae)}load(){return this.restService.get()}get(e){return this.load().then((t=>t[e]))}getBoolean(e){return this.load().then((t=>t[e]===true||t[e]==="true"))}getStringList(e){return this.load().then((t=>t[e]))}};__decorate([a.Cached({actions:[bn]}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],t.SettingsService.prototype,"load",null);t.SettingsService=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.RestServiceFactory])],t.SettingsService);class SeRouteService{static provideNgRoute(e,t){this.provideRouteShortcutConfigs(e);return g.RouterModule.forRoot(e,t)}static get routeShortcutConfigs(){return this.routeShortcuts}static provideRouteShortcutConfigs(e){const t=[];this.generateRouteShortcutConfig(t,e);t.filter((e=>this.canRegisterRouteShortcutConfig(e))).forEach((e=>{this.routeShortcuts.push(e)}))}static generateRouteShortcutConfig(e,t,n=""){t.forEach((t=>{if(t.path!==undefined){const i=this.getFullPath(n,t);e.push({fullPath:i,titleI18nKey:t.titleI18nKey,priority:t.priority,shortcutComponent:t.shortcutComponent})}if(t.children){const i=this.getFullPath(n,t);const o=t.path?i:n;this.generateRouteShortcutConfig(e,t.children,o)}}))}static getFullPath(e,t){return e?e+"/"+t.path:t.path}static canRegisterRouteShortcutConfig(e){if(e.fullPath===undefined){return false}let t=e.fullPath;this.CATALOG_AWARE_PATH_PLACEHOLDERS.forEach((e=>{t=t.replace(e,"")}));if(t.indexOf(":")>-1){return false}return true}}SeRouteService.CATALOG_AWARE_PATH_PLACEHOLDERS=[":siteId",":catalogId",":catalogVersion"];SeRouteService.routeShortcuts=[];const Bn="yjQuery";function yjQueryServiceFactory(){const e="smarteditJQuery";if(!window[e]){if(i&&i.noConflict){window[e]=i.noConflict(true)}else{window[e]=i}}return window[e]}t.YjqueryModule=class YjqueryModule{};t.YjqueryModule=__decorate([o.NgModule({providers:[{provide:Bn,useFactory:yjQueryServiceFactory},G.initialize((e=>{e.fn.extend({getCssPath(){let e;let t=this;while(t.length){const n=t[0];const i=n.className;if(n.tagName==="BODY"){break}t=t.parent();e=i+(e?">"+e:"")}return e}})}),[Bn])]})],t.YjqueryModule);const Hn={root:null,threshold:0};const Gn={attributes:true,attributeOldValue:false,childList:true,characterData:false,subtree:true};t.InViewElementObserver=class InViewElementObserver{constructor(e,t,n){this.logService=e;this.document=t;this.yjQuery=n;this.componentsQueue=[];this.selectors=[];this.hasClassBasedSelectors=false}elementFromPoint(e){const t=this.document.elementFromPoint(e.x,e.y);return t||this.getInViewElements().find((t=>U.isPointOverElement(e,t)))}addSelector(e,t){if(!W.isBlank(e)&&this.selectors.map((e=>e.selector)).indexOf(e)===-1){if(/\.[\w]+/.test(e)){this.hasClassBasedSelectors=true}this.selectors.push({selector:e,callback:t});this.restart()}return()=>{const t=this.selectors.map((e=>e.selector)).indexOf(e);this.selectors.splice(t,1);this.restart()}}getAllElements(){return this.componentsQueue.map((e=>e.component))}getInViewElements(){return this.componentsQueue.filter((e=>e.isIntersecting)).map((e=>e.component))}restart(){this.stopListener();this.initListener()}stopListener(){if(this.mutationObserver){this.mutationObserver.disconnect();delete this.mutationObserver}if(this.intersectionObserver){this.intersectionObserver.disconnect();delete this.intersectionObserver}this.componentsQueue=[]}initListener(){if(!this.mutationObserver){this.mutationObserver=this._newMutationObserver(this._mutationObserverCallback.bind(this));if(!this.intersectionObserver){this.intersectionObserver=this._newIntersectionObserver((e=>{const t=e.filter((e=>this._isEligibleComponent(e.target)));t.forEach((e=>{this._updateQueue(e)}));this.selectors.filter((e=>!!e.callback)).forEach((e=>{if(t.find((t=>this.yjQuery(t.target).is(e.selector)))){e.callback()}}))}))}this._getEligibleElements().forEach((e=>{this.intersectionObserver.observe(e)}))}}_aggregateAddedOrRemovedNodes(e,t){const n=x.flatten(e.filter((e=>e.type===ge.CHILD_LIST.NAME&&(!!t&&e.addedNodes&&e.addedNodes.length||!t&&e.removedNodes&&e.removedNodes.length))).map((e=>{const n=x.flatten(Array.prototype.slice.call(t?e.addedNodes:e.removedNodes).filter((e=>e.nodeType===Node.ELEMENT_NODE)).map((e=>{const t=this._getAllEligibleChildren(e);return this._isEligibleComponent(e)?[e].concat(t):t}))).sort(U.compareHTMLElementsPosition()).reverse();return n})));return x.uniqWith(n,((e,t)=>e.contains(t)||t.contains(e)))}_aggregateMutationsOnClass(e,t){return x.compact(e.filter((e=>e.target&&e.target.nodeType===Node.ELEMENT_NODE&&e.type===ge.ATTRIBUTES.NAME&&e.attributeName==="class")).map((e=>{if(t&&this._isEligibleComponent(e.target)){return e.target}else if(!t&&this._isEligibleComponent(e.target)){return e.target}return null})))}_mutationObserverCallback(e){this.logService.debug(e);this._aggregateAddedOrRemovedNodes(e,true).forEach((e=>{this.intersectionObserver.observe(e)}));if(this.hasClassBasedSelectors){this._aggregateMutationsOnClass(e,true).forEach((e=>{this.intersectionObserver.observe(e)}))}this._aggregateAddedOrRemovedNodes(e,false).forEach((e=>{const t=this._getComponentIndexInQueue(e);if(t!==-1){this.componentsQueue.splice(t,1)}}));if(this.hasClassBasedSelectors){this._aggregateMutationsOnClass(e,false).forEach((e=>{const t=this._getComponentIndexInQueue(e);if(t!==-1){this.componentsQueue.splice(t,1)}}))}}_updateQueue(e){const t=this._getComponentIndexInQueue(e.target);if(t!==-1){if(!e.intersectionRatio&&!this._isInDOM(e.target)){this.componentsQueue.splice(t,1)}else{this.componentsQueue[t].isIntersecting=!!e.intersectionRatio}}else if(this._isInDOM(e.target)){this.componentsQueue.push({component:e.target,isIntersecting:!!e.intersectionRatio})}}_newMutationObserver(e){const t=new MutationObserver(e);t.observe(this.document.body,x.merge(x.cloneDeep(Gn),{attributes:this.hasClassBasedSelectors}));return t}_newIntersectionObserver(e){return new IntersectionObserver(e,Hn)}_getJQuerySelector(){return this.selectors.map((e=>e.selector)).join(",")}_isEligibleComponent(e){return this.yjQuery(e).is(this._getJQuerySelector())}_getEligibleElements(){return Array.prototype.slice.call(this.yjQuery(this._getJQuerySelector()))}_getAllEligibleChildren(e){return Array.prototype.slice.call(e.querySelectorAll(this._getJQuerySelector()))}_getComponentIndexInQueue(e){return this.componentsQueue.findIndex((function(t){return e===t.component}))}_isInDOM(e){return this.yjQuery.contains(this.document.body,e)}};t.InViewElementObserver=__decorate([o.Injectable(),__param(1,o.Inject(u.DOCUMENT)),__param(2,o.Inject(Bn)),__metadata("design:paramtypes",[a.LogService,Document,Function])],t.InViewElementObserver);var Wn;t.DragAndDropScrollingService=Wn=class DragAndDropScrollingService{constructor(e,t,n,i){this.windowUtils=e;this.translate=t;this.inViewElementObserver=n;this.yjQuery=i;this.SCROLLING_AREA_HEIGHT=50;this.FAST_SCROLLING_AREA_HEIGHT=25;this.SCROLLING_STEP=5;this.FAST_SCROLLING_STEP=15;this.topScrollArea=null;this.bottomScrollArea=null;this.throttleScrollingEnabled=false;this.inViewElementObserver.addSelector("#"+Wn.TOP_SCROLL_AREA_ID);this.inViewElementObserver.addSelector("#"+Wn.BOTTOM_SCROLL_AREA_ID);this.throttledScrollPage=x.throttle(this.scrollPage.bind(this),wt)}initialize(){this.scrollable=this.getFromElementSelector(this.windowUtils.getWindow().document.scrollingElement);this.addScrollAreas();this.addEventListeners();this.scrollDelta=0;this.initialized=true}deactivate(){this.removeEventListeners();this.scrollDelta=0;this.initialized=false}enable(){if(this.initialized){this.scrollLimitY=this.scrollable.get(0).scrollHeight-this.windowUtils.getWindow().innerHeight;this.showScrollAreas()}}disable(){if(this.initialized){const e=this.getScrollAreas();e.trigger("dragleave");e.hide()}}toggleThrottling(e){this.throttleScrollingEnabled=e}addScrollAreas(){this.topScrollArea=this.getFromSelector('<div id="'+Wn.TOP_SCROLL_AREA_ID+'" class="'+Rt+'"></div>').appendTo("body");this.bottomScrollArea=this.getFromSelector('<div id="'+Wn.BOTTOM_SCROLL_AREA_ID+'" class="'+Rt+'"></div>').appendTo("body");const e=this.getScrollAreas();e.height(this.SCROLLING_AREA_HEIGHT);this.topScrollArea.css({top:0});this.bottomScrollArea.css({bottom:0});e.hide();let t;let n;return this.translate.get("se.draganddrop.uihint.top").toPromise().then((e=>{t=e;return this.translate.get("se.draganddrop.uihint.bottom").toPromise()})).then((e=>{n=e;this.topScrollArea.text(t);this.bottomScrollArea.text(n)}))}addEventListeners(){const e=this.getScrollAreas();e.on("dragenter",this.onDragEnter.bind(this));e.on("dragover",this.onDragOver.bind(this));e.on("dragleave",this.onDragLeave.bind(this))}removeEventListeners(){const e=this.getScrollAreas();e.off("dragenter");e.off("dragover");e.off("dragleave");e.remove()}onDragEnter(e){let t=this.SCROLLING_STEP;const n=this.getFromSelector(e.target);const i=n.attr("id");if(i===Wn.TOP_SCROLL_AREA_ID){t*=-1}this.scrollDelta=t;this.animationFrameId=this.windowUtils.getWindow().requestAnimationFrame(this.scrollPage.bind(this))}onDragOver(e){const t=e.originalEvent;const n=this.getFromSelector(t.target);const i=n.attr("id");if(i===Wn.TOP_SCROLL_AREA_ID){if(t.clientY<=this.FAST_SCROLLING_AREA_HEIGHT){this.scrollDelta=-this.FAST_SCROLLING_STEP}else{this.scrollDelta=-this.SCROLLING_STEP}}else{const e=this.windowUtils.getWindow().innerHeight;if(t.clientY>=e-this.FAST_SCROLLING_AREA_HEIGHT){this.scrollDelta=this.FAST_SCROLLING_STEP}else{this.scrollDelta=this.SCROLLING_STEP}}}onDragLeave(){this.scrollDelta=0;this.windowUtils.getWindow().cancelAnimationFrame(this.animationFrameId)}scrollPage(){if(this.scrollDelta){const e=this.scrollable.scrollTop();let t=false;if(this.scrollDelta>0&&e<this.scrollLimitY){t=true}else if(this.scrollDelta<0&&e>0){t=true}if(t){const e=this.scrollable.scrollTop();const t=e+this.scrollDelta;this.scrollable.scrollTop(t);this.animationFrameId=this.windowUtils.getWindow().requestAnimationFrame(this.throttleScrollingEnabled?this.throttledScrollPage:this.scrollPage.bind(this))}this.showScrollAreas()}}getFromSelector(e){if(typeof e==="string"){return this.yjQuery(e)}else{return this.getFromHTMLSelector(e)}}getFromHTMLSelector(e){return this.yjQuery(e)}getFromElementSelector(e){return this.yjQuery(e)}getScrollAreas(){return this.yjQuery(["#"+Wn.TOP_SCROLL_AREA_ID,"#"+Wn.BOTTOM_SCROLL_AREA_ID].join(","))}showScrollAreas(){const e=this.scrollable.scrollTop();if(e===0){this.topScrollArea.hide()}else{this.topScrollArea.show()}if(e>=this.scrollLimitY){this.bottomScrollArea.hide()}else{this.bottomScrollArea.show()}}};t.DragAndDropScrollingService.TOP_SCROLL_AREA_ID="top_scroll_page";t.DragAndDropScrollingService.BOTTOM_SCROLL_AREA_ID="bottom_scroll_page";t.DragAndDropScrollingService=Wn=__decorate([o.Injectable(),__param(3,o.Inject(Bn)),__metadata("design:paramtypes",[a.WindowUtils,h.TranslateService,t.InViewElementObserver,Function])],t.DragAndDropScrollingService);var $n;t.DragAndDropService=$n=class DragAndDropService{constructor(e,t,n,i,o){this.yjQuery=e;this.dragAndDropScrollingService=t;this.inViewElementObserver=n;this.systemEventService=i;this.dragAndDropCrossOrigin=o;this.configurations={};this.isDragAndDropExecuting=false;this.dragAndDropCrossOrigin.initialize()}register(e){if(!e||!e.id){throw new Error("dragAndDropService - register(): Configuration needs an ID.")}this.configurations[e.id]=e;if(!a.stringUtils.isBlank(e.targetSelector)){this.inViewElementObserver.addSelector(e.targetSelector)}}unregister(e){e.forEach((e=>{const t=this.configurations[e];if(t){this.deactivateConfiguration(t);this.deactivateScrolling(t);delete this.configurations[e]}}))}applyAll(){x.forEach(this.configurations,(e=>{this.apply(e.id)}))}apply(e){const t=this.configurations[e];if(t){this.update(t.id);this.cacheDragImages(t);this.initializeScrolling(t)}}update(e){const t=this.configurations[e];if(t){this.deactivateConfiguration(t);this._update(t)}}markDragStarted(){this.setDragAndDropExecutionStatus(true);this.dragAndDropScrollingService.enable()}markDragStopped(){this.setDragAndDropExecutionStatus(false);this.dragAndDropScrollingService.disable()}_update(e){const t=x.isArray(e.sourceSelector)?e.sourceSelector:[e.sourceSelector];t.forEach((t=>{const n=this.getSelector(t+":not([draggable])");n.attr($n.DRAGGABLE_ATTR,"true");n.on("dragstart",this.onDragStart.bind(this,e));n.on("dragend",this.onDragEnd.bind(this,e))}));const n=this.getSelector(e.targetSelector+":not([draggable])");n.attr($n.DROPPABLE_ATTR,"true");n.on("dragenter",this.onDragEnter.bind(this,e));n.on("dragover",this.onDragOver.bind(this,e));n.on("drop",this.onDrop.bind(this,e));n.on("dragleave",this.onDragLeave.bind(this,e))}deactivateConfiguration(e){const t=Array.isArray(e.sourceSelector)?e.sourceSelector.join(","):e.sourceSelector;const n=this.getSelector(t);const i=this.getSelector(e.targetSelector);n.removeAttr($n.DRAGGABLE_ATTR);i.removeAttr($n.DROPPABLE_ATTR);n.off("dragstart");n.off("dragend");i.off("dragenter");i.off("dragover");i.off("dragleave");i.off("drop")}onDragStart(e,t){const n=t.originalEvent;this.setDragTransferData(e,n);setTimeout((()=>{const i=this.yjQuery(t.target).closest("."+nt);this.setDragAndDropExecutionStatus(true,i);this.dragAndDropScrollingService.enable();if(e.startCallback){e.startCallback(n)}}),0)}onDragEnd(e,t){const n=t.originalEvent;this.dragAndDropScrollingService.disable();if(this.isDragAndDropExecuting&&e.stopCallback){e.stopCallback(n)}this.setDragAndDropExecutionStatus(false)}onDragEnter(e,t){const n=t.originalEvent;n.preventDefault();if(this.isDragAndDropExecuting&&e.dragEnterCallback){e.dragEnterCallback(n)}}onDragOver(e,t){const n=t.originalEvent;n.preventDefault();if(this.isDragAndDropExecuting&&e.dragOverCallback){e.dragOverCallback(n)}}onDrop(e,t){const n=t.originalEvent;n.preventDefault();n.stopPropagation();if(n.relatedTarget&&n.relatedTarget.nodeType===3){return true}if(n.target===n.relatedTarget){return true}if(this.isDragAndDropExecuting&&e.dropCallback){e.dropCallback(n)}return false}onDragLeave(e,t){const n=t.originalEvent;n.preventDefault();if(this.isDragAndDropExecuting&&e.outCallback){e.outCallback(n)}}cacheDragImages(e){let t;if(e.helper){t=e.helper()}if(!t){return}if(typeof t==="string"){e._cachedDragImage=new Image;e._cachedDragImage.src=t}else{e._cachedDragImage=t}}setDragTransferData(e,t){t.dataTransfer.setData("Text",e.id);if(e._cachedDragImage&&t.dataTransfer.setDragImage){t.dataTransfer.setDragImage(e._cachedDragImage,0,0)}}getSelector(e){return this.yjQuery(e)}setDragAndDropExecutionStatus(e,t){this.isDragAndDropExecuting=e;this.systemEventService.publish(e?bt.DRAG_DROP_START:bt.DRAG_DROP_END,t)}initializeScrolling(e){if(e.enableScrolling&&this.browserRequiresCustomScrolling()){this.dragAndDropScrollingService.initialize()}}deactivateScrolling(e){if(e.enableScrolling&&this.browserRequiresCustomScrolling()){this.dragAndDropScrollingService.deactivate()}}browserRequiresCustomScrolling(){return true}};t.DragAndDropService.DRAGGABLE_ATTR="draggable";t.DragAndDropService.DROPPABLE_ATTR="data-droppable";t.DragAndDropService=$n=__decorate([o.Injectable(),__param(0,o.Inject(Bn)),__metadata("design:paramtypes",[Function,t.DragAndDropScrollingService,t.InViewElementObserver,t.SystemEventService,IDragAndDropCrossOrigin])],t.DragAndDropService);t.DragAndDropServiceModule=class DragAndDropServiceModule{};t.DragAndDropServiceModule=__decorate([o.NgModule({providers:[t.InViewElementObserver,t.DragAndDropScrollingService,t.DragAndDropService]})],t.DragAndDropServiceModule);const Kn={DROP:"drop",DRAG_ENTER:"dragenter",DRAG_OVER:"dragover",DRAG_LEAVE:"dragleave"};class StorageNamespaceConverter{static ERR_INVALID_NAMESPACED_ID(e){return new Error(`StorageNamespaceConverter - Invalid namespaced id [${e}]`)}static getNamespacedStorageId(e,t){return`${e}${this.separator}${t}`}static getStorageIdFromNamespacedId(e){const t=e.match(new RegExp(this.namespaceDecoderRegexStr));if(t&&t[2].length>0){return t[2]}throw StorageNamespaceConverter.ERR_INVALID_NAMESPACED_ID(e)}static getNamespaceFromNamespacedId(e){const t=e.match(new RegExp(this.namespaceDecoderRegexStr));if(t&&t[1].length>0){return t[1]}throw StorageNamespaceConverter.ERR_INVALID_NAMESPACED_ID(e)}}StorageNamespaceConverter.separator="<ns:id>";StorageNamespaceConverter.namespaceDecoderRegexStr="(.*)"+StorageNamespaceConverter.separator+"(.*)";class NamespacedStorageManager{constructor(e,t){this.storageManager=e;this.namespace=t}getStorage(e){e.storageId=this.getNamespaceStorageId(e.storageId);return this.storageManager.getStorage(e)}deleteStorage(e,t=false){return this.storageManager.deleteStorage(this.getNamespaceStorageId(e),t)}deleteExpiredStorages(e=false){return this.storageManager.deleteExpiredStorages(e)}hasStorage(e){return this.storageManager.hasStorage(this.getNamespaceStorageId(e))}registerStorageController(e){return this.storageManager.registerStorageController(e)}getNamespaceStorageId(e){return StorageNamespaceConverter.getNamespacedStorageId(this.namespace,e)}getStorageManager(){return this.storageManager}}class StorageManagerFactory{constructor(e){this.theOneAndOnlyStorageManager=e}static ERR_INVALID_NAMESPACE(e){return new Error(`StorageManagerFactory Error: invalid namespace [${e}]. Namespace must be a non-empty string`)}getStorageManager(e){this.validateNamespace(e);return new NamespacedStorageManager(this.theOneAndOnlyStorageManager,e)}validateNamespace(e){if(typeof e!=="string"||e.length<=0){throw StorageManagerFactory.ERR_INVALID_NAMESPACE(e)}}}class IStorageGateway{handleStorageRequest(e,t,n){"proxyFunction";return Promise.resolve()}}class IStorageManager{registerStorageController(e){"proxyFunction"}hasStorage(e){"proxyFunction";return null}getStorage(e){"proxyFunction";return null}deleteStorage(e,t){"proxyFunction";return Promise.resolve(true)}deleteExpiredStorages(e){"proxyFunction";return Promise.resolve(true)}}class IStorageManagerFactory{getStorageManager(e){"proxyFunction";return null}}class IStorageManagerGateway extends IStorageManager{getStorageSanitityCheck(e){"proxyFunction";return Promise.resolve(true)}}class IStoragePropertiesService{getProperty(e){"proxyFunction";return null}}const qn=new o.InjectionToken("storageProperties");const Yn=new o.InjectionToken("doNotUseStorageManager");class Timer{constructor(e,t,n=1e3){this.zone=e;this._callback=t;this._duration=n;this._timer=null}isActive(){return!!this._timer}restart(e){this._duration=e||this._duration;this.stop();this.start()}start(e){this._duration=e||this._duration;this.zone.runOutsideAngular((()=>{this._timer=setInterval((()=>{try{if(this._callback){this._callback()}else{this.stop()}}catch(e){this.stop()}}),this._duration)}))}stop(){clearInterval(this._timer);this._timer=null}resetDuration(e){this._duration=e||this._duration}teardown(){this.stop();this._callback=null;this._duration=null;this._timer=null}}t.TimerService=class TimerService{constructor(e){this.ngZone=e}createTimer(e,t){return new Timer(this.ngZone,e,t)}};t.TimerService=__decorate([o.Injectable(),__metadata("design:paramtypes",[o.NgZone])],t.TimerService);t.JQueryUtilsService=class JQueryUtilsService{constructor(e,t,n,i){this.yjQuery=e;this.document=t;this.EXTENDED_VIEW_PORT_MARGIN=n;this.windowUtils=i}extractFromElement(e,t){const n=this.yjQuery(e);return n.filter(t).add(n.find(t))}unsafeParseHTML(e){return this.yjQuery.parseHTML(e,null,true)}isInDOM(e){return this.document.documentElement.contains(e)}isInExtendedViewPort(e){if(!this.document.documentElement.contains(e)){return false}const t=this.yjQuery(e);const n=Object.assign(Object.assign({},t.offset()),{width:t.outerWidth(),height:t.outerHeight()});const i=this.document.scrollingElement||this.document.documentElement;return U.areIntersecting({left:-this.EXTENDED_VIEW_PORT_MARGIN+i.scrollLeft,width:this.windowUtils.getWindow().innerWidth+2*this.EXTENDED_VIEW_PORT_MARGIN,top:-this.EXTENDED_VIEW_PORT_MARGIN+i.scrollTop,height:this.windowUtils.getWindow().innerHeight+2*this.EXTENDED_VIEW_PORT_MARGIN},n)}};t.JQueryUtilsService=__decorate([o.Injectable(),__param(0,o.Inject(Bn)),__param(1,o.Inject(u.DOCUMENT)),__param(2,o.Inject(un)),__metadata("design:paramtypes",[Function,Document,Number,t.WindowUtils])],t.JQueryUtilsService);const Qn=new o.InjectionToken("CATALOG_DETAILS_ITEM_DATA");window.__smartedit__.addDecoratorPayload("Injectable","L10nService",{providedIn:"root"});t.L10nService=class L10nService{constructor(e,t){this.languageService=e;this.languageSwitchSubject=new p.BehaviorSubject(null);this.languageSwitch$=this.languageSwitchSubject.asObservable();this.unRegSwitchLanguageEvent=t.subscribe(a.SWITCH_LANGUAGE_EVENT,(()=>this.resolveLanguage()))}ngOnDestroy(){this.unRegSwitchLanguageEvent();this.languageSwitchSubject.unsubscribe()}resolveLanguage(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.languageService.getResolveLocaleIsoCode();this.languageSwitchSubject.next(e)}))}};t.L10nService=__decorate([o.Injectable({providedIn:"root"}),__metadata("design:paramtypes",[t.LanguageService,t.CrossFrameEventService])],t.L10nService);class CustomHandlingStrategy{shouldProcessUrl(e){return true}extract(e){return e}merge(e,t){return e}}var Zn;t.CMSModesService=Zn=class CMSModesService{constructor(e){this.perspectiveService=e}isVersioningPerspectiveActive(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.perspectiveService.getActivePerspectiveKey();return e===Zn.VERSIONING_PERSPECTIVE_KEY}))}};t.CMSModesService.BASIC_PERSPECTIVE_KEY="se.cms.perspective.basic";t.CMSModesService.ADVANCED_PERSPECTIVE_KEY="se.cms.perspective.advanced";t.CMSModesService.VERSIONING_PERSPECTIVE_KEY="se.cms.perspective.versioning";t.CMSModesService=Zn=__decorate([o.Injectable(),__metadata("design:paramtypes",[IPerspectiveService])],t.CMSModesService);var Xn;const Jn=`/cmswebservices/v1/sites/${se}/cmsitems`;const ei=new a.EvictionTag({event:Wt});t.CmsitemsRestService=class CmsitemsRestService{constructor(e,t){this.restServiceFactory=e;this.catalogService=t;this.cmsitemsUuidsUri=`/cmswebservices/v1/sites/${se}/cmsitems/uuids`;this.resource=e.get(Jn);this.versionedResource=e.get(Jn+"/:itemUuid");this.uuidsResource=e.get(this.cmsitemsUuidsUri)}getByIdAndVersion(e,t){return this.versionedResource.get({itemUuid:e,versionId:t})}get(e){return this.catalogService.retrieveUriContext().then((t=>{const n={catalogId:e.catalogId||t.CURRENT_CONTEXT_CATALOG,catalogVersion:e.catalogVersion||t.CURRENT_CONTEXT_CATALOG_VERSION};e=x.merge(n,e);return this.restServiceFactory.get(Jn).get(e)}))}getByIds(e,t){return this.getByIdsNoCache(e,t)}update(e,t){return this.resource.update(e,t)}delete(e){return this.resource.remove({identifier:e})}create(e){return this.catalogService.getCatalogVersionUUid().then((t=>{e.catalogVersion=e.catalogVersion||t;if(e.onlyOneRestrictionMustApply===undefined){e.onlyOneRestrictionMustApply=false}return this.resource.save(e)}))}getByIdsNoCache(e,t){e=Array.from(new Set(e));return this.catalogService.getCatalogVersionUUid().then((n=>{const i={catalogVersion:n,uuids:e,fields:t};return this.uuidsResource.save(i)}))}getById(e){return this.resource.getById(e)}};__decorate([a.Cached({actions:[bn],tags:[On,ei]}),__metadata("design:type",Function),__metadata("design:paramtypes",[String,String]),__metadata("design:returntype",Promise)],t.CmsitemsRestService.prototype,"getByIdAndVersion",null);__decorate([a.Cached({actions:[bn],tags:[On,ei]}),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Promise)],t.CmsitemsRestService.prototype,"get",null);__decorate([a.Cached({actions:[bn],tags:[On,ei]}),__metadata("design:type",Function),__metadata("design:paramtypes",[Array,String]),__metadata("design:returntype",Promise)],t.CmsitemsRestService.prototype,"getByIds",null);__decorate([a.InvalidateCache(ei),__metadata("design:type",Function),__metadata("design:paramtypes",[typeof(Xn=typeof T!=="undefined"&&T)==="function"?Xn:Object,Object]),__metadata("design:returntype",Promise)],t.CmsitemsRestService.prototype,"update",null);__decorate([a.InvalidateCache(ei),__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",Promise)],t.CmsitemsRestService.prototype,"delete",null);t.CmsitemsRestService=__decorate([a.OperationContextRegistered(Jn.replace(/CONTEXT_SITE_ID/,":CONTEXT_SITE_ID"),"CMS"),o.Injectable(),__metadata("design:paramtypes",[IRestServiceFactory,ICatalogService])],t.CmsitemsRestService);t.WorkflowActionStatus=void 0;(function(e){e["PENDING"]="pending";e["IN_PROGRESS"]="in_progress";e["PAUSED"]="paused";e["COMPLETED"]="completed";e["DISABLED"]="disabled";e["ENDED_THROUGH_END_OF_WORKFLOW"]="ended_through_end_of_workflow";e["TERMINATED"]="terminated"})(t.WorkflowActionStatus||(t.WorkflowActionStatus={}));t.WorkflowOperations=void 0;(function(e){e["CANCEL"]="CANCEL_WORKFLOW";e["MAKE_DECISION"]="MAKE_DECISION"})(t.WorkflowOperations||(t.WorkflowOperations={}));t.WorkflowStatus=void 0;(function(e){e["CONTINUED"]="continued";e["RUNNING"]="running";e["PAUSED"]="paused";e["FINISHED"]="finished";e["ABORTED"]="aborted";e["NEW"]="new"})(t.WorkflowStatus||(t.WorkflowStatus={}));const ti="WORKFLOW_CREATED_EVENT";const ni="WORKFLOW_FINISHED_EVENT";const ii=new a.EvictionTag({event:ti});const oi=new a.EvictionTag({event:ni});const si=new a.EvictionTag({event:"WORKFLOW_TASKS_MENU_OPENED_EVENT"});const ri={INBOX_POLLING_TIMEOUT:2e4,INBOX_POLLING_PAGESIZE:10,INBOX_POLLING_CURRENTPAGE:0};t.WorkflowTasksPollingService=class WorkflowTasksPollingService{constructor(e,t,n){this.timerService=e;this.restServiceFactory=t;this.crossFrameEventService=n;this.resourceInboxURI="/cmssmarteditwebservices/v1/inbox/workflowtasks";this.subscribers=[];this.syncPollingTimer=null;this.savedHashedTasks=[];this.inboxRESTService=this.restServiceFactory.get(this.resourceInboxURI);this.crossFrameEventService.subscribe(a.EVENTS.AUTHORIZATION_SUCCESS,(()=>this.initPolling()));this.crossFrameEventService.subscribe(a.EVENTS.LOGOUT,(()=>this.stopPolling()));this.crossFrameEventService.subscribe(a.EVENTS.REAUTH_STARTED,(()=>this.stopPolling()));this.initPolling()}stopPolling(){if(this.syncPollingTimer.isActive()){this.syncPollingTimer.stop()}}startPolling(){if(!this.syncPollingTimer.isActive()){this.syncPollingTimer.restart(ri.INBOX_POLLING_TIMEOUT)}}addSubscriber(e,t){this.subscribers.push({subscriber:e,callOnInit:t});return()=>this.unsubscribe(e)}initPolling(){this.syncPollingTimer=this.timerService.createTimer((()=>this.fetchInboxTasks(false)),ri.INBOX_POLLING_TIMEOUT);this.fetchInboxTasks(true);this.startPolling()}unsubscribe(e){const t=this.subscribers.findIndex((t=>t.subscriber===e));if(t>-1){this.subscribers.splice(t,1)}}getNewTasks(e){return e.filter((e=>!this.savedHashedTasks.includes(this.encodeTask(e))))}saveNewHashedTasks(e){e.forEach((e=>this.savedHashedTasks.push(this.encodeTask(e))));const t=this.savedHashedTasks.length-ri.INBOX_POLLING_PAGESIZE;if(t>0){for(let e=0;e<t;e++){this.savedHashedTasks.shift()}}}encodeTask(e){const t=s.cloneDeep(e);if(t.action){delete t.action.startedAgoInMillis}return W.getEncodedString(t)}fetchInboxTasks(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.fetchTaskList();if(!t){this.stopPolling();return}const n=this.getNewTasks(t.tasks);this.saveNewHashedTasks(n);this.subscribers.forEach((i=>{if(!e||e&&!!i.callOnInit){i.subscriber(n,t.pagination)}}))}))}fetchTaskList(){return __awaiter(this,void 0,void 0,(function*(){try{return yield this.inboxRESTService.get({pageSize:ri.INBOX_POLLING_PAGESIZE,currentPage:ri.INBOX_POLLING_CURRENTPAGE})}catch(e){return Promise.reject()}}))}};t.WorkflowTasksPollingService=__decorate([o.Injectable(),__metadata("design:paramtypes",[t.TimerService,IRestServiceFactory,t.CrossFrameEventService])],t.WorkflowTasksPollingService);t.OpenPageWorkflowMenu=void 0;(function(e){e["Default"]="Default";e["SwitchPerspective"]="SwitchPerspective"})(t.OpenPageWorkflowMenu||(t.OpenPageWorkflowMenu={}));t.WorkflowService=class WorkflowService{constructor(e,t,n,i,o,s,r,a,l,c,d,u,m){this.restServiceFactory=e;this.crossFrameEventService=t;this.systemEventService=n;this.sharedDataService=i;this.perspectiveService=o;this.catalogService=s;this.experienceService=r;this.workflowTasksPollingService=a;this.pageService=l;this.syncPollingService=c;this.cmsitemsRestService=d;this.translateService=u;this.storageService=m;this.workflowTasksCountSubject=new p.BehaviorSubject(0);this.resourceWorkflowURI=`/cmswebservices/v1/catalogs/${re}/versions/${ae}/workflows`;this.resourceWorkflowActionsURI=`/cmswebservices/v1/catalogs/${re}/versions/${ae}/workflows/:workflowCode/actions`;this.resourceWorkflowTemplateURI=`/cmswebservices/v1/catalogs/${re}/versions/${ae}/workflowtemplates`;this.resourceWorkflowOperationsURI=`/cmswebservices/v1/catalogs/${re}/versions/${ae}/workflows/:workflowCode/operations`;this.resourceWorkflowActionCommentsURI=`/cmswebservices/v1/catalogs/${re}/versions/${ae}/workflows/:workflowCode/actions/:actionCode/comments`;this.resourceWorkflowEditableItemsURI=`/cmssmarteditwebservices/v1/catalogs/${re}/versions/${ae}/workfloweditableitems`;this.resourceWorkflowInboxTasksURI=`/cmssmarteditwebservices/v1/inbox/workflowtasks`;this.workflowRESTService=this.restServiceFactory.get(this.resourceWorkflowURI);this.workflowTemplateRESTService=this.restServiceFactory.get(this.resourceWorkflowTemplateURI);this.workflowActionsRESTService=this.restServiceFactory.get(this.resourceWorkflowActionsURI);this.workflowInboxTasksRESTService=this.restServiceFactory.get(this.resourceWorkflowInboxTasksURI);this.workflowEditableItemsRESTService=this.restServiceFactory.get(this.resourceWorkflowEditableItemsURI);this.crossFrameEventService.subscribe(Le,(()=>this.openPageWorkflowMenu()));this.crossFrameEventService.subscribe(xe,(()=>this.openPageWorkflowMenu()));this.workflowTasksPollingService.addSubscriber(((e,t)=>{const n=t.totalCount||0;this.updateWorkflowTasksCount(n)}),true)}getWorkflows(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.workflowRESTService.get(e);return t.workflows}))}getWorkflowTemplates(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.workflowTemplateRESTService.get(e);return t.templates}))}getAllActionsForWorkflowCode(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.workflowActionsRESTService.get({workflowCode:e});return t.actions}))}cancelWorflow(e){this.workflowOperationsRESTService=this.restServiceFactory.get(this.resourceWorkflowOperationsURI.replace(":workflowCode",e.workflowCode));return this.workflowOperationsRESTService.save({operation:t.WorkflowOperations.CANCEL})}getWorkflowTemplateByCode(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.getWorkflowTemplates({});const n=t.find((t=>t.code===e));return n}))}areWorkflowsEnabledOnCurrentCatalogVersion(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getWorkflowTemplates({});return e&&e.length>0}))}getActiveWorkflowForPageUuid(e){return __awaiter(this,void 0,void 0,(function*(){const n=yield this.getWorkflows({pageSize:1,currentPage:0,attachment:e,statuses:t.WorkflowStatus.RUNNING+","+t.WorkflowStatus.PAUSED});return n[0]===undefined?null:n[0]}))}isPageInWorkflow(e){return __awaiter(this,void 0,void 0,(function*(){return!!(yield this.getActiveWorkflowForPageUuid(e.uuid))}))}isUserParticipanInActiveAction(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.getActiveActionsForWorkflowCode(e);return t.length>0}))}getActiveActionsForWorkflowCode(e){return __awaiter(this,void 0,void 0,(function*(){const n=yield this.getAllActionsForWorkflowCode(e);return n.filter((e=>e.isCurrentUserParticipant&&(t.WorkflowActionStatus.IN_PROGRESS===e.status.toLowerCase()||t.WorkflowActionStatus.PAUSED===e.status.toLowerCase())))}))}getCommentsForWorkflowAction(e,t,n){this.workflowActionCommentsRESTService=this.restServiceFactory.get(this.resourceWorkflowActionCommentsURI.replace(":workflowCode",e).replace(":actionCode",t));return this.workflowActionCommentsRESTService.page(n)}getWorkflowInboxTasks(e){return this.workflowInboxTasksRESTService.page(e)}getTotalNumberOfActiveWorkflowTasks(){return this.workflowTasksCountSubject.asObservable()}updateWorkflowTasksCount(e){this.workflowTasksCountSubject.next(e)}getWorkflowEditableItems(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.workflowEditableItemsRESTService.get({itemUids:e});return t.editableItems}))}getResourceWorkflowURI(){return this.resourceWorkflowURI}getResourceWorkflowOperationsURI(){return this.resourceWorkflowOperationsURI}openPageWorkflowMenu(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.sharedDataService.get(Ht);if(e===t.OpenPageWorkflowMenu.Default){const e=yield this.perspectiveService.getActivePerspectiveKey();if(e===t.CMSModesService.BASIC_PERSPECTIVE_KEY||e===t.CMSModesService.ADVANCED_PERSPECTIVE_KEY){this.systemEventService.publish(Gt,true);this.sharedDataService.remove(Ht)}else{yield this.sharedDataService.set(Ht,t.OpenPageWorkflowMenu.SwitchPerspective);this.perspectiveService.switchTo(t.CMSModesService.ADVANCED_PERSPECTIVE_KEY)}}else if(e===t.OpenPageWorkflowMenu.SwitchPerspective){this.systemEventService.publish(Gt,true);this.sharedDataService.remove(Ht)}}))}loadExperienceAndOpenPageWorkflowMenu(e){return __awaiter(this,void 0,void 0,(function*(){if(e){const n=yield this.catalogService.getDefaultSiteForContentCatalog(e.attachments[0].catalogId);const i={siteId:n.uid,catalogId:e.attachments[0].catalogId,catalogVersion:e.attachments[0].catalogVersion,pageId:e.attachments[0].pageUid};if(!!H.getGatewayTargetFrame()){const n=yield this.experienceService.compareWithCurrentExperience(i);const o=yield this.pageService.getCurrentPageInfo();if(n&&o&&o.displayStatus===e.action.status){yield this.sharedDataService.set(Ht,t.OpenPageWorkflowMenu.Default);this.openPageWorkflowMenu()}else{this._loadExperience(i)}}else{this._loadExperience(i)}}}))}pageHasUnavailableDependencies(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getPageSyncStatus();return!!e.unavailableDependencies&&e.unavailableDependencies.length>0}))}fetchPageTranslatedApprovalInfo(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getPageSyncStatus();const t=e.unavailableDependencies.map((({itemId:e})=>e));const n=yield this.cmsitemsRestService.getByIds(t).then((({response:e})=>e.map((({name:e})=>e)).join(", ")));return this.translateService.instant("se.cms.workflow.approval.info",{itemNames:n})}))}_loadExperience(e){this.storageService.setValueInLocalStorage("seselectedsite",e.siteId,false);this.experienceService.loadExperience(e).then((()=>{this.sharedDataService.set(Ht,t.OpenPageWorkflowMenu.Default)}))}getPageSyncStatus(){return __awaiter(this,void 0,void 0,(function*(){const{uuid:e}=yield this.pageService.getCurrentPageInfo();const t=yield this.catalogService.retrieveUriContext();return this.syncPollingService.getSyncStatus(e,t)}))}};__decorate([a.Cached({actions:[bn],tags:[Nn,Ln,si,oi,ii]}),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Promise)],t.WorkflowService.prototype,"getWorkflows",null);__decorate([a.Cached({actions:[bn],tags:[Nn]}),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Promise)],t.WorkflowService.prototype,"getWorkflowTemplates",null);__decorate([a.Cached({actions:[bn],tags:[Nn,si,oi,ii]}),__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",Promise)],t.WorkflowService.prototype,"getAllActionsForWorkflowCode",null);t.WorkflowService=__decorate([o.Injectable(),__metadata("design:paramtypes",[IRestServiceFactory,t.CrossFrameEventService,t.SystemEventService,a.ISharedDataService,IPerspectiveService,ICatalogService,IExperienceService,t.WorkflowTasksPollingService,IPageService,ISyncPollingService,t.CmsitemsRestService,h.TranslateService,a.IStorageService])],t.WorkflowService);t.SyncPollingService=class SyncPollingService extends ISyncPollingService{constructor(){super()}};t.SyncPollingService=__decorate([Vn("getSyncStatus","fetchSyncStatus","changePollingSpeed","registerSyncPollingEvents","performSync"),__metadata("design:paramtypes",[])],t.SyncPollingService);t.PageVersioningService=class PageVersioningService{constructor(e){this.restServiceFactory=e;this.pageVersionsServiceResourceURI=`/cmswebservices/v1/sites/${le}/cmsitems/:pageUuid/versions`;this.pageVersionsRollbackServiceResourceURI=`/cmswebservices/v1/sites/${le}/cmsitems/:pageUuid/versions/:versionId/rollbacks`;this.pageVersionRESTService=this.restServiceFactory.get(this.pageVersionsServiceResourceURI);this.pageVersionsRollbackRESTService=this.restServiceFactory.get(this.pageVersionsRollbackServiceResourceURI)}findPageVersions(e){return this.pageVersionRESTService.page(e)}getPageVersionForId(e,t){return this.pageVersionRESTService.get({pageUuid:e,identifier:t})}getResourceURI(){return this.pageVersionsServiceResourceURI}deletePageVersion(e,t){return this.pageVersionRESTService.remove({pageUuid:e,identifier:t})}rollbackPageVersion(e,t){return this.pageVersionsRollbackRESTService.save({pageUuid:e,versionId:t})}};t.PageVersioningService=__decorate([o.Injectable(),__metadata("design:paramtypes",[IRestServiceFactory])],t.PageVersioningService);t.PageVersionSelectionService=class PageVersionSelectionService{constructor(e,t,n,i,o,s,r){this.crossFrameEventService=e;this.alertService=t;this.experienceService=n;this.cMSModesService=i;this.pageInfoService=o;this.pageVersioningService=s;this.translateService=r;this.PAGE_VERSIONS_TOOLBAR_ITEM_KEY="se.cms.pageVersionsMenu";this.PAGE_VERSION_UNSELECTED_MSG_KEY="se.cms.versions.unselect.version";this.selectedPageVersionSubject=new p.BehaviorSubject(null);this.unSubEventPerspectiveChanged=this.crossFrameEventService.subscribe(xe,(()=>this.removePageVersionOnPerspectiveChange()));this.unSubEventPerspectiveRefreshed=this.crossFrameEventService.subscribe(Le,(()=>this.resetPageVersionContext()));this.unSubEventPageChange=this.crossFrameEventService.subscribe(a.EVENTS.PAGE_CHANGE,((e,t)=>this.initOnPageChange(t)));this.unSubSelectedPageVersion=this.selectedPageVersionSubject.subscribe((e=>this.selectedPageVersion=e))}ngOnDestroy(){this.unSubEventPerspectiveChanged();this.unSubEventPerspectiveRefreshed();this.unSubEventPageChange();this.unSubSelectedPageVersion.unsubscribe()}getSelectedPageVersion(){return this.selectedPageVersion}getSelectedPageVersion$(){return this.selectedPageVersionSubject.asObservable()}hideToolbarContextIfNotNeeded(){if(!this.selectedPageVersion){this.crossFrameEventService.publish(Et,this.PAGE_VERSIONS_TOOLBAR_ITEM_KEY)}}showToolbarContextIfNeeded(){if(this.selectedPageVersion){this.crossFrameEventService.publish(It,this.PAGE_VERSIONS_TOOLBAR_ITEM_KEY)}}selectPageVersion(e){if(!this.isSameVersion(this.selectedPageVersion,e)){this.selectedPageVersionSubject.next(e);this.experienceService.updateExperience({versionId:e.uid});this.showToolbarContextIfNeeded();this.crossFrameEventService.publish(a.EVENTS.PAGE_SELECTED)}}deselectPageVersion(e=true){if(this.selectedPageVersion&&e){const e=this.translateService.instant(this.PAGE_VERSION_UNSELECTED_MSG_KEY);this.alertService.showInfo(e)}this.selectedPageVersionSubject.next(null);this.experienceService.updateExperience({versionId:null});this.crossFrameEventService.publish(Et,this.PAGE_VERSIONS_TOOLBAR_ITEM_KEY)}updatePageVersionDetails(e){this.selectedPageVersionSubject.next(e)}initOnPageChange(e){return __awaiter(this,void 0,void 0,(function*(){if(e.versionId&&!this.selectedPageVersion){const t=yield this.pageInfoService.getPageUUID();const n=yield this.pageVersioningService.getPageVersionForId(t,String(e.versionId));this.selectedPageVersionSubject.next(n);this.showToolbarContextIfNeeded();this.crossFrameEventService.publish(a.EVENTS.PAGE_SELECTED)}}))}isSameVersion(e,t){return e!==null&&t!==null?this.selectedPageVersion.uid===t.uid:false}removePageVersionOnPerspectiveChange(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.cMSModesService.isVersioningPerspectiveActive();if(this.selectedPageVersion){const t=yield this.pageInfoService.getPageUUID();if(!e||this.selectedPageVersion.itemUUID!==t){this.deselectPageVersion()}}}))}resetPageVersionContext(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.experienceService.getCurrentExperience();if(!e.versionId&&this.selectedPageVersion){this.selectedPageVersionSubject.next(null);this.hideToolbarContextIfNotNeeded()}else{this.showToolbarContextIfNeeded()}}))}};t.PageVersionSelectionService=__decorate([o.Injectable(),__metadata("design:paramtypes",[t.CrossFrameEventService,a.IAlertService,IExperienceService,t.CMSModesService,IPageInfoService,t.PageVersioningService,h.TranslateService])],t.PageVersionSelectionService);const ai=`You need to import RouterModule to enable theme settings via the url.`;t.ThemesService=class ThemesService{constructor(e,t,n,i){this._activatedRoute=e;this._sanitizer=t;this.restServiceFactory=n;this.languageService=i;this.onThemeQueryParamChange=new p.Subject;this._onDestroy$=new p.Subject;this.initThemes()}initThemes(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.languageService.getResolveLocale();this.themeRestService=this.restServiceFactory.get(`${sn}?langIsoCode=${e}`);this.themes=yield this.themeRestService.get()}))}getThemes(){return this.themes}setThemeByRoute(e){const t=e||"theme";if(!this._activatedRoute){throw new Error(ai)}this._activatedRoute.queryParams.pipe(_.takeUntil(this._onDestroy$),_.filter((e=>e&&e[t]))).subscribe((e=>this.propagateThemes(e[t])));const n=this.getNativeParameterByName(t);if(n){this.propagateThemes(n)}}getThemesFromURL(e){const t=e||"theme";const n=this.getNativeParameterByName(t);if(!n||o.isDevMode()){return}return{themeUrl:this.setTheme(n),customThemeUrl:this.setCustomTheme(n)}}setTheme(e){return this._sanitizer.bypassSecurityTrustResourceUrl(`static-resources/dist/smartedit-container-new/${e}/css_variables.css`)}setCustomTheme(e){return this._sanitizer.bypassSecurityTrustResourceUrl(`static-resources/dist/smartedit-container-new/${e}/${e}.css`)}getNativeParameterByName(e){e=e.replace(/[[\]]/g,"\\$&");const t=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`);const n=2;const i=t.exec(window.location.href);if(!i||!i[n]){return""}return decodeURIComponent(i[n].replace(/\+/g," "))}propagateThemes(e){this.onThemeQueryParamChange.next({themeUrl:this.setTheme(e),customThemeUrl:this.setCustomTheme(e)})}};t.ThemesService=__decorate([o.Injectable(),__param(0,o.Optional()),__metadata("design:paramtypes",[g.ActivatedRoute,v.DomSanitizer,IRestServiceFactory,t.LanguageService])],t.ThemesService);t.SlotRestrictionsService=class SlotRestrictionsService extends ISlotRestrictionsService{getAllComponentTypesSupportedOnPage(){return null}getSlotRestrictions(e){return null}isSlotEditable(e){return null}isComponentAllowedInSlot(e,t){return null}};t.SlotRestrictionsService=__decorate([Vn("getAllComponentTypesSupportedOnPage","getSlotRestrictions","isSlotEditable","isComponentAllowedInSlot")],t.SlotRestrictionsService);t.EditorModalService=class EditorModalService extends IEditorModalService{};t.EditorModalService=__decorate([Vn("open","openAndRerenderSlot","openGenericEditor")],t.EditorModalService);t.PageContentSlotsService=class PageContentSlotsService{constructor(e,t,n){this.crossFrameEventService=t;this.pageInfoService=n;this.resource=e.get($t);this.crossFrameEventService.subscribe(a.EVENTS.PAGE_CHANGE,(()=>this.reloadPageContentSlots()))}getPageContentSlots(){return __awaiter(this,void 0,void 0,(function*(){if(!this.pageContentSlots){yield this.reloadPageContentSlots()}return this.pageContentSlots}))}getSlotStatus(e){return __awaiter(this,void 0,void 0,(function*(){yield this.getPageContentSlots();const t=s.first(this.pageContentSlots.filter((t=>t.slotId===e)));return t?t.slotStatus:null}))}isSlotShared(e){return __awaiter(this,void 0,void 0,(function*(){yield this.getPageContentSlots();const t=s.first(this.pageContentSlots.filter((t=>t.slotId===e)));return t&&t.slotShared}))}reloadPageContentSlots(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.pageInfoService.getPageUID();const t=yield this.resource.get({pageId:e});this.pageContentSlots=s.uniq(t.pageContentSlotList||[])}))}};t.PageContentSlotsService=__decorate([o.Injectable(),__metadata("design:paramtypes",[IRestServiceFactory,t.CrossFrameEventService,IPageInfoService])],t.PageContentSlotsService);class PageInfoService extends IPageInfoService{getPageUID(){return null}getPageUUID(){return null}getCatalogVersionUUIDFromPage(){return null}}PageInfoService.PATTERN_SMARTEDIT_CATALOG_VERSION_UUID=/smartedit-catalog-version-uuid\-(\S+)/;t.IComponentHandlerService=class IComponentHandlerService{constructor(e){this.yjQuery=e}reloadInner(){"proxyFunction";return}isExternalComponent(e,t){"proxyFunction";return Promise.resolve(true)}getOverlay(){return this.yjQuery("#"+Ge)}isOverlayOn(){return this.getOverlay().length&&this.getOverlay()[0].style.display!=="none"}getComponentUnderSlot(e,t,n,i){const o=this.buildComponentQuery(n,it);const s=this.buildComponentQuery(e,t,i);const r=`${o} ${s}`;return this.yjQuery(r)}getComponent(e,t,n){return this.yjQuery(this.buildComponentQuery(e,t,n))}getOriginalComponentWithinSlot(e,t,n){return this.getComponentUnderSlot(e,t,n,qe)}getOriginalComponent(e,t){return this.getComponent(e,t,qe)}getOverlayComponentWithinSlot(e,t,n){return this.getComponentUnderSlot(e,t,n,nt)}getOverlayComponent(e){const t=this.getParentSlotForComponent(e.parent());if(t){return this.getComponentUnderSlot(e.attr(Z),e.attr(X),t,nt)}else{return this.getComponent(e.attr(Z),e.attr(X),nt)}}getComponentInOverlay(e,t){return this.getComponent(e,t,nt)}getParentSlotForComponent(e){const t=this.yjQuery(e).closest(`[${X}=${it}]`);return t.attr(Z)}getComponentPositionInSlot(e,t){const n=this.getOriginalComponentsWithinSlot(e);return x.findIndex(n,(e=>this.getId(e)===t))}getOriginalComponentsWithinSlot(e){return this.yjQuery(this.buildComponentsInSlotQuery(e))}getSlotOperationRelatedId(e){e=this.yjQuery(e);const t=e.attr(Ye);return t&&e.attr(ot)?t:e.attr(Z)}getSlotOperationRelatedUuid(e){const t=this.yjQuery(e).attr(Ye);return t&&this.yjQuery(e).attr(ot)?t:this.yjQuery(e).attr(tt)}getParent(e){e=this.yjQuery(e);let t=null;if(e.hasClass(qe)){t=qe}else if(e.hasClass(nt)){t=nt}if(a.stringUtils.isBlank(t)){throw new Error("componentHandlerService.getparent.error.component.from.unknown.layer")}return e.closest(`.${t}[${Z}]`+`[${Z}!='${e.attr(Z)}']`)}getClosestSmartEditComponent(e){return this.yjQuery(e).closest("."+qe)}isSmartEditComponent(e){return this.yjQuery(e).hasClass(qe)}setId(e,t){return this.yjQuery(e).attr(Z,t)}getId(e){return this.yjQuery(e).attr(Z)}getUuid(e){return this.yjQuery(e).attr(tt)}getCatalogVersionUuid(e){return this.yjQuery(e).attr(Ke)}setType(e,t){return this.yjQuery(e).attr(X,t)}getType(e){return this.yjQuery(e).attr(X)}getSlotOperationRelatedType(e){const t=this.yjQuery(e).attr(ot);return t&&this.yjQuery(e).attr(Ye)?t:this.yjQuery(e).attr(X)}getAllComponentsSelector(){return`.${qe}[${X}!='ContentSlot']`}getAllSlotsSelector(){return`.${qe}[${X}='ContentSlot']`}getParentSlotUuidForComponent(e){return this.yjQuery(e).closest(`[${X}=${it}]`).attr(tt)}getBodyClassAttributeByRegEx(e){try{const t=this.yjQuery("body").attr("class");return e.exec(t)[1]}catch(e){throw new Error(JSON.stringify({name:"InvalidStorefrontPageError",message:"Error: the page is not a valid storefront page."}))}}getFirstSmartEditComponentChildren(e){const t=this.yjQuery(e);const n=t[0];if(!n){return[]}const i=Array.from(n.getElementsByClassName(qe)).filter((e=>{let t=e.parentElement;while(t!==n){if(t.classList.contains(qe)){return false}t=t.parentElement}return true}));return this.yjQuery(i)}getComponentCloneInOverlay(e){const t=e.attr(Q);return this.yjQuery(`.${nt}[${Q}='${t}']`)}getAllSlotUids(){const e=this.yjQuery(this.getAllSlotsSelector());return Array.prototype.slice.call(e.map(((e,t)=>this.getId(t))))}buildComponentQuery(e,t,n){let i="";i+=n?"."+n:"";i+=`[${Z}='${e}']`;i+=`[${X}='${t}']`;return i}buildComponentsInSlotQuery(e){let t="";t+="."+qe;t+=`[${Z}='${e}']`;t+=`[${X}='${it}']`;t+=" > ";t+=`[${Z}]`;return t}};t.IComponentHandlerService=__decorate([__param(0,o.Inject(Bn)),__metadata("design:paramtypes",[Function])],t.IComponentHandlerService);t.SlotSharedService=class SlotSharedService{constructor(e,t,n,i,o,s,r){this.pageContentSlotsService=e;this.pageInfoService=t;this.translateService=n;this.editorModalService=i;this.componentHandlerService=o;this.catalogService=s;this.sharedDataService=r}isSlotShared(e){return this.pageContentSlotsService.isSlotShared(e)}isGlobalSlot(e,t){return __awaiter(this,void 0,void 0,(function*(){const n=yield this.componentHandlerService.isExternalComponent(e,t);const[i,o]=yield Promise.all([this.catalogService.isCurrentCatalogMultiCountry(),this.sharedDataService.get(zt)]);const s=i||false;const r=this.isCurrentPageFromParentCatalog(o);return s&&(n||r&&!n)}))}setSharedSlotEnablementStatus(e){this.disableShareSlotStatus=e}areSharedSlotsDisabled(){return this.disableShareSlotStatus}replaceGlobalSlot(e){return __awaiter(this,void 0,void 0,(function*(){this.validateComponentAttributes(e);const t=yield this.constructCmsItemParameter(e);const n={title:"se.cms.slot.shared.replace.editor.title",structure:{attributes:[{cmsStructureType:"SlotSharedSlotTypeField",qualifier:"isSlotCustom",required:true},{cmsStructureType:"SlotSharedCloneActionField",qualifier:"cloneAction",required:true}]},contentApi:Jn,saveLabel:"se.cms.slot.shared.replace.editor.save",content:t,initialDirty:true};return this.editorModalService.openGenericEditor(n)}))}replaceSharedSlot(e){return __awaiter(this,void 0,void 0,(function*(){this.validateComponentAttributes(e);const t=yield this.constructCmsItemParameter(e);t.isSlotCustom=true;const n={title:"se.cms.slot.shared.replace.editor.title",structure:{attributes:[{cmsStructureType:"SlotSharedCloneActionField",qualifier:"cloneAction",required:true}]},contentApi:Jn,saveLabel:"se.cms.slot.shared.replace.editor.save",content:t,initialDirty:true};return this.editorModalService.openGenericEditor(n)}))}constructCmsItemParameter(e){return __awaiter(this,void 0,void 0,(function*(){const t=this.translateService.instant("se.cms.slot.shared.clone");const n=yield this.pageInfoService.getPageUID();const i=yield this.pageInfoService.getCatalogVersionUUIDFromPage();const o=`${n}-${e.smarteditComponentId}-${t}`;const s={name:o,smarteditComponentId:e.smarteditComponentId,contentSlotUuid:e.smarteditComponentUuid,itemtype:e.smarteditComponentType,catalogVersion:i,pageUuid:n,onlyOneRestrictionMustApply:false};return s}))}validateComponentAttributes(e){if(!e){throw new Error("Parameter: componentAttributes needs to be supplied!")}const t=["smarteditComponentId","smarteditComponentUuid","smarteditComponentType"];const n=t.find((t=>!e[t]));if(!!n){throw new Error(`Parameter: componentAttributes.${n} needs to be supplied!`)}}isCurrentPageFromParentCatalog(e){var t,n;const i=((t=e===null||e===void 0?void 0:e.pageContext)===null||t===void 0?void 0:t.catalogVersionUuid)||"";const o=((n=e===null||e===void 0?void 0:e.catalogDescriptor)===null||n===void 0?void 0:n.catalogVersionUuid)||"";const s=o!==i;return s}};t.SlotSharedService=__decorate([o.Injectable(),__metadata("design:paramtypes",[t.PageContentSlotsService,IPageInfoService,h.TranslateService,IEditorModalService,t.IComponentHandlerService,ICatalogService,a.ISharedDataService])],t.SlotSharedService);t.ComponentMenuService=class ComponentMenuService{constructor(e,t,n){this.catalogService=e;this.experienceService=t;this.storageService=n;this.SELECTED_CATALOG_VERSION_COOKIE_NAME="se_catalogmenu_catalogversion_cookie"}hasMultipleContentCatalogs(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getPageContext();const t=yield this.getContentCatalogs();const n=t.find((t=>t.catalogId===e.catalogId));return!!n.parents&&n.parents.length>0}))}getContentCatalogs(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getPageContext();return e?this.catalogService.getContentCatalogsForSite(e.siteId):[]}))}getValidContentCatalogVersions(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getPageContext();const t=yield this.getContentCatalogs();let n=[];const i=t.find((t=>t.catalogId===e.catalogId));n.push(this.getActiveOrCurrentVersionForCatalog(e,i));const o=i.parents.map((t=>this.getActiveOrCurrentVersionForCatalog(e,t)));n=[...o,...n];return n}))}getInitialCatalogVersion(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.storageService.getValueFromLocalStorage(this.SELECTED_CATALOG_VERSION_COOKIE_NAME,false);const n=typeof t==="string"?t:null;const i=e.find((e=>e.id===n));return i?i:e[e.length-1]}))}persistCatalogVersion(e){return this.storageService.setValueInLocalStorage(this.SELECTED_CATALOG_VERSION_COOKIE_NAME,e,false)}getActiveOrCurrentVersionForCatalog(e,t){const n=t.versions.find((n=>{if(e.catalogId===t.catalogId){return e.catalogVersion===n.version}return n.active}));return{isCurrentCatalog:e.catalogVersion===n.version,catalogName:t.name?t.name:t.catalogName,catalogId:t.catalogId,catalogVersionId:n.version,id:n.uuid}}getPageContext(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.experienceService.getCurrentExperience();return e.pageContext}))}};t.ComponentMenuService=__decorate([o.Injectable(),__metadata("design:paramtypes",[ICatalogService,IExperienceService,a.IStorageService])],t.ComponentMenuService);const li=1024;const ci={ACCEPTED_FILE_TYPES:{VIDEO:["mp4","avi","x-msvideo","wmv","mpg","mpeg","flv"],IMAGE:["jpeg","jpg","gif","bmp","tiff","tif","png","svg"],PDF_DOCUMENT:["pdf"],DEFAULT:["jpeg","jpg","gif","bmp","tiff","tif","png","svg"]},DEFAULT_MAX_UPLOAD_FILE_SIZE:20,I18N_KEYS:{FILE_TYPE_INVALID:"se.upload.file.type.invalid",FILE_SIZE_INVALID:"se.upload.file.size.invalid"}};t.FileValidationService=class FileValidationService extends IFileValidation{constructor(e,t){super();this.fileMimeTypeService=e;this.fileValidatorFactory=t;this.validators=[{subject:"size",message:ci.I18N_KEYS.FILE_SIZE_INVALID,validate:(e,t)=>e<=t*li*li}]}validate(e,t,n){return __awaiter(this,void 0,void 0,(function*(){this.fileValidatorFactory.build(this.validators).validate(e,t,n);try{yield this.fileMimeTypeService.isFileMimeTypeValid(e);if(n.length>0){return Promise.reject(n)}return Promise.resolve()}catch(e){n.push({subject:"type",message:ci.I18N_KEYS.FILE_TYPE_INVALID});return Promise.reject(n)}}))}};t.FileValidationService=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.FileMimeTypeService,a.FileValidatorFactory])],t.FileValidationService);t.MediaUploaderService=class MediaUploaderService extends IMediaToUpload{constructor(e){super();this.restServiceFactory=e;this.mediaRestService=this.restServiceFactory.get(kt)}uploadMedia(e){var t;const n=new FormData;x.forEach(e,((e,t)=>{n.append(t,e)}));return this.mediaRestService.save(n,{headers:{enctype:"multipart/form-data",fileSize:""+((t=e===null||e===void 0?void 0:e.file)===null||t===void 0?void 0:t.size)}})}};t.MediaUploaderService=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.RestServiceFactory])],t.MediaUploaderService);t.MediaService=class MediaService extends IMediaService{constructor(e){super();this.restServiceFactory=e}getPage(e,t,n,i){return __awaiter(this,void 0,void 0,(function*(){const o={catalogId:ie,catalogVersion:oe};const s=this.contextParamsToCommaSeparated(o);const r={params:s,mask:e,pageSize:t,currentPage:n,mimeType:i};const a=yield this.restServiceFactory.get(jt).get(r);const l={results:[],pagination:a.pagination};l.results=a.media.map((e=>this.mediaDTOtoMedia(e)));return l}))}getMedia(e){return __awaiter(this,void 0,void 0,(function*(){const t=`${Vt}/${e}`;const n=yield this.restServiceFactory.get(t).get();return this.mediaDTOtoMedia(n)}))}contextParamsToCommaSeparated(e){return Object.keys(e).reduce(((t,n)=>{t+=`,${n}:${e[n]}`;return t}),"").substring(1)}mediaDTOtoMedia(e){const t=["catalogId","catalogVersion","uuid"];const n={};Object.getOwnPropertyNames(e).filter((e=>t.indexOf(e)===-1)).forEach((t=>n[t]=e[t]));n.id=e.uuid;return n}};t.MediaService=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.RestServiceFactory])],t.MediaService);const di=new o.InjectionToken("DROPDOWN_MENU_ITEM_DATA");window.__smartedit__.addDecoratorPayload("Component","DropdownMenuItemDefaultComponent",{selector:"se-dropdown-menu-item-default",changeDetection:o.ChangeDetectionStrategy.OnPush,template:`<a fd-list-link class="se-dropdown-item" [ngClass]="data.dropdownItem.customCss" (click)="data.dropdownItem.callback(data.selectedItem, data.dropdownItem)"><span *ngIf="data.dropdownItem.icon" [ngClass]="data.dropdownItem.icon"></span> <span fd-list-title>{{ data.dropdownItem.key | translate }}</span></a>`});t.DropdownMenuItemDefaultComponent=class DropdownMenuItemDefaultComponent{constructor(e){this.data=e}};t.DropdownMenuItemDefaultComponent=__decorate([o.Component({selector:"se-dropdown-menu-item-default",changeDetection:o.ChangeDetectionStrategy.OnPush,template:`<a fd-list-link class="se-dropdown-item" [ngClass]="data.dropdownItem.customCss" (click)="data.dropdownItem.callback(data.selectedItem, data.dropdownItem)"><span *ngIf="data.dropdownItem.icon" [ngClass]="data.dropdownItem.icon"></span> <span fd-list-title>{{ data.dropdownItem.key | translate }}</span></a>`}),__param(0,o.Inject(di)),__metadata("design:paramtypes",[Object])],t.DropdownMenuItemDefaultComponent);const pi={expandedByDefault:false,iconAlignment:"right",iconVisible:true};window.__smartedit__.addDecoratorPayload("Component","CollapsibleContainerComponent",{selector:"se-collapsible-container",template:`<div role="tab" class="collapsible-container__header" [ngClass]="{\n        'collapsible-container__header--icon-right': isIconRight(),\n        'collapsible-container__header--icon-left': isIconLeft()\n    }" [attr.id]="headingId" [attr.aria-selected]="isOpen" (keypress)="handleKeypress($event)"><button type="button" tabindex="0" class="collapsible-container__header__title" (click)="toggle()" [attr.aria-expanded]="isOpen" [attr.aria-controls]="panelId"><ng-content select="se-collapsible-container-header"></ng-content></button> <a class="collapsible-container__header__button btn btn-link" *ngIf="configuration.iconVisible" [ngClass]="{\n            'collapsible-container__header__button--expanded': isOpen\n        }" [title]="isOpen\n            ? ('se.ycollapsible.action.collapse' | translate)\n            : ('se.ycollapsible.action.expand' | translate)\n        " [attr.aria-expanded]="isOpen" (click)="toggle()"><span class="sap-icon--navigation-down-arrow collapsible-container__header__icon"></span></a></div><div #container class="collapsible-container__content panel" [ngStyle]="{ 'max-height.px': isOpen ? containerHeight : 0 }" [attr.id]="panelId" [attr.aria-labelledby]="headingId" [attr.aria-hidden]="!isOpen" role="tabpanel"><ng-content select="se-collapsible-container-content"></ng-content></div>`,styles:[`.collapsible-container__content{overflow:hidden;display:block;transition:max-height .4s ease;width:100%;background-color:#fff}.collapsible-container__header{max-width:100%;background-color:#fff;display:flex;align-items:center;min-height:50px;box-shadow:0 1px 1px rgba(0,0,0,.05)}.collapsible-container__header__title{text-align:left;background:0 0;border:0;outline:0;flex:1;display:flex;align-items:center;min-height:50px;text-decoration:none;user-select:none}.collapsible-container__header__title:hover{text-decoration:none}.collapsible-container__header__button{flex:0;transition:all .4s ease;font-size:20px}.collapsible-container__header__button--expanded{transform:rotate(180deg)}.collapsible-container__header--icon-right .collapsible-container__header__title{order:1}.collapsible-container__header--icon-right .collapsible-container__header__button{order:2}.collapsible-container__header--icon-left .collapsible-container__header__title{order:2}.collapsible-container__header--icon-left .collapsible-container__header__button{order:1}:host(.se-collapsible-container--noshadow) .collapsible-container__content.panel{box-shadow:none}`],changeDetection:o.ChangeDetectionStrategy.OnPush});t.CollapsibleContainerComponent=class CollapsibleContainerComponent{constructor(e){this.cdr=e;this.getApi=new o.EventEmitter;this.containerHeight=0;this.headingId=W.generateIdentifier();this.panelId=W.generateIdentifier();this.api={isExpanded:()=>this.isOpen}}set _container(e){this.container=e;this.containerHeight=e.nativeElement.scrollHeight;if(!this.mutationObserver&&this.container&&this.container.nativeElement){this.mutationObserver=new MutationObserver((()=>{this.containerHeight=this.container.nativeElement.scrollHeight;if(!this.cdr.destroyed){this.cdr.detectChanges()}}));this.mutationObserver.observe(this.container.nativeElement,{childList:true,subtree:true,attributes:true})}}ngOnDestroy(){this.mutationObserver.disconnect()}ngOnChanges(e){if(e.configuration){this.configure()}}ngOnInit(){this.configure();this.isOpen=this.configuration.expandedByDefault;this.getApi.emit(this.api)}toggle(){this.isOpen=!this.isOpen}handleKeypress(e){if(e.code==="Enter"){this.toggle()}}isIconRight(){return this.configuration.iconAlignment==="right"}isIconLeft(){return this.configuration.iconAlignment==="left"}configure(){this.configuration=Object.assign(Object.assign({},pi),this.configuration||{})}};__decorate([o.Input(),__metadata("design:type",Object)],t.CollapsibleContainerComponent.prototype,"configuration",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.CollapsibleContainerComponent.prototype,"getApi",void 0);__decorate([o.ViewChild("container",{static:true}),__metadata("design:type",o.ElementRef),__metadata("design:paramtypes",[o.ElementRef])],t.CollapsibleContainerComponent.prototype,"_container",null);t.CollapsibleContainerComponent=__decorate([o.Component({selector:"se-collapsible-container",template:`<div role="tab" class="collapsible-container__header" [ngClass]="{\n        'collapsible-container__header--icon-right': isIconRight(),\n        'collapsible-container__header--icon-left': isIconLeft()\n    }" [attr.id]="headingId" [attr.aria-selected]="isOpen" (keypress)="handleKeypress($event)"><button type="button" tabindex="0" class="collapsible-container__header__title" (click)="toggle()" [attr.aria-expanded]="isOpen" [attr.aria-controls]="panelId"><ng-content select="se-collapsible-container-header"></ng-content></button> <a class="collapsible-container__header__button btn btn-link" *ngIf="configuration.iconVisible" [ngClass]="{\n            'collapsible-container__header__button--expanded': isOpen\n        }" [title]="isOpen\n            ? ('se.ycollapsible.action.collapse' | translate)\n            : ('se.ycollapsible.action.expand' | translate)\n        " [attr.aria-expanded]="isOpen" (click)="toggle()"><span class="sap-icon--navigation-down-arrow collapsible-container__header__icon"></span></a></div><div #container class="collapsible-container__content panel" [ngStyle]="{ 'max-height.px': isOpen ? containerHeight : 0 }" [attr.id]="panelId" [attr.aria-labelledby]="headingId" [attr.aria-hidden]="!isOpen" role="tabpanel"><ng-content select="se-collapsible-container-content"></ng-content></div>`,styles:[`.collapsible-container__content{overflow:hidden;display:block;transition:max-height .4s ease;width:100%;background-color:#fff}.collapsible-container__header{max-width:100%;background-color:#fff;display:flex;align-items:center;min-height:50px;box-shadow:0 1px 1px rgba(0,0,0,.05)}.collapsible-container__header__title{text-align:left;background:0 0;border:0;outline:0;flex:1;display:flex;align-items:center;min-height:50px;text-decoration:none;user-select:none}.collapsible-container__header__title:hover{text-decoration:none}.collapsible-container__header__button{flex:0;transition:all .4s ease;font-size:20px}.collapsible-container__header__button--expanded{transform:rotate(180deg)}.collapsible-container__header--icon-right .collapsible-container__header__title{order:1}.collapsible-container__header--icon-right .collapsible-container__header__button{order:2}.collapsible-container__header--icon-left .collapsible-container__header__title{order:2}.collapsible-container__header--icon-left .collapsible-container__header__button{order:1}:host(.se-collapsible-container--noshadow) .collapsible-container__content.panel{box-shadow:none}`],changeDetection:o.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[o.ChangeDetectorRef])],t.CollapsibleContainerComponent);window.__smartedit__.addDecoratorPayload("Component","CollapsibleContainerContentComponent",{selector:"se-collapsible-container-content",template:` <ng-content></ng-content> `});t.CollapsibleContainerContentComponent=class CollapsibleContainerContentComponent{};t.CollapsibleContainerContentComponent=__decorate([o.Component({selector:"se-collapsible-container-content",template:` <ng-content></ng-content> `})],t.CollapsibleContainerContentComponent);window.__smartedit__.addDecoratorPayload("Component","CollapsibleContainerHeaderComponent",{selector:"se-collapsible-container-header",template:` <ng-content></ng-content> `});t.CollapsibleContainerHeaderComponent=class CollapsibleContainerHeaderComponent{};t.CollapsibleContainerHeaderComponent=__decorate([o.Component({selector:"se-collapsible-container-header",template:` <ng-content></ng-content> `})],t.CollapsibleContainerHeaderComponent);t.CollapsibleContainerModule=class CollapsibleContainerModule{};t.CollapsibleContainerModule=__decorate([o.NgModule({imports:[h.TranslateModule.forChild(),u.CommonModule],declarations:[t.CollapsibleContainerComponent,t.CollapsibleContainerContentComponent,t.CollapsibleContainerHeaderComponent],entryComponents:[t.CollapsibleContainerComponent,t.CollapsibleContainerContentComponent,t.CollapsibleContainerHeaderComponent],exports:[t.CollapsibleContainerComponent,t.CollapsibleContainerContentComponent,t.CollapsibleContainerHeaderComponent]})],t.CollapsibleContainerModule);window.__smartedit__.addDecoratorPayload("Component","WaitDialogComponent",{template:`\n        <fd-dialog id="se-busy-indicator-dialog">\n            <fd-dialog-body>\n                <div class="panel panel-default ySEPanelSpinner">\n                    <div class="panel-body">\n                        <div class="spinner ySESpinner">\n                            <div class="fd-busy-indicator-extended">\n                                <fd-busy-indicator\n                                    [loading]="true"\n                                    size="l"\n                                    [label]="\n                                        modalRef.data.customLoadingMessageLocalizedKey ||\n                                            'se.wait.dialog.message' | translate\n                                    "></fd-busy-indicator>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </fd-dialog-body>\n        </fd-dialog>\n    `});t.WaitDialogComponent=class WaitDialogComponent{constructor(e){this.modalRef=e}};t.WaitDialogComponent=__decorate([o.Component({template:`\n        <fd-dialog id="se-busy-indicator-dialog">\n            <fd-dialog-body>\n                <div class="panel panel-default ySEPanelSpinner">\n                    <div class="panel-body">\n                        <div class="spinner ySESpinner">\n                            <div class="fd-busy-indicator-extended">\n                                <fd-busy-indicator\n                                    [loading]="true"\n                                    size="l"\n                                    [label]="\n                                        modalRef.data.customLoadingMessageLocalizedKey ||\n                                            'se.wait.dialog.message' | translate\n                                    "></fd-busy-indicator>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </fd-dialog-body>\n        </fd-dialog>\n    `}),__metadata("design:paramtypes",[S.DialogRef])],t.WaitDialogComponent);class TabsSelectAdapter{static transform(e,t){return{id:t,label:e.title,value:e,listItemClassName:e.hasErrors&&"sm-tab-error"}}}window.__smartedit__.addDecoratorPayload("Component","TabsComponent",{selector:"se-tabs",template:`<div class="se-tabset-wrapper"><nav fd-tab-nav class="nav nav-tabs se-tabset" role="tablist" *ngIf="isInitialized"><ng-container *ngIf="tabsList.length !== numTabsDisplayed"><ng-container *ngFor="let tab of (getVisibleTabs() | async); trackBy: trackTabById" [ngTemplateOutlet]="tabsetLink" [ngTemplateOutletContext]="{ $implicit: tab }"></ng-container></ng-container><ng-container *ngIf="tabsList && tabsList.length == numTabsDisplayed"><ng-container *ngFor="let tab of tabsList; trackBy: trackTabById" [ngTemplateOutlet]="tabsetLink" [ngTemplateOutletContext]="{ $implicit: tab }"></ng-container></ng-container><su-select class="se-tabset__select" *ngIf="tabsList.length > numTabsDisplayed && (getDropdownTabs() | async)" [items]="dropdownTabs" [isKeyboardControlEnabled]="false" [hasCustomTrigger]="true" (onItemSelected)="selectTab($event.value)"><li fd-list-item [ngClass]="{'active': isActiveInMoreTab()}" su-select-custom-trigger><a fd-list-link [ngClass]="{'sm-tab-error': dropDownHasErrors()}" class="dropdown-toggle"><span fd-list-title *ngIf="!isActiveInMoreTab()" class="multi-tabs__more-span">{{ 'se.ytabset.tabs.more' | translate }} </span><span fd-list-title *ngIf="isActiveInMoreTab()" class="multi-tabs__more-span">{{selectedTab.title | translate}} </span><span class="caret"></span></a></li></su-select><ng-template #tabsetLink let-tab><div fd-tab-item [ngClass]="{\n                    'active': tab.id === selectedTab.id,\n                    'se-tabset__tab--disabled': tab.disabled,\n                    'sm-tab-error': tab.hasErrors\n                }" [attr.tab-id]="tab.id" class="se-tabset__tab"><a fd-tab-link [ngClass]="{'sm-tab-error': tab.hasErrors}" class="se-tabset__link mycustomtabset" (click)="selectTab(tab)" *ngIf="!tab.message">{{tab.title | translate}}</a><se-tooltip [triggers]="['mouseover']" *ngIf="tab.message"><a fd-list-title se-tooltip-trigger [ngClass]="{'sm-tab-error': tab.hasErrors}" class="se-tabset__link" (click)="selectTab(tab)">{{tab.title | translate}} </a><span fd-list-title se-tooltip-body>{{ tab.message }}</span></se-tooltip></div></ng-template></nav><div class="se-tab-set__content-wrapper" *ngIf="selectedTab"><ng-container *ngFor="let tab of tabsList; trackBy: trackTabById"><se-tab [hidden]="tab.id !== selectedTab.id" [attr.tab-id]="tab.id" [tab]="tab" [model]="model"></se-tab></ng-container></div></div>`});t.TabsComponent=class TabsComponent{constructor(e){this.userTrackingService=e;this.tabsList=[];this.onTabSelected=new o.EventEmitter;this.tabChangedStream=new p.BehaviorSubject(null)}get isInitialized(){return!!this.tabsList&&this.tabsList.length>1&&!!this.selectedTab}isActiveInMoreTab(){return this.tabsList.findIndex((e=>e.id===this.selectedTab.id))>=this.numTabsDisplayed-1}ngOnChanges(e){const t=e.tabsList&&e.tabsList.currentValue&&!e.tabsList.previousValue||e.tabsList&&e.tabsList.firstChange&&!!e.tabsList.currentValue;const n=e.tabsList&&!!e.tabsList.previousValue&&!!e.tabsList.currentValue;if(this.tabsList){const e=this.tabsList.find((e=>e.active))||this.tabsList[0];if(!this.selectedTab||this.selectedTab&&this.selectedTab.id!==e.id){this.selectedTab=e;this.selectedTab.active=true}}if(t){this.tabsList=this.tabsList.map((e=>Object.assign(Object.assign({},e),{active:false,hasErrors:false})));this.tabChangedStream.next()}if(n){this.tabChangedStream.next()}this.getDropdownTabs().subscribe((e=>{this.dropdownTabs=e}))}selectTab(e){if(e&&e.id!==this.selectedTab.id){this.userTrackingService.trackingUserAction(rn.ADD_COMPONENT,e.title);if(!this.selectedTab.active){this.findSelectedTab()}this.selectedTab.active=false;this.selectedTab=e;this.selectedTab.active=true;this.onTabSelected.emit(this.selectedTab.id)}}dropDownHasErrors(){const e=this.tabsList.slice(this.numTabsDisplayed-1);return e.some((e=>e.hasErrors))}findSelectedTab(){const e=this.tabsList.find((e=>e.active));if(e){this.selectedTab=e}}getDropdownTabs(){return this.tabChangedStream.pipe(_.map((()=>(this.tabsList||[]).slice(this.numTabsDisplayed-1).map(TabsSelectAdapter.transform))),_.distinctUntilChanged(((e,t)=>s.isEqual(e,t))))}getVisibleTabs(){return this.tabChangedStream.pipe(_.map((()=>(this.tabsList||[]).slice(0,this.numTabsDisplayed-1))),_.distinctUntilChanged(((e,t)=>s.isEqual(e,t))))}trackTabById(e){return e}};__decorate([o.Input(),__metadata("design:type",Object)],t.TabsComponent.prototype,"model",void 0);__decorate([o.Input(),__metadata("design:type",Array)],t.TabsComponent.prototype,"tabsList",void 0);__decorate([o.Input(),__metadata("design:type",Number)],t.TabsComponent.prototype,"numTabsDisplayed",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.TabsComponent.prototype,"onTabSelected",void 0);t.TabsComponent=__decorate([o.Component({selector:"se-tabs",template:`<div class="se-tabset-wrapper"><nav fd-tab-nav class="nav nav-tabs se-tabset" role="tablist" *ngIf="isInitialized"><ng-container *ngIf="tabsList.length !== numTabsDisplayed"><ng-container *ngFor="let tab of (getVisibleTabs() | async); trackBy: trackTabById" [ngTemplateOutlet]="tabsetLink" [ngTemplateOutletContext]="{ $implicit: tab }"></ng-container></ng-container><ng-container *ngIf="tabsList && tabsList.length == numTabsDisplayed"><ng-container *ngFor="let tab of tabsList; trackBy: trackTabById" [ngTemplateOutlet]="tabsetLink" [ngTemplateOutletContext]="{ $implicit: tab }"></ng-container></ng-container><su-select class="se-tabset__select" *ngIf="tabsList.length > numTabsDisplayed && (getDropdownTabs() | async)" [items]="dropdownTabs" [isKeyboardControlEnabled]="false" [hasCustomTrigger]="true" (onItemSelected)="selectTab($event.value)"><li fd-list-item [ngClass]="{'active': isActiveInMoreTab()}" su-select-custom-trigger><a fd-list-link [ngClass]="{'sm-tab-error': dropDownHasErrors()}" class="dropdown-toggle"><span fd-list-title *ngIf="!isActiveInMoreTab()" class="multi-tabs__more-span">{{ 'se.ytabset.tabs.more' | translate }} </span><span fd-list-title *ngIf="isActiveInMoreTab()" class="multi-tabs__more-span">{{selectedTab.title | translate}} </span><span class="caret"></span></a></li></su-select><ng-template #tabsetLink let-tab><div fd-tab-item [ngClass]="{\n                    'active': tab.id === selectedTab.id,\n                    'se-tabset__tab--disabled': tab.disabled,\n                    'sm-tab-error': tab.hasErrors\n                }" [attr.tab-id]="tab.id" class="se-tabset__tab"><a fd-tab-link [ngClass]="{'sm-tab-error': tab.hasErrors}" class="se-tabset__link mycustomtabset" (click)="selectTab(tab)" *ngIf="!tab.message">{{tab.title | translate}}</a><se-tooltip [triggers]="['mouseover']" *ngIf="tab.message"><a fd-list-title se-tooltip-trigger [ngClass]="{'sm-tab-error': tab.hasErrors}" class="se-tabset__link" (click)="selectTab(tab)">{{tab.title | translate}} </a><span fd-list-title se-tooltip-body>{{ tab.message }}</span></se-tooltip></div></ng-template></nav><div class="se-tab-set__content-wrapper" *ngIf="selectedTab"><ng-container *ngFor="let tab of tabsList; trackBy: trackTabById"><se-tab [hidden]="tab.id !== selectedTab.id" [attr.tab-id]="tab.id" [tab]="tab" [model]="model"></se-tab></ng-container></div></div>`}),__metadata("design:paramtypes",[IUserTrackingService])],t.TabsComponent);const ui=new o.InjectionToken("tab-data");window.__smartedit__.addDecoratorPayload("Component","TabComponent",{selector:"se-tab",template:`<ng-container *ngComponentOutlet="tab.component; injector: tabInjector"></ng-container>`});t.TabComponent=class TabComponent{constructor(e){this.injector=e;this.scopeStream=new p.BehaviorSubject(null)}ngOnChanges(e){const t=e.model&&!s.isEqual(e.model.previousValue,e.model.currentValue);const n=e.tab&&!s.isEqual(e.tab.previousValue,e.tab.currentValue);if(n||t){this.scopeStream.next({model:this.model,tabId:this.tab.id,tab:this.tab})}}ngOnInit(){this.tabInjector=o.Injector.create({providers:[{provide:ui,useValue:{model:this.model,tabId:this.tab.id,tab:this.tab}}],parent:this.injector})}};__decorate([o.Input(),__metadata("design:type",Object)],t.TabComponent.prototype,"tab",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.TabComponent.prototype,"model",void 0);t.TabComponent=__decorate([o.Component({selector:"se-tab",template:`<ng-container *ngComponentOutlet="tab.component; injector: tabInjector"></ng-container>`}),__metadata("design:paramtypes",[o.Injector])],t.TabComponent);t.FundamentalsModule=class FundamentalsModule{};t.FundamentalsModule=__decorate([o.NgModule({imports:[S.DialogModule,S.ButtonModule,E.BrowserAnimationsModule,f.FormsModule,S.PopoverModule,S.MenuModule,S.MessageStripModule,S.PaginationModule,S.BusyIndicatorModule],exports:[S.DialogModule,S.ButtonModule,S.FormModule,S.PopoverModule,S.MenuModule,S.MessageStripModule,S.PaginationModule,S.BusyIndicatorModule]})],t.FundamentalsModule);window.__smartedit__.addDecoratorPayload("Component","TooltipComponent",{selector:"se-tooltip",template:`\n        <fd-popover\n            [triggers]="triggers"\n            [placement]="placement"\n            [appendTo]="appendTo"\n            [noArrow]="!isChevronVisible"\n            [additionalBodyClass]="'se-tooltip-container'"\n            [ngClass]="additionalClasses"\n            class="se-tooltip">\n            <fd-popover-control>\n                <ng-content select="[se-tooltip-trigger]"></ng-content>\n            </fd-popover-control>\n            <fd-popover-body>\n                <div class="popover se-popover">\n                    <h3 class="se-popover__title" *ngIf="title">{{ title | translate }}</h3>\n\n                    <div class="se-popover__content">\n                        <ng-content select="[se-tooltip-body]"></ng-content>\n                    </div>\n                </div>\n            </fd-popover-body>\n        </fd-popover>\n    `});let mi=class TooltipComponent{ngAfterViewInit(){this.popoverIsOpenChangeSubscription=this.popover.isOpenChange.subscribe((e=>{if(e){setTimeout((()=>this.popover.refreshPosition()))}}))}ngOnDestroy(){this.popoverIsOpenChangeSubscription.unsubscribe()}};__decorate([o.Input(),__metadata("design:type",Array)],mi.prototype,"triggers",void 0);__decorate([o.Input(),__metadata("design:type",String)],mi.prototype,"placement",void 0);__decorate([o.Input(),__metadata("design:type",String)],mi.prototype,"title",void 0);__decorate([o.Input(),__metadata("design:type",o.ElementRef)],mi.prototype,"appendTo",void 0);__decorate([o.Input(),__metadata("design:type",Boolean)],mi.prototype,"isChevronVisible",void 0);__decorate([o.Input(),__metadata("design:type",Array)],mi.prototype,"additionalClasses",void 0);__decorate([o.ViewChild(S.PopoverComponent,{static:false}),__metadata("design:type",S.PopoverComponent)],mi.prototype,"popover",void 0);mi=__decorate([o.Component({selector:"se-tooltip",template:`\n        <fd-popover\n            [triggers]="triggers"\n            [placement]="placement"\n            [appendTo]="appendTo"\n            [noArrow]="!isChevronVisible"\n            [additionalBodyClass]="'se-tooltip-container'"\n            [ngClass]="additionalClasses"\n            class="se-tooltip">\n            <fd-popover-control>\n                <ng-content select="[se-tooltip-trigger]"></ng-content>\n            </fd-popover-control>\n            <fd-popover-body>\n                <div class="popover se-popover">\n                    <h3 class="se-popover__title" *ngIf="title">{{ title | translate }}</h3>\n\n                    <div class="se-popover__content">\n                        <ng-content select="[se-tooltip-body]"></ng-content>\n                    </div>\n                </div>\n            </fd-popover-body>\n        </fd-popover>\n    `})],mi);t.TooltipModule=class TooltipModule{};t.TooltipModule=__decorate([o.NgModule({imports:[u.CommonModule,t.FundamentalsModule,a.TranslationModule.forChild()],declarations:[mi],entryComponents:[mi],exports:[mi]})],t.TooltipModule);t.TabsModule=class TabsModule{};t.TabsModule=__decorate([o.NgModule({imports:[u.CommonModule,a.SelectModule,t.TooltipModule,C.TabsModule,y.ListModule,a.TranslationModule.forChild()],declarations:[t.TabsComponent,t.TabComponent],entryComponents:[t.TabsComponent,t.TabComponent],exports:[t.TabsComponent,t.TabComponent]})],t.TabsModule);const hi=new o.InjectionToken("DATA_TABLE_COMPONENT_DATA");window.__smartedit__.addDecoratorPayload("Component","DataTableComponent",{selector:"se-data-table",styles:[`.se-paged-list-table.fd-table th{cursor:pointer}`],template:`<table class="se-paged-list-table fd-table"><thead><tr><th *ngFor="let column of columns" (click)="sortColumn(column)" [ngStyle]="{'width.': columnWidth + '%'}" [ngClass]="'se-paged-list__header-'+column.property" class="se-paged-list__header">{{ column.i18n | translate }} <span class="se-data-table__sort" *ngIf="visibleSortingHeader === column.property" [ngClass]="{ \n                        'sap-icon--sort-descending': headersSortingState[column.property],\n                        'sap-icon--sort-ascending': !headersSortingState[column.property] }"></span></th></tr></thead><tbody class="se-paged-list__table-body"><tr *ngFor="let item of items" class="se-paged-list-item"><td *ngFor="let column of columns" [ngClass]="'se-paged-list-item-'+column.property"><se-data-table-renderer [column]="column" [item]="item"></se-data-table-renderer></td></tr></tbody></table>`});t.DataTableComponent=class DataTableComponent{constructor(){this.onSortColumn=new o.EventEmitter;this.headersSortingState={}}ngOnInit(){this._configure()}sortColumn(e){if(e.sortable){this.columnToggleReversed=!this.columnToggleReversed;this.headersSortingState[e.property]=this.columnToggleReversed;this.visibleSortingHeader=e.property;this.currentPage=1;this.internalSortBy=e.property;this.columnSortMode=this.columnToggleReversed?t.SortDirections.Descending:t.SortDirections.Ascending;this.onSortColumn.emit({$columnKey:e,$columnSortMode:this.columnSortMode})}}_configure(){const e=100;this.columnWidth=e/this.columns.length;this.columnToggleReversed=this.sortStatus.reversed;this.columnSortMode=this.sortStatus.reversed?t.SortDirections.Descending:t.SortDirections.Ascending;this.headersSortingState[this.sortStatus.internalSortBy]=this.config.reversed;this.visibleSortingHeader=this.sortStatus.internalSortBy}};__decorate([o.Input(),__metadata("design:type",Array)],t.DataTableComponent.prototype,"columns",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.DataTableComponent.prototype,"config",void 0);__decorate([o.Input(),__metadata("design:type",Array)],t.DataTableComponent.prototype,"items",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.DataTableComponent.prototype,"sortStatus",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.DataTableComponent.prototype,"onSortColumn",void 0);t.DataTableComponent=__decorate([o.Component({selector:"se-data-table",styles:[`.se-paged-list-table.fd-table th{cursor:pointer}`],template:`<table class="se-paged-list-table fd-table"><thead><tr><th *ngFor="let column of columns" (click)="sortColumn(column)" [ngStyle]="{'width.': columnWidth + '%'}" [ngClass]="'se-paged-list__header-'+column.property" class="se-paged-list__header">{{ column.i18n | translate }} <span class="se-data-table__sort" *ngIf="visibleSortingHeader === column.property" [ngClass]="{ \n                        'sap-icon--sort-descending': headersSortingState[column.property],\n                        'sap-icon--sort-ascending': !headersSortingState[column.property] }"></span></th></tr></thead><tbody class="se-paged-list__table-body"><tr *ngFor="let item of items" class="se-paged-list-item"><td *ngFor="let column of columns" [ngClass]="'se-paged-list-item-'+column.property"><se-data-table-renderer [column]="column" [item]="item"></se-data-table-renderer></td></tr></tbody></table>`})],t.DataTableComponent);window.__smartedit__.addDecoratorPayload("Component","DataTableRendererComponent",{selector:"se-data-table-renderer",changeDetection:o.ChangeDetectionStrategy.OnPush,template:`\n        <div *ngIf="column.component; else cellText">\n            <ng-container\n                *ngComponentOutlet="column.component; injector: componentInjector"></ng-container>\n        </div>\n        <ng-template #cellText\n            ><span>{{ item[column.property] }}</span></ng-template\n        >\n    `});let gi=class DataTableRendererComponent{constructor(e){this.injector=e}ngOnChanges(e){const t=e.column;if(t===null||t===void 0?void 0:t.currentValue.component){this.createInjector()}}createInjector(){const{column:e,item:t}=this;this.componentInjector=o.Injector.create({providers:[{provide:hi,useValue:{column:e,item:t}}],parent:this.injector})}};__decorate([o.Input(),__metadata("design:type",Object)],gi.prototype,"column",void 0);__decorate([o.Input(),__metadata("design:type",Object)],gi.prototype,"item",void 0);gi=__decorate([o.Component({selector:"se-data-table-renderer",changeDetection:o.ChangeDetectionStrategy.OnPush,template:`\n        <div *ngIf="column.component; else cellText">\n            <ng-container\n                *ngComponentOutlet="column.component; injector: componentInjector"></ng-container>\n        </div>\n        <ng-template #cellText\n            ><span>{{ item[column.property] }}</span></ng-template\n        >\n    `}),__metadata("design:paramtypes",[o.Injector])],gi);let _i=class DataTableModule{};_i=__decorate([o.NgModule({imports:[u.CommonModule,a.TranslationModule.forChild()],declarations:[t.DataTableComponent,gi],entryComponents:[t.DataTableComponent,gi],exports:[t.DataTableComponent,gi]})],_i);window.__smartedit__.addDecoratorPayload("Component","DropdownMenuComponent",{selector:"se-dropdown-menu",template:`<fd-popover [triggers]="[]" [isOpen]="isOpen" [placement]="placement || 'bottom-end'" class="se-dropdown-more-menu"><fd-popover-control><div #toggleMenu><div *ngIf="!useProjectedAnchor; else projectedAnchor;" class="sap-icon--overflow se-dropdown-more-menu__toggle" title="{{ 'se.contextmenu.title.more' | translate }}"></div><ng-template #projectedAnchor><ng-content></ng-content></ng-template></div></fd-popover-control><fd-popover-body><ul fd-list class="se-dropdown-menu__list" [ngClass]="additionalClasses"><se-dropdown-menu-item *ngFor="let dropdownItem of clonedDropdownItems" [dropdownItem]="dropdownItem" [selectedItem]="selectedItem" (selectedItemChange)="selectedItemChange.emit($event)" class="fd-list__byline-left"></se-dropdown-menu-item></ul><div *ngIf="message" class="se-information">{{ message | translate }}</div></fd-popover-body></fd-popover>`,styles:[`se-dropdown-menu .fd-popover__popper{border:0}.se-information{padding:12px}.se-dropdown-more-menu__toggle{color:var(--sapInformativeColor)!important;cursor:pointer}.se-dropdown-more-menu__toggle.sap-icon--overflow{position:relative;bottom:3px;height:20px;line-height:36px}se-dropdown-menu-item li>*{width:100%!important}.se-dropdown-menu__list{display:flex;flex-direction:column;min-width:100px;border-radius:var(--sapElement_BorderCornerRadius)!important}.se-dropdown-menu__list se-dropdown-menu-item:first-child .se-dropdown-item,.se-dropdown-menu__list se-dropdown-menu-item:first-child .se-dropdown-item:hover{border-top-left-radius:var(--sapElement_BorderCornerRadius);border-top-right-radius:var(--sapElement_BorderCornerRadius)}.se-dropdown-menu__list se-dropdown-menu-item:last-child .se-dropdown-item,.se-dropdown-menu__list se-dropdown-menu-item:last-child .se-dropdown-item:hover{border-bottom-left-radius:var(--sapElement_BorderCornerRadius);border-bottom-right-radius:var(--sapElement_BorderCornerRadius);border-bottom:none!important}.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item{border-bottom:none;padding:unset}.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item{text-decoration:none!important;white-space:nowrap;color:var(--sapTextColor);width:100%;padding:10px 24px;border-bottom:var(--sapList_BorderWidth) solid var(--sapList_BorderColor)}.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item.fd-has-color-status-3{color:var(--sapNegativeColor)}.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item__delete,.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item__delete a{order:99}.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item__delete,.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item__delete a,.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item__delete a:hover,.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item__delete:hover{color:var(--sapNegativeColor)}.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item__delete a.se-dropdown-item--disabled,.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item__delete a.se-dropdown-item--disabled:hover,.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item__delete.se-dropdown-item--disabled,.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item__delete.se-dropdown-item--disabled:hover{opacity:.4;padding-right:8px!important;background:var(--sapBaseColor)!important}.se-dropdown-item__delete-wrapper{display:flex;flex-direction:row;align-items:center;width:100%}.se-dropdown-item__delete-page-popover{margin-right:16px}.se-dropdown-item__delete-page-popover .sap-icon--message-error{color:var(--sapIndicationColor_5)}.se-dropdown-item__delete-link-wrapper{width:100%}.se-dropdown-item__delete-link-wrapper--disabled{cursor:not-allowed}`],encapsulation:o.ViewEncapsulation.None});t.DropdownMenuComponent=class DropdownMenuComponent{constructor(e,t){this.cd=e;this.yjQuery=t;this.selectedItemChange=new o.EventEmitter;this.useProjectedAnchor=false;this.isOpen=false;this.additionalClasses=[];this.isOpenChange=new o.EventEmitter;this.dropdownListSelector=".se-dropdown-menu__list";this.isSubscription=false}clickHandler(e){if(this.toggleMenuElement.nativeElement.contains(e.target)){e.stopPropagation();this.isOpen=!this.isOpen;this.cd.detectChanges();this.emitIsOpenChange();return}if(this.isOpen){this.isOpen=false;this.cd.detectChanges();this.emitIsOpenChange()}}ngOnChanges(e){const t=e.dropdownItems;if(t){this.clonedDropdownItems=t.currentValue.map((e=>Object.assign(Object.assign({},e),{condition:e.condition||(()=>true)}))).map((e=>this.setDefaultComponentIfNeeded(e)))}}ngDoCheck(){if(this.isOpen&&!this.isSubscription){const e=this.yjQuery(this.dropdownListSelector);if(e.length&&!e.height()){this.message="se.actions.without.permission"}this.isSubscription=true}}emitIsOpenChange(){this.isOpenChange.emit(this.isOpen)}setDefaultComponentIfNeeded(e){if(this.validateDropdownItem(e)==="callback"){return Object.assign(Object.assign({},e),{component:t.DropdownMenuItemDefaultComponent})}else{return e}}validateDropdownItem(e){const t=["callback","component"];const n=Object.keys(e);const i=n.filter((e=>t.includes(e)));if(i.length!==1){throw new Error('DropdownMenuComponent.validateDropdownItem - Dropdown Item must contain "callback" or "component"')}return i[0]}};__decorate([o.Input(),__metadata("design:type",Array)],t.DropdownMenuComponent.prototype,"dropdownItems",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.DropdownMenuComponent.prototype,"selectedItem",void 0);__decorate([o.Output(),__metadata("design:type",Object)],t.DropdownMenuComponent.prototype,"selectedItemChange",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.DropdownMenuComponent.prototype,"placement",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.DropdownMenuComponent.prototype,"useProjectedAnchor",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.DropdownMenuComponent.prototype,"isOpen",void 0);__decorate([o.Input(),__metadata("design:type",Array)],t.DropdownMenuComponent.prototype,"additionalClasses",void 0);__decorate([o.Output(),__metadata("design:type",Object)],t.DropdownMenuComponent.prototype,"isOpenChange",void 0);__decorate([o.ViewChild("toggleMenu",{static:true}),__metadata("design:type",o.ElementRef)],t.DropdownMenuComponent.prototype,"toggleMenuElement",void 0);__decorate([o.HostListener("document:click",["$event"]),__metadata("design:type",Function),__metadata("design:paramtypes",[MouseEvent]),__metadata("design:returntype",void 0)],t.DropdownMenuComponent.prototype,"clickHandler",null);t.DropdownMenuComponent=__decorate([o.Component({selector:"se-dropdown-menu",template:`<fd-popover [triggers]="[]" [isOpen]="isOpen" [placement]="placement || 'bottom-end'" class="se-dropdown-more-menu"><fd-popover-control><div #toggleMenu><div *ngIf="!useProjectedAnchor; else projectedAnchor;" class="sap-icon--overflow se-dropdown-more-menu__toggle" title="{{ 'se.contextmenu.title.more' | translate }}"></div><ng-template #projectedAnchor><ng-content></ng-content></ng-template></div></fd-popover-control><fd-popover-body><ul fd-list class="se-dropdown-menu__list" [ngClass]="additionalClasses"><se-dropdown-menu-item *ngFor="let dropdownItem of clonedDropdownItems" [dropdownItem]="dropdownItem" [selectedItem]="selectedItem" (selectedItemChange)="selectedItemChange.emit($event)" class="fd-list__byline-left"></se-dropdown-menu-item></ul><div *ngIf="message" class="se-information">{{ message | translate }}</div></fd-popover-body></fd-popover>`,styles:[`se-dropdown-menu .fd-popover__popper{border:0}.se-information{padding:12px}.se-dropdown-more-menu__toggle{color:var(--sapInformativeColor)!important;cursor:pointer}.se-dropdown-more-menu__toggle.sap-icon--overflow{position:relative;bottom:3px;height:20px;line-height:36px}se-dropdown-menu-item li>*{width:100%!important}.se-dropdown-menu__list{display:flex;flex-direction:column;min-width:100px;border-radius:var(--sapElement_BorderCornerRadius)!important}.se-dropdown-menu__list se-dropdown-menu-item:first-child .se-dropdown-item,.se-dropdown-menu__list se-dropdown-menu-item:first-child .se-dropdown-item:hover{border-top-left-radius:var(--sapElement_BorderCornerRadius);border-top-right-radius:var(--sapElement_BorderCornerRadius)}.se-dropdown-menu__list se-dropdown-menu-item:last-child .se-dropdown-item,.se-dropdown-menu__list se-dropdown-menu-item:last-child .se-dropdown-item:hover{border-bottom-left-radius:var(--sapElement_BorderCornerRadius);border-bottom-right-radius:var(--sapElement_BorderCornerRadius);border-bottom:none!important}.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item{border-bottom:none;padding:unset}.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item{text-decoration:none!important;white-space:nowrap;color:var(--sapTextColor);width:100%;padding:10px 24px;border-bottom:var(--sapList_BorderWidth) solid var(--sapList_BorderColor)}.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item.fd-has-color-status-3{color:var(--sapNegativeColor)}.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item__delete,.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item__delete a{order:99}.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item__delete,.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item__delete a,.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item__delete a:hover,.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item__delete:hover{color:var(--sapNegativeColor)}.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item__delete a.se-dropdown-item--disabled,.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item__delete a.se-dropdown-item--disabled:hover,.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item__delete.se-dropdown-item--disabled,.se-dropdown-menu__list se-dropdown-menu-item .fd-list__item .se-dropdown-item__delete.se-dropdown-item--disabled:hover{opacity:.4;padding-right:8px!important;background:var(--sapBaseColor)!important}.se-dropdown-item__delete-wrapper{display:flex;flex-direction:row;align-items:center;width:100%}.se-dropdown-item__delete-page-popover{margin-right:16px}.se-dropdown-item__delete-page-popover .sap-icon--message-error{color:var(--sapIndicationColor_5)}.se-dropdown-item__delete-link-wrapper{width:100%}.se-dropdown-item__delete-link-wrapper--disabled{cursor:not-allowed}`],encapsulation:o.ViewEncapsulation.None}),__param(1,o.Inject(Bn)),__metadata("design:paramtypes",[o.ChangeDetectorRef,Function])],t.DropdownMenuComponent);window.__smartedit__.addDecoratorPayload("Component","DropdownMenuItemComponent",{selector:"se-dropdown-menu-item",template:`<li fd-list-item *ngIf="dropdownItem.condition(selectedItem)" class="fd-list__byline-left" [ngClass]="dropdownItem.customCss" (click)="onClick()"><ng-container *ngComponentOutlet="dropdownItem.component; injector: dropdownItemInjector;"></ng-container></li>`});let vi=class DropdownMenuItemComponent{constructor(e){this.injector=e;this.selectedItemChange=new o.EventEmitter}ngOnInit(){this.createDropdownItemInjector()}onClick(){this.selectedItemChange.emit(this.dropdownItem)}createDropdownItemInjector(){const{selectedItem:e}=this;this.dropdownItemInjector=o.Injector.create({parent:this.injector,providers:[{provide:di,useValue:{dropdownItem:this.dropdownItem,selectedItem:e}}]})}};__decorate([o.Input(),__metadata("design:type",Object)],vi.prototype,"dropdownItem",void 0);__decorate([o.Input(),__metadata("design:type",Object)],vi.prototype,"selectedItem",void 0);__decorate([o.Output(),__metadata("design:type",Object)],vi.prototype,"selectedItemChange",void 0);vi=__decorate([o.Component({selector:"se-dropdown-menu-item",template:`<li fd-list-item *ngIf="dropdownItem.condition(selectedItem)" class="fd-list__byline-left" [ngClass]="dropdownItem.customCss" (click)="onClick()"><ng-container *ngComponentOutlet="dropdownItem.component; injector: dropdownItemInjector;"></ng-container></li>`}),__metadata("design:paramtypes",[o.Injector])],vi);t.DropdownMenuModule=class DropdownMenuModule{};t.DropdownMenuModule=__decorate([o.NgModule({imports:[u.CommonModule,t.FundamentalsModule,a.TranslationModule.forChild(),y.ListModule],declarations:[t.DropdownMenuComponent,vi,t.DropdownMenuItemDefaultComponent],entryComponents:[t.DropdownMenuComponent,t.DropdownMenuItemDefaultComponent],exports:[t.DropdownMenuComponent,vi]})],t.DropdownMenuModule);window.__smartedit__.addDecoratorPayload("Component","DynamicPagedListComponent",{selector:"se-dynamic-paged-list",template:`<div *ngIf="ready" class="se-dynamic-paged-list"><div class="fd-panel__body fd-panel__body--bleed"><se-data-table [columns]="columns" [config]="config" [items]="items" [sortStatus]="sortStatus" (onSortColumn)="orderByColumn($event)"></se-data-table></div><div class="fd-panel__footer"><se-pagination *ngIf="!!items.length" class="se-dynamic-list__pagination" [totalItems]="totalItems" [itemsPerPage]="config.itemsPerPage" [currentPage]="currentPage" (onChange)="onCurrentPageChange($event)"></se-pagination><span class="se-paged-list__page-count-wrapper se-paged-list__page-count-wrapper--footer"><span class="span-page-list__page-count-text">{{'se.pagelist.countsearchresult' | translate}} </span><span class="se-page-list__page-count">({{ totalItems }})</span></span></div></div><se-spinner [isSpinning]="!ready"></se-spinner>`});t.DynamicPagedListComponent=class DynamicPagedListComponent{constructor(e,t,n){this.logService=e;this.restServiceFactory=t;this.cdr=n;this.getApi=new o.EventEmitter;this.onItemsUpdate=new o.EventEmitter;this.api={reloadItems:()=>this.loadItems()}}ngOnInit(){this._validateInput();this.ready=false;this.totalItems=0;this.currentPage=1;this.columnSortMode=this.config.reversed?t.SortDirections.Descending:t.SortDirections.Ascending;this.internalSortBy=s.cloneDeep(this.config.sortBy);this.oldMask=this.mask;this.columns=[];this.sortStatus={internalSortBy:this.internalSortBy,reversed:this.config.reversed,currentPage:this.currentPage};this._buildColumnData();this.loadItems();this.getApi.emit(this.api)}ngOnChanges(e){const t=e.mask;if(!!t&&!t.firstChange&&this.oldMask!==this.mask){this.oldMask=this.mask;this.currentPage=1;this.loadItems()}}orderByColumn(e){this.internalSortBy=e.$columnKey.property;this.columnSortMode=e.$columnSortMode;this.config.reversed=this.columnSortMode===t.SortDirections.Descending;this.sortStatus.internalSortBy=this.internalSortBy;this.sortStatus.reversed=this.config.reversed;if(e.$columnKey.sortable){this.currentPage=1;this.sortStatus.currentPage=1;this.loadItems()}}loadItems(){this.ready=false;const e=Object.assign(Object.assign({},this.config.queryParams||{}),{currentPage:this.currentPage-1,mask:this.mask,pageSize:this.config.itemsPerPage,sort:`${this.internalSortBy}:${this.columnSortMode}`});return this.restServiceFactory.get(this.config.uri).page(e).then((e=>{this.items=e.results;if(this.items.length===0){this.logService.warn("PagedList: No items returned to display")}this.totalItems=e.pagination.totalCount;this.currentPage=parseInt(String(e.pagination.page),10)+1;this.ready=true;if(!this.cdr.destroyed){this.cdr.detectChanges()}this.onItemsUpdate.emit(e);return e}))}onCurrentPageChange(e){if(e===this.currentPage){return}this.currentPage=e;this.loadItems()}_validateInput(){if(!this.config){throw new Error("config object is required")}if(!(this.config.keys instanceof Array)){throw new Error("keys must be an array")}if(this.config.keys.length<1){throw new Error("dynamic paged list requires at least one key")}if(!this.config.uri){throw new Error("dynamic paged list requires a uri to fetch the list of items")}}_buildColumnData(){this.columns=this.config.keys.map((e=>Object.assign({},e)))}};__decorate([o.Input(),__metadata("design:type",Object)],t.DynamicPagedListComponent.prototype,"config",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.DynamicPagedListComponent.prototype,"mask",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.DynamicPagedListComponent.prototype,"getApi",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.DynamicPagedListComponent.prototype,"onItemsUpdate",void 0);t.DynamicPagedListComponent=__decorate([o.Component({selector:"se-dynamic-paged-list",template:`<div *ngIf="ready" class="se-dynamic-paged-list"><div class="fd-panel__body fd-panel__body--bleed"><se-data-table [columns]="columns" [config]="config" [items]="items" [sortStatus]="sortStatus" (onSortColumn)="orderByColumn($event)"></se-data-table></div><div class="fd-panel__footer"><se-pagination *ngIf="!!items.length" class="se-dynamic-list__pagination" [totalItems]="totalItems" [itemsPerPage]="config.itemsPerPage" [currentPage]="currentPage" (onChange)="onCurrentPageChange($event)"></se-pagination><span class="se-paged-list__page-count-wrapper se-paged-list__page-count-wrapper--footer"><span class="span-page-list__page-count-text">{{'se.pagelist.countsearchresult' | translate}} </span><span class="se-page-list__page-count">({{ totalItems }})</span></span></div></div><se-spinner [isSpinning]="!ready"></se-spinner>`}),__metadata("design:paramtypes",[a.LogService,a.RestServiceFactory,o.ChangeDetectorRef])],t.DynamicPagedListComponent);window.__smartedit__.addDecoratorPayload("Component","PaginationComponent",{selector:"se-pagination",template:`<fd-pagination class="se-pagination" [displayTotalItems]="displayTotalItems" [totalItems]="totalItems" [itemsPerPage]="totalItems === 1 ? 1 : itemsPerPage" [currentPage]="currentPage" (pageChangeStart)="onPageChanged($event)" nextLabel="{{ 'se.btn.nextpage.title' | translate }}" previousLabel="{{ 'se.btn.previouspage.title' | translate }}"></fd-pagination>`});t.PaginationComponent=class PaginationComponent{constructor(){this.displayTotalItems=false;this.onChange=new o.EventEmitter}onPageChanged(e){this.currentPage=e;this.onChange.emit(e)}};__decorate([o.Input(),__metadata("design:type",Number)],t.PaginationComponent.prototype,"totalItems",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.PaginationComponent.prototype,"displayTotalItems",void 0);__decorate([o.Input(),__metadata("design:type",Number)],t.PaginationComponent.prototype,"itemsPerPage",void 0);__decorate([o.Input(),__metadata("design:type",Number)],t.PaginationComponent.prototype,"currentPage",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.PaginationComponent.prototype,"onChange",void 0);t.PaginationComponent=__decorate([o.Component({selector:"se-pagination",template:`<fd-pagination class="se-pagination" [displayTotalItems]="displayTotalItems" [totalItems]="totalItems" [itemsPerPage]="totalItems === 1 ? 1 : itemsPerPage" [currentPage]="currentPage" (pageChangeStart)="onPageChanged($event)" nextLabel="{{ 'se.btn.nextpage.title' | translate }}" previousLabel="{{ 'se.btn.previouspage.title' | translate }}"></fd-pagination>`})],t.PaginationComponent);t.PaginationModule=class PaginationModule{};t.PaginationModule=__decorate([o.NgModule({imports:[t.FundamentalsModule,h.TranslateModule.forChild()],declarations:[t.PaginationComponent],exports:[t.PaginationComponent]})],t.PaginationModule);window.__smartedit__.addDecoratorPayload("Component","SpinnerComponent",{selector:"se-spinner",changeDetection:o.ChangeDetectionStrategy.OnPush,template:`\n        <div\n            *ngIf="isSpinning"\n            class="se-spinner fd-busy-indicator-extended panel-body"\n            [ngClass]="{ 'se-spinner--fluid': isFluid }">\n            <div class="spinner">\n                <fd-busy-indicator [loading]="true" size="m"></fd-busy-indicator>\n            </div>\n        </div>\n    `});t.SpinnerComponent=class SpinnerComponent{constructor(){this.isFluid=true}};__decorate([o.Input(),__metadata("design:type",Boolean)],t.SpinnerComponent.prototype,"isSpinning",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.SpinnerComponent.prototype,"isFluid",void 0);t.SpinnerComponent=__decorate([o.Component({selector:"se-spinner",changeDetection:o.ChangeDetectionStrategy.OnPush,template:`\n        <div\n            *ngIf="isSpinning"\n            class="se-spinner fd-busy-indicator-extended panel-body"\n            [ngClass]="{ 'se-spinner--fluid': isFluid }">\n            <div class="spinner">\n                <fd-busy-indicator [loading]="true" size="m"></fd-busy-indicator>\n            </div>\n        </div>\n    `})],t.SpinnerComponent);t.SpinnerModule=class SpinnerModule{};t.SpinnerModule=__decorate([o.NgModule({imports:[u.CommonModule,b.BusyIndicatorModule],declarations:[t.SpinnerComponent],entryComponents:[t.SpinnerComponent],exports:[t.SpinnerComponent]})],t.SpinnerModule);t.DynamicPagedListModule=class DynamicPagedListModule{};t.DynamicPagedListModule=__decorate([o.NgModule({imports:[u.CommonModule,t.PaginationModule,_i,a.TranslationModule.forChild(),t.SpinnerModule],declarations:[t.DynamicPagedListComponent],entryComponents:[t.DynamicPagedListComponent],exports:[t.DynamicPagedListComponent]})],t.DynamicPagedListModule);window.__smartedit__.addDecoratorPayload("Component","InfiniteScrollingComponent",{selector:"se-infinite-scrolling",template:`<div #container class="se-infinite-scrolling__container" [ngClass]="dropDownContainerClass" fdInfiniteScroll (onScrollAction)="nextPage()" [scrollPercent]="distance" *ngIf="initiated"><div class="se-infinite-scrolling__holder" [ngClass]="dropDownClass"><div #content><ng-content></ng-content></div><div class="spinner-container"><se-spinner [isSpinning]="isLoading" [isFluid]="false"></se-spinner></div></div></div>`,styles:[`se-infinite-scrolling.se-infinite-scrolling--narrowed .se-infinite-scrolling__holder{padding:0 20px}se-infinite-scrolling .se-infinite-scrolling__container{overflow-y:auto;max-height:200px}se-infinite-scrolling .se-infinite-scrolling__holder{overflow-y:hidden}`],encapsulation:o.ViewEncapsulation.None});t.InfiniteScrollingComponent=class InfiniteScrollingComponent{constructor(e,t){this.discardablePromiseUtils=e;this.cdr=t;this.distance=80;this.itemsChange=new o.EventEmitter;this.containerId=W.generateIdentifier();this.initiated=false;this.isLoading=false;this.internalItemsSelected=[]}ngOnInit(){this.init()}ngOnChanges(){this.context=this.context||this;this.init()}ngAfterViewInit(){this.initContentResizeObserver()}ngOnDestroy(){this.discardablePromiseUtils.clear(this.containerId);this.contentResizeObserver.disconnect()}nextPage(){if(this.pagingDisabled){return}this.pagingDisabled=true;this.currentPage=this.currentPage+1;this.mask=this.mask||"";this.isLoading=true;this.internalItemsSelected=this.context.selected||[];this.discardablePromiseUtils.apply(this.containerId,this.fetchPage(this.mask,this.pageSize,this.currentPage,this.internalItemsSelected),(e=>{e.results=e.results||[];e.results.forEach((e=>{e.technicalUniqueId=W.encode(e)}));const t=s.differenceBy(e.results,this.context.items,"technicalUniqueId");if(t.length>0){this.context.items=[...this.context.items,...t||[]]}this.itemsChange.emit(this.context.items);this.pagingDisabled=this.isPagingDisabled(e);if(this.pagingDisabled){this.isLoading=false;if(!this.cdr.destroyed){this.cdr.detectChanges()}}this.tryToLoadNextPage(e)}))}scrollToTop(){if(this.containerElement){this.containerElement.nativeElement.scrollTop=0}}scrollToBottom(){if(this.containerElement){this.containerElement.nativeElement.scrollTop=this.containerElement.nativeElement.scrollHeight}}init(){const e=this.initiated;this.context.items=[];this.currentPage=-1;this.pagingDisabled=false;this.initiated=true;if(e){this.scrollToTop();this.nextPage()}}initContentResizeObserver(){this.contentResizeObserver=new O.ResizeObserver((e=>{const{contentRect:t}=e[0];const n=t.height===0;if(!this.pagingDisabled&&this.isLoading&&!n){if(this.shouldLoadNextPage()){this.nextPage()}else{this.isLoading=false;if(!this.cdr.destroyed){this.cdr.detectChanges()}}this.contentResizeObserver.disconnect()}}));this.contentResizeObserver.observe(this.contentElement.nativeElement)}shouldLoadNextPage(){const e=this.contentElement.nativeElement.offsetHeight;const t=this.containerElement.nativeElement.offsetHeight;return e<=t}isPagingDisabled(e){return e.pagination===undefined||e.pagination&&this.context.items.length===e.pagination.totalCount||e.pagination&&e.pagination.totalPages===e.pagination.page+1}tryToLoadNextPage(e){if(e.pagination===undefined||this.pagingDisabled){return}if(this.context.items.length===0||e.pagination.count<this.pageSize&&this.containerElement.nativeElement.offsetHeight!==0&&this.shouldLoadNextPage()){this.nextPage()}}};__decorate([o.Input(),__metadata("design:type",Number)],t.InfiniteScrollingComponent.prototype,"pageSize",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.InfiniteScrollingComponent.prototype,"mask",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.InfiniteScrollingComponent.prototype,"dropDownContainerClass",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.InfiniteScrollingComponent.prototype,"dropDownClass",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.InfiniteScrollingComponent.prototype,"distance",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.InfiniteScrollingComponent.prototype,"context",void 0);__decorate([o.Input(),__metadata("design:type",Function)],t.InfiniteScrollingComponent.prototype,"fetchPage",void 0);__decorate([o.Output(),__metadata("design:type",Object)],t.InfiniteScrollingComponent.prototype,"itemsChange",void 0);__decorate([o.ViewChild("container",{static:false}),__metadata("design:type",o.ElementRef)],t.InfiniteScrollingComponent.prototype,"containerElement",void 0);__decorate([o.ViewChild("content",{static:false}),__metadata("design:type",o.ElementRef)],t.InfiniteScrollingComponent.prototype,"contentElement",void 0);t.InfiniteScrollingComponent=__decorate([o.Component({selector:"se-infinite-scrolling",template:`<div #container class="se-infinite-scrolling__container" [ngClass]="dropDownContainerClass" fdInfiniteScroll (onScrollAction)="nextPage()" [scrollPercent]="distance" *ngIf="initiated"><div class="se-infinite-scrolling__holder" [ngClass]="dropDownClass"><div #content><ng-content></ng-content></div><div class="spinner-container"><se-spinner [isSpinning]="isLoading" [isFluid]="false"></se-spinner></div></div></div>`,styles:[`se-infinite-scrolling.se-infinite-scrolling--narrowed .se-infinite-scrolling__holder{padding:0 20px}se-infinite-scrolling .se-infinite-scrolling__container{overflow-y:auto;max-height:200px}se-infinite-scrolling .se-infinite-scrolling__holder{overflow-y:hidden}`],encapsulation:o.ViewEncapsulation.None}),__metadata("design:paramtypes",[t.DiscardablePromiseUtils,o.ChangeDetectorRef])],t.InfiniteScrollingComponent);t.InfiniteScrollingModule=class InfiniteScrollingModule{};t.InfiniteScrollingModule=__decorate([o.NgModule({imports:[S.InfiniteScrollModule,t.SpinnerModule,u.CommonModule],declarations:[t.InfiniteScrollingComponent],entryComponents:[t.InfiniteScrollingComponent],exports:[t.InfiniteScrollingComponent]})],t.InfiniteScrollingModule);function getLocalizedFilterFn(e){return t=>{if(typeof t==="string"){return t}else if(t){return t[e]||t[Object.keys(t)[0]]}else{return undefined}}}t.L10nPipe=class L10nPipe{constructor(e){this.l10nService=e}transform(e){return this.l10nService.languageSwitch$.pipe(_.startWith(null),_.pairwise(),_.tap((([e,t])=>{if(e!==t){this.filterFn=getLocalizedFilterFn(t)}})),_.map((()=>this.filterFn(e))))}};t.L10nPipe=__decorate([o.Pipe({name:"seL10n"}),__metadata("design:paramtypes",[t.L10nService])],t.L10nPipe);t.L10nPipeModule=class L10nPipeModule{};t.L10nPipeModule=__decorate([o.NgModule({declarations:[t.L10nPipe],exports:[t.L10nPipe],providers:[t.L10nPipe,G.initialize((e=>e.resolveLanguage()),[t.L10nService])]})],t.L10nPipeModule);class TreeNestedDataSource{constructor(){this._data=new p.BehaviorSubject([])}get(){return this._data.asObservable()}set(e){this._data.next(e)}}class TreeNodeItem{constructor(e){this.position=0;this.nodes=[];this.hasChildren=e.hasChildren;this.name=e.name;this.title=e.title;this.parentUid=e.parentUid;this.position=e.position;this.itemType=e.itemType;this.uid=e.uid;this.uuid=e.uuid;this.level=e.level;this.nodes=[]}setPosition(e){this.position=e;return this}setMouseHovered(e){this.mouseHovered=e;return this}setInitiated(e){this.initiated=e;return this}setLevel(e){this.level=e;return this}addNode(e){this.nodes=[...this.nodes,e.setParent(this)].map(((e,t)=>e.setPosition(t).setLevel(this.level+1)));this.updateHasChildren();return this}addNodes(e){this.nodes=[...this.nodes,...e.map((e=>e.setParent(this)))].map(((e,t)=>e.setPosition(t).setLevel(this.level+1)));this.updateHasChildren();return this}removeAllNodes(){this.nodes=[];this.updateHasChildren();return this}removeNode(e){this.nodes=this.nodes.filter((t=>t.uid!==e.uid)).map(((e,t)=>e.setPosition(t)));this.updateHasChildren();return this}setParent(e){this.parent=e;this.parentUid=e.uid;return this}toggle(){this.isExpanded=!this.isExpanded;return this}collapse(){this.isExpanded=false;return this}expand(){this.isExpanded=true;return this}collapseAll(){this.nodes.forEach((e=>this.collapseRecursively(e)))}expandAll(){this.nodes.forEach((e=>this.expandRecursively(e)))}collapseRecursively(e){e.collapse().nodes.forEach((e=>this.collapseRecursively(e)))}expandRecursively(e){e.expand().nodes.forEach((e=>this.expandRecursively(e)))}updateHasChildren(){this.hasChildren=!!this.nodes.length}}class NavigationNodeItem extends TreeNodeItem{constructor(e){super(e);this.entries=e.entries}}var Si;(function(e){e["CMSNavigationNode"]="CMSNavigationNode"})(Si||(Si={}));class TreeNodeItemFactory{get(e){switch(e.itemType){case Si.CMSNavigationNode:return new NavigationNodeItem(e);default:return new TreeNodeItem(e)}}}t.TreeService=class TreeService{constructor(e,t){this.restServiceFactory=e;this.treeNodeItemFactory=t;this.dataSource=new TreeNestedDataSource;this.$onTreeUpdated=new p.BehaviorSubject(false)}onTreeUpdated(){return this.$onTreeUpdated.pipe(_.filter((e=>!!e)))}init(e,t){if(e){this.nodesRestService=this.restServiceFactory.get(e)}this.setRoot(t)}rearrange(e,t,n){const i=t.nodes.filter((t=>t.uid!==e.uid));const o=[...i.slice(0,n),e,...i.slice(n,i.length)];e.parent.removeNode(e);t.removeAllNodes().addNodes(o);this.update()}fetchChildren(e){return __awaiter(this,void 0,void 0,(function*(){const t=e||this.root;if(t.initiated){this.update();return Promise.resolve(t.nodes)}else{const e=yield this.nodesRestService.get({parentUid:t.uid});const n=(cn.getDataFromResponse(e)||[]).map((e=>this.treeNodeItemFactory.get(e)));t.removeAllNodes().addNodes(n).setInitiated(true);this.update();return n}}))}toggle(e){return __awaiter(this,void 0,void 0,(function*(){e.toggle();return this.fetchChildren(e)}))}newChild(e){return __awaiter(this,void 0,void 0,(function*(){const t=e||this.root;const n=yield this.saveNode(t);if(!t.isExpanded){this.toggle(t)}else{const e=t.nodes.find((e=>e.uid===n.uid));if(!e){t.addNode(this.treeNodeItemFactory.get(n));this.update()}}}))}newSibling(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.saveNode(e.parent);e.parent.addNode(this.treeNodeItemFactory.get(t));this.update()}))}removeNode(e){return __awaiter(this,void 0,void 0,(function*(){yield this.nodesRestService.remove({identifier:e.uid});e.parent.removeNode(e);this.update()}))}update(){this.dataSource.set(null);this.dataSource.set(this.root.nodes);this.$onTreeUpdated.next(true)}expandAll(){this.root.expandAll();this.update()}collapseAll(){this.root.collapseAll();this.update()}getNodePositionById(e){return this.getNodeById(e).position}getNodeById(e,t){if(e===this.root.uid){return this.root}const n=t||this.root.nodes;for(const t of n){if(t.uid===e){return t}if(t.hasChildren){t.nodes=t.nodes||[];return this.getNodeById(e,t.nodes)}}return null}saveNode(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.nodesRestService.save({parentUid:e.uid,name:(e.name?e.name:e.uid)+e.nodes.length});return t}))}setRoot(e){this.root=this.treeNodeItemFactory.get({uid:e,name:"root",level:0})}};t.TreeService=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.RestServiceFactory,TreeNodeItemFactory])],t.TreeService);class TreeDragAndDropEvent{constructor(e,t,n,i,o){this.sourceNode=e;this.destinationNodes=t;this.sourceParentNode=n;this.destinationParentNode=i;this.position=o}}const yi=new o.InjectionToken("TREE_NODE");let Ci=class TreeDragAndDropService{constructor(e,t,n){this.confirmationModalService=e;this.alertService=t;this.treeService=n}init(e){this.config=e;this.isDragEnabled=!!e&&(!!e.onDropCallback||!!e.beforeDropCallback||!!e.allowDropCallback)}handleDrop(e){if(!this.config||!e.isPointerOverContainer){return Promise.resolve()}if(!this.allowDrop(e)){return Promise.resolve()}return this.beforeDrop(e).then((t=>{if(t===false){return}this.onDrop(e);this.rearrangeNodes(e)}))}rearrangeNodes(e){this.treeService.rearrange(e.item.data,e.container.data[0].parent,e.currentIndex)}onDrop(e){if(!this.config.onDropCallback){return}const t=new TreeDragAndDropEvent(e.item.data,e.container.data,e.item.data.parent,e.container.data[0].parent,e.currentIndex);return this.config.onDropCallback(t)}allowDrop(e){if(!this.config.allowDropCallback){return true}return this.config.allowDropCallback(new TreeDragAndDropEvent(e.item.data,e.container.data,e.item.data.parent,e.container.data[0].parent,e.currentIndex))}beforeDrop(e){if(!this.config.beforeDropCallback){return Promise.resolve()}const t=new TreeDragAndDropEvent(e.item.data,e.container.data,e.item.data.parent,e.container.data[0].parent,e.currentIndex);return this.config.beforeDropCallback(t).then((e=>{if(typeof e==="object"){if(e.confirmDropI18nKey){const t={description:e.confirmDropI18nKey};return this.confirmationModalService.confirm(t)}if(e.rejectDropI18nKey){this.alertService.showDanger({message:e.rejectDropI18nKey,minWidth:"",mousePersist:true,duration:1e3,dismissible:true,width:"300px"});return false}throw new Error("Unexpected return value for beforeDropCallback does not contain confirmDropI18nKey nor rejectDropI18nKey: "+e)}return e}))}};Ci=__decorate([o.Injectable(),__metadata("design:paramtypes",[IConfirmationModalService,a.IAlertService,t.TreeService])],Ci);window.__smartedit__.addDecoratorPayload("Component","TreeComponent",{selector:"se-tree",providers:[t.TreeService,Ci,TreeNodeItemFactory],host:{class:"se-tree"},template:`<div class="categoryTable se-tree"><div class="se-tree__body"><div class="desktopLayout"><ol class="se-tree__nodes"><li *ngIf="(this.treeService.dataSource.get() | async).length === 0" class="se-tree__nodes--nodata">{{ 'se.ytree.no.nodes.to.display' | translate }}</li><li class="se-tree__nodes--item"><se-tree-node [source]="this.treeService.dataSource.get() | async"></se-tree-node></li></ol></div></div></div>`});t.TreeComponent=class TreeComponent{constructor(e,t){this.treeService=e;this.treeDragAndDropService=t;this.onTreeUpdated=new o.EventEmitter}ngOnInit(){this.setNodeActions();this.treeService.init(this.nodeUri,this.rootNodeUid);this.treeDragAndDropService.init(this.dragOptions);this.fetchData(this.treeService.root);this.treeService.onTreeUpdated().subscribe((()=>this.onTreeUpdated.emit(this.treeService.root.nodes)))}fetchData(e){return this.treeService.fetchChildren(e)}hasChildren(e){return e.hasChildren}collapseAll(){this.treeService.collapseAll()}expandAll(){this.treeService.expandAll()}remove(e){this.treeService.removeNode(e)}newSibling(e){this.treeService.newSibling(e)}refresh(e){e.setInitiated(false);return this.treeService.fetchChildren(e)}refreshParent(e){this.refresh(e.parent)}newChild(e){return __awaiter(this,void 0,void 0,(function*(){this.treeService.newChild(e)}))}getNodeById(e,t){return this.treeService.getNodeById(e,t)}get dragEnabled(){return this.treeDragAndDropService.isDragEnabled}setNodeActions(){Object.keys(this.nodeActions).forEach((e=>{this[e]=this.nodeActions[e].bind(this,this.treeService);this.nodeActions[e]=this.nodeActions[e].bind(this,this.treeService)}))}};__decorate([o.Input(),__metadata("design:type",String)],t.TreeComponent.prototype,"nodeTemplateUrl",void 0);__decorate([o.Input(),__metadata("design:type",o.Type)],t.TreeComponent.prototype,"nodeComponent",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.TreeComponent.prototype,"nodeUri",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.TreeComponent.prototype,"nodeActions",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.TreeComponent.prototype,"rootNodeUid",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.TreeComponent.prototype,"dragOptions",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.TreeComponent.prototype,"removeDefaultTemplate",void 0);__decorate([o.Input(),__metadata("design:type",Boolean)],t.TreeComponent.prototype,"showAsList",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.TreeComponent.prototype,"onTreeUpdated",void 0);t.TreeComponent=__decorate([o.Component({selector:"se-tree",providers:[t.TreeService,Ci,TreeNodeItemFactory],host:{class:"se-tree"},template:`<div class="categoryTable se-tree"><div class="se-tree__body"><div class="desktopLayout"><ol class="se-tree__nodes"><li *ngIf="(this.treeService.dataSource.get() | async).length === 0" class="se-tree__nodes--nodata">{{ 'se.ytree.no.nodes.to.display' | translate }}</li><li class="se-tree__nodes--item"><se-tree-node [source]="this.treeService.dataSource.get() | async"></se-tree-node></li></ol></div></div></div>`}),__metadata("design:paramtypes",[t.TreeService,Ci])],t.TreeComponent);window.__smartedit__.addDecoratorPayload("Component","TreeNodeComponent",{selector:"se-tree-node",template:`<ol class="se-tree-node__ol angular-ui-tree-nodes" cdkDropList (cdkDropListDropped)="onDrop($event)" [cdkDropListData]="source" [cdkDropListDisabled]="isDisabled"><li *ngFor="let node of source" cdkDrag [cdkDragData]="node" class="angular-ui-tree-node se-tree-node__li"><se-tree-node-renderer [node]="node"></se-tree-node-renderer></li></ol>`});let fi=class TreeNodeComponent{constructor(e,t){this.treeDragAndDropService=e;this.logService=t}get isDisabled(){return!this.treeDragAndDropService.isDragEnabled}onDrop(e){this.treeDragAndDropService.handleDrop(e).catch((e=>{this.logService.debug(`TreeNodeComponent - onDrop: error: ${e}`)}))}};__decorate([o.Input(),__metadata("design:type",Array)],fi.prototype,"source",void 0);fi=__decorate([o.Component({selector:"se-tree-node",template:`<ol class="se-tree-node__ol angular-ui-tree-nodes" cdkDropList (cdkDropListDropped)="onDrop($event)" [cdkDropListData]="source" [cdkDropListDisabled]="isDisabled"><li *ngFor="let node of source" cdkDrag [cdkDragData]="node" class="angular-ui-tree-node se-tree-node__li"><se-tree-node-renderer [node]="node"></se-tree-node-renderer></li></ol>`}),__metadata("design:paramtypes",[Ci,a.LogService])],fi);const Ei=10;window.__smartedit__.addDecoratorPayload("Component","TreeNodeRendererComponent",{selector:"se-tree-node-renderer",template:`<div class="tree-node tree-node-content se-tree-node angular-ui-tree-handle" [ngClass]="{\n        'hovered': node.mouseHovered,\n        'se-tree-node--first-level': isRootNodeDescendant,\n        'se-tree-node--selected': !collapsed\n    }" [ngStyle]="{\n        'padding-left': getPaddingLeft(node.level)\n    }" [attr.level]="node.level" (mouseover)="onMouseOver()" (mouseout)="onMouseOut()"><div *ngIf="!showAsList" class="se-tree-node__expander--wrapper col-xs-1 text-left"><a class="se-tree-node__expander btn" *ngIf="node.hasChildren" [attr.disabled]="isDisabled || null" (click)="toggle($event)"><span [ngClass]="{\n                    'sap-icon--slim-arrow-right': collapsed,\n                    'sap-icon--slim-arrow-down': !collapsed\n                }" title="{{ getNavigationTreeIconIsCollapse() | translate }}"></span></a></div><div *ngIf="displayDefaultTemplate" class="se-tree-node__name col-xs-5" [attr.title]="node.title | seL10n | async "><span>{{node.name}}</span><h6 *ngIf="node.title">{{node.title | seL10n | async }}</h6></div><ng-container *ngIf="tree.nodeComponent"><ng-container *ngComponentOutlet="tree.nodeComponent; injector: nodeComponentInjector"></ng-container></ng-container></div><se-tree-node [source]="node.nodes" *ngIf="node.nodes.length && node.isExpanded"></se-tree-node>`});t.TreeNodeRendererComponent=class TreeNodeRendererComponent{constructor(e,t,n){this.tree=e;this.treeService=t;this.injector=n}ngOnInit(){this.createNodeComponentInjector()}ngOnChanges(e){if(e.node){this.createNodeComponentInjector()}}toggle(e){e.stopPropagation();e.preventDefault();this.tree.isDropDisabled=true;this.treeService.toggle(this.node).then((()=>{this.tree.isDropDisabled=false}))}onMouseOver(){this.node.setMouseHovered(true);this.treeService.update()}onMouseOut(){this.node.setMouseHovered(false);this.treeService.update()}getPaddingLeft(e){return`${(e-1)*Ei}px`}get showAsList(){return this.tree.showAsList}get isDisabled(){return this.tree.isDropDisabled}get collapsed(){return!this.node.isExpanded}get displayDefaultTemplate(){return!this.tree.removeDefaultTemplate}get isRootNodeDescendant(){return this.node.parentUid==="root"}getNavigationTreeIconIsCollapse(){return this.node.isExpanded?"se.arrowicon.collapse.title":"se.arrowicon.expand.title"}createNodeComponentInjector(){this.nodeComponentInjector=o.Injector.create({providers:[{provide:yi,useValue:this.node}],parent:this.injector})}};__decorate([o.Input(),__metadata("design:type",Object)],t.TreeNodeRendererComponent.prototype,"node",void 0);t.TreeNodeRendererComponent=__decorate([o.Component({selector:"se-tree-node-renderer",template:`<div class="tree-node tree-node-content se-tree-node angular-ui-tree-handle" [ngClass]="{\n        'hovered': node.mouseHovered,\n        'se-tree-node--first-level': isRootNodeDescendant,\n        'se-tree-node--selected': !collapsed\n    }" [ngStyle]="{\n        'padding-left': getPaddingLeft(node.level)\n    }" [attr.level]="node.level" (mouseover)="onMouseOver()" (mouseout)="onMouseOut()"><div *ngIf="!showAsList" class="se-tree-node__expander--wrapper col-xs-1 text-left"><a class="se-tree-node__expander btn" *ngIf="node.hasChildren" [attr.disabled]="isDisabled || null" (click)="toggle($event)"><span [ngClass]="{\n                    'sap-icon--slim-arrow-right': collapsed,\n                    'sap-icon--slim-arrow-down': !collapsed\n                }" title="{{ getNavigationTreeIconIsCollapse() | translate }}"></span></a></div><div *ngIf="displayDefaultTemplate" class="se-tree-node__name col-xs-5" [attr.title]="node.title | seL10n | async "><span>{{node.name}}</span><h6 *ngIf="node.title">{{node.title | seL10n | async }}</h6></div><ng-container *ngIf="tree.nodeComponent"><ng-container *ngComponentOutlet="tree.nodeComponent; injector: nodeComponentInjector"></ng-container></ng-container></div><se-tree-node [source]="node.nodes" *ngIf="node.nodes.length && node.isExpanded"></se-tree-node>`}),__param(0,o.Inject(o.forwardRef((()=>t.TreeComponent)))),__metadata("design:paramtypes",[t.TreeComponent,t.TreeService,o.Injector])],t.TreeNodeRendererComponent);t.NgTreeModule=class NgTreeModule{};t.NgTreeModule=__decorate([o.NgModule({imports:[P.DragDropModule,u.CommonModule,t.L10nPipeModule,a.TranslationModule.forChild()],declarations:[t.TreeComponent,t.TreeNodeRendererComponent,fi],exports:[t.TreeComponent,fi],entryComponents:[t.TreeComponent,t.TreeNodeRendererComponent]})],t.NgTreeModule);class EditableListNodeItem extends TreeNodeItem{constructor(e){super(e);this.thumbnail=e.thumbnail||{};this.id=e.id;this.code=e.code;this.catalogId=e.catalogId;this.catalogVersion=e.catalogVersion}}window.__smartedit__.addDecoratorPayload("Component","EditableListComponent",{selector:"se-editable-list",template:`<div [ngClass]="{ 'y-editable-list-disabled': !editable, 'se-editable-list-disabled': !editable }"><se-tree (onTreeUpdated)="handleTreeUpdated($event)" [removeDefaultTemplate]="true" [rootNodeUid]="rootId" [nodeTemplateUrl]="itemTemplateUrl" [nodeComponent]="itemComponent" [nodeActions]="actions" [dragOptions]="dragOptions" [showAsList]="true"></se-tree></div>`});t.EditableListComponent=class EditableListComponent{constructor(){this.refreshChange=new o.EventEmitter;this.itemsChange=new o.EventEmitter;this.dragOptions={};this.itemsOld=[]}ngOnInit(){this._enableDragAndDrop=()=>{this.dragOptions.allowDropCallback=e=>e.sourceNode.parentUid===this.rootId};this.actions=this.getTreeActions();this.refreshChange.emit((()=>this.actions.refreshList()));if(!this.itemTemplateUrl&&!this.itemComponent){this.itemComponent=t.EditableListDefaultItem}this.rootId="root"+this.id;if(this.editable===undefined){this.editable=true}if(this.editable===true){this._enableDragAndDrop()}}handleTreeUpdated(e){if(this.hasItemsChanged(this.itemsOld,e)){this.itemsOld=e;this.itemsChange.emit(e);this.actions.performUpdate()}}getDropdownItems(){return[{key:"se.ydropdownmenu.remove",callback:e=>{this.actions.removeItem(e)}},{key:"se.ydropdownmenu.move.up",condition:e=>this.actions.isMoveUpAllowed(e),callback:e=>{this.actions.moveUp(e)}},{key:"se.ydropdownmenu.move.down",condition:e=>this.actions.isMoveDownAllowed(e),callback:e=>{this.actions.moveDown(e)}}]}hasItemsChanged(e,t){const n=e.map((({uid:e})=>e));const i=t.map((({uid:e})=>e));return!s.isEqual(n,i)}getTreeActions(){const e=this.getDropdownItems();return{fetchData:(e,t)=>{const n=this.items.map((e=>new EditableListNodeItem(e)));n.forEach((e=>{if(e.id&&!e.uid){e.uid=e.id}e.setParent(t)}));t.removeAllNodes().addNodes(n);e.update();return Promise.resolve(t)},getDropdownItems:()=>e,removeItem(e,t){t.parent.removeNode(t);e.update()},moveUp(e,t){e.rearrange(t,e.root,t.position-1)},moveDown(e,t){e.rearrange(t,e.root,t.position+1)},isMoveUpAllowed(e,t){return t.position>0},isMoveDownAllowed(e,t){return e.root.nodes.length!==t.position+1},performUpdate:e=>{if(this.onChange){this.onChange()}},refreshList(e){this.fetchData(e.root)}}}};__decorate([o.Input(),__metadata("design:type",Function)],t.EditableListComponent.prototype,"refresh",void 0);__decorate([o.Input(),__metadata("design:type",Array)],t.EditableListComponent.prototype,"items",void 0);__decorate([o.Input(),__metadata("design:type",Function)],t.EditableListComponent.prototype,"onChange",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.EditableListComponent.prototype,"itemTemplateUrl",void 0);__decorate([o.Input(),__metadata("design:type",o.Type)],t.EditableListComponent.prototype,"itemComponent",void 0);__decorate([o.Input(),__metadata("design:type",Boolean)],t.EditableListComponent.prototype,"editable",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.EditableListComponent.prototype,"id",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.EditableListComponent.prototype,"refreshChange",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.EditableListComponent.prototype,"itemsChange",void 0);t.EditableListComponent=__decorate([o.Component({selector:"se-editable-list",template:`<div [ngClass]="{ 'y-editable-list-disabled': !editable, 'se-editable-list-disabled': !editable }"><se-tree (onTreeUpdated)="handleTreeUpdated($event)" [removeDefaultTemplate]="true" [rootNodeUid]="rootId" [nodeTemplateUrl]="itemTemplateUrl" [nodeComponent]="itemComponent" [nodeActions]="actions" [dragOptions]="dragOptions" [showAsList]="true"></se-tree></div>`})],t.EditableListComponent);window.__smartedit__.addDecoratorPayload("Component","EditableListDefaultItem",{selector:"se-editable-list-default-item",template:`\n        <div>\n            <span>{{ node.uid }}</span>\n            <se-dropdown-menu\n                *ngIf="parent.editable"\n                [dropdownItems]="parent.getDropdownItems()"\n                [selectedItem]="node"\n                class="pull-right se-tree-node__actions--more-menu"\n                title="{{ 'se.contextmenu.title.more' | translate }}"></se-dropdown-menu>\n        </div>\n    `});t.EditableListDefaultItem=class EditableListDefaultItem{constructor(e,t){this.parent=e;this.node=t}};t.EditableListDefaultItem=__decorate([o.Component({selector:"se-editable-list-default-item",template:`\n        <div>\n            <span>{{ node.uid }}</span>\n            <se-dropdown-menu\n                *ngIf="parent.editable"\n                [dropdownItems]="parent.getDropdownItems()"\n                [selectedItem]="node"\n                class="pull-right se-tree-node__actions--more-menu"\n                title="{{ 'se.contextmenu.title.more' | translate }}"></se-dropdown-menu>\n        </div>\n    `}),__param(1,o.Inject(yi)),__metadata("design:paramtypes",[t.EditableListComponent,Object])],t.EditableListDefaultItem);t.EditableListModule=class EditableListModule{};t.EditableListModule=__decorate([o.NgModule({imports:[u.CommonModule,t.NgTreeModule,t.DropdownMenuModule,a.TranslationModule.forChild()],declarations:[t.EditableListComponent,t.EditableListDefaultItem],entryComponents:[t.EditableListComponent,t.EditableListDefaultItem],exports:[t.EditableListComponent,t.EditableListDefaultItem]})],t.EditableListModule);t.MessageType=void 0;(function(e){e["danger"]="danger";e["info"]="info";e["success"]="success";e["warning"]="warning"})(t.MessageType||(t.MessageType={}));window.__smartedit__.addDecoratorPayload("Component","MessageComponent",{selector:"se-message",template:`\n        <div\n            [attr.message-id]="messageId"\n            class="fd-message-strip se-y-message"\n            role="alert"\n            [ngClass]="classes">\n            <div class="y-message-text">\n                <div class="y-message-info-title">\n                    <ng-content select="[se-message-title]"></ng-content>\n                </div>\n                <div class="y-message-info-description">\n                    <ng-content select="[se-message-description]"></ng-content>\n                </div>\n            </div>\n        </div>\n    `});t.MessageComponent=class MessageComponent{ngOnInit(){this.messageId=this.messageId||"y-message-default-id";switch(this.type){case t.MessageType.danger:this.classes="fd-message-strip--error";break;case t.MessageType.info:this.classes="fd-message-strip--information";break;case t.MessageType.success:this.classes="fd-message-strip--success";break;case t.MessageType.warning:this.classes="fd-message-strip--warning";break;default:this.classes="fd-message-strip--information"}}};__decorate([o.Input(),__metadata("design:type",String)],t.MessageComponent.prototype,"messageId",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.MessageComponent.prototype,"type",void 0);t.MessageComponent=__decorate([o.Component({selector:"se-message",template:`\n        <div\n            [attr.message-id]="messageId"\n            class="fd-message-strip se-y-message"\n            role="alert"\n            [ngClass]="classes">\n            <div class="y-message-text">\n                <div class="y-message-info-title">\n                    <ng-content select="[se-message-title]"></ng-content>\n                </div>\n                <div class="y-message-info-description">\n                    <ng-content select="[se-message-description]"></ng-content>\n                </div>\n            </div>\n        </div>\n    `})],t.MessageComponent);window.__smartedit__.addDecoratorPayload("Component","EventMessageComponent",{selector:"se-event-message",template:`\n        <div>\n            <se-message [type]="type" *ngIf="show">\n                <ng-container *ngIf="showTitle()" se-message-title>\n                    {{ title | translate }}\n                </ng-container>\n                <ng-container *ngIf="showDescription()" se-message-description>\n                    {{ description | translate }}\n                </ng-container>\n            </se-message>\n        </div>\n    `});t.EventMessageComponent=class EventMessageComponent{constructor(e){this.systemEventService=e;this.show=false}ngOnInit(){this.show=this.showToStart==="true"||this.showToStart===true;this.watchShowEventChange();this.watchHideEventChange()}ngOnDestroy(){this.removeShowEventHandler();this.removeHideEventHandler()}ngOnChanges(e){if(e.showEvent){this.watchShowEventChange()}if(e.hideEvent){this.watchHideEventChange()}}showDescription(){return typeof this.description==="string"&&this.description.length>0}showTitle(){return typeof this.title==="string"&&this.title.length>0}showEventHandler(e,t){if(t.description&&t.description.length){this.description=t.description}if(t.title&&t.title.length){this.title=t.title}this.show=true}removeHideEventHandler(){if(this.unregisterHideEventHandler){this.unregisterHideEventHandler()}}removeShowEventHandler(){if(this.unregisterShowEventHandler){this.unregisterShowEventHandler()}}watchShowEventChange(){this.removeShowEventHandler();this.unregisterShowEventHandler=this.systemEventService.subscribe(this.showEvent,((e,t)=>this.showEventHandler(e,t)))}watchHideEventChange(){this.removeHideEventHandler();this.unregisterHideEventHandler=this.systemEventService.subscribe(this.hideEvent,(()=>this.show=false))}};__decorate([o.Input(),__metadata("design:type",String)],t.EventMessageComponent.prototype,"type",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.EventMessageComponent.prototype,"title",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.EventMessageComponent.prototype,"description",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.EventMessageComponent.prototype,"showEvent",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.EventMessageComponent.prototype,"hideEvent",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.EventMessageComponent.prototype,"showToStart",void 0);t.EventMessageComponent=__decorate([o.Component({selector:"se-event-message",template:`\n        <div>\n            <se-message [type]="type" *ngIf="show">\n                <ng-container *ngIf="showTitle()" se-message-title>\n                    {{ title | translate }}\n                </ng-container>\n                <ng-container *ngIf="showDescription()" se-message-description>\n                    {{ description | translate }}\n                </ng-container>\n            </se-message>\n        </div>\n    `}),__metadata("design:paramtypes",[t.SystemEventService])],t.EventMessageComponent);t.MessageModule=class MessageModule{};t.MessageModule=__decorate([o.NgModule({imports:[u.CommonModule,h.TranslateModule.forChild()],declarations:[t.MessageComponent,t.EventMessageComponent],entryComponents:[t.MessageComponent,t.EventMessageComponent],exports:[t.MessageComponent,t.EventMessageComponent]})],t.MessageModule);window.__smartedit__.addDecoratorPayload("Component","MoreTextComponent",{selector:"se-more-text",template:`\n        <span id="y-more-text-payload" class="se-more-text__payload">{{ text }}</span>\n        <span\n            id="y-more-text-toggle"\n            class="se-more-text__toggle"\n            [ngClass]="{ 'se-more-text__toggle--capitalize': capitalizeLabel }"\n            (click)="showHideMoreText()"\n            *ngIf="isTruncated"\n            >{{ linkLabel }}</span\n        >\n    `,styles:[`.se-more-text__toggle--capitalize{text-transform:capitalize;color:var(--sapInformativeColor);cursor:pointer}`],providers:[TextTruncateService]});t.MoreTextComponent=class MoreTextComponent{constructor(e,t){this.textTruncateService=e;this.translate=t;this.capitalizeLabel=false;this.isTruncated=false;this.showingMore=false}ngOnInit(){this.limit=this.limit||100;this.moreLabelI18nKey=this.moreLabelI18nKey||"se.moretext.more.link";this.lessLabelI18nKey=this.lessLabelI18nKey||"se.moretext.less.link";this.truncatedText=this.textTruncateService.truncateToNearestWord(this.limit,this.text,this.ellipsis);this.isTruncated=this.truncatedText.isTruncated();this.translateLabels().subscribe((()=>{this.showHideMoreText()}))}showHideMoreText(){if(!this.isTruncated){return}this.text=this.showingMore?this.truncatedText.getUntruncatedText():this.truncatedText.getTruncatedText();this.linkLabel=this.showingMore?this.lessLabel:this.moreLabel;this.showingMore=!this.showingMore}translateLabels(){return p.zip(this.translate.get(this.moreLabelI18nKey),this.translate.get(this.lessLabelI18nKey)).pipe(_.tap((([e,t])=>{this.moreLabel=e;this.lessLabel=t})))}};__decorate([o.Input(),__metadata("design:type",String)],t.MoreTextComponent.prototype,"text",void 0);__decorate([o.Input(),__metadata("design:type",Number)],t.MoreTextComponent.prototype,"limit",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.MoreTextComponent.prototype,"moreLabelI18nKey",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.MoreTextComponent.prototype,"lessLabelI18nKey",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.MoreTextComponent.prototype,"ellipsis",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.MoreTextComponent.prototype,"capitalizeLabel",void 0);t.MoreTextComponent=__decorate([o.Component({selector:"se-more-text",template:`\n        <span id="y-more-text-payload" class="se-more-text__payload">{{ text }}</span>\n        <span\n            id="y-more-text-toggle"\n            class="se-more-text__toggle"\n            [ngClass]="{ 'se-more-text__toggle--capitalize': capitalizeLabel }"\n            (click)="showHideMoreText()"\n            *ngIf="isTruncated"\n            >{{ linkLabel }}</span\n        >\n    `,styles:[`.se-more-text__toggle--capitalize{text-transform:capitalize;color:var(--sapInformativeColor);cursor:pointer}`],providers:[TextTruncateService]}),__metadata("design:paramtypes",[TextTruncateService,h.TranslateService])],t.MoreTextComponent);t.MoreTextModule=class MoreTextModule{};t.MoreTextModule=__decorate([o.NgModule({imports:[u.CommonModule],declarations:[t.MoreTextComponent],entryComponents:[t.MoreTextComponent],exports:[t.MoreTextComponent]})],t.MoreTextModule);const Ii=new o.InjectionToken("POPUP_OVERLAY_DATA");t.PopoverTrigger=void 0;(function(e){e["Hover"]="hover";e["Click"]="click"})(t.PopoverTrigger||(t.PopoverTrigger={}));window.__smartedit__.addDecoratorPayload("Component","PopupOverlayComponent",{selector:"se-popup-overlay",template:`<fd-popover [placement]="getPlacement()" [noArrow]="true" [triggers]="trigger && trigger.length ? [] : trigger" (isOpenChange)="handleOpenChange($event)" [additionalBodyClass]="'se-popup-overlay-container'" class="popup-overlay popover-outer" [ngClass]="popupOverlay.additionalClasses"><fd-popover-control><ng-content></ng-content></fd-popover-control><fd-popover-body #popoverBody class="popover-inner popup-overlay__inner"><ng-container *ngIf="isOpen"><ng-container *ngIf="popupOverlay.component"><ng-container *ngComponentOutlet="\n                        popupOverlay.component;\n                        injector: popupOverlayInjector\n                    "></ng-container></ng-container><ng-content select="[se-popup-overlay-body]"></ng-content></ng-container></fd-popover-body></fd-popover>`,styles:[`.se-popup-overlay-container{z-index:1060!important}`],encapsulation:o.ViewEncapsulation.None});t.PopupOverlayComponent=class PopupOverlayComponent{constructor(e){this.injector=e;this.popupOverlayOnShow=new o.EventEmitter;this.popupOverlayOnHide=new o.EventEmitter;this.trigger=[]}ngOnInit(){this.createInjector();this.setTrigger()}ngOnChanges(e){if(e.popupOverlayTrigger){this.setTrigger()}if(e.popupOverlayData){this.createInjector()}}handleOpenChange(e){return e?this.handleOpen():this.handleClose()}handleOpen(){this.isOpen=true;this.popupOverlayOnShow.emit()}handleClose(){this.isOpen=false;this.popupOverlayOnHide.emit()}getPlacement(){return`${this.popupOverlay.valign||"bottom"}-${this.getHorizontalAlign()}`}updatePosition(){this.popover.refreshPosition()}setTrigger(){if(this.popupOverlayTrigger===t.PopoverTrigger.Click){this.trigger=[this.popupOverlayTrigger]}if(this.popupOverlayTrigger===t.PopoverTrigger.Hover){this.trigger=["mouseenter","mouseleave"]}if(!this.popover){return}if(this.popupOverlayTrigger==="true"||this.popupOverlayTrigger===true){this.popover.open()}else{this.popover.close()}}getHorizontalAlign(){if(!this.popupOverlay.halign){return"start"}return this.popupOverlay.halign==="right"?"start":"end"}createInjector(){this.popupOverlayInjector=o.Injector.create({providers:[{provide:Ii,useValue:this.popupOverlayData||{}}],parent:this.injector})}};__decorate([o.Input(),__metadata("design:type",Object)],t.PopupOverlayComponent.prototype,"popupOverlay",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.PopupOverlayComponent.prototype,"popupOverlayTrigger",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.PopupOverlayComponent.prototype,"popupOverlayData",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.PopupOverlayComponent.prototype,"popupOverlayOnShow",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.PopupOverlayComponent.prototype,"popupOverlayOnHide",void 0);__decorate([o.ViewChild(S.PopoverComponent,{static:false}),__metadata("design:type",S.PopoverComponent)],t.PopupOverlayComponent.prototype,"popover",void 0);t.PopupOverlayComponent=__decorate([o.Component({selector:"se-popup-overlay",template:`<fd-popover [placement]="getPlacement()" [noArrow]="true" [triggers]="trigger && trigger.length ? [] : trigger" (isOpenChange)="handleOpenChange($event)" [additionalBodyClass]="'se-popup-overlay-container'" class="popup-overlay popover-outer" [ngClass]="popupOverlay.additionalClasses"><fd-popover-control><ng-content></ng-content></fd-popover-control><fd-popover-body #popoverBody class="popover-inner popup-overlay__inner"><ng-container *ngIf="isOpen"><ng-container *ngIf="popupOverlay.component"><ng-container *ngComponentOutlet="\n                        popupOverlay.component;\n                        injector: popupOverlayInjector\n                    "></ng-container></ng-container><ng-content select="[se-popup-overlay-body]"></ng-content></ng-container></fd-popover-body></fd-popover>`,styles:[`.se-popup-overlay-container{z-index:1060!important}`],encapsulation:o.ViewEncapsulation.None}),__metadata("design:paramtypes",[o.Injector])],t.PopupOverlayComponent);t.PopupOverlayModule=class PopupOverlayModule{};t.PopupOverlayModule=__decorate([o.NgModule({imports:[u.CommonModule,S.PopoverModule],declarations:[t.PopupOverlayComponent],entryComponents:[t.PopupOverlayComponent],exports:[t.PopupOverlayComponent]})],t.PopupOverlayModule);const bi="max-height.px";window.__smartedit__.addDecoratorPayload("Component","PreventVerticalOverflowComponent",{selector:"se-prevent-vertical-overflow",changeDetection:o.ChangeDetectionStrategy.OnPush,template:`\n        <div #container [ngStyle]="containerStyle">\n            <ng-content></ng-content>\n        </div>\n    `});t.PreventVerticalOverflowComponent=class PreventVerticalOverflowComponent{constructor(e,t){this.document=e;this.cdr=t;this.containerStyle={"max-height.px":null,overflow:null}}onWindowResize(){if(this.containerElement){this.onResize()}}ngAfterViewInit(){this.observer=new IntersectionObserver((([e])=>{if(e.isIntersecting){this.onResize()}}),{root:this.document,threshold:0});this.observer.observe(this.containerElement.nativeElement)}ngOnDestroy(){this.observer.unobserve(this.containerElement.nativeElement)}onResize(){const{top:e,height:t}=this.getContainerBoundingClientRect();if(e===0&&t===0){return}this.preventOverflow(e,t)}preventOverflow(e,t){const n=this.preventIfOverflowing(e,t);if(!n&&this.containerStyle[bi]){this.reset();const{top:e,height:t}=this.getContainerBoundingClientRect();this.preventIfOverflowing(e,t)}}preventIfOverflowing(e,t){if(this.isOverflowing(e,t)){this.prevent(e);return true}return false}isOverflowing(e,t){const n=this.getDocumentHeight();return n<e+t}prevent(e){const t=this.getDocumentHeight();const n=t-e;this.containerStyle[bi]=n;this.containerStyle.overflow="auto";if(!this.cdr.destroyed){this.cdr.detectChanges()}}reset(){this.containerStyle[bi]=null;this.containerStyle.overflow=null;if(!this.cdr.destroyed){this.cdr.detectChanges()}}getContainerBoundingClientRect(){return this.containerElement.nativeElement.getBoundingClientRect()}getDocumentHeight(){const{height:e}=this.document.documentElement.getBoundingClientRect();return e}};__decorate([o.ViewChild("container",{static:false}),__metadata("design:type",o.ElementRef)],t.PreventVerticalOverflowComponent.prototype,"containerElement",void 0);__decorate([o.HostListener("window:resize"),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],t.PreventVerticalOverflowComponent.prototype,"onWindowResize",null);t.PreventVerticalOverflowComponent=__decorate([o.Component({selector:"se-prevent-vertical-overflow",changeDetection:o.ChangeDetectionStrategy.OnPush,template:`\n        <div #container [ngStyle]="containerStyle">\n            <ng-content></ng-content>\n        </div>\n    `}),__param(0,o.Inject(u.DOCUMENT)),__metadata("design:paramtypes",[Document,o.ChangeDetectorRef])],t.PreventVerticalOverflowComponent);t.PreventVerticalOverflowModule=class PreventVerticalOverflowModule{};t.PreventVerticalOverflowModule=__decorate([o.NgModule({imports:[u.CommonModule],declarations:[t.PreventVerticalOverflowComponent],entryComponents:[t.PreventVerticalOverflowComponent],exports:[t.PreventVerticalOverflowComponent]})],t.PreventVerticalOverflowModule);window.__smartedit__.addDecoratorPayload("Component","HelpComponent",{selector:"se-help",template:`<se-tooltip [triggers]="['mouseenter', 'mouseleave']" placement="right" [isChevronVisible]="true" [title]="title" class="se-help"><span se-tooltip-trigger class="sap-icon--sys-help se-y-help-icon"></span><ng-content se-tooltip-body></ng-content></se-tooltip>`});t.HelpComponent=class HelpComponent{};__decorate([o.Input(),__metadata("design:type",String)],t.HelpComponent.prototype,"title",void 0);t.HelpComponent=__decorate([o.Component({selector:"se-help",template:`<se-tooltip [triggers]="['mouseenter', 'mouseleave']" placement="right" [isChevronVisible]="true" [title]="title" class="se-help"><span se-tooltip-trigger class="sap-icon--sys-help se-y-help-icon"></span><ng-content se-tooltip-body></ng-content></se-tooltip>`})],t.HelpComponent);t.HelpModule=class HelpModule{};t.HelpModule=__decorate([o.NgModule({imports:[u.CommonModule,t.TooltipModule],declarations:[t.HelpComponent],entryComponents:[t.HelpComponent],exports:[t.HelpComponent]})],t.HelpModule);window.__smartedit__.addDecoratorPayload("Component","ShortcutLinkComponent",{selector:"shortcut-link",template:`<ng-container #container><ng-template #defaultTemplate let-shortcutLink><div class="se-shortcut-link"><a class="se-shortcut-link__item" [ngClass]="{'se-shortcut-link__item--active': shortcutLink.active}" (click)="onClick(shortcutLink)">{{shortcutLink.titleI18nKey | translate}}</a></div></ng-template></ng-container>`});t.ShortcutLinkComponent=class ShortcutLinkComponent{constructor(e,t,n,i,o,s,r){this.router=e;this.location=t;this.resolver=n;this.experienceService=i;this.priorityService=o;this.systemEventService=s;this.userTrackingService=r}ngOnInit(){this.unregFn=this.systemEventService.subscribe(a.EVENTS.EXPERIENCE_UPDATE,(()=>this._createShortcutLink()))}ngOnDestroy(){this.unregFn()}ngAfterViewInit(){this._createShortcutLink()}onClick(e){this.userTrackingService.trackingUserAction(rn.NAVIGATION,e.titleI18nKey);this.location.go(e.fullPath);this.router.navigateByUrl(e.fullPath)}_createShortcutLink(){const e=this.experienceService.getCurrentExperience();e.then((e=>{const t=this._getShortcutLinks(e);const n=this._orderByPriority(t);this._createShortcutLinkDynamicComponents(n)}))}_createShortcutLinkDynamicComponents(e){this.containerEntry.clear();e.forEach((e=>{if(e&&e.titleI18nKey){this.containerEntry.createEmbeddedView(this.defaultTemplate,{$implicit:e})}else if(e&&e.shortcutComponent){const t=this.resolver.resolveComponentFactory(e.shortcutComponent);const n=this.containerEntry.createComponent(t);n.instance.shortcutLink=e}}))}_getShortcutLinks(e){const t=this.location.path();return SeRouteService.routeShortcutConfigs.map((n=>{let i;const o=n.fullPath.replace(":siteId",e.catalogDescriptor.siteId).replace(":catalogId",e.catalogDescriptor.catalogId).replace(":catalogVersion",e.catalogDescriptor.catalogVersion);if(o.startsWith("/")){i=o===t}else{i=`/${o}`===t}const s=Object.assign({},n);s.fullPath=o;s.active=i;return s}))}_orderByPriority(e){e.forEach((e=>e.priority=e.priority||500));return this.priorityService.sort(e)}};__decorate([o.ViewChild("container",{read:o.ViewContainerRef,static:false}),__metadata("design:type",o.ViewContainerRef)],t.ShortcutLinkComponent.prototype,"containerEntry",void 0);__decorate([o.ViewChild("defaultTemplate",{read:o.TemplateRef,static:false}),__metadata("design:type",o.TemplateRef)],t.ShortcutLinkComponent.prototype,"defaultTemplate",void 0);t.ShortcutLinkComponent=__decorate([o.Component({selector:"shortcut-link",template:`<ng-container #container><ng-template #defaultTemplate let-shortcutLink><div class="se-shortcut-link"><a class="se-shortcut-link__item" [ngClass]="{'se-shortcut-link__item--active': shortcutLink.active}" (click)="onClick(shortcutLink)">{{shortcutLink.titleI18nKey | translate}}</a></div></ng-template></ng-container>`}),__metadata("design:paramtypes",[g.Router,u.Location,o.ComponentFactoryResolver,IExperienceService,t.PriorityService,t.SystemEventService,IUserTrackingService])],t.ShortcutLinkComponent);class SliderPanelZIndexHelper{getHighestZIndex(e){return Math.max(...this.getChildrenNodesFromTreeOrLeaf(e[0]).filter((e=>this.filterBlacklistedNodes(e))).map((e=>this.mapToZIndexIntegers(e))))}filterBlacklistedNodes(e){return!SliderPanelZIndexHelper.BLACKLISTED_NODE_NAMES.has(e.nodeName)}mapToZIndexIntegers(e){return parseInt(window.getComputedStyle(e).getPropertyValue("z-index"),10)||parseInt(e.style.zIndex,10)||0}getChildrenNodesFromTreeOrLeaf(e){return[e,...s.flatten(Array.from(e.children).map((e=>this.getChildrenNodesFromTreeOrLeaf(e))))]}}SliderPanelZIndexHelper.BLACKLISTED_NODE_NAMES=new Set(["SCRIPT","LINK","BASE"]);class SliderPanelService{constructor(e,t,n,i){this.element=e;this.window=t;this.configuration=n;this.yjQuery=i;this.inlineStyling={container:{},content:{}};this.sliderPanelDefaultConfiguration={slideFrom:"right",overlayDimension:"80%"};this.init()}updateContainerInlineStyling(e){const t=this.parent[0].getBoundingClientRect();const n={left:this.parent.css("border-left-width")?parseInt(this.parent.css("border-left-width").replace("px",""),10):0,top:this.parent.css("border-top-width")?parseInt(this.parent.css("border-top-width").replace("px",""),10):0};this.inlineStyling.container.height=this.parent[0].clientHeight+"px";this.inlineStyling.container.width=this.parent[0].clientWidth+"px";this.inlineStyling.container.left=(this.appendChildTarget.nodeName==="BODY"?Math.round(t.left+this.window.pageXOffset+n.left):0)+"px";this.inlineStyling.container.top=(this.appendChildTarget.nodeName==="BODY"?Math.round(t.top+this.window.pageYOffset+n.top):0)+"px";if(!e){this.inlineStyling.container.zIndex=this.sliderPanelConfiguration.zIndex?this.sliderPanelConfiguration.zIndex.toString():(this.returningHigherZIndex()+1).toString()}}returningHigherZIndex(){return(new SliderPanelZIndexHelper).getHighestZIndex(this.yjQuery("body"))}initializeParentRawElement(){const e=this.sliderPanelConfiguration.cssSelector?document.querySelector(this.sliderPanelConfiguration.cssSelector):null;this.parent=this.yjQuery(e||this.element.parent())}initializePanelConfiguration(){this.sliderPanelConfiguration=s.defaultsDeep(this.configuration,this.sliderPanelDefaultConfiguration)}initializeInlineStyles(){const e=["top","bottom"].indexOf(this.sliderPanelConfiguration.slideFrom)===-1?"width":"height";this.inlineStyling.content[e]=this.sliderPanelConfiguration.overlayDimension}initializeChildTarget(){let e=this.parent;let t=false;let n=0;for(n;e[0]&&e[0].nodeName!=="BODY";e=this.yjQuery(e.parent()),n++){const n=(e[0].getAttribute("class")||"").includes("fd-dialog__content");const i=e[0].getAttribute("id")==="y-modal-dialog";if(n||i){t=true;break}}this.appendChildTarget=t?e[0]:document.body}append(){this.yjQuery(this.appendChildTarget).append(this.element[0])}init(){this.initializePanelConfiguration();this.initializeParentRawElement();this.initializeInlineStyles();this.initializeChildTarget();this.append()}}t.SliderPanelServiceFactory=class SliderPanelServiceFactory{constructor(e){this.yjQuery=e}getNewServiceInstance(e,t,n){return new SliderPanelService(e,t,n,this.yjQuery)}};t.SliderPanelServiceFactory=__decorate([__param(0,o.Inject(Bn)),__metadata("design:paramtypes",[Function])],t.SliderPanelServiceFactory);const Ti={SLIDERPANEL_ANIMATED:"sliderpanel--animated",SLIDERPANEL_SLIDEPREFIX:"sliderpanel--slidefrom"};window.__smartedit__.addDecoratorPayload("Component","SliderPanelComponent",{selector:"se-slider-panel",template:`<div class="se-slider-panel-wrapper" *ngIf="isShown"><div class="se-slider-panel-container slide-in"><div class="se-slider-panel__header" *ngIf="sliderPanelConfiguration.modal"><span class="se-slider-panel__title" *ngIf="sliderPanelConfiguration.modal.title">{{ sliderPanelConfiguration.modal.title | translate }}</span> <button type="button" class="se-slider-panel__close-btn fd-button fd-button--transparent fd-dialog__close" aria-label="close" *ngIf="sliderPanelConfiguration.modal.showDismissButton" (click)="sliderPanelDismissAction()" title="{{ 'se.btn.close.title' | translate }}"><span class="sap-icon--decline"></span></button></div><div class="se-slider-panel__body"><ng-content></ng-content></div><div class="se-slider-panel__footer" *ngIf="sliderPanelConfiguration.modal && (sliderPanelConfiguration.modal.cancel || sliderPanelConfiguration.modal.save)"><button type="button" class="fd-button fd-button--emphasized se-slider-panel__footer-btn se-slider-panel__footer-btn--save" *ngIf="sliderPanelConfiguration.modal.save" (click)="sliderPanelConfiguration.modal.save.onClick()" [disabled]="isSaveDisabled()">{{ sliderPanelConfiguration.modal.save.label | translate }}</button> <button type="button" class="fd-button fd-button--transparent se-slider-panel__footer-btn se-slider-panel__footer-btn--cancel" *ngIf="sliderPanelConfiguration.modal.cancel" (click)="sliderPanelConfiguration.modal.cancel.onClick()">{{ sliderPanelConfiguration.modal.cancel.label | translate }}</button></div></div></div>`,styles:[`.se-slider-panel-wrapper{position:fixed;display:flex;justify-content:center;overflow:hidden;width:100%;top:0;left:0;z-index:999}.se-slider-panel-container{display:flex;flex-direction:column;transform:translateX(100%);-webkit-transform:translateX(100%);background-color:var(--sapBaseColor);border-radius:4px;width:650px}.se-slider-panel__header{padding:20px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;border-bottom:1px solid var(--sapGroup_ContentBorderColor);height:53px}.se-slider-panel__header:first-child{font-size:1rem!important;line-height:1.25;font-weight:400;color:var(--sapTextColor)}.se-slider-panel__body{padding:20px;overflow-y:auto;max-height:70vh;height:70vh;min-height:500px;flex:1 1 auto}.se-slider-panel__footer{padding:20px;display:flex;flex-direction:row;align-items:center;justify-content:flex-end;border-top:1px solid var(--sapGroup_ContentBorderColor);height:69px}.se-slider-panel__footer button{text-transform:capitalize;margin-left:12px}.slide-in{animation:slide-in .4s forwards;-webkit-animation:slide-in .4s forwards}@keyframes slide-in{100%{transform:translateX(0)}}@-webkit-keyframes slide-in{100%{-webkit-transform:translateX(0)}}:host-context(fd-dialog-container).sliderpanel--animated{position:fixed;left:0;top:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);align-items:center;display:flex;z-index:1000}:host-context(fd-dialog-container).sliderpanel--animated .se-slider-panel-wrapper{top:auto}:host-context(fd-dialog-container).sliderpanel--animated .se-slider-panel-wrapper .se-slider-panel__body{max-height:calc(100vh - 128px);min-height:auto}`]});t.SliderPanelComponent=class SliderPanelComponent{constructor(e,t,n,i,s){this.renderer=e;this.element=t;this.windowUtils=n;this.yjQuery=i;this.sliderPanelServiceFactory=s;this.sliderPanelHideChange=new o.EventEmitter;this.sliderPanelShowChange=new o.EventEmitter;this.isShownChange=new o.EventEmitter;this.inlineStyling={container:{},content:{}}}ngOnInit(){this.isShown=false;this.uniqueId=W.generateIdentifier();this.sliderPanelService=this.sliderPanelServiceFactory.getNewServiceInstance(this.yjQuery(this.element.nativeElement),this.windowUtils.getWindow(),this.sliderPanelConfiguration);this.sliderPanelConfiguration=this.sliderPanelService.sliderPanelConfiguration;this.slideClassName=Ti.SLIDERPANEL_SLIDEPREFIX+this.sliderPanelConfiguration.slideFrom;this.inlineStyling={container:this.sliderPanelService.inlineStyling.container,content:this.sliderPanelService.inlineStyling.content};setTimeout((()=>{this.sliderPanelShowChange.emit((()=>this.showSlider()));this.sliderPanelHideChange.emit((()=>this.hideSlider()))}));this.sliderPanelDismissAction=this.sliderPanelConfiguration.modal&&this.sliderPanelConfiguration.modal.dismiss&&this.sliderPanelConfiguration.modal.dismiss.onClick?this.sliderPanelConfiguration.modal.dismiss.onClick:this.hideSlider;this.addScreenResizeEventHandler();if(this.sliderPanelConfiguration.displayedByDefault){this.showSlider()}}ngOnDestroy(){this.yjQuery(this.windowUtils.getWindow()).off("resize.doResize")}hideSlider(){return new Promise((e=>{this.renderer.removeClass(this.element.nativeElement,Ti.SLIDERPANEL_ANIMATED);this.isShown=false;this.isShownChange.emit(this.isShown);e()}))}showSlider(){return new Promise((e=>{this.sliderPanelService.updateContainerInlineStyling(false);this.inlineStyling.container=this.sliderPanelService.inlineStyling.container;let t=false;this.yjQuery("se-slider-panel.sliderpanel--animated .se-slider-panel-container").toArray().forEach((e=>{const n=this.yjQuery(e);if(!t){if(n.css("height")===this.inlineStyling.container.height&&n.css("width")===this.inlineStyling.container.width&&n.css("left")===this.inlineStyling.container.left&&n.css("top")===this.inlineStyling.container.top){t=true}}}));this.sliderPanelConfiguration.noGreyedOutOverlay=typeof this.sliderPanelConfiguration.noGreyedOutOverlay==="boolean"?this.sliderPanelConfiguration.noGreyedOutOverlay:t;this.isShown=true;this.isShownChange.emit(this.isShown);this.renderer.addClass(this.element.nativeElement,Ti.SLIDERPANEL_ANIMATED);e()}))}isSaveDisabled(){if(this.sliderPanelConfiguration.modal&&this.sliderPanelConfiguration.modal.save&&this.sliderPanelConfiguration.modal.save.isDisabledFn){return this.sliderPanelConfiguration.modal.save.isDisabledFn()}return false}addScreenResizeEventHandler(){this.yjQuery(this.windowUtils.getWindow()).on("resize.sliderPanelRedraw_"+this.uniqueId,(()=>{if(this.isShown){setTimeout((()=>{this.sliderPanelService.updateContainerInlineStyling(true);this.inlineStyling.container=this.sliderPanelService.inlineStyling.container}),0)}}))}};__decorate([o.Input(),__metadata("design:type",Object)],t.SliderPanelComponent.prototype,"sliderPanelConfiguration",void 0);__decorate([o.Input(),__metadata("design:type",Function)],t.SliderPanelComponent.prototype,"sliderPanelHide",void 0);__decorate([o.Input(),__metadata("design:type",Function)],t.SliderPanelComponent.prototype,"sliderPanelShow",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.SliderPanelComponent.prototype,"sliderPanelHideChange",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.SliderPanelComponent.prototype,"sliderPanelShowChange",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.SliderPanelComponent.prototype,"isShownChange",void 0);__decorate([o.ContentChild(o.TemplateRef,{static:false}),__metadata("design:type",o.TemplateRef)],t.SliderPanelComponent.prototype,"content",void 0);t.SliderPanelComponent=__decorate([o.Component({selector:"se-slider-panel",template:`<div class="se-slider-panel-wrapper" *ngIf="isShown"><div class="se-slider-panel-container slide-in"><div class="se-slider-panel__header" *ngIf="sliderPanelConfiguration.modal"><span class="se-slider-panel__title" *ngIf="sliderPanelConfiguration.modal.title">{{ sliderPanelConfiguration.modal.title | translate }}</span> <button type="button" class="se-slider-panel__close-btn fd-button fd-button--transparent fd-dialog__close" aria-label="close" *ngIf="sliderPanelConfiguration.modal.showDismissButton" (click)="sliderPanelDismissAction()" title="{{ 'se.btn.close.title' | translate }}"><span class="sap-icon--decline"></span></button></div><div class="se-slider-panel__body"><ng-content></ng-content></div><div class="se-slider-panel__footer" *ngIf="sliderPanelConfiguration.modal && (sliderPanelConfiguration.modal.cancel || sliderPanelConfiguration.modal.save)"><button type="button" class="fd-button fd-button--emphasized se-slider-panel__footer-btn se-slider-panel__footer-btn--save" *ngIf="sliderPanelConfiguration.modal.save" (click)="sliderPanelConfiguration.modal.save.onClick()" [disabled]="isSaveDisabled()">{{ sliderPanelConfiguration.modal.save.label | translate }}</button> <button type="button" class="fd-button fd-button--transparent se-slider-panel__footer-btn se-slider-panel__footer-btn--cancel" *ngIf="sliderPanelConfiguration.modal.cancel" (click)="sliderPanelConfiguration.modal.cancel.onClick()">{{ sliderPanelConfiguration.modal.cancel.label | translate }}</button></div></div></div>`,styles:[`.se-slider-panel-wrapper{position:fixed;display:flex;justify-content:center;overflow:hidden;width:100%;top:0;left:0;z-index:999}.se-slider-panel-container{display:flex;flex-direction:column;transform:translateX(100%);-webkit-transform:translateX(100%);background-color:var(--sapBaseColor);border-radius:4px;width:650px}.se-slider-panel__header{padding:20px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;border-bottom:1px solid var(--sapGroup_ContentBorderColor);height:53px}.se-slider-panel__header:first-child{font-size:1rem!important;line-height:1.25;font-weight:400;color:var(--sapTextColor)}.se-slider-panel__body{padding:20px;overflow-y:auto;max-height:70vh;height:70vh;min-height:500px;flex:1 1 auto}.se-slider-panel__footer{padding:20px;display:flex;flex-direction:row;align-items:center;justify-content:flex-end;border-top:1px solid var(--sapGroup_ContentBorderColor);height:69px}.se-slider-panel__footer button{text-transform:capitalize;margin-left:12px}.slide-in{animation:slide-in .4s forwards;-webkit-animation:slide-in .4s forwards}@keyframes slide-in{100%{transform:translateX(0)}}@-webkit-keyframes slide-in{100%{-webkit-transform:translateX(0)}}:host-context(fd-dialog-container).sliderpanel--animated{position:fixed;left:0;top:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);align-items:center;display:flex;z-index:1000}:host-context(fd-dialog-container).sliderpanel--animated .se-slider-panel-wrapper{top:auto}:host-context(fd-dialog-container).sliderpanel--animated .se-slider-panel-wrapper .se-slider-panel__body{max-height:calc(100vh - 128px);min-height:auto}`]}),__param(3,o.Inject(Bn)),__metadata("design:paramtypes",[o.Renderer2,o.ElementRef,t.WindowUtils,Function,t.SliderPanelServiceFactory])],t.SliderPanelComponent);t.SliderPanelModule=class SliderPanelModule{};t.SliderPanelModule=__decorate([o.NgModule({imports:[u.CommonModule,a.TranslationModule.forChild()],declarations:[t.SliderPanelComponent],entryComponents:[t.SliderPanelComponent],providers:[t.SliderPanelServiceFactory],exports:[t.SliderPanelComponent]})],t.SliderPanelModule);t.ResizeObserverDirective=class ResizeObserverDirective{constructor(e){this.elementRef=e;this.onResize=new o.EventEmitter}ngOnInit(){this.startWatching()}ngOnDestroy(){this.observer.disconnect()}startWatching(){this.observer=new O.ResizeObserver((e=>this.internalOnResize(e)));this.observer.observe(this.elementRef.nativeElement)}internalOnResize(e){this.onResize.emit()}};__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.ResizeObserverDirective.prototype,"onResize",void 0);t.ResizeObserverDirective=__decorate([o.Directive({selector:"[seResizeObserver]"}),__metadata("design:paramtypes",[o.ElementRef])],t.ResizeObserverDirective);t.ResizeObserverModule=class ResizeObserverModule{};t.ResizeObserverModule=__decorate([o.NgModule({declarations:[t.ResizeObserverDirective],exports:[t.ResizeObserverDirective]})],t.ResizeObserverModule);class HasOperationPermissionBaseDirective{constructor(e,t,n){this.systemEventService=e;this.permissionService=t;this.logService=n}ngOnInit(){this.unregisterHandler=this.systemEventService.subscribe(a.EVENTS.PERMISSION_CACHE_CLEANED,this.refreshIsPermissionGranted.bind(this))}ngOnDestroy(){this.unregisterHandler()}ngOnChanges(e){if(e.hasOperationPermission&&e.hasOperationPermission.currentValue){this.permission=e.hasOperationPermission.currentValue;this.refreshIsPermissionGranted()}}set isPermissionGrantedHandler(e){this._isPermissionGrantedHandler=e}refreshIsPermissionGranted(){this.isPermissionGranted(this.permission).then((e=>{this._isPermissionGrantedHandler(e)}))}isPermissionGranted(e){return this.permissionService.isPermitted(this.validateAndPreparePermissions(e)).then((e=>e),(e=>{this.logService.error("Failed to retrieve authorization",e);return false})).then((e=>e))}validateAndPreparePermissions(e){if(typeof e!=="string"&&!Array.isArray(e)){throw new Error("Permission should be string or an array of objects")}return typeof e==="string"?this.toPermissions(e):e}toPermissions(e){return[{names:e.split(",")}]}}let Oi=class HasOperationPermissionDirective extends HasOperationPermissionBaseDirective{constructor(e,t,n,i,o,s){super(n,i,o);this.templateRef=e;this.viewContainerRef=t;this.cdr=s;this.hasView=false;this.isPermissionGrantedHandler=this.getIsPermissionGrantedHandler()}ngOnInit(){super.ngOnInit()}ngOnChanges(e){super.ngOnChanges({hasOperationPermission:new o.SimpleChange(e.seHasOperationPermission.previousValue,e.seHasOperationPermission.currentValue,e.seHasOperationPermission.firstChange)})}ngOnDestroy(){super.ngOnDestroy()}getIsPermissionGrantedHandler(){return e=>{this.updateView(e)}}updateView(e){if(e&&!this.hasView){this.viewContainerRef.createEmbeddedView(this.templateRef);this.hasView=true}else if(!e&&this.hasView){this.viewContainerRef.clear()}this.cdr.markForCheck()}};__decorate([o.Input(),__metadata("design:type",Object)],Oi.prototype,"seHasOperationPermission",void 0);Oi=__decorate([o.Directive({selector:"[seHasOperationPermission]"}),__param(3,o.Inject(IPermissionService)),__metadata("design:paramtypes",[o.TemplateRef,o.ViewContainerRef,t.SystemEventService,IPermissionService,a.LogService,o.ChangeDetectorRef])],Oi);t.HasOperationPermissionDirectiveModule=class HasOperationPermissionDirectiveModule{};t.HasOperationPermissionDirectiveModule=__decorate([o.NgModule({declarations:[Oi],exports:[Oi]})],t.HasOperationPermissionDirectiveModule);t.ClickOutsideDirective=class ClickOutsideDirective{constructor(e,t,n){this.document=e;this.host=t;this.iframeClickDetectionService=n;this.clickOutside=new o.EventEmitter;this.id=`clickOutsideIframeClick${W.generateIdentifier()}`}onDocumentClick(e){if(e===this.host.nativeElement||this.host.nativeElement.contains(e)||this.popBody&&(this.popBody._elementRef.nativeElement.contains(e)||e===this.popBody._elementRef.nativeElement)||this.ignoreNotExistingTarget(e)){return}this.clickOutside.emit()}ngOnInit(){this.iframeClickDetectionService.registerCallback(this.id,(()=>this.onOutsideClick()))}ngOnDestroy(){this.iframeClickDetectionService.removeCallback(this.id)}ignoreNotExistingTarget(e){return!this.document.contains(e)}onOutsideClick(){this.clickOutside.emit()}};__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.ClickOutsideDirective.prototype,"clickOutside",void 0);__decorate([o.Input(),__metadata("design:type",S.PopoverBodyComponent)],t.ClickOutsideDirective.prototype,"popBody",void 0);__decorate([o.HostListener("document:click",["$event.target"]),__metadata("design:type",Function),__metadata("design:paramtypes",[HTMLElement]),__metadata("design:returntype",void 0)],t.ClickOutsideDirective.prototype,"onDocumentClick",null);t.ClickOutsideDirective=__decorate([o.Directive({selector:"[seClickOutside]"}),__param(0,o.Inject(u.DOCUMENT)),__metadata("design:paramtypes",[Document,o.ElementRef,IIframeClickDetectionService])],t.ClickOutsideDirective);t.ClickOutsideModule=class ClickOutsideModule{};t.ClickOutsideModule=__decorate([o.NgModule({imports:[u.CommonModule],declarations:[t.ClickOutsideDirective],exports:[t.ClickOutsideDirective]})],t.ClickOutsideModule);t.CustomComponentOutletDirective=class CustomComponentOutletDirective{constructor(e,t){this.elementRef=e;this.renderer=t;this.hasView=false}ngOnChanges(){this.updateView(this.componentName)}updateView(e){if(e&&!this.hasView){this.createView()}else if(!e&&this.hasView){this.removeView()}else if(e&&this.hasView){this.removeView();this.createView()}}createView(){const e=window.__smartedit__.getComponentDecoratorPayload(this.componentName);this.component=this.renderer.createElement(e.selector);this.renderer.appendChild(this.elementRef.nativeElement,this.component);this.hasView=true}removeView(){this.renderer.removeChild(this.elementRef.nativeElement,this.component);this.hasView=false}};__decorate([o.Input("seCustomComponentOutlet"),__metadata("design:type",String)],t.CustomComponentOutletDirective.prototype,"componentName",void 0);t.CustomComponentOutletDirective=__decorate([o.Directive({selector:"[seCustomComponentOutlet]"}),__metadata("design:paramtypes",[o.ElementRef,o.Renderer2])],t.CustomComponentOutletDirective);t.CustomComponentOutletDirectiveModule=class CustomComponentOutletDirectiveModule{};t.CustomComponentOutletDirectiveModule=__decorate([o.NgModule({declarations:[t.CustomComponentOutletDirective],exports:[t.CustomComponentOutletDirective]})],t.CustomComponentOutletDirectiveModule);t.ReversePipe=class ReversePipe{transform(e){if(!e){return undefined}return e.slice().reverse()}};t.ReversePipe=__decorate([o.Pipe({name:"seReverse"})],t.ReversePipe);t.ReversePipeModule=class ReversePipeModule{};t.ReversePipeModule=__decorate([o.NgModule({declarations:[t.ReversePipe],exports:[t.ReversePipe]})],t.ReversePipeModule);t.PropertyPipe=class PropertyPipe{transform(e,t){if(!e){return undefined}if(!t){return[...e]}return e.filter((e=>Object.keys(t).every((n=>e[n]===t[n]))))}};t.PropertyPipe=__decorate([o.Pipe({name:"seProperty"})],t.PropertyPipe);t.PropertyPipeModule=class PropertyPipeModule{};t.PropertyPipeModule=__decorate([o.NgModule({declarations:[t.PropertyPipe],exports:[t.PropertyPipe]})],t.PropertyPipeModule);var Pi;t.StartFromPipe=Pi=class StartFromPipe{static transform(e,t){return e?e.slice(Number(t)):[]}transform(e,t){return Pi.transform(e,t)}};t.StartFromPipe=Pi=__decorate([o.Pipe({name:"seStartFrom"})],t.StartFromPipe);t.StartFromPipeModule=class StartFromPipeModule{};t.StartFromPipeModule=__decorate([o.NgModule({declarations:[t.StartFromPipe],exports:[t.StartFromPipe]})],t.StartFromPipeModule);var wi;t.FilterByFieldPipe=wi=class FilterByFieldPipe{static transform(e,t,n,i){const o=i||s.noop;const r=[];if(!t){o(e);return e}const a=t.toLowerCase().split(" ");(e||[]).forEach((e=>{n=n||Object.keys(e);const t=n.map((t=>e[t])).filter((e=>typeof e==="string"||e instanceof String)).map((e=>e.toLowerCase()));const i=a.map((e=>!!t.find((t=>t.indexOf(e)>=0)))).filter((e=>!e));if(i.length===0){r.push(e)}}));o(r);return r}transform(e,t,n,i){return wi.transform(e,t,n,i)}};t.FilterByFieldPipe=wi=__decorate([o.Pipe({name:"seFilterByField"})],t.FilterByFieldPipe);t.FilterByFieldPipeModule=class FilterByFieldPipeModule{};t.FilterByFieldPipeModule=__decorate([o.NgModule({declarations:[t.FilterByFieldPipe],exports:[t.FilterByFieldPipe]})],t.FilterByFieldPipeModule);t.SharedComponentsModule=class SharedComponentsModule{};t.SharedComponentsModule=__decorate([o.NgModule({imports:[a.TranslationModule.forChild(),t.FundamentalsModule,u.CommonModule,f.FormsModule,a.SelectModule,a.LanguageDropdownModule,f.ReactiveFormsModule,t.CollapsibleContainerModule,t.MessageModule,t.NgTreeModule,t.HasOperationPermissionDirectiveModule,t.DropdownMenuModule,t.ResizeObserverModule,t.InfiniteScrollingModule,t.SpinnerModule,t.PopupOverlayModule,t.StartFromPipeModule,t.PaginationModule,t.TooltipModule,t.ReversePipeModule,t.EditableListModule,t.SliderPanelModule,a.LoginDialogModule,a.FundamentalModalTemplateModule,t.DynamicPagedListModule,_i,t.HelpModule,t.TabsModule,t.MoreTextModule,t.PreventVerticalOverflowModule,I.DialogModule],declarations:[t.WaitDialogComponent,t.ShortcutLinkComponent],entryComponents:[t.WaitDialogComponent,t.ShortcutLinkComponent],exports:[t.WaitDialogComponent,t.ShortcutLinkComponent,a.SelectModule,a.LanguageDropdownModule,t.MessageModule,t.NgTreeModule,t.CollapsibleContainerModule,t.HasOperationPermissionDirectiveModule,t.DropdownMenuModule,t.PopupOverlayModule,t.ResizeObserverModule,t.InfiniteScrollingModule,t.StartFromPipeModule,t.PaginationModule,t.TooltipModule,t.ReversePipeModule,t.EditableListModule,t.SpinnerModule,t.SliderPanelModule,a.LoginDialogModule,a.FundamentalModalTemplateModule,t.DynamicPagedListModule,_i,t.HelpModule,t.TabsModule,t.MoreTextModule,t.PreventVerticalOverflowModule]})],t.SharedComponentsModule);window.__smartedit__.addDecoratorPayload("Component","ActionableSearchItemComponent",{selector:"se-actionable-search-item",changeDetection:o.ChangeDetectionStrategy.OnPush,host:{"[class.se-actionable-search-item]":"true"},template:`<div *ngIf="search" class="se-actionable-search-item"><div class="se-actionable-search-item__name">{{ search }}</div><button type="button" class="fd-button fd-button--transparent se-actionable-search-item__action-btn" (click)="onButtonClick()">{{ getActionText() | translate }}</button></div>`});t.ActionableSearchItemComponent=class ActionableSearchItemComponent{constructor(e){this.systemEventService=e;this.actionButtonClick=new o.EventEmitter;this.defaultEventId="yActionableSearchItem_ACTION_CREATE";this.defaultActionText="se.yationablesearchitem.action.create"}getActionText(){return this.actionText||this.defaultActionText}onButtonClick(){const e=this.eventId||this.defaultEventId;this.systemEventService.publishAsync(e,this.search||"");this.actionButtonClick.emit()}};__decorate([o.Input(),__metadata("design:type",String)],t.ActionableSearchItemComponent.prototype,"search",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.ActionableSearchItemComponent.prototype,"eventId",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.ActionableSearchItemComponent.prototype,"actionText",void 0);__decorate([o.Output(),__metadata("design:type",Object)],t.ActionableSearchItemComponent.prototype,"actionButtonClick",void 0);t.ActionableSearchItemComponent=__decorate([o.Component({selector:"se-actionable-search-item",changeDetection:o.ChangeDetectionStrategy.OnPush,host:{"[class.se-actionable-search-item]":"true"},template:`<div *ngIf="search" class="se-actionable-search-item"><div class="se-actionable-search-item__name">{{ search }}</div><button type="button" class="fd-button fd-button--transparent se-actionable-search-item__action-btn" (click)="onButtonClick()">{{ getActionText() | translate }}</button></div>`}),__metadata("design:paramtypes",[t.SystemEventService])],t.ActionableSearchItemComponent);const Ai=new o.InjectionToken("ITEM_COMPONENT_DATA");window.__smartedit__.addDecoratorPayload("Component","DefaultItemPrinterComponent",{selector:"se-default-item-printer",changeDetection:o.ChangeDetectionStrategy.OnPush,styles:[`.se-item-printer-text{vertical-align:middle;position:relative;max-width:100%;font-family:"72";color:var(--sapNeutralColor);display:inline-block}`],template:`<span fd-menu-title [attr.title]="((data.item.label || data.item.name) | seL10n | async) | translate" class="se-item-printer-text se-nowrap-ellipsis">{{ ((data.item.label || data.item.name) | seL10n | async) | translate }}</span>`});let Ri=class DefaultItemPrinterComponent{constructor(e){this.data=e}};Ri=__decorate([o.Component({selector:"se-default-item-printer",changeDetection:o.ChangeDetectionStrategy.OnPush,styles:[`.se-item-printer-text{vertical-align:middle;position:relative;max-width:100%;font-family:"72";color:var(--sapNeutralColor);display:inline-block}`],template:`<span fd-menu-title [attr.title]="((data.item.label || data.item.name) | seL10n | async) | translate" class="se-item-printer-text se-nowrap-ellipsis">{{ ((data.item.label || data.item.name) | seL10n | async) | translate }}</span>`}),__param(0,o.Inject(Ai)),__metadata("design:paramtypes",[Object])],Ri);window.__smartedit__.addDecoratorPayload("Component","SearchInputComponent",{selector:"se-select-search-input",changeDetection:o.ChangeDetectionStrategy.OnPush,host:{"[class.se-select-search-input]":"true"},template:`<div class="search"><input #searchInput type="search" class="search__input fd-input" [disabled]="isDisabled" [readOnly]="isReadOnly" [placeholder]="placeholder" [ngModel]="search" (ngModelChange)="onChange($event)" (keyup)="onKeyup($event)"/></div>`});let Di=class SearchInputComponent{constructor(e,t){this.elementRef=e;this.sharedDataService=t;this.searchKeyup=new o.EventEmitter;this.searchChange=new o.EventEmitter}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.configurations=yield this.sharedDataService.get("configuration");this.initSearchInputFilter()}))}ngOnDestroy(){this.searchTermSubscription.unsubscribe()}get nativeElement(){return this.elementRef.nativeElement}get inputElement(){return this.searchInput.nativeElement}focus(){this.inputElement.focus()}onChange(e){this.isTypeAheadEnabled?this.searchTermSubject.next(e):this.searchChange.emit(e)}onKeyup(e){this.keyUpEvent=e;const t=e.target.value;this.isTypeAheadEnabled?this.searchTermSubject.next(t):this.searchKeyup.emit({event:this.keyUpEvent,value:t})}initSearchInputFilter(){this.searchTermSubject=new p.Subject;this.searchTerm$=this.searchTermSubject.asObservable().pipe(_.filter((e=>this.configurations&&this.configurations.typeAheadMiniSearchTermLength?e.length>0&&e.length>this.configurations.typeAheadMiniSearchTermLength:true)),_.debounceTime(this.configurations&&this.configurations.typeAheadDebounce||500),_.distinctUntilChanged());this.searchTermSubscription=this.searchTerm$.subscribe((e=>{this.searchKeyup.emit({event:this.keyUpEvent,value:e});this.searchChange.emit(e)}))}};__decorate([o.Input(),__metadata("design:type",Boolean)],Di.prototype,"isDisabled",void 0);__decorate([o.Input(),__metadata("design:type",Boolean)],Di.prototype,"isReadOnly",void 0);__decorate([o.Input(),__metadata("design:type",Boolean)],Di.prototype,"isTypeAheadEnabled",void 0);__decorate([o.Input(),__metadata("design:type",String)],Di.prototype,"placeholder",void 0);__decorate([o.Input(),__metadata("design:type",String)],Di.prototype,"search",void 0);__decorate([o.Output(),__metadata("design:type",Object)],Di.prototype,"searchKeyup",void 0);__decorate([o.Output(),__metadata("design:type",Object)],Di.prototype,"searchChange",void 0);__decorate([o.ViewChild("searchInput",{static:false}),__metadata("design:type",o.ElementRef)],Di.prototype,"searchInput",void 0);Di=__decorate([o.Component({selector:"se-select-search-input",changeDetection:o.ChangeDetectionStrategy.OnPush,host:{"[class.se-select-search-input]":"true"},template:`<div class="search"><input #searchInput type="search" class="search__input fd-input" [disabled]="isDisabled" [readOnly]="isReadOnly" [placeholder]="placeholder" [ngModel]="search" (ngModelChange)="onChange($event)" (keyup)="onKeyup($event)"/></div>`}),__metadata("design:paramtypes",[o.ElementRef,a.ISharedDataService])],Di);window.__smartedit__.addDecoratorPayload("Component","SelectComponent",{selector:"se-select",changeDetection:o.ChangeDetectionStrategy.OnPush,host:{"[class.se-select]":"true"},template:`<fd-select [style.display]="'none'"></fd-select><div [attr.id]="id + '-selector'" class="select-container" [ngClass]="{\n        'has-warning': hasWarning(),\n        'has-error': hasError()\n    }"><ng-container *ngIf="multiSelect; then multi; else singleSelect"></ng-container><ng-template #singleSelect><fd-popover [triggers]="['click']" [(isOpen)]="isOpen" [placement]="'bottom'" (isOpenChange)="onSingleSelectIsOpenChange($event)" fillControlMode="equal" [focusTrapped]="true" [focusAutoCapture]="true" [additionalBodyClass]="fullAdditionalBodyClass"><fd-popover-control><div class="selected-container fd-select-custom" [attr.has-selected-option]="!!selected || null"><button fd-button class="fd-select-button-custom toggle-button" [disabled]="isReadOnly" [fdMenu]="!isReadOnly"><span *ngIf="!selected; else selectedItem" class="selected-placeholder selected-item">{{ placeholder | translate }}</span><ng-template #selectedItem><div class="selected-item"><span *ngIf="controls" class="sap-icon--search">{{ placeholder | translate }}</span><se-item-printer *ngIf="selected" [attr.id]="id + '-selected'" [item]="selected" [component]="itemComponent" [selectComponentCtx]="this"></se-item-printer><span *ngIf="controls || showRemoveButton" class="sap-icon--sys-cancel selected-item__remove-button" (click)="removeSelectedOption($event, selected)"></span></div></ng-template></button></div></fd-popover-control><fd-popover-body><ul fd-list class="se-select-list-container"><ng-container *ngIf="searchEnabled && isOpen"><ng-container *ngTemplateOutlet="searchInputTemplate"></ng-container></ng-container><ng-container *ngTemplateOutlet="resultsHeader"></ng-container><ng-container *ngIf="isOpen"><ng-container *ngTemplateOutlet="selectListTemplate"></ng-container></ng-container></ul></fd-popover-body></fd-popover></ng-template><ng-template #multi><div [ngClass]="{'se-multi-select': selected && selected.length > 0}"><div class="selected-container se-selected-list"><ng-container *ngIf="selected && selected.length > 0"><div class="selected-list" cdkDropList (cdkDropListDropped)="onDrop($event)"><div *ngFor="let item of selected; trackBy: itemTrackBy" class="selected-list__item selected-item"><div cdkDrag><se-item-printer [item]="item" [component]="itemComponent" [selectComponentCtx]="this"></se-item-printer><div class="selected-list__placeholder" *cdkDragPlaceholder></div></div><span class="sap-icon--sys-cancel selected-item__remove-button selected-item-remove" (click)="removeSelectedOption($event, item)"></span></div></div></ng-container></div></div><fd-popover class="se-multi-select" [triggers]="[]" [closeOnOutsideClick]="false" [isOpen]="isOpen" [placement]="'bottom'" fillControlMode="equal" [focusTrapped]="true" [focusAutoCapture]="true" [additionalBodyClass]="fullAdditionalBodyClass"><fd-popover-control><ng-container *ngTemplateOutlet="searchInputTemplate"></ng-container></fd-popover-control><fd-popover-body><ul fd-list class="se-select-list-container"><ng-container *ngTemplateOutlet="resultsHeader"></ng-container><ng-container *ngIf="isOpen"><ng-container *ngTemplateOutlet="selectListTemplate"></ng-container></ng-container></ul></fd-popover-body></fd-popover></ng-template><ng-template #resultsHeader><se-select-results-header [search]="search" [resultsHeaderComponent]="resultsHeaderComponent" [resultsHeaderLabel]="resultsHeaderLabel" [displayResultsHeaderLabel]="showResultsHeaderLabel()" [actionableSearchItem]="actionableSearchItem" (actionButtonClick)="closeAndReset()"></se-select-results-header></ng-template><ng-template #searchInputTemplate><se-select-search-input [isDisabled]="isReadOnly" [isReadOnly]="multiSelect && !searchEnabled" [isTypeAheadEnabled]="!multiSelect" [placeholder]="showPlaceholder() ? (placeholder | translate) : ''" [search]="search" (searchKeyup)="onSearchInputKeyup($event.event, $event.value)" (searchChange)="onSearchInputChange($event)"></se-select-search-input></ng-template><ng-template #selectListTemplate><se-select-list [id]="id" [isPagedDropdown]="isPagedDropdown()" [fetchPage]="fetchStrategy.fetchPage" [search]="search" [items]="items" [selected]="selected" [excludeSelected]="multiSelect" [disableChoiceFn]="disableChoiceFn" [itemComponent]="itemComponent" [selectComponentCtx]="this" (optionClick)="onOptionClick($event)" (infiniteScrollItemsChange)="onInfiniteScrollItemsChange()"></se-select-list></ng-template></div>`,styles:[`.se-select:not(.se-select--paged) .se-select-list-container{overflow-y:auto;max-height:200px;width:auto}.se-select .select-container.has-warning .fd-select-button-custom,.se-select .select-container.has-warning .fd-select-button-custom:hover,.se-select .select-container.has-warning .selected-container{border-color:var(--sapWarningColor)}.se-select .select-container.has-error .fd-select-button-custom,.se-select .select-container.has-error .fd-select-button-custom:hover,.se-select .select-container.has-error .selected-container{border-color:var(--sapErrorColor)}.se-select .se-item-printer{width:100%}.se-select--single .selected-item{display:flex;width:100%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;z-index:1}.se-select.is-disabled fd-popover,.se-select:disabled fd-popover,.se-select[aria-disabled=true] fd-popover{pointer-events:none;cursor:not-allowed;box-shadow:none;opacity:.65}.se-select.is-disabled .selected-item__remove-button,.se-select:disabled .selected-item__remove-button,.se-select[aria-disabled=true] .selected-item__remove-button{color:var(--sapNeutralColor)}.se-select .fd-popover-custom{display:block;position:relative;width:100%}.se-select .fd-popover-custom .fd-select-button-custom{text-align:unset;width:100%;color:var(--sapUiFieldTextColor)}.se-select .fd-popover-custom .fd-select-button-custom:hover{border-color:inherit}.se-select .fd-popover-custom .fd-select-button-custom:focus{box-shadow:none}.se-select .fd-popover-custom .fd-select-button-custom.toggle-button .fd-button.fd-select__button{position:absolute;right:0;border:none;height:100%;border-top-right-radius:.25rem}.se-select .fd-list{padding:0;max-width:unset}.se-select .sap-icon--search{align-self:center;margin-right:5px}.se-select .sap-icon--sys-cancel{display:flex;justify-content:flex-end;color:var(--sapContent_IconColor);padding-right:30px;line-height:1.875rem;z-index:1000}.se-select .se-multi-select .selected-container{border-radius:.125rem;border:1px solid var(--sapUiFieldBorderColor,#89919a)}.se-select .se-multi-select .selected-container.se-selected-list{border-bottom:none}.se-select .se-multi-select .selected-list{padding:0;margin:0;list-style:none;border-bottom:1px solid var(--sapUiFieldBorderColor,#89919a)}.se-select .se-multi-select .selected-list__item{display:grid;grid-template-columns:16fr 1fr;padding:8px 16px;align-items:center;min-height:36px}.se-select .se-multi-select .selected-list__placeholder{opacity:0}.se-select .se-multi-select .selected-item-remove{cursor:pointer}`]});t.SelectComponent=class SelectComponent{constructor(e,t,n){this.l10nService=e;this.logService=t;this.cdr=n;this.modelChange=new o.EventEmitter;this.controls=false;this.multiSelect=false;this.keepModelOnReset=false;this.isReadOnly=false;this.searchEnabled=true;this.resetSearchInput=true;this.showRemoveButton=false;this.getApi=new o.EventEmitter;this.resetChange=new o.EventEmitter;this.isOpen=false;this.items=[];this.search="";this.api={setValidationState:this.setValidationState.bind(this),resetValidationState:this.resetValidationState.bind(this)}}get isSingleCss(){return!this.multiSelect}get isMultiCss(){return this.multiSelect}get isPagedCss(){return this.isPagedDropdown()}clickHandler(e){if(!this.multiSelect){return}if(e.target===this.searchInputCmp.inputElement){e.stopPropagation();if(!this.isOpen){this.onMultiSelectIsOpenChange(true)}}else if(this.isOpen){this.onMultiSelectIsOpenChange(false)}}ngOnInit(){if(!this.placeholder){this.placeholder="se.genericeditor.sedropdown.placeholder"}if(this.fetchStrategy.fetchAll){this.initSearchInputFilter()}this.fullAdditionalBodyClass="se-select";if(this.additionalBodyClass){this.fullAdditionalBodyClass=`${this.fullAdditionalBodyClass} ${this.additionalBodyClass}`}this.fetchData();setTimeout((()=>{this.resetChange.emit(this.internalReset.bind(this))}));this.getApi.emit(this.api)}ngOnChanges(e){if(!this.itemComponent){this.itemComponent=Ri}this.isValidConfiguration();const t=e.model;const n=t&&t.currentValue!==this.modelChangeOld&&!t.firstChange;if(n){if(this.multiSelect&&this.isModelEmpty()){this.model=[]}this.fetchData()}}ngOnDestroy(){if(this.languageSwitchSubscription){this.languageSwitchSubscription.unsubscribe()}if(this.searchInputChangeSubject){this.searchInputChangeSubject.unsubscribe()}}onSingleSelectIsOpenChange(e){if(e){setTimeout((()=>{if(this.searchInputCmp){this.searchInputCmp.focus()}if(this.fetchStrategy.fetchAll){this.refreshOptions(this.search)}}))}else{this.resetOnClose()}}onSearchInputKeyup(e,t){this.internalKeyup(e,t)}onSearchInputChange(e){this.onSearchChange(e);if(this.searchInputChangeSubject){this.searchInputChangeSubject.next(e)}}onOptionClick(e){let t=false;if(this.multiSelect){const n=[...this.selected||[],e];this.setSelected(n);t=true}else if(!this.isItemSelected(e)){this.setSelected(e);t=true}this.internalOnSelect(e,e.id);if(t){this.internalOnChange()}this.closeAndReset()}onSearchChange(e){this.search=e}onDrop(e){P.moveItemInArray(this.selected,e.previousIndex,e.currentIndex);this.setSelected(this.selected);const t=e.previousIndex!==e.currentIndex;if(t){this.internalOnChange()}}removeSelectedOption(e,t){e.stopPropagation();const n=this.multiSelect?this.selected.filter((e=>e!==t)):undefined;if(this.multiSelect){if(!this.searchInputCmp.isDisabled){this.setSelected(n);this.internalOnRemove(t,t.id)}}else{this.setSelected(n);this.internalOnRemove(t,t.id)}if(this.isOpen){this.closeAndReset()}}closeAndReset(){this.close();this.resetOnClose()}showResultsHeaderLabel(){return this.items.length>0&&!!this.resultsHeaderLabel}onInfiniteScrollItemsChange(){}showPlaceholder(){return this.multiSelect||!this.multiSelect&&!!this.selected}itemTrackBy(e,t){return t.id}setValidationState(e){this.validationState=e;if(!this.cdr.destroyed){this.cdr.detectChanges()}}resetValidationState(){this.validationState=undefined;if(!this.cdr.destroyed){this.cdr.detectChanges()}}hasError(){return ct.VALIDATION_ERROR===this.validationState}hasWarning(){return ct.WARNING===this.validationState}fetchEntity(e){return this.fetchStrategy.fetchEntity(e).then((e=>{if(!e){this.logService.debug("fetchEntity was used to fetch the option identified by "+e+" but failed to find a match")}return e}))}updateModelIfNotFoundInItems(e){if(!this.keepModelOnReset){if(this.multiSelect){if(this.isModelEmpty()){this.setSelected([],false);return}const t=this.model.filter((t=>this.getItemByModel(e,t)));const n=s.isEqual(this.model,t);if(!n){this.updateModel(t);this.resolveAndSetSelected(e)}else{this.resolveAndSetSelected(e)}return}if(this.isModelEmpty()){this.setSelected(undefined,false);return}const t=this.getItemByModel(e);if(!t){this.setSelected(undefined)}else{this.resolveAndSetSelected(e)}}}refreshOptions(e){this.internalFetchAll(e).then((e=>{this.items=e;if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}isValidConfiguration(){if(this.resultsHeaderComponent&&this.resultsHeaderLabel){throw new Error(`Only one of "resultsHeaderComponent" or "resultsHeaderLabel" must be specified`)}if(!this.fetchStrategy.fetchAll&&!this.fetchStrategy.fetchPage){throw new Error("Neither fetchAll nor fetchPage have been specified in fetchStrategy")}if(this.fetchStrategy.fetchAll&&this.fetchStrategy.fetchPage){throw new Error("Only one of either fetchAll or fetchPage must be specified in fetchStrategy")}if(this.fetchStrategy.fetchPage&&this.model&&!this.fetchStrategy.fetchEntity&&!this.fetchStrategy.fetchEntities){throw new Error(`fetchPage has been specified in fetchStrategy but neither fetchEntity nor fetchEntities are available to load item identified by ${this.model}`)}if(this.isPagedDropdown()&&!this.keepModelOnReset){this.logService.debug("current Select is paged, so keepModelOnReset flag is ignored (it will always keep the model on reset).")}}internalKeyup(e,t){if(this.keyup){this.keyup(e,t)}}internalOnRemove(e,t){if(this.onRemove){this.onRemove(e,t)}this.internalOnChange()}internalOnChange(){if(this.onChange){this.onChange()}}internalOnSelect(e,t){if(this.onSelect){this.onSelect(e,t)}}internalFetchAll(e=""){return this.fetchStrategy.fetchAll(e).then((e=>{this.fetchAllItems=e;return[...e]}))}internalFetchEntities(){let e;if(!this.multiSelect){e=this.fetchEntity(this.model).then((e=>[e]))}else{if(this.fetchStrategy.fetchEntities){e=this.fetchStrategy.fetchEntities(this.model).then((e=>{if(e.length!==this.model.length){this.logService.debug(`!fetchEntities was used to fetch the options identified by ${JSON.stringify(this.model)} but failed to find all matches`)}return e}))}else{const t=this.model.map((e=>this.fetchEntity(e)));e=Promise.all(t)}}return e.then((e=>{const t=e.filter((e=>e!==null)).map((e=>{delete e.$promise;delete e.$resolved;e.technicalUniqueId=W.encode(e);return e}));this.updateModelIfNotFoundInItems(t);this.internalOnChange();if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}onMultiSelectIsOpenChange(e){this.isOpen=e;if(e){if(this.isPagedDropdown()){if(!this.cdr.destroyed){this.cdr.detectChanges()}return}this.refreshOptions(this.search)}else{this.resetOnClose()}}initSearchInputFilter(){this.searchInputChangeSubject=new p.Subject;this.searchInputChange$=this.searchInputChangeSubject.asObservable();this.languageSwitchSubscription=this.l10nService.languageSwitch$.subscribe((e=>{this.filterFn=getLocalizedFilterFn(e)}));this.searchInputChange$.pipe(_.filter((()=>typeof this.fetchStrategy.fetchAll!=="undefined")),_.tap((e=>{this.items=this.filterItemsBySearch(this.fetchAllItems,e);if(!this.cdr.destroyed){this.cdr.detectChanges()}})),_.debounceTime(500),_.switchMap((e=>this.internalFetchAll(e)))).subscribe((e=>{this.items=this.filterItemsBySearch(e,this.search);if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}filterItemsBySearch(e,t){return e.filter((e=>this.filterFn(e.label||e.name).trim().toUpperCase().includes(t.trim().toUpperCase())))}close(){this.isOpen=false}resetOnClose(){if(this.search&&this.resetSearchInput){this.search="";if(!this.cdr.destroyed){this.cdr.detectChanges()}if(this.fetchStrategy.fetchAll){this.refreshOptions(this.search)}}}fetchData(){if(!this.isPagedDropdown()){this.internalFetchAllAndCheckModel()}else if(!this.isModelEmpty()){this.internalFetchEntities()}}internalFetchAllAndCheckModel(){return this.internalFetchAll().then((e=>{this.updateModelIfNotFoundInItems(e);this.internalOnChange();if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}getItemByModel(e,t=this.model){return e.find((e=>e.id===t))}getItemsByModel(e,t=this.model){return t.map((t=>this.getItemByModel(e,t))).filter((e=>!!e))}mapSelectedToModel(){return this.multiSelect?this.selected.map((e=>e.id)):this.selected.id}setSelected(e,t=true){this.selected=e;if(t){let e;if(this.selected){e=this.mapSelectedToModel()}this.updateModel(e)}}isItemSelected(e){if(!this.selected){return false}return e.id===this.selected.id}internalReset(e=false){this.items.length=0;if(e){this.selected=undefined;this.resetModel();return}if(!this.keepModelOnReset){this.fetchData()}}resetModel(){const e=this.multiSelect?[]:undefined;this.updateModel(e)}updateModel(e){this.model=e;this.modelChangeOld=this.model;this.modelChange.emit(e)}isPagedDropdown(){return!!this.fetchStrategy.fetchPage}isModelEmpty(){if(this.multiSelect){return!this.model||this.model&&this.model.length===0}else{return!this.model}}resolveAndSetSelected(e){const t=this.multiSelect?this.getItemsByModel(e):this.getItemByModel(e);this.setSelected(t,false)}};__decorate([o.HostBinding("class.se-select--single"),__metadata("design:type",Boolean),__metadata("design:paramtypes",[])],t.SelectComponent.prototype,"isSingleCss",null);__decorate([o.HostBinding("class.se-select--multi"),__metadata("design:type",Boolean),__metadata("design:paramtypes",[])],t.SelectComponent.prototype,"isMultiCss",null);__decorate([o.HostBinding("class.se-select--paged"),__metadata("design:type",Boolean),__metadata("design:paramtypes",[])],t.SelectComponent.prototype,"isPagedCss",null);__decorate([o.Input(),o.HostBinding("attr.id"),__metadata("design:type",String)],t.SelectComponent.prototype,"id",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"model",void 0);__decorate([o.Output(),__metadata("design:type",Object)],t.SelectComponent.prototype,"modelChange",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"fetchStrategy",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"controls",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"multiSelect",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"keepModelOnReset",void 0);__decorate([o.Input(),o.HostBinding("class.is-disabled"),__metadata("design:type",Object)],t.SelectComponent.prototype,"isReadOnly",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"actionableSearchItem",void 0);__decorate([o.Input(),__metadata("design:type",o.Type)],t.SelectComponent.prototype,"resultsHeaderComponent",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.SelectComponent.prototype,"resultsHeaderLabel",void 0);__decorate([o.Input(),__metadata("design:type",Function)],t.SelectComponent.prototype,"disableChoiceFn",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.SelectComponent.prototype,"placeholder",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.SelectComponent.prototype,"additionalBodyClass",void 0);__decorate([o.Input(),__metadata("design:type",o.Type)],t.SelectComponent.prototype,"itemComponent",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"searchEnabled",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"resetSearchInput",void 0);__decorate([o.Input(),__metadata("design:type",Function)],t.SelectComponent.prototype,"onChange",void 0);__decorate([o.Input(),__metadata("design:type",Function)],t.SelectComponent.prototype,"onRemove",void 0);__decorate([o.Input(),__metadata("design:type",Function)],t.SelectComponent.prototype,"onSelect",void 0);__decorate([o.Input(),__metadata("design:type",Function)],t.SelectComponent.prototype,"keyup",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"showRemoveButton",void 0);__decorate([o.Output(),__metadata("design:type",Object)],t.SelectComponent.prototype,"getApi",void 0);__decorate([o.Input(),__metadata("design:type",Function)],t.SelectComponent.prototype,"reset",void 0);__decorate([o.Output(),__metadata("design:type",Object)],t.SelectComponent.prototype,"resetChange",void 0);__decorate([o.ViewChild(Di,{static:false}),__metadata("design:type",Di)],t.SelectComponent.prototype,"searchInputCmp",void 0);__decorate([o.HostListener("document:click",["$event"]),__metadata("design:type",Function),__metadata("design:paramtypes",[MouseEvent]),__metadata("design:returntype",void 0)],t.SelectComponent.prototype,"clickHandler",null);t.SelectComponent=__decorate([o.Component({selector:"se-select",changeDetection:o.ChangeDetectionStrategy.OnPush,host:{"[class.se-select]":"true"},template:`<fd-select [style.display]="'none'"></fd-select><div [attr.id]="id + '-selector'" class="select-container" [ngClass]="{\n        'has-warning': hasWarning(),\n        'has-error': hasError()\n    }"><ng-container *ngIf="multiSelect; then multi; else singleSelect"></ng-container><ng-template #singleSelect><fd-popover [triggers]="['click']" [(isOpen)]="isOpen" [placement]="'bottom'" (isOpenChange)="onSingleSelectIsOpenChange($event)" fillControlMode="equal" [focusTrapped]="true" [focusAutoCapture]="true" [additionalBodyClass]="fullAdditionalBodyClass"><fd-popover-control><div class="selected-container fd-select-custom" [attr.has-selected-option]="!!selected || null"><button fd-button class="fd-select-button-custom toggle-button" [disabled]="isReadOnly" [fdMenu]="!isReadOnly"><span *ngIf="!selected; else selectedItem" class="selected-placeholder selected-item">{{ placeholder | translate }}</span><ng-template #selectedItem><div class="selected-item"><span *ngIf="controls" class="sap-icon--search">{{ placeholder | translate }}</span><se-item-printer *ngIf="selected" [attr.id]="id + '-selected'" [item]="selected" [component]="itemComponent" [selectComponentCtx]="this"></se-item-printer><span *ngIf="controls || showRemoveButton" class="sap-icon--sys-cancel selected-item__remove-button" (click)="removeSelectedOption($event, selected)"></span></div></ng-template></button></div></fd-popover-control><fd-popover-body><ul fd-list class="se-select-list-container"><ng-container *ngIf="searchEnabled && isOpen"><ng-container *ngTemplateOutlet="searchInputTemplate"></ng-container></ng-container><ng-container *ngTemplateOutlet="resultsHeader"></ng-container><ng-container *ngIf="isOpen"><ng-container *ngTemplateOutlet="selectListTemplate"></ng-container></ng-container></ul></fd-popover-body></fd-popover></ng-template><ng-template #multi><div [ngClass]="{'se-multi-select': selected && selected.length > 0}"><div class="selected-container se-selected-list"><ng-container *ngIf="selected && selected.length > 0"><div class="selected-list" cdkDropList (cdkDropListDropped)="onDrop($event)"><div *ngFor="let item of selected; trackBy: itemTrackBy" class="selected-list__item selected-item"><div cdkDrag><se-item-printer [item]="item" [component]="itemComponent" [selectComponentCtx]="this"></se-item-printer><div class="selected-list__placeholder" *cdkDragPlaceholder></div></div><span class="sap-icon--sys-cancel selected-item__remove-button selected-item-remove" (click)="removeSelectedOption($event, item)"></span></div></div></ng-container></div></div><fd-popover class="se-multi-select" [triggers]="[]" [closeOnOutsideClick]="false" [isOpen]="isOpen" [placement]="'bottom'" fillControlMode="equal" [focusTrapped]="true" [focusAutoCapture]="true" [additionalBodyClass]="fullAdditionalBodyClass"><fd-popover-control><ng-container *ngTemplateOutlet="searchInputTemplate"></ng-container></fd-popover-control><fd-popover-body><ul fd-list class="se-select-list-container"><ng-container *ngTemplateOutlet="resultsHeader"></ng-container><ng-container *ngIf="isOpen"><ng-container *ngTemplateOutlet="selectListTemplate"></ng-container></ng-container></ul></fd-popover-body></fd-popover></ng-template><ng-template #resultsHeader><se-select-results-header [search]="search" [resultsHeaderComponent]="resultsHeaderComponent" [resultsHeaderLabel]="resultsHeaderLabel" [displayResultsHeaderLabel]="showResultsHeaderLabel()" [actionableSearchItem]="actionableSearchItem" (actionButtonClick)="closeAndReset()"></se-select-results-header></ng-template><ng-template #searchInputTemplate><se-select-search-input [isDisabled]="isReadOnly" [isReadOnly]="multiSelect && !searchEnabled" [isTypeAheadEnabled]="!multiSelect" [placeholder]="showPlaceholder() ? (placeholder | translate) : ''" [search]="search" (searchKeyup)="onSearchInputKeyup($event.event, $event.value)" (searchChange)="onSearchInputChange($event)"></se-select-search-input></ng-template><ng-template #selectListTemplate><se-select-list [id]="id" [isPagedDropdown]="isPagedDropdown()" [fetchPage]="fetchStrategy.fetchPage" [search]="search" [items]="items" [selected]="selected" [excludeSelected]="multiSelect" [disableChoiceFn]="disableChoiceFn" [itemComponent]="itemComponent" [selectComponentCtx]="this" (optionClick)="onOptionClick($event)" (infiniteScrollItemsChange)="onInfiniteScrollItemsChange()"></se-select-list></ng-template></div>`,styles:[`.se-select:not(.se-select--paged) .se-select-list-container{overflow-y:auto;max-height:200px;width:auto}.se-select .select-container.has-warning .fd-select-button-custom,.se-select .select-container.has-warning .fd-select-button-custom:hover,.se-select .select-container.has-warning .selected-container{border-color:var(--sapWarningColor)}.se-select .select-container.has-error .fd-select-button-custom,.se-select .select-container.has-error .fd-select-button-custom:hover,.se-select .select-container.has-error .selected-container{border-color:var(--sapErrorColor)}.se-select .se-item-printer{width:100%}.se-select--single .selected-item{display:flex;width:100%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;z-index:1}.se-select.is-disabled fd-popover,.se-select:disabled fd-popover,.se-select[aria-disabled=true] fd-popover{pointer-events:none;cursor:not-allowed;box-shadow:none;opacity:.65}.se-select.is-disabled .selected-item__remove-button,.se-select:disabled .selected-item__remove-button,.se-select[aria-disabled=true] .selected-item__remove-button{color:var(--sapNeutralColor)}.se-select .fd-popover-custom{display:block;position:relative;width:100%}.se-select .fd-popover-custom .fd-select-button-custom{text-align:unset;width:100%;color:var(--sapUiFieldTextColor)}.se-select .fd-popover-custom .fd-select-button-custom:hover{border-color:inherit}.se-select .fd-popover-custom .fd-select-button-custom:focus{box-shadow:none}.se-select .fd-popover-custom .fd-select-button-custom.toggle-button .fd-button.fd-select__button{position:absolute;right:0;border:none;height:100%;border-top-right-radius:.25rem}.se-select .fd-list{padding:0;max-width:unset}.se-select .sap-icon--search{align-self:center;margin-right:5px}.se-select .sap-icon--sys-cancel{display:flex;justify-content:flex-end;color:var(--sapContent_IconColor);padding-right:30px;line-height:1.875rem;z-index:1000}.se-select .se-multi-select .selected-container{border-radius:.125rem;border:1px solid var(--sapUiFieldBorderColor,#89919a)}.se-select .se-multi-select .selected-container.se-selected-list{border-bottom:none}.se-select .se-multi-select .selected-list{padding:0;margin:0;list-style:none;border-bottom:1px solid var(--sapUiFieldBorderColor,#89919a)}.se-select .se-multi-select .selected-list__item{display:grid;grid-template-columns:16fr 1fr;padding:8px 16px;align-items:center;min-height:36px}.se-select .se-multi-select .selected-list__placeholder{opacity:0}.se-select .se-multi-select .selected-item-remove{cursor:pointer}`]}),__metadata("design:paramtypes",[t.L10nService,a.LogService,o.ChangeDetectorRef])],t.SelectComponent);window.__smartedit__.addDecoratorPayload("Component","ItemPrinterComponent",{selector:"se-item-printer",changeDetection:o.ChangeDetectionStrategy.OnPush,host:{"[class.se-item-printer]":"true"},template:`<ng-container *ngComponentOutlet="component; injector: componentInjector"></ng-container>`});let Mi=class ItemPrinterComponent{constructor(e){this.injector=e;this.isSelected=true}ngOnChanges(e){if(e.item){this.itemComponentData=this.createItemComponentData();if(this.component){this.componentInjector=this.createItemComponentInjector()}}}createItemComponentData(){return{item:this.item,selected:this.isSelected,select:this.selectComponentCtx}}createItemComponentInjector(){return o.Injector.create({parent:this.injector,providers:[{provide:Ai,useValue:this.itemComponentData}]})}};__decorate([o.Input(),__metadata("design:type",Object)],Mi.prototype,"item",void 0);__decorate([o.Input(),__metadata("design:type",o.Type)],Mi.prototype,"component",void 0);__decorate([o.Input(),__metadata("design:type",t.SelectComponent)],Mi.prototype,"selectComponentCtx",void 0);__decorate([o.Input(),__metadata("design:type",Object)],Mi.prototype,"isSelected",void 0);Mi=__decorate([o.Component({selector:"se-item-printer",changeDetection:o.ChangeDetectionStrategy.OnPush,host:{"[class.se-item-printer]":"true"},template:`<ng-container *ngComponentOutlet="component; injector: componentInjector"></ng-container>`}),__metadata("design:paramtypes",[o.Injector])],Mi);window.__smartedit__.addDecoratorPayload("Component","ResultsHeaderComponent",{selector:"se-select-results-header",changeDetection:o.ChangeDetectionStrategy.OnPush,host:{"[class.se-select-results-header]":"true"},template:`<div *ngIf="showResultsHeaderItem() || resultsHeaderLabel || actionableSearchItem" class="results-header"><div *ngIf="showResultsHeaderItem()"><ng-container *ngComponentOutlet="resultsHeaderComponent"></ng-container></div><se-actionable-search-item *ngIf="actionableSearchItem" [search]="search" [eventId]="actionableSearchItem.eventId" [actionText]="actionableSearchItem.actionText" (actionButtonClick)="onActionButtonClick()"></se-actionable-search-item><li class="fd-menu__list-header" *ngIf="displayResultsHeaderLabel">{{ resultsHeaderLabel | translate }}</li></div>`,styles:[`.results-header .fd-menu__list-header{font-size:1rem!important;line-height:1.25;font-weight:400;padding:8px 12px;border-bottom:1px solid var(--sapGroup_ContentBorderColor);color:var(--sapNeutralColor);display:block;padding-left:24px}`]});let Ni=class ResultsHeaderComponent{constructor(){this.actionButtonClick=new o.EventEmitter}onActionButtonClick(){this.actionButtonClick.emit()}showResultsHeaderItem(){return typeof this.resultsHeaderComponent!=="undefined"}};__decorate([o.Input(),__metadata("design:type",String)],Ni.prototype,"search",void 0);__decorate([o.Input(),__metadata("design:type",o.Type)],Ni.prototype,"resultsHeaderComponent",void 0);__decorate([o.Input(),__metadata("design:type",String)],Ni.prototype,"resultsHeaderLabel",void 0);__decorate([o.Input(),__metadata("design:type",Boolean)],Ni.prototype,"displayResultsHeaderLabel",void 0);__decorate([o.Input(),__metadata("design:type",Object)],Ni.prototype,"actionableSearchItem",void 0);__decorate([o.Output(),__metadata("design:type",Object)],Ni.prototype,"actionButtonClick",void 0);Ni=__decorate([o.Component({selector:"se-select-results-header",changeDetection:o.ChangeDetectionStrategy.OnPush,host:{"[class.se-select-results-header]":"true"},template:`<div *ngIf="showResultsHeaderItem() || resultsHeaderLabel || actionableSearchItem" class="results-header"><div *ngIf="showResultsHeaderItem()"><ng-container *ngComponentOutlet="resultsHeaderComponent"></ng-container></div><se-actionable-search-item *ngIf="actionableSearchItem" [search]="search" [eventId]="actionableSearchItem.eventId" [actionText]="actionableSearchItem.actionText" (actionButtonClick)="onActionButtonClick()"></se-actionable-search-item><li class="fd-menu__list-header" *ngIf="displayResultsHeaderLabel">{{ resultsHeaderLabel | translate }}</li></div>`,styles:[`.results-header .fd-menu__list-header{font-size:1rem!important;line-height:1.25;font-weight:400;padding:8px 12px;border-bottom:1px solid var(--sapGroup_ContentBorderColor);color:var(--sapNeutralColor);display:block;padding-left:24px}`]})],Ni);window.__smartedit__.addDecoratorPayload("Component","SelectListComponent",{selector:"se-select-list",changeDetection:o.ChangeDetectionStrategy.OnPush,host:{"[class.se-select-list]":"true"},template:`<se-infinite-scrolling *ngIf="isPagedDropdown; else selectList" [pageSize]="infiniteScrollingPageSize" [mask]="search" [fetchPage]="fetchPage" [context]="selectComponentCtx" (itemsChange)="onInfiniteScrollItemsChange()"><ng-container *ngTemplateOutlet="selectList"></ng-container></se-infinite-scrolling><ng-template #selectList><div [attr.id]="id +'-list'" suListKeyboardControl [suListKeyboardControlDisabledPredicate]="keyboardControlDisabledPredicate" (suListKeyboardControlEnterKeydown)="onEnterKeydown($event)" class="fd-list fd-list--selection" [ngClass]="{ 'fd-menu__list--basic': !isPagedDropdown }"><ng-container *ngFor="let item of items; trackBy: itemTrackBy"><li *ngIf="(excludeSelected && !isItemSelected(item)) || !excludeSelected" suListItemKeyboardControl class="se-select-list__item fd-list__item" [ngClass]="{'is-selected': !excludeSelected && isItemSelected(item), 'is-disabled': isItemDisabled(item)}"><a fd-list-title (click)="onOptionClick($event, item)" class="menu-option"><se-item-printer [item]="item" [isSelected]="false" [component]="itemComponent" [selectComponentCtx]="selectComponentCtx"></se-item-printer></a></li></ng-container></div></ng-template>`,styles:[`.se-select-list .fd-menu__list{position:relative;outline:0}.se-select-list .fd-menu__list--basic{max-height:200px;overflow-x:hidden;overflow-y:auto}.se-select-list__item{cursor:pointer}.se-select-list__item.fd-list__item{padding-left:0;padding-right:0}.se-select-list__item.is-selected{color:var(--sapSelectedColor)}.se-select-list__item.is-disabled .menu-option{cursor:not-allowed;opacity:.65}.se-select-list__item.is-disabled .menu-option:hover{background:0 0}.se-select-list__item .menu-option.fd-list__title{color:inherit;background:inherit;padding:.5rem 1.5rem}`]});let xi=class SelectListComponent{constructor(){this.isPagedDropdown=false;this.excludeSelected=false;this.optionClick=new o.EventEmitter;this.infiniteScrollItemsChange=new o.EventEmitter;this.infiniteScrollingPageSize=10}keyboardControlDisabledPredicate(e){return e.getElement().classList.contains("is-disabled")}itemTrackBy(e,t){return t.id}isItemSelected(e){const t=Array.isArray(this.selected);if(!this.selected||t&&this.selected.length===0){return false}return t?!!this.selected.find((t=>t.id===e.id)):e.id===this.selected.id}onOptionClick(e,t){if(this.isItemDisabled(t)){e.stopPropagation();return}this.optionClick.emit(t)}onEnterKeydown(e){const t=this.getItems();const n=t[e];this.optionClick.emit(n)}isItemDisabled(e){return this.disableChoiceFn?this.disableChoiceFn(e):false}onInfiniteScrollItemsChange(){this.infiniteScrollItemsChange.emit()}getItems(){if(this.excludeSelected){return this.items.filter((e=>!this.isItemSelected(e)))}else{return this.items}}};__decorate([o.Input(),__metadata("design:type",String)],xi.prototype,"id",void 0);__decorate([o.Input(),__metadata("design:type",Object)],xi.prototype,"isPagedDropdown",void 0);__decorate([o.Input(),__metadata("design:type",Function)],xi.prototype,"fetchPage",void 0);__decorate([o.Input(),__metadata("design:type",String)],xi.prototype,"search",void 0);__decorate([o.Input(),__metadata("design:type",Array)],xi.prototype,"items",void 0);__decorate([o.Input(),__metadata("design:type",Object)],xi.prototype,"selected",void 0);__decorate([o.Input(),__metadata("design:type",Object)],xi.prototype,"excludeSelected",void 0);__decorate([o.Input(),__metadata("design:type",Function)],xi.prototype,"disableChoiceFn",void 0);__decorate([o.Input(),__metadata("design:type",o.Type)],xi.prototype,"itemComponent",void 0);__decorate([o.Input(),__metadata("design:type",t.SelectComponent)],xi.prototype,"selectComponentCtx",void 0);__decorate([o.Output(),__metadata("design:type",Object)],xi.prototype,"optionClick",void 0);__decorate([o.Output(),__metadata("design:type",Object)],xi.prototype,"infiniteScrollItemsChange",void 0);xi=__decorate([o.Component({selector:"se-select-list",changeDetection:o.ChangeDetectionStrategy.OnPush,host:{"[class.se-select-list]":"true"},template:`<se-infinite-scrolling *ngIf="isPagedDropdown; else selectList" [pageSize]="infiniteScrollingPageSize" [mask]="search" [fetchPage]="fetchPage" [context]="selectComponentCtx" (itemsChange)="onInfiniteScrollItemsChange()"><ng-container *ngTemplateOutlet="selectList"></ng-container></se-infinite-scrolling><ng-template #selectList><div [attr.id]="id +'-list'" suListKeyboardControl [suListKeyboardControlDisabledPredicate]="keyboardControlDisabledPredicate" (suListKeyboardControlEnterKeydown)="onEnterKeydown($event)" class="fd-list fd-list--selection" [ngClass]="{ 'fd-menu__list--basic': !isPagedDropdown }"><ng-container *ngFor="let item of items; trackBy: itemTrackBy"><li *ngIf="(excludeSelected && !isItemSelected(item)) || !excludeSelected" suListItemKeyboardControl class="se-select-list__item fd-list__item" [ngClass]="{'is-selected': !excludeSelected && isItemSelected(item), 'is-disabled': isItemDisabled(item)}"><a fd-list-title (click)="onOptionClick($event, item)" class="menu-option"><se-item-printer [item]="item" [isSelected]="false" [component]="itemComponent" [selectComponentCtx]="selectComponentCtx"></se-item-printer></a></li></ng-container></div></ng-template>`,styles:[`.se-select-list .fd-menu__list{position:relative;outline:0}.se-select-list .fd-menu__list--basic{max-height:200px;overflow-x:hidden;overflow-y:auto}.se-select-list__item{cursor:pointer}.se-select-list__item.fd-list__item{padding-left:0;padding-right:0}.se-select-list__item.is-selected{color:var(--sapSelectedColor)}.se-select-list__item.is-disabled .menu-option{cursor:not-allowed;opacity:.65}.se-select-list__item.is-disabled .menu-option:hover{background:0 0}.se-select-list__item .menu-option.fd-list__title{color:inherit;background:inherit;padding:.5rem 1.5rem}`]})],xi);t.SelectModule=class SelectModule{};t.SelectModule=__decorate([o.NgModule({imports:[u.CommonModule,f.FormsModule,P.DragDropModule,S.PopoverModule,S.ButtonModule,S.MenuModule,S.SelectModule,S.FormModule,t.InfiniteScrollingModule,t.L10nPipeModule,a.ListKeyboardControlModule,a.TranslationModule.forChild(),y.ListModule],declarations:[t.SelectComponent,Ri,Mi,t.ActionableSearchItemComponent,xi,Di,Ni],entryComponents:[t.SelectComponent,Ri,Mi,t.ActionableSearchItemComponent,xi,Di,Ni],exports:[t.SelectComponent]})],t.SelectModule);let Fi=class ContentManager{constructor(){this.onSuccess=new o.EventEmitter;this.onError=new o.EventEmitter;this.submitting=false}set option(e){this._onSave=e.onSave}save(){this.submitting=true;return this._onSave().pipe(_.finalize((()=>this.submitting=false)),_.tap((e=>{this.onSuccess.emit(e)})),_.catchError((e=>{this.onError.emit(e);return p.throwError(e)})))}};__decorate([o.Input("contentManager"),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],Fi.prototype,"option",null);__decorate([o.Output(),__metadata("design:type",Object)],Fi.prototype,"onSuccess",void 0);__decorate([o.Output(),__metadata("design:type",Object)],Fi.prototype,"onError",void 0);Fi=__decorate([o.Directive({selector:"[contentManager]"})],Fi);const createApi=e=>({setSubmitButtonText:t=>{e.submitButtonText=t},setCancelButtonText:t=>{e.cancelButtonText=t},setAlwaysShowSubmit:t=>{e.alwaysShowSubmit=t},setAlwaysShowReset:t=>{e.alwaysShowReset=t},setOnReset:t=>{e.onReset=t},setPreparePayload:t=>{e.preparePayload=t},setUpdateCallback:t=>{e.updateCallback=t},updateContent:t=>{e.form&&e.form.patchComponent(t)},getContent:()=>e.form?ln.copy(e.form.component):undefined,onContentChange(){return},addContentChangeEvent:t=>{e.onChangeEvents.push(t);return()=>{const n=e.onChangeEvents.findIndex((e=>e===t));if(n>-1){e.onChangeEvents.splice(n,1)}}},triggerContentChangeEvents:()=>{e.onChangeEvents.forEach((t=>{t(ln.copy(e.form.component))}))},clearMessages:()=>{e.form.removeValidationMessages()},switchToTabContainingQualifier:t=>{e.targetedQualifier=t},considerFormDirty:()=>{e.initialDirty=true},setInProgress:t=>{e.inProgress=t},isSubmitDisabled:()=>e.isSubmitDisabled(),getLanguages:()=>null,setAlwaysEnableSubmit:t=>{e.alwaysEnableSubmit=t}});const Li=new o.InjectionToken("GENERIC_EDITOR_WIDGET_DATA");window.__smartedit__.addDecoratorPayload("Component","BooleanComponent",{selector:"se-boolean",template:`<div class="se-boolean fd-form__item fd-form__item--check"><span class="fd-toggle fd-toggle--xs fd-form__control"><label class="fd-form__label fd-switch fd-switch--compact" for="{{qualifierId}}-checkbox"><input type="checkbox" id="{{qualifierId}}-checkbox" class="se-boolean__input fd-switch__input" [placeholder]="(widget.field.tooltip || '') | translate" [attr.name]="widget.qualifier" [disabled]="!widget.field.editable" [(ngModel)]="widget.model[widget.qualifier]" (click)="checkboxOnClick($event.target)"/><div class="fd-switch__slider"><div class="fd-switch__track"><span class="fd-switch__handle" role="presentation" style="border-style: solid; border-width: 1px"></span></div></div></label></span><p *ngIf="widget.field.labelText && !widget.model[widget.qualifier]" class="se-boolean__text">{{widget.field.labelText| translate}}</p></div>`});t.BooleanComponent=class BooleanComponent{constructor(e,t){this.systemEventService=e;this.widget=t}ngOnInit(){this.eventId=`${this.widget.id}${this.widget.qualifier}${mt}`;this.qualifierId=this.widget.qualifier+W.generateIdentifier();if(this.widget.model[this.widget.qualifier]===undefined){const e=this.widget.field.defaultValue!==undefined?this.widget.field.defaultValue:false;this.widget.model[this.widget.qualifier]=e;this.widget.editor.pristine[this.widget.qualifier]=e}this.systemEventService.publishAsync(this.eventId,`${this.widget.model[this.widget.qualifier]}`)}checkboxOnClick(e){this.systemEventService.publishAsync(this.eventId,`${e.checked}`)}};t.BooleanComponent=__decorate([o.Component({selector:"se-boolean",template:`<div class="se-boolean fd-form__item fd-form__item--check"><span class="fd-toggle fd-toggle--xs fd-form__control"><label class="fd-form__label fd-switch fd-switch--compact" for="{{qualifierId}}-checkbox"><input type="checkbox" id="{{qualifierId}}-checkbox" class="se-boolean__input fd-switch__input" [placeholder]="(widget.field.tooltip || '') | translate" [attr.name]="widget.qualifier" [disabled]="!widget.field.editable" [(ngModel)]="widget.model[widget.qualifier]" (click)="checkboxOnClick($event.target)"/><div class="fd-switch__slider"><div class="fd-switch__track"><span class="fd-switch__handle" role="presentation" style="border-style: solid; border-width: 1px"></span></div></div></label></span><p *ngIf="widget.field.labelText && !widget.model[widget.qualifier]" class="se-boolean__text">{{widget.field.labelText| translate}}</p></div>`}),__param(1,o.Inject(Li)),__metadata("design:paramtypes",[t.SystemEventService,Object])],t.BooleanComponent);t.BooleanModule=class BooleanModule{};t.BooleanModule=__decorate([o.NgModule({imports:[u.CommonModule,f.FormsModule,h.TranslateModule.forChild()],declarations:[t.BooleanComponent],entryComponents:[t.BooleanComponent],exports:[t.BooleanComponent]})],t.BooleanModule);let Ui=class DateTimePickerLocalizationService{constructor(e){this.languageService=e}setLocale(e){this.languageService.getResolveLocale().then((t=>{const n=this.convertToDateTimePickerLocale(t);e.setLocale(n)}))}convertToDateTimePickerLocale(e){return e.replace("_","-")}};Ui=__decorate([o.Injectable(),__metadata("design:paramtypes",[t.LanguageService])],Ui);const ki={in:"id",zh:"zh-cn"};window.__smartedit__.addDecoratorPayload("Component","DateTimePickerComponent",{selector:"se-date-time-picker",template:`<fd-datetime-picker [state]="isInvalid() ? 'error' : 'success'" name="se-datetime-picker" [placeholder]="placeholderText | translate" [disabled]="isDisabled" [(ngModel)]="date" (ngModelChange)="handleDatePickerChange()" [allowNull]="true"></fd-datetime-picker>`,providers:[{provide:w.DatetimeAdapter,useClass:w.FdDatetimeAdapter},{provide:w.DATE_TIME_FORMATS,useValue:w.FD_DATETIME_FORMATS}]});let Vi=class DateTimePickerComponent{constructor(e,t,n){this.widget=e;this.localizationService=t;this.datetimeAdapter=n;this.placeholderText="se.componentform.select.date";this.date=w.FdDate.getToday();if(!!this.widget.model[this.widget.qualifier]){this.date=w.FdDate.getFdDateByDate(new Date(this.widget.model[this.widget.qualifier]))}else{this.handleDatePickerChange()}}ngOnInit(){this.localizationService.setLocale(this.datetimeAdapter)}handleDatePickerChange(){this.widget.model[this.widget.qualifier]=this.date?dn.formatDateAsUtc(this.date.toString()):undefined}get isDisabled(){return this.widget.isFieldDisabled()}isInvalid(){return!this.date?false:!this.date.isDateValid()}};Vi=__decorate([o.Component({selector:"se-date-time-picker",template:`<fd-datetime-picker [state]="isInvalid() ? 'error' : 'success'" name="se-datetime-picker" [placeholder]="placeholderText | translate" [disabled]="isDisabled" [(ngModel)]="date" (ngModelChange)="handleDatePickerChange()" [allowNull]="true"></fd-datetime-picker>`,providers:[{provide:w.DatetimeAdapter,useClass:w.FdDatetimeAdapter},{provide:w.DATE_TIME_FORMATS,useValue:w.FD_DATETIME_FORMATS}]}),__param(0,o.Inject(Li)),__metadata("design:paramtypes",[Object,Ui,w.DatetimeAdapter])],Vi);const ji=new o.InjectionToken("resolvedLocaleToMomentLocaleMap");new o.InjectionToken("tooltipsMap");let zi=class DateTimePickerModule{};zi=__decorate([o.NgModule({imports:[u.CommonModule,f.FormsModule,A.DatetimePickerModule,R.MomentDatetimeModule,h.TranslateModule.forChild()],providers:[{provide:ji,useValue:ki},{provide:w.DatetimeAdapter,useClass:w.FdDatetimeAdapter},{provide:w.DATE_TIME_FORMATS,useValue:w.FD_DATETIME_FORMATS},t.LanguageService,Ui],declarations:[Vi],entryComponents:[Vi],exports:[Vi]})],zi);window.__smartedit__.addDecoratorPayload("Component","DropdownItemPrinterComponent",{selector:"se-dropdown-item-printer",template:` <span>{{ data.item.label }}</span> `});let Bi=class DropdownItemPrinterComponent{constructor(e){this.data=e}};Bi=__decorate([o.Component({selector:"se-dropdown-item-printer",template:` <span>{{ data.item.label }}</span> `}),__param(0,o.Inject(Ai)),__metadata("design:paramtypes",[Object])],Bi);window.__smartedit__.addDecoratorPayload("Component","DropdownComponent",{selector:"se-dropdown-wrapper",template:`\n        <se-select\n            [id]="data.field.qualifier"\n            class="se-generic-editor-dropdown"\n            [(model)]="data.model[data.qualifier]"\n            [searchEnabled]="false"\n            [fetchStrategy]="fetchStrategy"\n            [itemComponent]="itemComponent"\n            [placeholder]="'se.genericeditor.sedropdown.placeholder'"></se-select>\n    `});let Hi=class DropdownComponent{constructor(e){this.data=e;this.itemComponent=Bi;const{field:{options:t}}=e;this.fetchStrategy={fetchAll:()=>Promise.resolve(t)}}};Hi=__decorate([o.Component({selector:"se-dropdown-wrapper",template:`\n        <se-select\n            [id]="data.field.qualifier"\n            class="se-generic-editor-dropdown"\n            [(model)]="data.model[data.qualifier]"\n            [searchEnabled]="false"\n            [fetchStrategy]="fetchStrategy"\n            [itemComponent]="itemComponent"\n            [placeholder]="'se.genericeditor.sedropdown.placeholder'"></se-select>\n    `}),__param(0,o.Inject(Li)),__metadata("design:paramtypes",[Object])],Hi);window.__smartedit__.addDecoratorPayload("Component","EditableDropdownComponent",{selector:"se-editable-dropdown",template:`<se-generic-editor-dropdown [id]="data.id" [field]="data.field" [qualifier]="data.qualifier" [model]="data.model"></se-generic-editor-dropdown>`});let Gi=class EditableDropdownComponent{constructor(e){this.data=e}};Gi=__decorate([o.Component({selector:"se-editable-dropdown",template:`<se-generic-editor-dropdown [id]="data.id" [field]="data.field" [qualifier]="data.qualifier" [model]="data.model"></se-generic-editor-dropdown>`}),__param(0,o.Inject(Li)),__metadata("design:paramtypes",[Object])],Gi);const Wi=new o.InjectionToken(ut);const $i=new o.InjectionToken("DROPDOWN_IMPLEMENTATION_SUFFIX_TOKEN");const Ki=new o.InjectionToken(mt);class IGenericEditorDropdownServiceConstructor{constructor(e){}}function genericEditorDropdownComponentOnInit(){this.field.params=this.field.params||{};this.field.params.catalogId=this.field.params.catalogId||ie;this.field.params.catalogVersion=this.field.params.catalogVersion||oe;const e=this.GenericEditorDropdownService||this.SEDropdownService;this.dropdown=new e({field:this.field,qualifier:this.qualifier,model:this.model,id:this.id,onClickOtherDropdown:this.onClickOtherDropdown.bind(this),getApi:this.getApi});this.dropdown.init()}window.__smartedit__.addDecoratorPayload("Component","GenericEditorDropdownComponent",{selector:"se-generic-editor-dropdown",host:{"[class.se-generic-editor-dropdown]":"true"},template:`<se-select *ngIf="dropdown.initialized" [id]="dropdown.qualifier" (click)="dropdown.onClick()" [placeholder]="field.placeholder" [(model)]="model[qualifier]" [onChange]="dropdown.triggerAction" [fetchStrategy]="dropdown.fetchStrategy" [(reset)]="dropdown.reset" [multiSelect]="dropdown.isMultiDropdown" [controls]="dropdown.isMultiDropdown" [showRemoveButton]="showRemoveButton" [isReadOnly]="!field.editable" [itemComponent]="itemComponent" [resultsHeaderComponent]="resultsHeaderComponent" [actionableSearchItem]="actionableSearchItem" (resetChange)="onResetChange($event)"></se-select>`});t.GenericEditorDropdownComponent=class GenericEditorDropdownComponent{constructor(e){this.GenericEditorDropdownService=e;this.resetChange=new o.EventEmitter}ngOnChanges(){genericEditorDropdownComponentOnInit.call(this)}ngOnInit(){genericEditorDropdownComponentOnInit.call(this)}onClickOtherDropdown(){this.selectComponent.closeAndReset()}onResetChange(e){this.resetChange.emit(e)}};__decorate([o.Input(),__metadata("design:type",String)],t.GenericEditorDropdownComponent.prototype,"id",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.GenericEditorDropdownComponent.prototype,"field",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.GenericEditorDropdownComponent.prototype,"qualifier",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.GenericEditorDropdownComponent.prototype,"model",void 0);__decorate([o.Input(),__metadata("design:type",Boolean)],t.GenericEditorDropdownComponent.prototype,"showRemoveButton",void 0);__decorate([o.Input(),__metadata("design:type",o.Type)],t.GenericEditorDropdownComponent.prototype,"itemComponent",void 0);__decorate([o.Input(),__metadata("design:type",o.Type)],t.GenericEditorDropdownComponent.prototype,"resultsHeaderComponent",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.GenericEditorDropdownComponent.prototype,"actionableSearchItem",void 0);__decorate([o.Input(),__metadata("design:type",Function)],t.GenericEditorDropdownComponent.prototype,"reset",void 0);__decorate([o.Output(),__metadata("design:type",Object)],t.GenericEditorDropdownComponent.prototype,"resetChange",void 0);__decorate([o.ViewChild(t.SelectComponent,{static:false}),__metadata("design:type",t.SelectComponent)],t.GenericEditorDropdownComponent.prototype,"selectComponent",void 0);t.GenericEditorDropdownComponent=__decorate([o.Component({selector:"se-generic-editor-dropdown",host:{"[class.se-generic-editor-dropdown]":"true"},template:`<se-select *ngIf="dropdown.initialized" [id]="dropdown.qualifier" (click)="dropdown.onClick()" [placeholder]="field.placeholder" [(model)]="model[qualifier]" [onChange]="dropdown.triggerAction" [fetchStrategy]="dropdown.fetchStrategy" [(reset)]="dropdown.reset" [multiSelect]="dropdown.isMultiDropdown" [controls]="dropdown.isMultiDropdown" [showRemoveButton]="showRemoveButton" [isReadOnly]="!field.editable" [itemComponent]="itemComponent" [resultsHeaderComponent]="resultsHeaderComponent" [actionableSearchItem]="actionableSearchItem" (resetChange)="onResetChange($event)"></se-select>`}),__metadata("design:paramtypes",[IGenericEditorDropdownServiceConstructor])],t.GenericEditorDropdownComponent);const GenericEditorDropdownServiceFactory=(e,t,n,i,o,r,a,l,c)=>class{constructor(e){this.field=e.field;this.qualifier=e.qualifier;this.model=e.model;this.id=e.id;this.onClickOtherDropdown=e.onClickOtherDropdown;this.items=[]}init(){this.populatorName={options:a.constructor.name,uri:l.constructor.name,propertyType:this.field.propertyType+o,cmsStructureType:this.field.cmsStructureType+o,smarteditComponentType:{withQualifier:this.field.smarteditComponentType+this.field.qualifier+o,withQualifierForDowngradedService:s.camelCase(this.field.smarteditComponentType+this.field.qualifier+o),withoutQualifier:this.field.smarteditComponentType+o}};this.isMultiDropdown=this.field.collection?this.field.collection:false;this.triggerAction=this.triggerAction.bind(this);this.eventId=(this.id||"")+n;this.clickEventKey=(this.id||"")+i;if(this.field.dependsOn){r.subscribe(this.eventId,this._respondToChange.bind(this))}r.subscribe(this.clickEventKey,this._respondToOtherClicks.bind(this));const d=e.resolvePopulator(this.field,this.populatorName,a,l,c);if(!d){t.error("No dropdown populator found")}({instance:this.populator,isPaged:this.isPaged}=d);this.fetchStrategy={fetchEntity:this.fetchEntity.bind(this)};if(this.isPaged){this.fetchStrategy.fetchPage=this.fetchPage.bind(this)}else{this.fetchStrategy.fetchAll=this.fetchAll.bind(this)}this.initialized=true}triggerAction(){const e=this.items.filter((e=>e.id===this.model[this.qualifier]))[0];const t={qualifier:this.qualifier,optionObject:e};r.publishAsync(this.eventId,t)}onClick(){r.publishAsync(this.clickEventKey,this.field.qualifier)}fetchAll(e){return this.populator.fetchAll({field:this.field,model:this.model,selection:this.selection,search:e}).then((e=>{this.items=e;return this.items}))}fetchEntity(e){return this.populator.getItem({field:this.field,id:e,model:this.model})}fetchPage(e,n,i,o){return this.populator.fetchPage({field:this.field,model:this.model,selection:this.selection,search:e,pageSize:n,currentPage:i}).then((e=>{const t=cn.getKeyHoldingDataFromResponse(e);e.results=e[t];delete e[t];this.items=[...this.items,...e.results];if(this.isMultiDropdown&&o){return this.limitToNonSelectedItems(e,o)}else{return e}})).catch((e=>{t.error(`Failed to fetch items and paging information. ${e}`)}))}isInclude(e,t){let n=false;t.forEach((t=>{if(t.uid===e.uid){n=true}}));return n}limitToNonSelectedItems(e,t){const n=e.results.length;for(let i=n-1;i>=0;i--){const n=e.results[i];if(this.isInclude(n,t)){e.results.splice(i,1);e.pagination.count--}}return e}_respondToChange(e,t){if(this.field.dependsOn&&this.field.dependsOn.split(",").indexOf(t.qualifier)>-1){this.selection=t.optionObject;if(this.reset){this.reset()}}}_respondToOtherClicks(e,t){if(this.field.qualifier!==t&&typeof this.onClickOtherDropdown==="function"){this.onClickOtherDropdown(e,t)}}};class GenericEditorUtil{isFieldPaged(e=undefined){return e?e:false}resolvePopulatorByName(e,t,n,i){if(e===t.constructor.name){return t}if(e===n.constructor.name){return n}if(i&&i.length>0){return i.find((t=>t.constructor.name.toUpperCase()===e.toUpperCase()))}return undefined}isPopulatorPaged(e){return e.isPaged&&e.isPaged()}resolvePopulator(e,t,n,i,o){if(e.options&&e.uri){throw new Error("se.dropdown.contains.both.uri.and.options")}if(e.options){return{instance:this.resolvePopulatorByName(t.options,n,i,o),isPaged:false}}if(e.uri){return{instance:this.resolvePopulatorByName(t.uri,n,i,o),isPaged:this.isFieldPaged(e.paged)}}if(e.propertyType){const e=this.resolvePopulatorByName(t.propertyType,n,i,o);return{instance:e,isPaged:this.isPopulatorPaged(e)}}const s=this.resolvePopulatorByName(t.cmsStructureType,n,i,o);if(s){return{instance:s,isPaged:this.isFieldPaged(e.paged)}}const r=this.resolvePopulatorByName(t.smarteditComponentType.withQualifier,n,i,o);if(r){return{instance:r,isPaged:this.isPopulatorPaged(r)}}const a=this.resolvePopulatorByName(t.smarteditComponentType.withQualifierForDowngradedService,n,i,o);if(a){return{instance:a,isPaged:this.isPopulatorPaged(a)}}const l=this.resolvePopulatorByName(t.smarteditComponentType.withoutQualifier,n,i,o);if(l){return{instance:l,isPaged:this.isPopulatorPaged(l)}}return undefined}}class DropdownPopulatorInterface{constructor(e,t,n){this.lodash=e;this.languageService=t;this.translateService=n}getItem(e){return null}fetchAll(e){"proxyFunction";return null}fetchPage(e){"proxyFunction";return null}isPaged(){return false}populateAttributes(e,t,n){return this.lodash.map(e,(e=>{if(t&&this.lodash.isEmpty(e.id)){e.id=e[t]}if(n&&this.lodash.isEmpty(e.label)){const t=this.lodash.find(n,(t=>!this.lodash.isEmpty(e[t])));if(t){e.label=e[t]}}return e}))}search(e,t){return this.languageService.getResolveLocale().then((n=>this.lodash.filter(e,(e=>{let i;if(this.lodash.isObject(e.label)){n=e.label[n]?n:Object.keys(e.label)[0];i=e.label[n]}else{i=this.translateService?this.translateService.instant(e.label):e.label}return i&&i.toUpperCase().indexOf(t.toUpperCase())>-1}))))}}t.OptionsDropdownPopulator=class OptionsDropdownPopulator extends DropdownPopulatorInterface{constructor(e,t){super(x,e,t);this.languageService=e;this.translateService=t}fetchAll(e){const t=this.populateAttributes(e.field.options,e.field.idAttribute,e.field.labelAttributes);if(e.search){return this.search(t,e.search)}return Promise.resolve(t)}};t.OptionsDropdownPopulator=__decorate([o.Injectable(),__metadata("design:paramtypes",[t.LanguageService,h.TranslateService])],t.OptionsDropdownPopulator);t.UriDropdownPopulator=class UriDropdownPopulator extends DropdownPopulatorInterface{constructor(e,t,n){super(x,t,n);this.restServiceFactory=e;this.languageService=t;this.translateService=n}fetchAll(e){let t;if(e.field.dependsOn){t=this._buildQueryParams(e.field.dependsOn,e.model)}return this.restServiceFactory.get(e.field.uri).get(t).then((t=>{const n=cn.getDataFromResponse(t);const i=this.populateAttributes(n,e.field.idAttribute,e.field.labelAttributes);if(e.search){return this.search(i,e.search)}return Promise.resolve(i)}))}fetchPage(e){let t={};if(e.field.dependsOn){t=this._buildQueryParams(e.field.dependsOn,e.model)}t.pageSize=e.pageSize;t.currentPage=e.currentPage;t.mask=e.search;if(e.field.params){this.lodash.extend(t,e.field.params)}return this.restServiceFactory.get(e.field.uri).get(t).then((t=>{const n=cn.getKeyHoldingDataFromResponse(t);t[n]=this.populateAttributes(t[n],e.field.idAttribute,e.field.labelAttributes);return Promise.resolve(t)}))}getItem(e){return this.restServiceFactory.get(e.field.uri).getById(e.id).then((t=>{t=this.populateAttributes([t],e.field.idAttribute,e.field.labelAttributes)[0];return Promise.resolve(t)}))}_buildQueryParams(e,t){const n=e.split(",").reduce(((e,n)=>{e[n]=t[n];return e}),{});return n}};t.UriDropdownPopulator=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.RestServiceFactory,t.LanguageService,h.TranslateService])],t.UriDropdownPopulator);t.DropdownPopulatorModule=class DropdownPopulatorModule{};t.DropdownPopulatorModule=__decorate([o.NgModule({providers:[t.OptionsDropdownPopulator,t.UriDropdownPopulator]})],t.DropdownPopulatorModule);const qi=new o.InjectionToken("CustomDropdownPopulatorsToken");t.GenericEditorDropdownModule=class GenericEditorDropdownModule{};t.GenericEditorDropdownModule=__decorate([o.NgModule({imports:[u.CommonModule,t.SelectModule,t.DropdownPopulatorModule],declarations:[t.GenericEditorDropdownComponent],entryComponents:[t.GenericEditorDropdownComponent],exports:[t.GenericEditorDropdownComponent],providers:[{provide:$i,useValue:ht},{provide:Wi,useValue:ut},{provide:Ki,useValue:mt},GenericEditorUtil,{provide:IGenericEditorDropdownServiceConstructor,useFactory:GenericEditorDropdownServiceFactory,deps:[GenericEditorUtil,a.LogService,Wi,Ki,$i,t.SystemEventService,t.OptionsDropdownPopulator,t.UriDropdownPopulator,[new o.Optional,qi]]}]})],t.GenericEditorDropdownModule);let Yi=class EditableDropdownModule{};Yi=__decorate([o.NgModule({imports:[u.CommonModule,t.GenericEditorDropdownModule],declarations:[Gi],entryComponents:[Gi],exports:[Gi]})],Yi);window.__smartedit__.addDecoratorPayload("Component","EmailComponent",{selector:"se-email",template:`<input fd-form-control [ngClass]="{ 'is-invalid': widget.field.hasErrors, 'is-warning': widget.field.hasWarnings }" [placeholder]="(widget.field.tooltip || '') | translate" [attr.name]="widget.field.qualifier" [disabled]="widget.isFieldDisabled()" [(ngModel)]="widget.model[widget.qualifier]" [max]="255" type="email" id="{{widget.field.qualifier}}-shortstring"/>`});let Qi=class EmailComponent{constructor(e){this.widget=e}};Qi=__decorate([o.Component({selector:"se-email",template:`<input fd-form-control [ngClass]="{ 'is-invalid': widget.field.hasErrors, 'is-warning': widget.field.hasWarnings }" [placeholder]="(widget.field.tooltip || '') | translate" [attr.name]="widget.field.qualifier" [disabled]="widget.isFieldDisabled()" [(ngModel)]="widget.model[widget.qualifier]" [max]="255" type="email" id="{{widget.field.qualifier}}-shortstring"/>`}),__param(0,o.Inject(Li)),__metadata("design:paramtypes",[Object])],Qi);let Zi=class EmailModule{};Zi=__decorate([o.NgModule({imports:[u.CommonModule,h.TranslateModule.forChild(),f.FormsModule,D.FormModule],declarations:[Qi],entryComponents:[Qi],exports:[Qi]})],Zi);window.__smartedit__.addDecoratorPayload("Component","EnumItemPrinterComponent",{selector:"se-enum-item-printer",template:` <span id="enum-{{ data.select.id }}">{{ data.item.label }}</span> `});let Xi=class EnumItemPrinterComponent{constructor(e){this.data=e}};Xi=__decorate([o.Component({selector:"se-enum-item-printer",template:` <span id="enum-{{ data.select.id }}">{{ data.item.label }}</span> `}),__param(0,o.Inject(Ai)),__metadata("design:paramtypes",[Object])],Xi);window.__smartedit__.addDecoratorPayload("Component","EnumComponent",{selector:"se-enum",template:`\n        <se-select\n            [id]="data.field.qualifier"\n            class="se-generic-editor-dropdown"\n            [(model)]="data.model[data.qualifier]"\n            [isReadOnly]="data.isFieldDisabled()"\n            [resetSearchInput]="false"\n            [fetchStrategy]="fetchStrategy"\n            [itemComponent]="itemComponent"\n            [placeholder]="'se.genericeditor.sedropdown.placeholder'"\n            [showRemoveButton]="true"></se-select>\n    `});let Ji=class EnumComponent{constructor(e){this.data=e;this.itemComponent=Xi;const{editor:t,field:n,qualifier:i}=e;this.fetchStrategy={fetchAll:e=>__awaiter(this,void 0,void 0,(function*(){yield t.refreshOptions(n,i,e);const o=n.options[i];const s=o.map((e=>Object.assign(Object.assign({},e),{id:e.code})));return s}))}}};Ji=__decorate([o.Component({selector:"se-enum",template:`\n        <se-select\n            [id]="data.field.qualifier"\n            class="se-generic-editor-dropdown"\n            [(model)]="data.model[data.qualifier]"\n            [isReadOnly]="data.isFieldDisabled()"\n            [resetSearchInput]="false"\n            [fetchStrategy]="fetchStrategy"\n            [itemComponent]="itemComponent"\n            [placeholder]="'se.genericeditor.sedropdown.placeholder'"\n            [showRemoveButton]="true"></se-select>\n    `}),__param(0,o.Inject(Li)),__metadata("design:paramtypes",[Object])],Ji);const eo="0.01";window.__smartedit__.addDecoratorPayload("Component","FloatComponent",{selector:"se-float",template:`<input pattern="^[-]?([0-9]*)(.[0-9]{1,5})?$" type="number" id="{{widget.field.qualifier}}-float" class="fd-form-control" [ngClass]="{ 'is-invalid': widget.field.hasErrors, 'is-warning': widget.field.hasWarnings }" [placeholder]="(widget.field.tooltip || '') | translate" [attr.name]="widget.field.qualifier" [disabled]="widget.isFieldDisabled()" [(ngModel)]="widget.model[widget.qualifier]" [step]="precision"/>`});let to=class FloatComponent{constructor(e){this.widget=e;this.precision=eo}};to=__decorate([o.Component({selector:"se-float",template:`<input pattern="^[-]?([0-9]*)(.[0-9]{1,5})?$" type="number" id="{{widget.field.qualifier}}-float" class="fd-form-control" [ngClass]="{ 'is-invalid': widget.field.hasErrors, 'is-warning': widget.field.hasWarnings }" [placeholder]="(widget.field.tooltip || '') | translate" [attr.name]="widget.field.qualifier" [disabled]="widget.isFieldDisabled()" [(ngModel)]="widget.model[widget.qualifier]" [step]="precision"/>`}),__param(0,o.Inject(Li)),__metadata("design:paramtypes",[Object])],to);let no=class FloatModule{};no=__decorate([o.NgModule({imports:[u.CommonModule,h.TranslateModule.forChild(),f.FormsModule],declarations:[to],entryComponents:[to],exports:[to]})],no);window.__smartedit__.addDecoratorPayload("Component","LongStringComponent",{template:`\n        <textarea\n            class="fd-form__control"\n            style="width: 100%;"\n            [ngClass]="{ 'is-invalid': data.field.hasErrors, 'is-warning': data.field.hasWarnings }"\n            [placeholder]="data.field.tooltip || '' | translate"\n            [attr.name]="data.field.qualifier"\n            [disabled]="data.isFieldDisabled()"\n            [(ngModel)]="data.model[data.qualifier]"></textarea>\n    `,selector:"se-long-string"});let io=class LongStringComponent{constructor(e){this.data=e}};io=__decorate([o.Component({template:`\n        <textarea\n            class="fd-form__control"\n            style="width: 100%;"\n            [ngClass]="{ 'is-invalid': data.field.hasErrors, 'is-warning': data.field.hasWarnings }"\n            [placeholder]="data.field.tooltip || '' | translate"\n            [attr.name]="data.field.qualifier"\n            [disabled]="data.isFieldDisabled()"\n            [(ngModel)]="data.model[data.qualifier]"></textarea>\n    `,selector:"se-long-string"}),__param(0,o.Inject(Li)),__metadata("design:paramtypes",[Object])],io);window.__smartedit__.addDecoratorPayload("Component","NumberComponent",{selector:"se-number",template:`<input [min]="1" [ngClass]="{ 'is-invalid': widget.field.hasErrors, 'is-warning': widget.field.hasWarnings }" [placeholder]="(widget.field.tooltip || '') | translate" [attr.name]="widget.qualifier" [disabled]="widget.isFieldDisabled()" [(ngModel)]="widget.model[widget.qualifier]" id="{{widget.qualifier}}-number" class="fd-form-control fd-input" type="number"/>`});t.NumberComponent=class NumberComponent{constructor(e,t){this.systemEventService=e;this.widget=t;const n=`${this.widget.id}${this.widget.field.dependsOnField}${mt}`;this.unRegClickValueChanged=this.systemEventService.subscribe(n,((e,t)=>this.onClickEvent(t)))}onClickEvent(e){this.widget.field.hideFieldWidget=e!==this.widget.field.dependsOnValue;if(this.widget.field.hideFieldWidget){this.widget.model[this.widget.qualifier]=null}}};t.NumberComponent=__decorate([o.Component({selector:"se-number",template:`<input [min]="1" [ngClass]="{ 'is-invalid': widget.field.hasErrors, 'is-warning': widget.field.hasWarnings }" [placeholder]="(widget.field.tooltip || '') | translate" [attr.name]="widget.qualifier" [disabled]="widget.isFieldDisabled()" [(ngModel)]="widget.model[widget.qualifier]" id="{{widget.qualifier}}-number" class="fd-form-control fd-input" type="number"/>`}),__param(1,o.Inject(Li)),__metadata("design:paramtypes",[t.SystemEventService,Object])],t.NumberComponent);t.NumberModule=class NumberModule{};t.NumberModule=__decorate([o.NgModule({imports:[u.CommonModule,h.TranslateModule.forChild(),f.FormsModule],declarations:[t.NumberComponent],entryComponents:[t.NumberComponent],exports:[t.NumberComponent]})],t.NumberModule);const oo=new o.InjectionToken("resolvedLocaleToCKEDITORLocaleMap");const so=new o.InjectionToken("richTextConfiguration");t.GenericEditorSanitizationService=class GenericEditorSanitizationService{constructor(e){this.domSanitizer=e}isSanitized(e){const t=document.createElement("div");const n=document.createElement("div");const i=this.domSanitizer.sanitize(o.SecurityContext.HTML,e).replace(/&#10;/g,"\n").replace(/&#160;/g,"").replace(/<br>/g,"<br />");t.innerHTML=i;const s=e.replace(/&#10;/g,"\n").replace(/&#160;/g,"").replace(/<br>/g,"<br />");n.innerHTML=s;return t.innerHTML===n.innerHTML}};t.GenericEditorSanitizationService=__decorate([o.Injectable(),__metadata("design:paramtypes",[v.DomSanitizer])],t.GenericEditorSanitizationService);t.RichTextFieldLocalizationService=class RichTextFieldLocalizationService{constructor(e,t){this.languageService=e;this.resolvedLocaleToCKEDITORLocaleMap=t}localizeCKEditor(){return this.languageService.getResolveLocale().then((e=>{CKEDITOR.config.language=this.convertResolvedToCKEditorLocale(e)}))}convertResolvedToCKEditorLocale(e){const t=this.resolvedLocaleToCKEDITORLocaleMap[e];if(t){return t}return e}};t.RichTextFieldLocalizationService=__decorate([__param(1,o.Inject(oo)),__metadata("design:paramtypes",[t.LanguageService,Object])],t.RichTextFieldLocalizationService);class RichTextLoaderService{constructor(){this.loadPromise=new Promise((e=>{this.checkLoadedInterval=setInterval((()=>{if(CKEDITOR.status==="loaded"){e();clearInterval(this.checkLoadedInterval);this.checkLoadedInterval=null}}),100)}))}load(){return this.loadPromise}}window.__smartedit__.addDecoratorPayload("Component","RichTextFieldComponent",{selector:"se-rich-text-field",template:`<textarea #textarea class="fd-form__control" [ngClass]="{'has-error': widget.field.hasErrors}" name="{{widget.field.qualifier}}-{{widget.qualifier}}" [disabled]="widget.isFieldDisabled()" [(ngModel)]="widget.model[widget.qualifier]" (change)="reassignUserCheck()"></textarea><div *ngIf="requiresUserCheck()"><div id="richTextWarningMessage" [hidden]="widget.field.isUserChecked"><span fd-object-status [status]="'critical'" [glyph]="'message-warning'" class="se-generic-editor__warning" label="{{'se.editor.richtext.message.warning' | translate}}"></span></div><input id="richTextWarningCheckBox" type="checkbox" [(ngModel)]="widget.field.isUserChecked" (click)="checkboxOnClick($event.target)"/> <span [ngClass]="{'warning-check-msg': true, 'not-checked': widget.editor.hasFrontEndValidationErrors && !widget.field.isUserChecked}">{{'se.editor.richtext.check' | translate}}</span></div>`});t.RichTextFieldComponent=class RichTextFieldComponent{constructor(e,t,n,i,o,s){this.widget=e;this.seRichTextLoaderService=t;this.seRichTextConfiguration=n;this.genericEditorSanitizationService=i;this.seRichTextFieldLocalizationService=o;this.settingsService=s}ngAfterViewInit(){return this.settingsService.get("cms.components.allowUnsafeJavaScript").then((e=>this.seRichTextLoaderService.load().then((()=>{this.seRichTextConfiguration.allowedContent=e==="true";this.editorInstance=CKEDITOR.replace(this.textarea.nativeElement,this.seRichTextConfiguration);this.seRichTextFieldLocalizationService.localizeCKEditor();if(this.editorInstance){this.editorInstance.on("change",(()=>this.onChange()));this.editorInstance.on("mode",(()=>this.onMode()));CKEDITOR.on("instanceReady",(e=>this.onInstanceReady(e)))}}))))}ngOnDestroy(){if(this.editorInstance&&CKEDITOR.instances[this.editorInstance.name]){CKEDITOR.instances[this.editorInstance.name].destroy()}}onChange(){setTimeout((()=>{this.widget.model[this.widget.qualifier]=this.editorInstance.getData();this.reassignUserCheck();this.toggleSubmitButton(this.requiresUserCheck()&&!this.widget.field.isUserChecked)}))}onMode(){if(this.editorInstance.mode==="source"){const e=this.editorInstance.editable();e.attachListener(e,"input",(()=>{this.editorInstance.fire("change")}))}}onInstanceReady(e){const t=CKEDITOR.dtd;const n=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t.$nonBodyContent),t.$block),t.$listItem),t.$tableContent),{br:1});for(const t of Object.keys(n)){e.editor.dataProcessor.writer.setRules(t,{indent:false,breakBeforeOpen:false,breakAfterOpen:false,breakBeforeClose:false,breakAfterClose:false})}e.editor.dataProcessor.writer.lineBreakChars="";e.editor.dataProcessor.writer.indentationChars=""}requiresUserCheck(){let e=false;for(const t in this.widget.field.requiresUserCheck){if(this.widget.field.requiresUserCheck.hasOwnProperty(t)){e=e||this.widget.field.requiresUserCheck[t]}}return e}reassignUserCheck(){if(this.widget.model&&this.widget.qualifier&&this.widget.model[this.widget.qualifier]){const e=this.genericEditorSanitizationService.isSanitized(this.widget.model[this.widget.qualifier]);this.widget.field.requiresUserCheck=this.widget.field.requiresUserCheck||{};this.widget.field.requiresUserCheck[this.widget.qualifier]=!e}else{this.widget.field.requiresUserCheck=this.widget.field.requiresUserCheck||{};this.widget.field.requiresUserCheck[this.widget.qualifier]=false}}checkboxOnClick(e){this.toggleSubmitButton(!e.checked)}toggleSubmitButton(e){this.widget.editor.api.setInProgress(e)}};__decorate([o.ViewChild("textarea",{static:false}),__metadata("design:type",o.ElementRef)],t.RichTextFieldComponent.prototype,"textarea",void 0);t.RichTextFieldComponent=__decorate([o.Component({selector:"se-rich-text-field",template:`<textarea #textarea class="fd-form__control" [ngClass]="{'has-error': widget.field.hasErrors}" name="{{widget.field.qualifier}}-{{widget.qualifier}}" [disabled]="widget.isFieldDisabled()" [(ngModel)]="widget.model[widget.qualifier]" (change)="reassignUserCheck()"></textarea><div *ngIf="requiresUserCheck()"><div id="richTextWarningMessage" [hidden]="widget.field.isUserChecked"><span fd-object-status [status]="'critical'" [glyph]="'message-warning'" class="se-generic-editor__warning" label="{{'se.editor.richtext.message.warning' | translate}}"></span></div><input id="richTextWarningCheckBox" type="checkbox" [(ngModel)]="widget.field.isUserChecked" (click)="checkboxOnClick($event.target)"/> <span [ngClass]="{'warning-check-msg': true, 'not-checked': widget.editor.hasFrontEndValidationErrors && !widget.field.isUserChecked}">{{'se.editor.richtext.check' | translate}}</span></div>`}),__param(0,o.Inject(Li)),__param(2,o.Inject(so)),__metadata("design:paramtypes",[Object,RichTextLoaderService,Object,t.GenericEditorSanitizationService,t.RichTextFieldLocalizationService,t.SettingsService])],t.RichTextFieldComponent);t.RichTextFieldModule=class RichTextFieldModule{};t.RichTextFieldModule=__decorate([o.NgModule({imports:[u.CommonModule,f.FormsModule,h.TranslateModule.forChild(),M.ObjectStatusModule],providers:[t.GenericEditorSanitizationService,t.RichTextFieldLocalizationService,RichTextLoaderService,t.SettingsService,{provide:oo,useValue:{in:"id",es_CO:"es"}},{provide:so,useValue:{toolbar:"full",toolbar_full:[{name:"basicstyles",items:["Bold","Italic","Strike","Underline"]},{name:"paragraph",items:["BulletedList","NumberedList","Blockquote"]},{name:"editing",items:["JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"links",items:["Link","Unlink","Anchor"]},{name:"tools",items:["SpellChecker","Maximize"]},"/",{name:"styles",items:["Format","Font","FontSize","TextColor","PasteText","PasteFromWord","RemoveFormat"]},{name:"insert",items:["Image","Table","SpecialChar"]},{name:"forms",items:["Outdent","Indent"]},"/",{name:"clipboard",items:["Undo","Redo"]},{name:"document",items:["PageBreak","Source"]}],disableNativeSpellChecker:false,height:"100px",width:"100%",autoParagraph:false,basicEntities:false,fillEmptyBlocks:false,extraAllowedContent:"div(*)[role]",extraPlugins:"colorbutton, colordialog, font",font_names:"Arial/Arial, Helvetica, sans-serif;Times New Roman/Times New Roman, Times, serif;Verdana",fontSize_sizes:"10/10px;12/12px;14/14px;16/16px;18/18px;20/20px;22/22px;24/24px;36/36px;48/48px;",protectedSource:[/\r|\n|\r\n|\t/g]}}],declarations:[t.RichTextFieldComponent],entryComponents:[t.RichTextFieldComponent],exports:[t.RichTextFieldComponent]})],t.RichTextFieldModule);window.__smartedit__.addDecoratorPayload("Component","ShortStringComponent",{template:`\n        <input\n            type="text"\n            fd-form-control\n            [state]="data.field.hasErrors ? 'error' : ''"\n            id="{{ data.field.qualifier }}-shortstring"\n            [attr.name]="data.field.qualifier"\n            [disabled]="data.isFieldDisabled()"\n            [(ngModel)]="data.model[data.qualifier]"\n            [ngClass]="{\n                'is-warning': data.field.hasWarnings\n            }" />\n    `,selector:"se-short-string"});t.ShortStringComponent=class ShortStringComponent{constructor(e){this.data=e}};t.ShortStringComponent=__decorate([o.Component({template:`\n        <input\n            type="text"\n            fd-form-control\n            [state]="data.field.hasErrors ? 'error' : ''"\n            id="{{ data.field.qualifier }}-shortstring"\n            [attr.name]="data.field.qualifier"\n            [disabled]="data.isFieldDisabled()"\n            [(ngModel)]="data.model[data.qualifier]"\n            [ngClass]="{\n                'is-warning': data.field.hasWarnings\n            }" />\n    `,selector:"se-short-string"}),__param(0,o.Inject(Li)),__metadata("design:paramtypes",[Object])],t.ShortStringComponent);window.__smartedit__.addDecoratorPayload("Component","TextComponent",{template:` <p [id]="data.field.qualifier + '-text'">{{ data.model[data.qualifier] }}</p> `,selector:"se-component-text"});let ro=class TextComponent{constructor(e){this.data=e}};ro=__decorate([o.Component({template:` <p [id]="data.field.qualifier + '-text'">{{ data.model[data.qualifier] }}</p> `,selector:"se-component-text"}),__param(0,o.Inject(Li)),__metadata("design:paramtypes",[Object])],ro);var ao;const lo="0.01";t.EditorFieldMappingService=ao=class EditorFieldMappingService{constructor(e){this.logService=e;this._editorsFieldMapping=[];this._fieldsTabsMapping=[]}addFieldMapping(e,t,n,i){this._addMapping(e,t,n,i,this._editorsFieldMapping)}getEditorFieldMapping(e,t){let n=this._getMapping(e,t,this._editorsFieldMapping);if(!n){this.logService.warn("editorFieldMappingService - Cannot find suitable field mapping for type ",e.cmsStructureType);n=null}else if(n&&n.template){n.template=this._cleanTemplate(n.template)}return n}addFieldTabMapping(e,t,n,i){this._addMapping(e,t,n,i,this._fieldsTabsMapping)}getFieldTabMapping(e,t){return this._getMapping(e,t,this._fieldsTabsMapping)}_addMapping(e,t,n,i,o){e=this._validateField(e);t=this._validateField(t);n=this._validateField(n);const r={structureTypeMatcher:e,componentTypeMatcher:t,discriminatorMatcher:n,value:i};s.remove(o,(i=>i.structureTypeMatcher===e&&i.componentTypeMatcher===t&&i.discriminatorMatcher===n));o.push(r)}_validateField(e){if(e===null){e=ao.WILDCARD}else if(typeof e!=="string"&&typeof e!=="function"){throw new Error("editorFieldMappingService: Mapping matcher must be of type string or function.")}return e}_getMapping(e,t,n){let i=null;let o=0;n.forEach((n=>{const s=this._evaluateMapping(n,e,t);if(s>o){i=n.value;o=s}}));return i}_evaluateMapping(e,t,n){let i;let o;let s=ao.MATCH.NONE;const r=this._evaluateMatcher(e.structureTypeMatcher,t.cmsStructureType,t,n);if(r!==ao.MATCH.NONE){i=this._evaluateMatcher(e.componentTypeMatcher,t.smarteditComponentType,t,n);if(i!==ao.MATCH.NONE){o=this._evaluateMatcher(e.discriminatorMatcher,t.qualifier,t,n)}}if(r!==ao.MATCH.NONE&&i!==ao.MATCH.NONE&&o!==ao.MATCH.NONE){s=r+i+o}return s}_evaluateMatcher(e,t,n,i){if(typeof e==="string"){if(e===ao.WILDCARD){return ao.MATCH.PARTIAL}else{return this._exactValueMatchPredicate(e,t)?ao.MATCH.EXACT:ao.MATCH.NONE}}else{return e(t,n,i)?ao.MATCH.EXACT:ao.MATCH.NONE}}_registerDefaultFieldMappings(){if(!this._initialized){this._initialized=true;this.addFieldMapping("Boolean",null,null,{component:t.BooleanComponent});this.addFieldMapping("ShortString",null,null,{component:t.ShortStringComponent,validators:{notBlank:(e,t,n,i)=>!!n?!!n:undefined}});this.addFieldMapping("Text",null,null,{component:ro});this.addFieldMapping("LongString",null,null,{component:io});this.addFieldMapping("RichText",null,null,{component:t.RichTextFieldComponent});this.addFieldMapping("Number",null,null,{component:t.NumberComponent});this.addFieldMapping("Float",null,null,{component:to});this.addFieldMapping("Dropdown",null,null,{component:Hi});this.addFieldMapping("EditableDropdown",null,null,{component:Gi});this.addFieldMapping("DateTime",null,null,{component:Vi});this.addFieldMapping("Enum",null,null,{component:Ji});this.addFieldMapping("Email",null,null,{component:Qi,validators:{email:(e,t,n,i)=>true}})}}_cleanTemplate(e){const t=e?e.lastIndexOf("/"):-1;if(t!==-1){e=e.substring(t+1)}return e}_exactValueMatchPredicate(e,t){return e===t}};t.EditorFieldMappingService.WILDCARD="*";t.EditorFieldMappingService.MATCH={NONE:0,PARTIAL:1,EXACT:4};t.EditorFieldMappingService=ao=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.LogService])],t.EditorFieldMappingService);var co;t.FetchEnumDataHandler=co=class FetchEnumDataHandler{constructor(e){this.restServiceFactory=e;this.restServiceForEnum=this.restServiceFactory.get(dt)}static resetForTests(){co.cache={}}findByMask(e,t){return(co.cache[e.cmsStructureEnumType]?Promise.resolve(co.cache[e.cmsStructureEnumType]):Promise.resolve(this.restServiceForEnum.get({enumClass:e.cmsStructureEnumType}))).then((n=>{co.cache[e.cmsStructureEnumType]=n;return co.cache[e.cmsStructureEnumType].enums.filter((e=>a.stringUtils.isBlank(t)||e.label.toUpperCase().indexOf(t.toUpperCase())>-1))}))}getById(e,t){return null}};t.FetchEnumDataHandler.cache={};t.FetchEnumDataHandler=co=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.RestServiceFactory])],t.FetchEnumDataHandler);t.GenericEditorFactoryService=class GenericEditorFactoryService{constructor(e,t,n,i,o,s,r){s._registerDefaultFieldMappings();this.genericEditorConstructor=class extends DefaultGenericEditor{constructor(s){super(s,e,t,n,i,o,r)}}}getGenericEditorConstructor(){return this.genericEditorConstructor}};t.GenericEditorFactoryService=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.RestServiceFactory,t.LanguageService,a.ISharedDataService,t.SystemEventService,a.LogService,t.EditorFieldMappingService,t.FetchEnumDataHandler])],t.GenericEditorFactoryService);class DefaultGenericEditor{constructor(e,t,n,i,o,s,r){this.restServiceFactory=t;this.languageService=n;this.sharedDataService=i;this.systemEventService=o;this.logService=s;this.fetchEnumDataHandler=r;this.schema$=new p.BehaviorSubject(null);this.data$=new p.BehaviorSubject(null);this.submitButtonText="se.componentform.actions.submit";this.cancelButtonText="se.componentform.actions.cancel";this.api=createApi(this);this.onSubmit=e=>{if(this.smarteditComponentId){e.identifier=this.smarteditComponentId}if(this.editorCRUDService&&!this.smarteditComponentId&&this.structure&&this.structure.type&&!e.type){e.type=this.structure.type}return this.preparePayload(e).then((t=>{const updateOrSaveEditor=()=>this.smarteditComponentId?this.editorCRUDService.update(t):this.editorCRUDService.save(t);const n=this.editorCRUDService?updateOrSaveEditor():Promise.resolve(t);return n.then((function(t){return{payload:e,response:t}}))}))};this.submit$=()=>p.from(this.submit(this.form.component));this.onSuccess=e=>{let t;if(e.response){t=ln.copy(e.response)}else{t=ln.copy(e.payload)}delete t.identifier;if(!this.smarteditComponentId&&e.response){this.smarteditComponentId=e.response.uuid}this.form&&this.form.removeValidationMessages();this.inProgress=false;if(this.updateCallback){this.updateCallback(t,e.response)}};this.onFailure=e=>{this.form.removeValidationMessages();const t=e.error?e.error.errors:[];this.form.displayValidationMessages(t,true);const n=this.form.collectUnrelatedValidationMessages(t);if(n.length>0){this.systemEventService.publishAsync(lt,{messages:n,sourceGenericEditorId:this.id})}this.inProgress=false};this.isSubmitDisabled=()=>{if(this.inProgress){return true}else if(!this.isDirty()||!this.isValid()){return!this.alwaysEnableSubmit}else{return false}};this._validate(e);this.id=e.id;this.inProgress=false;this.smarteditComponentType=e.smarteditComponentType;this.smarteditComponentId=e.smarteditComponentId;this.editorStackId=e.editorStackId||this.id;this.updateCallback=e.updateCallback;this.structure=e.structure;this.onChangeEvents=[];if(e.structureApi){this.editorStructureService=this.restServiceFactory.get(e.structureApi)}this.uriContext=e.uriContext;if(e.contentApi){this.editorCRUDService=this.restServiceFactory.get(e.contentApi)}this.initialContent=x.cloneDeep(e.content);this.initialDirty=false;if(e.customOnSubmit){this.onSubmit=e.customOnSubmit}this._unregisterUnrelatedMessagesEvent=this.systemEventService.subscribe(lt,this._handleUnrelatedValidationMessages.bind(this));this.element=e.element}get pristine(){return this.form?this.form.pristine:undefined}get nativeForm(){return this.element.querySelector("form")}setForm(e){this.form=e;this.form.group.valueChanges.subscribe((()=>{this.api.triggerContentChangeEvents()}))}_finalize(){this._unregisterUnrelatedMessagesEvent();this.popEditorFromStack()}popEditorFromStack(){if(!this.editorStackId){return}this.systemEventService.publishAsync(t.GenericEditorStackService.EDITOR_POP_FROM_STACK_EVENT,{editorStackId:this.editorStackId})}reset(e){this.form&&this.form.removeValidationMessages();const t=this.editorStructureService?this.editorStructureService.get({smarteditComponentType:this.smarteditComponentType}):Promise.resolve(this.structure);return this._getUriContext().then((e=>Promise.all([this.api.getLanguages()||this.languageService.getLanguagesForSite(e[se]),t.then((e=>this._convertStructureArray(e))),Promise.resolve(e)]))).then((([t,n,i])=>{const o={languages:t,structure:n,uriContext:i,id:this.id,smarteditComponentType:this.smarteditComponentType,targetedQualifier:this.targetedQualifier};this.schema$.next(o);this.data$.next(e?e:this.pristine)}))}fetch(){const fetchPayload=()=>this.smarteditComponentId?this.editorCRUDService.getById(this.smarteditComponentId).then((e=>e||{})):Promise.resolve({});if(!this.initialDirty){return this.initialContent?Promise.resolve(this.initialContent):fetchPayload()}return Promise.resolve({})}load(){return this.fetch().then((e=>this.reset(e)),(e=>{this.logService.error("GenericEditor.load failed");this.logService.error(e)}))}getComponent(){return this.form&&this.form.component||null}preparePayload(e){return Promise.resolve(this.form.sanitizedPayload(e))}submit(e){this.form.removeValidationMessages();this.hasFrontEndValidationErrors=false;if(!this.form.fieldsAreUserChecked()){this.hasFrontEndValidationErrors=true;return Promise.reject(true)}else if(this.isValid(true)){this.inProgress=true;return this.onSubmit(e)}else{this.logService.warn("GenericEditor.submit() - unable to submit form. Form is unexpectedly invalid.");return Promise.reject({})}}refreshOptions(e,t,n){return new Promise((i=>{let o;let s;if(e.localized){o=this.form.component[e.qualifier][t];s=t}else{o=this.form.component[e.qualifier];s=e.qualifier}e.initiated=e.initiated||[];e.options=e.options||{};if(e.cmsStructureType==="Enum"){e.initiated.push(s)}if(e.initiated.indexOf(s)>-1){if(n.length>2||e.cmsStructureType==="Enum"){return this.fetchEnumDataHandler.findByMask(e,n).then((t=>{e.options[s]=t;i()}))}}else if(o){return this.fetchEnumDataHandler.getById(e,o).then((t=>{e.options[s]=[t];e.initiated.push(s);i()}))}else{e.initiated.push(s)}return i()}))}isDirty(e,t){return this.initialDirty||(this.form?this.form.isDirty(e,t):false)}isValid(e=false){if(e){const t=this.form.collectFrontEndValidationErrors(e,this.nativeForm);this.form.removeFrontEndValidationMessages();this.form.displayValidationMessages(t,e)}return!!this.form&&this.form.group.valid}watchFormErrors(e){this.form.watchErrors(e)}init(){return this.load().then((()=>{if(this.initialDirty){this.form.patchComponent(this.initialContent||{});this.data$.next(this.initialContent||{})}this._pushEditorToStack();this.systemEventService.publishAsync(at,this.id)}))}_validate(e){if(W.isBlank(e.structureApi)&&!e.structure){throw new Error("genericEditor.configuration.error.no.structure")}else if(!W.isBlank(e.structureApi)&&e.structure){throw new Error("genericEditor.configuration.error.2.structures")}}_getUriContext(){return Promise.resolve(this.uriContext?this.uriContext:this.sharedDataService.get(zt).then((e=>({[se]:e.siteDescriptor.uid,[ie]:e.catalogDescriptor.catalogId,[oe]:e.catalogDescriptor.catalogVersion}))))}_convertStructureArray(e){const t=e.structures||e.componentTypes;if(x.isArray(t)){if(t.length>1){throw new Error("init: Invalid structure, multiple structures returned")}e=t[0]}return e}_handleUnrelatedValidationMessages(e,t){if(t.targetGenericEditorId&&t.targetGenericEditorId!==this.id){return}if(t.sourceGenericEditorId&&t.sourceGenericEditorId===this.id){return}this.form.removeValidationMessages();this.form.displayValidationMessages(t.messages,true)}_pushEditorToStack(){this.systemEventService.publishAsync(t.GenericEditorStackService.EDITOR_PUSH_TO_STACK_EVENT,{editorId:this.id,editorStackId:this.editorStackId,component:this.form.component,componentType:this.smarteditComponentType})}}const po=new Set(["id","smarteditComponentId","smarteditComponentType","structureApi","structure","contentApi","content","uriContext","updateCallback","customOnSubmit","editorStackId","modalHeaderTitle"]);window.__smartedit__.addDecoratorPayload("Component","GenericEditorComponent",{selector:"se-generic-editor",template:`<ng-template let-state [formBuilder]="{schema$: editor.schema$, data$: editor.data$}" (stateCreated)="setFormState($event)"><div class="se-generic-editor"><se-generic-editor-breadcrumb></se-generic-editor-breadcrumb><ng-container *ngIf="state; else noSupport"><form novalidate #nativeForm class="no-enter-submit se-generic-editor__form" [contentManager]="{onSave: editor.submit$}" (onSuccess)="editor.onSuccess($event)" (onError)="editor.onFailure($event)"><div class="modal-header se-generic-editor__header" *ngIf="modalHeaderTitle"><h4 class="modal-title">{{modalHeaderTitle| translate}}</h4></div><div class="se-generic-editor__body"><ng-container [formRenderer]="state.group"></ng-container></div><div class="se-generic-editor__footer dialog-footer" *ngIf="editor && showCommands()"><button fd-button id="submit" name="submit" options="emphasized" *ngIf="showSubmit()" [seSubmitBtn]="editor.isSubmitDisabled" [label]="editor.submitButtonText | translate"></button> <button fd-button id="cancel" type="button" options="light" *ngIf="showCancel()" (click)="_reset()">{{editor.cancelButtonText | translate}}</button></div></form></ng-container><ng-template #noSupport><div class="se-generic-editor__body"><se-message type="info" id="GenericEditor.NoEditingSupportDisclaimer"><ng-container se-message-description>{{ 'se.editor.notification.editing.not.supported' | translate }}</ng-container></se-message></div></ng-template></div></ng-template>`});t.GenericEditorComponent=class GenericEditorComponent{constructor(e,t,n){this.elementRef=e;this.genericEditorFactoryService=t;this.waitDialogService=n;this.submit=null;this.reset=null;this.isDirty=null;this.isValid=null;this.getApi=new o.EventEmitter;this.submitChange=new o.EventEmitter;this.resetChange=new o.EventEmitter;this.isValidChange=new o.EventEmitter;this.isDirtyChange=new o.EventEmitter;this.editor=null;this.componentForm=new f.FormGroup({});this.formInitialized$=new p.BehaviorSubject(null);this.formSet$=new p.BehaviorSubject(false);this.isSubmitDisabled=()=>this.editor.isSubmitDisabled()}set nativeForm(e){if(!e){return}this.formInitialized$.next(e.nativeElement)}ngOnChanges(e){const t=!!Object.keys(e).find((e=>po.has(e)));if(!t){return}if(this.editor){this.editor._finalize()}const n=this.genericEditorFactoryService.getGenericEditorConstructor();this.editor=new n({id:this.id||W.generateIdentifier(),smarteditComponentType:this.smarteditComponentType,smarteditComponentId:this.smarteditComponentId,editorStackId:this.editorStackId,structureApi:this.structureApi,structure:this.structure,contentApi:this.contentApi,updateCallback:this.updateCallback,content:this.content,uriContext:this.uriContext,customOnSubmit:this.customOnSubmit,element:this.elementRef.nativeElement});this.getApi.emit(this.editor.api);this.editor.init()}ngOnInit(){this.waitDialogService.hideWaitModal();this.showResetButton=s.isNull(this.reset);this.showSubmitButton=s.isNull(this.submit);setTimeout((()=>{this.submitChange.emit((()=>this.contentManager.save().toPromise().then((e=>e.response))));this.isValidChange.emit((()=>this._isValid()));this.isDirtyChange.emit((()=>this._isDirty()));this.resetChange.emit((()=>this._reset()))}));p.combineLatest([this.formSet$,this.formInitialized$]).pipe(_.filter((e=>e.every((e=>!!e)))),_.take(1)).subscribe((([e,t])=>this.editor.watchFormErrors(t)))}ngOnDestroy(){this.editor._finalize();this.waitDialogService.hideWaitModal()}setFormState(e){this.editor.setForm(e);this.formSet$.next(true)}showCommands(){return this.showCancel()||this.showSubmit()}showCancel(){return this.editor.alwaysShowReset||this.showResetButton===true&&this.editor.isDirty()&&this.editor.isValid()}showSubmit(){return this.editor.alwaysShowSubmit||this.showSubmitButton===true&&this.editor.isDirty()&&this.editor.isValid()}_reset(){return __awaiter(this,void 0,void 0,(function*(){if(this.editor.onReset&&this.editor.onReset()===false){return null}return this.editor.reset()}))}_isValid(){return this.editor.isValid()}_isDirty(){return this.editor?this.editor.isDirty():false}};__decorate([o.Input(),__metadata("design:type",String)],t.GenericEditorComponent.prototype,"id",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.GenericEditorComponent.prototype,"smarteditComponentId",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.GenericEditorComponent.prototype,"smarteditComponentType",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.GenericEditorComponent.prototype,"structureApi",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.GenericEditorComponent.prototype,"structure",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.GenericEditorComponent.prototype,"contentApi",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.GenericEditorComponent.prototype,"content",void 0);__decorate([o.Input(),__metadata("design:type",Promise)],t.GenericEditorComponent.prototype,"uriContext",void 0);__decorate([o.Input(),__metadata("design:type",Function)],t.GenericEditorComponent.prototype,"submit",void 0);__decorate([o.Input(),__metadata("design:type",Function)],t.GenericEditorComponent.prototype,"reset",void 0);__decorate([o.Input(),__metadata("design:type",Function)],t.GenericEditorComponent.prototype,"isDirty",void 0);__decorate([o.Input(),__metadata("design:type",Function)],t.GenericEditorComponent.prototype,"isValid",void 0);__decorate([o.Input(),__metadata("design:type",Function)],t.GenericEditorComponent.prototype,"updateCallback",void 0);__decorate([o.Input(),__metadata("design:type",Function)],t.GenericEditorComponent.prototype,"customOnSubmit",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.GenericEditorComponent.prototype,"editorStackId",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.GenericEditorComponent.prototype,"modalHeaderTitle",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.GenericEditorComponent.prototype,"getApi",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.GenericEditorComponent.prototype,"submitChange",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.GenericEditorComponent.prototype,"resetChange",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.GenericEditorComponent.prototype,"isValidChange",void 0);__decorate([o.Output(),__metadata("design:type",o.EventEmitter)],t.GenericEditorComponent.prototype,"isDirtyChange",void 0);__decorate([o.ViewChild("nativeForm",{static:false,read:o.ElementRef}),__metadata("design:type",o.ElementRef),__metadata("design:paramtypes",[o.ElementRef])],t.GenericEditorComponent.prototype,"nativeForm",null);__decorate([o.ViewChild(Fi,{static:false}),__metadata("design:type",Fi)],t.GenericEditorComponent.prototype,"contentManager",void 0);t.GenericEditorComponent=__decorate([o.Component({selector:"se-generic-editor",template:`<ng-template let-state [formBuilder]="{schema$: editor.schema$, data$: editor.data$}" (stateCreated)="setFormState($event)"><div class="se-generic-editor"><se-generic-editor-breadcrumb></se-generic-editor-breadcrumb><ng-container *ngIf="state; else noSupport"><form novalidate #nativeForm class="no-enter-submit se-generic-editor__form" [contentManager]="{onSave: editor.submit$}" (onSuccess)="editor.onSuccess($event)" (onError)="editor.onFailure($event)"><div class="modal-header se-generic-editor__header" *ngIf="modalHeaderTitle"><h4 class="modal-title">{{modalHeaderTitle| translate}}</h4></div><div class="se-generic-editor__body"><ng-container [formRenderer]="state.group"></ng-container></div><div class="se-generic-editor__footer dialog-footer" *ngIf="editor && showCommands()"><button fd-button id="submit" name="submit" options="emphasized" *ngIf="showSubmit()" [seSubmitBtn]="editor.isSubmitDisabled" [label]="editor.submitButtonText | translate"></button> <button fd-button id="cancel" type="button" options="light" *ngIf="showCancel()" (click)="_reset()">{{editor.cancelButtonText | translate}}</button></div></form></ng-container><ng-template #noSupport><div class="se-generic-editor__body"><se-message type="info" id="GenericEditor.NoEditingSupportDisclaimer"><ng-container se-message-description>{{ 'se.editor.notification.editing.not.supported' | translate }}</ng-container></se-message></div></ng-template></div></ng-template>`}),__metadata("design:paramtypes",[o.ElementRef,t.GenericEditorFactoryService,IWaitDialogService])],t.GenericEditorComponent);var uo;t.GenericEditorTabService=uo=class GenericEditorTabService{constructor(){this._tabsConfiguration={};this._defaultTabPredicates=[]}configureTab(e,t){this._tabsConfiguration[e]=t}getTabConfiguration(e){const t=this._tabsConfiguration[e];return t?t:null}sortTabs(e){return e.sort(((e,t)=>{const n=this.getTabPriority(e);const i=this.getTabPriority(t);if(i-n!==0){return i-n}else{if(e.id<t.id){return-1}else if(e.id>t.id){return 1}return 0}}))}getComponentTypeDefaultTab(e){let t=null;this._defaultTabPredicates.some((n=>{t=n(e);return t!==null}));return t!==null?t:uo.DEFAULT_TAB_ID}addComponentTypeDefaultTabPredicate(e){if(!e||typeof e!=="function"){throw new Error("genericEditorTabService - provided predicate must be a function.")}this._defaultTabPredicates.push(e)}getTabPriority(e){const t=e.id;if(!t){throw new Error("genericEditorTabService - Every tab must have an id.")}let n=uo.MIN_PRIORITY;if(this._tabsConfiguration[t]&&this._tabsConfiguration[t].priority){n=this._tabsConfiguration[t].priority}return n}};t.GenericEditorTabService.MIN_PRIORITY=0;t.GenericEditorTabService.DEFAULT_TAB_ID="default";t.GenericEditorTabService=uo=__decorate([o.Injectable()],t.GenericEditorTabService);const parseValidationMessage=e=>{const t=new RegExp("[a-zA-Z]+: ([|{)([a-zA-Z0-9]+)(]|}).?","g");const n=e.match(t)||[];return n.reduce(((e,t)=>{e.message=e.message.replace(t,"").trim();const n=t.split(":")[0].trim().toLowerCase();const i=t.split(":")[1].match(/[a-zA-Z0-9]+/g)[0];e[n]=i;return e}),{message:e})};t.SeValidationMessageParser=class SeValidationMessageParser{parse(e){return parseValidationMessage(e)}};t.SeValidationMessageParser=__decorate([o.Injectable()],t.SeValidationMessageParser);function isBlankValidator(){return e=>{const t=e.value&&e.value.length>0&&""===x.trim(e.value);return t?{isBlank:{value:e.value}}:null}}window.__smartedit__.addDecoratorPayload("Component","GenericEditorBreadcrumbComponent",{selector:"se-generic-editor-breadcrumb",template:`\n        <div class="se-ge-breadcrumb">\n            <ng-container *ngIf="showBreadcrumb()">\n                <div\n                    *ngFor="let breadcrumbItem of getEditorsStack(); let i = index"\n                    class="se-ge-breadcrumb__item">\n                    <div class="se-ge-breadcrumb__data">\n                        <span class="se-ge-breadcrumb__title">\n                            {{ getComponentName(breadcrumbItem) | translate }}\n                        </span>\n                        <span class="se-ge-breadcrumb__info">\n                            {{ breadcrumbItem.componentType | translate }}\n                        </span>\n                    </div>\n\n                    <div class="se-ge-breadcrumb__divider" *ngIf="i < getEditorsStack().length - 1">\n                        <i class="sap-icon--navigation-right-arrow"></i>\n                    </div>\n                </div>\n            </ng-container>\n        </div>\n    `});t.GenericEditorBreadcrumbComponent=class GenericEditorBreadcrumbComponent{constructor(e,t){this.genericEditorStackService=e;this.ge=t}getEditorsStack(){if(!this.editorsStack){this.editorsStack=this.genericEditorStackService.getEditorsStack(this.ge.editorStackId)}return this.editorsStack}showBreadcrumb(){return this.getEditorsStack()&&this.getEditorsStack().length>1}getComponentName(e){if(!e.component.name){return"se.breadcrumb.name.empty"}return e.component.name}};t.GenericEditorBreadcrumbComponent=__decorate([o.Component({selector:"se-generic-editor-breadcrumb",template:`\n        <div class="se-ge-breadcrumb">\n            <ng-container *ngIf="showBreadcrumb()">\n                <div\n                    *ngFor="let breadcrumbItem of getEditorsStack(); let i = index"\n                    class="se-ge-breadcrumb__item">\n                    <div class="se-ge-breadcrumb__data">\n                        <span class="se-ge-breadcrumb__title">\n                            {{ getComponentName(breadcrumbItem) | translate }}\n                        </span>\n                        <span class="se-ge-breadcrumb__info">\n                            {{ breadcrumbItem.componentType | translate }}\n                        </span>\n                    </div>\n\n                    <div class="se-ge-breadcrumb__divider" *ngIf="i < getEditorsStack().length - 1">\n                        <i class="sap-icon--navigation-right-arrow"></i>\n                    </div>\n                </div>\n            </ng-container>\n        </div>\n    `}),__param(1,o.Inject(o.forwardRef((()=>t.GenericEditorComponent)))),__metadata("design:paramtypes",[t.GenericEditorStackService,t.GenericEditorComponent])],t.GenericEditorBreadcrumbComponent);window.__smartedit__.addDecoratorPayload("Component","GenericEditorDynamicFieldComponent",{selector:"se-ge-dynamic-field",styles:[`\n            :host {\n                display: block;\n            }\n        `],template:`\n        <se-generic-editor-field\n            [formControl]="form"\n            [field]="field"\n            [model]="component"\n            [qualifier]="qualifier"\n            [id]="id"></se-generic-editor-field>\n    `});let mo=class GenericEditorDynamicFieldComponent{constructor(e){this.cdr=e}ngAfterViewChecked(){if(!this.cdr.destroyed){this.cdr.detectChanges()}}};__decorate([a.DynamicForm(),__metadata("design:type",a.FormField)],mo.prototype,"form",void 0);__decorate([a.DynamicInput(),__metadata("design:type",Object)],mo.prototype,"component",void 0);__decorate([a.DynamicInput(),__metadata("design:type",Object)],mo.prototype,"field",void 0);__decorate([a.DynamicInput(),__metadata("design:type",String)],mo.prototype,"qualifier",void 0);__decorate([a.DynamicInput(),__metadata("design:type",String)],mo.prototype,"id",void 0);mo=__decorate([o.Component({selector:"se-ge-dynamic-field",styles:[`\n            :host {\n                display: block;\n            }\n        `],template:`\n        <se-generic-editor-field\n            [formControl]="form"\n            [field]="field"\n            [model]="component"\n            [qualifier]="qualifier"\n            [id]="id"></se-generic-editor-field>\n    `}),__metadata("design:paramtypes",[o.ChangeDetectorRef])],mo);window.__smartedit__.addDecoratorPayload("Component","GenericEditorTabComponent",{selector:"se-ge-tab",template:`<div class="se-generic-editor__row ySErow" *ngFor="let field of fields" [ngClass]="'se-generic-editor__row--' + field.qualifier"><label [id]="field.qualifier + '-label'" class="se-control-label" *ngIf="!field.hideFieldWidget && !field.hidePrefixLabel && field.i18nKey" [hidden]="field.hideFieldWidget && field.hidePrefixLabel" [ngClass]="{ required: field.required }">{{ field.i18nKey | lowercase | translate }}</label><se-help class="se-help-tooltip" *ngIf="field.tooltip"><span>{{ field.tooltip | translate }}</span></se-help><div class="ySEGenericEditorFieldStructure" [hidden]="field.hideFieldWidget" [id]="field.qualifier" [attr.data-cms-field-qualifier]="field.qualifier" [attr.data-cms-structure-type]="field.cmsStructureType"><ng-template [formRenderer]="getForm(field.qualifier)"></ng-template></div></div>`});let ho=class GenericEditorTabComponent{constructor(e,t,n){this.cdr=e;this.ge=t;this.data=n}ngOnInit(){const{model:e,tabId:t}=this.data;this.fields=e.getInput("fieldsMap")[t];const n=e.controls[t];this.forms=n.controls;this._subscription=n.statusChanges.subscribe((()=>{const e=s.values(this.forms).some((e=>{const t=e.getInput("field");return t.messages&&t.messages.length>0}));this.data.tab.hasErrors=e}));Object.keys(this.forms).forEach((e=>{this.forms[e].setInput("id",this.ge.editor.id)}))}ngAfterViewChecked(){if(!this.cdr.destroyed){this.cdr.detectChanges()}}ngOnDestroy(){this._subscription.unsubscribe()}getForm(e){return this.forms[e]}};ho=__decorate([o.Component({selector:"se-ge-tab",template:`<div class="se-generic-editor__row ySErow" *ngFor="let field of fields" [ngClass]="'se-generic-editor__row--' + field.qualifier"><label [id]="field.qualifier + '-label'" class="se-control-label" *ngIf="!field.hideFieldWidget && !field.hidePrefixLabel && field.i18nKey" [hidden]="field.hideFieldWidget && field.hidePrefixLabel" [ngClass]="{ required: field.required }">{{ field.i18nKey | lowercase | translate }}</label><se-help class="se-help-tooltip" *ngIf="field.tooltip"><span>{{ field.tooltip | translate }}</span></se-help><div class="ySEGenericEditorFieldStructure" [hidden]="field.hideFieldWidget" [id]="field.qualifier" [attr.data-cms-field-qualifier]="field.qualifier" [attr.data-cms-structure-type]="field.cmsStructureType"><ng-template [formRenderer]="getForm(field.qualifier)"></ng-template></div></div>`}),__param(2,o.Inject(ui)),__metadata("design:paramtypes",[o.ChangeDetectorRef,t.GenericEditorComponent,Object])],ho);const createValidatorMap=(e,t,n,i,o)=>Object.keys(e||{}).reduce(((s,r)=>Object.assign(Object.assign({},s),{[r]:e[r](t,n,i,o)})),{});class RootSchemaDataMapper{constructor(e,t,n){this.mappers=e;this.tabs=t;this.fieldsMap=n}toValue(){return this.mappers.reduce(((e,t)=>{e[t.id]=t.toValue();return e}),{})}toSchema(){return{type:"group",component:"tabs",schemas:this.mappers.reduce(((e,t)=>{e[t.id]=t.toSchema();return e}),{}),inputs:{tabs:this.tabs,fieldsMap:this.fieldsMap}}}}const go="$$internal";class InternalProperty{constructor(){this._map=new Map}watch(e,t){this._map.set(e,t);return()=>{this._map.delete(e)}}trigger(e,t){if(this._map.has(e)){this._map.get(e)(t)}}}const proxifyDataObject=e=>{const t=new InternalProperty;Object.defineProperty(e,go,{get:()=>t});return new Proxy(e,{set(e,t,n){e[t]=n;e[go].trigger(t,n);return true}})};const _o=new Set(x.values(ct));const vo={SHORT_STRING:"ShortString",LONG_STRING:"LongString"};class GenericEditorState{constructor(e,t,n,i,o,s,r,a,l){this.id=e;this.group=t;this.component=n;this.proxiedComponent=i;this.pristine=o;this.tabs=s;this.fields=r;this.languages=a;this.parameters=l;this.removeValidationMessages=()=>{this.fields.forEach((e=>{e.messages=undefined;e.hasErrors=false;e.hasWarnings=false}))};this._qualifierFieldMap=this.fields.reduce(((e,t)=>{e.set(t.qualifier,t);return e}),new Map);this._formFields=this._buildFormFieldsArray(this.group)}removeFrontEndValidationMessages(){this.fields.forEach((e=>{if(!Array.isArray(e.messages)){return}const t=(e.messages||[]).filter((e=>e.fromSubmit===undefined?true:e.fromSubmit));e.messages=t.length?t:undefined;e.hasErrors=this._containsValidationMessageType(e.messages,ct.VALIDATION_ERROR);e.hasWarnings=this._containsValidationMessageType(e.messages,ct.WARNING)}))}validationMessageBelongsToCurrentInstance(e){return this._qualifierFieldMap.has(e.subject)}collectUnrelatedValidationMessages(e){return e.filter((e=>this._isValidationMessageType(e.type)&&!this.validationMessageBelongsToCurrentInstance(e)))}watchErrors(e){const t=this._formFields.map((e=>e.statusChanges.pipe(_.startWith(null))));p.combineLatest([...t,this.group.statusChanges.pipe(_.startWith(null))]).pipe(_.distinctUntilChanged(((e,t)=>x.isEqual(e,t))),_.map((()=>this.collectFrontEndValidationErrors(false,e)))).subscribe((e=>{this.removeFrontEndValidationMessages();this.displayValidationMessages(e,false)}))}collectFrontEndValidationErrors(e,t){e=e||false;return this._formFields.reduce(((n,i)=>{const o=i.getInput("field");if((()=>{const e=Array.from(t||[]).find((e=>e.getAttribute("name")===o.qualifier));return!!e&&!e.checkValidity()})()){n.push({type:ct.VALIDATION_ERROR,subject:o.qualifier,message:"se.editor.htmlo.validation.error",fromSubmit:e,isNonPristine:this.isDirty(o.qualifier)})}if(i.getError("required")&&i.touched||i.getError("isBlank")&&i.touched){if(o.localized){const t=i.getInput("id");n.push({type:ct.VALIDATION_ERROR,subject:o.qualifier,message:"se.componentform.required.field",language:t,fromSubmit:e,isNonPristine:this.isDirty(o.qualifier,t)})}else{n.push({type:ct.VALIDATION_ERROR,subject:o.qualifier,message:"se.componentform.required.field",fromSubmit:e,isNonPristine:this.isDirty(o.qualifier)})}}return n}),[])}displayValidationMessages(e,t){e.filter((e=>this._isValidationMessageType(e.type)&&(t||e.isNonPristine))).forEach((e=>{e.type=e.type||ct.VALIDATION_ERROR;const t=this._qualifierFieldMap.get(e.subject);if(!t){return}if(!t.messages){t.messages=[]}const n=x.merge(e,this._getParseValidationMessage(e.message));n.marker=t.localized?n.language:t.qualifier;n.type=e.type;n.uniqId=W.encode(n);const i=t.messages.find((e=>e.uniqId===n.uniqId));if(!i){t.messages.push(n);if(n.type===ct.VALIDATION_ERROR){t.hasErrors=true}else if(n.type===ct.WARNING){t.hasWarnings=true}}else{x.merge(i,n)}}));x.values(this.group.controls).forEach((e=>{e.updateValueAndValidity({emitEvent:true})}));return Promise.resolve()}isDirty(e,t){this._bcPristine=this._buildComparable(this.fields,this.pristine);const n=this._buildComparable(this.fields,this.component);const i=e?t?this._bcPristine[e][t]:this._bcPristine[e]:this._bcPristine;const o=e?t?n[e][t]:n[e]:n;return!x.isEqual(i,o)}fieldsAreUserChecked(){return this.fields.every((e=>{let t=false;for(const n in e.requiresUserCheck){if(e.requiresUserCheck.hasOwnProperty(n)){t=t||e.requiresUserCheck[n]}}return!t||e.isUserChecked}))}patchComponent(e){this._qualifierFieldMap.forEach((({localized:t,qualifier:n})=>{if(t&&e[n]){e[n]=proxifyDataObject(e[n])}}));Object.assign(this.proxiedComponent,e)}sanitizedPayload(e=this.component){this.fields.filter((e=>e.cmsStructureType===vo.LONG_STRING||e.cmsStructureType===vo.SHORT_STRING||typeof e.customSanitize==="function")).forEach((({qualifier:t,localized:n,customSanitize:i})=>{if(e[t]!==undefined&&t in e){if(i){e[t]=i(e[t],W.sanitize);return}}}));return e}switchToTabContainingQualifier(e){if(!e){return}this.tabs.forEach((t=>{t.active=!!this.group.get([t.id,e])}))}_getParseValidationMessage(e){return parseValidationMessage(e)}_containsValidationMessageType(e,t){if(!Array.isArray(e)){return false}return e.some((e=>e.type===t&&this.validationMessageBelongsToCurrentInstance(e)))}_isValidationMessageType(e){return _o.has(e)}_buildComparable(e,t){if(!t){return t}const n={};e.forEach((e=>{let i=t[e.qualifier];if(e.localized){i=i;const t={};x.forEach(i,((n,i)=>{if(!x.isUndefined(n)){t[i]=this._buildFieldComparable(n,e)}}));n[e.qualifier]=t}else{i=t[e.qualifier];n[e.qualifier]=this._buildFieldComparable(i,e)}}));x.forEach(t,((t,i)=>{const o=!e.some((e=>e.qualifier===i));if(o){n[i]=t}}));return x.omitBy(n,x.isUndefined)}_buildFieldComparable(e,t){switch(t.cmsStructureType){case"RichText":return e!==undefined?W.sanitizeHTML(e):null;case"Boolean":return e!==undefined?e:false;default:return e}}_buildFormFieldsArray(e,t=[]){if(e instanceof a.FormField){t.push(e);return t}if(e instanceof a.FormGrouping){Object.keys(e.controls).forEach((n=>{const i=e.controls[n];this._buildFormFieldsArray(i,t)}));return t}return t}}class FieldSchemaDataMapper{constructor(e,t,n,i){this.id=e;this.structure=t;this.required=n;this.component=i}toValue(){return this.component[this.id]}toSchema(){return{type:"field",component:"field",validators:Object.assign({required:this.required&&this.structure.editable||undefined},createValidatorMap(this.structure.validators,this.id,this.structure,this.required,this.component)),inputs:{id:this.id,field:this.structure,qualifier:this.id,component:this.component}}}}class LocalizedSchemaDataMapper{constructor(e,t,n,i,o){this.id=e;this.mappers=t;this.structure=n;this.languages=i;this.component=o}toValue(){return this.mappers.reduce(((e,t)=>{e[t.id]=t.toValue();return e}),{})}toSchema(){return{type:"group",component:"localized",schemas:this.mappers.reduce(((e,t)=>{e[t.id]=t.toSchema();return e}),{}),inputs:{field:this.structure,languages:this.languages,component:this.component}}}}class TabSchemaDataMapper{constructor(e,t){this.id=e;this.mappers=t}toValue(){return this.mappers.reduce(((e,t)=>{e[t.id]=t.toValue();return e}),{})}toSchema(){return{type:"group",persist:false,schemas:this.mappers.reduce(((e,t)=>{e[t.id]=t.toSchema();return e}),{})}}}const createFieldMapper=(e,t,n,i)=>new FieldSchemaDataMapper(e,t,n,i);const createLocalizedMapper=(e,t,n)=>{if(n[e.qualifier]===undefined){n[e.qualifier]={}}n[e.qualifier]=proxifyDataObject(n[e.qualifier]);const i=t.map((({isocode:t,required:i})=>createFieldMapper(t,e,e.required&&i,n[e.qualifier])));return new LocalizedSchemaDataMapper(e.qualifier,i,e,t,n)};const createTabMapper=(e,t,n,i)=>{const o=t.map((e=>{if(e.localized){return createLocalizedMapper(e,n,i)}return createFieldMapper(e.qualifier,e,e.required,i)}));return new TabSchemaDataMapper(e,o)};const createRootMapper=(e,t,n,i)=>{const o=s.toPairs(e).map((([e,i])=>createTabMapper(e,i,n,t)));return new RootSchemaDataMapper(o,i,e)};let So=class GenericEditorStateBuilderService{constructor(e,t,n,i){this.editorFieldMappingService=e;this.genericEditorTabService=t;this.translateService=n;this.schemaCompiler=i}buildState(e,t){const n=this._fieldAdaptor(t);const i=[];const o=n.reduce(((e,n)=>{let o=this.editorFieldMappingService.getFieldTabMapping(n,t.structure);if(!o){o=this.genericEditorTabService.getComponentTypeDefaultTab(t.structure)}if(!e[o]){e[o]=[];i.push({id:o,title:"se.genericeditor.tab."+o+".title",component:ho})}e[o].push(n);return e}),{});this.genericEditorTabService.sortTabs(i);const s={siteId:t.uriContext[se],catalogId:t.uriContext[ie],catalogVersion:t.uriContext[oe]};const r=ln.copy(e);const a=proxifyDataObject(r);const l=this._createMapper(o,a,t.languages,i);const c=this.schemaCompiler.compileGroup(l.toValue(),l.toSchema());const d=new GenericEditorState(t.id,c,r,a,ln.copy(e),i,n,t.languages,s);d.switchToTabContainingQualifier(t.targetedQualifier);return d}_createMapper(e,t,n,i){return createRootMapper(e,t,n,i)}_fieldAdaptor(e){const t=e.structure;return t.attributes.map((n=>{const i=this.editorFieldMappingService.getEditorFieldMapping(n,t);const o=Object.assign(n,i);if(o.editable===undefined){o.editable=true}if(!o.postfixText){const e=(t.type?t.type.toLowerCase():"")+"."+n.qualifier.toLowerCase()+".postfix.text";const i=this.translateService.instant(e);o.postfixText=i!==e?i:""}o.smarteditComponentType=e.smarteditComponentType;return o}))}};So=__decorate([o.Injectable(),__metadata("design:paramtypes",[t.EditorFieldMappingService,t.GenericEditorTabService,h.TranslateService,a.SchemaCompilerService])],So);let yo=class FormBuilderDirective{constructor(e,t,n){this.templateRef=e;this.viewContainer=t;this.stateBuilderService=n;this.stateCreated=new o.EventEmitter}set formBuilder(e){this._dispose();this._subscription=p.combineLatest([e.data$,e.schema$]).subscribe(this._onDataStream.bind(this))}ngOnDestroy(){this._dispose()}_onDataStream([e,t]){if(!e||!t){return}this.viewContainer.clear();if(!t.structure){this.viewContainer.createEmbeddedView(this.templateRef,{$implicit:null});return}const n=this.stateBuilderService.buildState(e,t);this.stateCreated.emit(n);this.viewContainer.createEmbeddedView(this.templateRef,{$implicit:n})}_dispose(){this._subscription&&this._subscription.unsubscribe();this.viewContainer.clear()}};__decorate([o.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],yo.prototype,"formBuilder",null);__decorate([o.Output(),__metadata("design:type",Object)],yo.prototype,"stateCreated",void 0);yo=__decorate([o.Directive({selector:"[formBuilder]"}),__metadata("design:paramtypes",[o.TemplateRef,o.ViewContainerRef,So])],yo);var Co;window.__smartedit__.addDecoratorPayload("Component","GenericEditorFieldComponent",{selector:"se-generic-editor-field",providers:[{provide:f.NG_VALUE_ACCESSOR,useExisting:o.forwardRef((()=>Co)),multi:true}],template:`<div [attr.validation-id]="field.qualifier" class="ySEField"><ng-container *ngIf="field.component"><ng-container *ngComponentOutlet="field.component; injector: widgetInjector"></ng-container></ng-container><se-generic-editor-field-messages [field]="field" [qualifier]="qualifier"></se-generic-editor-field-messages><div *ngIf="field.postfix" class="ySEText ySEFieldPostfix">{{ field.postfix | translate }}</div></div>`});t.GenericEditorFieldComponent=Co=class GenericEditorFieldComponent{constructor(e,t,n){this.elementRef=e;this.injector=t;this.ge=n}writeValue(e){this.model[this.qualifier]=e}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}ngOnInit(){this.createInjector();this._unWatch=this.model[go].watch(this.qualifier,(e=>{if(this._onChange&&this._onTouched){this._onTouched();this._onChange(e)}}))}ngOnDestroy(){this._unWatch()}ngAfterViewInit(){if(!this.field.template){return}const e=document.createElement("se-template-ge-widget");this.elementRef.nativeElement.editor=this.ge.editor;this.elementRef.nativeElement.model=this.model;this.elementRef.nativeElement.field=this.field;this.elementRef.nativeElement.qualifier=this.qualifier;this.elementRef.nativeElement.id=this.id;this.elementRef.nativeElement.editorStackId=this.ge.editor.editorStackId;this.elementRef.nativeElement.isFieldDisabled=()=>this.isFieldDisabled();this.elementRef.nativeElement.$ctrl=this;this.geWidget.nativeElement.appendChild(e)}isFieldDisabled(){let e=this.field.editable;if(this.field.localized){e=this.field.editable&&this.field.isLanguageEnabledMap[this.qualifier]}return!e}createInjector(){this.widgetInjector=o.Injector.create({parent:this.injector,providers:[{provide:Li,useValue:{id:this.id,field:this.field,model:this.model,editor:this.ge.editor,qualifier:this.qualifier,isFieldDisabled:()=>this.isFieldDisabled()}}]})}};__decorate([o.Input(),__metadata("design:type",Object)],t.GenericEditorFieldComponent.prototype,"field",void 0);__decorate([o.Input(),__metadata("design:type",Object)],t.GenericEditorFieldComponent.prototype,"model",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.GenericEditorFieldComponent.prototype,"qualifier",void 0);__decorate([o.Input(),__metadata("design:type",String)],t.GenericEditorFieldComponent.prototype,"id",void 0);__decorate([o.ViewChild("widget",{read:o.ElementRef,static:false}),__metadata("design:type",o.ElementRef)],t.GenericEditorFieldComponent.prototype,"geWidget",void 0);t.GenericEditorFieldComponent=Co=__decorate([o.Component({selector:"se-generic-editor-field",providers:[{provide:f.NG_VALUE_ACCESSOR,useExisting:o.forwardRef((()=>Co)),multi:true}],template:`<div [attr.validation-id]="field.qualifier" class="ySEField"><ng-container *ngIf="field.component"><ng-container *ngComponentOutlet="field.component; injector: widgetInjector"></ng-container></ng-container><se-generic-editor-field-messages [field]="field" [qualifier]="qualifier"></se-generic-editor-field-messages><div *ngIf="field.postfix" class="ySEText ySEFieldPostfix">{{ field.postfix | translate }}</div></div>`}),__param(2,o.Inject(o.forwardRef((()=>t.GenericEditorComponent)))),__metadata("design:paramtypes",[o.ElementRef,o.Injector,t.GenericEditorComponent])],t.GenericEditorFieldComponent);window.__smartedit__.addDecoratorPayload("Component","GenericEditorFieldMessagesComponent",{selector:"se-generic-editor-field-messages",template:`<div *ngIf="errors?.length > 0" style="display: grid"><span *ngFor="let error of errors" class="se-generic-editor__error se-help-block--has-error help-block fd-form__message fd-form__message--error">{{ error | translate}}</span></div><div *ngIf="warnings?.length > 0" style="display: grid"><span *ngFor="let warning of warnings" class="se-generic-editor__warning se-help-block--has-warning help-block fd-form__message fd-form__message--warning">{{ warning | translate }}</span></div>`});let fo=class GenericEditorFieldMessagesComponent{constructor(){this.previousMessages=null}ngDoCheck(){if(this.field){const e=JSON.stringify(this.field.messages);if(this.previousMessages!==e){this.previousMessages=e;this.errors=this.getFilteredMessagesByType(ct.VALIDATION_ERROR);this.warnings=this.getFilteredMessagesByType(ct.WARNING)}}}getFilteredMessagesByType(e){return(this.field.messages||[]).filter((t=>t.marker===this.qualifier&&!t.format&&t.type===e)).map((e=>e.message))}};__decorate([o.Input(),__metadata("design:type",Object)],fo.prototype,"field",void 0);__decorate([o.Input(),__metadata("design:type",String)],fo.prototype,"qualifier",void 0);fo=__decorate([o.Component({selector:"se-generic-editor-field-messages",template:`<div *ngIf="errors?.length > 0" style="display: grid"><span *ngFor="let error of errors" class="se-generic-editor__error se-help-block--has-error help-block fd-form__message fd-form__message--error">{{ error | translate}}</span></div><div *ngIf="warnings?.length > 0" style="display: grid"><span *ngFor="let warning of warnings" class="se-generic-editor__warning se-help-block--has-warning help-block fd-form__message fd-form__message--warning">{{ warning | translate }}</span></div>`})],fo);window.__smartedit__.addDecoratorPayload("Component","GenericEditorFieldWrapperComponent",{selector:"se-generic-editor-field-wrapper",template:` <ng-template [formRenderer]="form"></ng-template> `});let Eo=class GenericEditorFieldWrapperComponent{constructor({model:e,tabId:t,tab:n}){this.form=e.controls[t];this._subscription=this.form.statusChanges.subscribe((e=>{n.hasErrors=e==="INVALID"}))}ngOnDestroy(){this._subscription.unsubscribe()}};Eo=__decorate([o.Component({selector:"se-generic-editor-field-wrapper",template:` <ng-template [formRenderer]="form"></ng-template> `}),__param(0,o.Inject(ui)),__metadata("design:paramtypes",[Object])],Eo);window.__smartedit__.addDecoratorPayload("Component","LocalizedElementComponent",{selector:"se-localized-element",styles:[`\n            :host {\n                display: block;\n            }\n        `],template:`<se-tabs *ngIf="tabs" class="multi-tabs-editor" [model]="form" [tabsList]="tabs" [numTabsDisplayed]="6"></se-tabs>`});let Io=class LocalizedElementComponent{constructor(e){this.sessionService=e}onDynamicInputChange(){this._createLocalizedTabs()}ngDoCheck(){if(this.tabs&&this.field.messages!==this._previousMessages){this._previousMessages=this.field.messages;const e=this.field.messages?this.field.messages.filter((e=>e.type===ct.VALIDATION_ERROR)).reduce(((e,t)=>{e[t.language]=true;return e}),{}):{};this.tabs=this.tabs.map((function(t){const n=e[t.id];t.hasErrors=n!==undefined?n:false;return t}))}}_createLocalizedTabs(){return __awaiter(this,void 0,void 0,(function*(){this.field.isLanguageEnabledMap={};const{readableLanguages:e,writeableLanguages:t}=yield this.sessionService.getCurrentUser();const n=new Set(e);const i=new Set(t);this.tabs=this.languages.filter((e=>n.has(e.isocode))).map((({isocode:e,required:t})=>{this.field.isLanguageEnabledMap[e]=i.has(e);const n=`${e.toUpperCase()}${this.field.editable&&this.field.required&&t?"*":""}`;return{title:n,id:e,component:Eo}}))}))}};__decorate([a.DynamicForm(),__metadata("design:type",a.FormGrouping)],Io.prototype,"form",void 0);__decorate([a.DynamicInput(),__metadata("design:type",Object)],Io.prototype,"field",void 0);__decorate([a.DynamicInput(),__metadata("design:type",Object)],Io.prototype,"component",void 0);__decorate([a.DynamicInput(),__metadata("design:type",Array)],Io.prototype,"languages",void 0);Io=__decorate([o.Component({selector:"se-localized-element",styles:[`\n            :host {\n                display: block;\n            }\n        `],template:`<se-tabs *ngIf="tabs" class="multi-tabs-editor" [model]="form" [tabsList]="tabs" [numTabsDisplayed]="6"></se-tabs>`}),__metadata("design:paramtypes",[a.ISessionService])],Io);window.__smartedit__.addDecoratorPayload("Component","GenericEditorRootTabsComponent",{selector:"se-ge-root-tabs",styles:[`\n            :host {\n                display: block;\n            }\n        `],template:`\n        <se-tabs\n            class="se-generic-editor__tabs"\n            [model]="form"\n            [tabsList]="tabs"\n            [numTabsDisplayed]="3"></se-tabs>\n    `});let bo=class GenericEditorRootTabsComponent{};__decorate([a.DynamicForm(),__metadata("design:type",a.FormGrouping)],bo.prototype,"form",void 0);__decorate([a.DynamicInput(),__metadata("design:type",Array)],bo.prototype,"tabs",void 0);bo=__decorate([o.Component({selector:"se-ge-root-tabs",styles:[`\n            :host {\n                display: block;\n            }\n        `],template:`\n        <se-tabs\n            class="se-generic-editor__tabs"\n            [model]="form"\n            [tabsList]="tabs"\n            [numTabsDisplayed]="3"></se-tabs>\n    `})],bo);let To=class SubmitBtnDirective{constructor(e){this.cm=e}get disabled(){return this.cm.submitting||this.isDisabled&&this.isDisabled()}save(e){e.preventDefault();this.cm.save().subscribe()}};__decorate([o.Input("seSubmitBtn"),__metadata("design:type",Function)],To.prototype,"isDisabled",void 0);__decorate([o.HostBinding("disabled"),__metadata("design:type",Boolean),__metadata("design:paramtypes",[])],To.prototype,"disabled",null);__decorate([o.HostListener("click",["$event"]),__metadata("design:type",Function),__metadata("design:paramtypes",[Event]),__metadata("design:returntype",void 0)],To.prototype,"save",null);To=__decorate([o.Directive({selector:"[seSubmitBtn]"}),__metadata("design:paramtypes",[Fi])],To);t.GenericEditorWidgetModule=class GenericEditorWidgetModule{};t.GenericEditorWidgetModule=__decorate([o.NgModule({imports:[u.CommonModule,zi,t.BooleanModule,a.TranslationModule.forChild(),f.FormsModule,t.RichTextFieldModule,t.SelectModule,no,t.NumberModule,Zi,Yi,D.FormModule],declarations:[t.ShortStringComponent,io,Ji,Xi,Hi,Bi,ro],entryComponents:[t.ShortStringComponent,io,Ji,Xi,Hi,Bi,ro]})],t.GenericEditorWidgetModule);t.SeGenericEditorModule=class SeGenericEditorModule{};t.SeGenericEditorModule=__decorate([o.NgModule({schemas:[o.CUSTOM_ELEMENTS_SCHEMA],imports:[u.CommonModule,t.YjqueryModule,f.FormsModule,f.ReactiveFormsModule,t.FundamentalsModule,t.SharedComponentsModule,t.GenericEditorWidgetModule,t.SelectModule,t.GenericEditorDropdownModule,a.TranslationModule.forChild(),a.FormBuilderModule.forRoot({validators:{required:()=>f.Validators.required,email:()=>f.Validators.email,notBlank:()=>isBlankValidator()},types:{tabs:bo,localized:Io,field:mo}})],providers:[t.GenericEditorFactoryService,t.EditorFieldMappingService,t.FetchEnumDataHandler,t.GenericEditorStackService,t.GenericEditorTabService,t.SeValidationMessageParser,So],declarations:[mo,t.GenericEditorComponent,ho,Io,t.GenericEditorFieldComponent,fo,Eo,t.GenericEditorBreadcrumbComponent,yo,Fi,bo,To],entryComponents:[t.GenericEditorComponent,ho,Io,t.GenericEditorFieldComponent,fo,Eo,t.GenericEditorBreadcrumbComponent],exports:[t.GenericEditorComponent,t.GenericEditorWidgetModule,t.GenericEditorDropdownModule]})],t.SeGenericEditorModule);t.GenericEditorMediaType=void 0;(function(e){e["VIDEO"]="video";e["IMAGE"]="image";e["PDF_DOCUMENT"]="pdf";e["DEFAULT"]=""})(t.GenericEditorMediaType||(t.GenericEditorMediaType={}));window.__smartedit__.addDecoratorPayload("Component","HeaderLanguageDropdownComponent",{selector:"header-language-dropdown",template:`\n        <ul role="menu" class="fd-menu__list se-language-selector">\n            <li *ngIf="selectedLanguage" class="fd-menu__item">\n                <a\n                    class="yToolbarActions__dropdown-element se-language-selector__element--selected fd-menu__link">\n                    <span class="fd-menu__title"> {{ selectedLanguage.name }} </span>\n                </a>\n            </li>\n            <ng-container *ngFor="let language of items">\n                <li\n                    *ngIf="selectedLanguage.isoCode !== language.value.isoCode"\n                    class="fd-menu__item">\n                    <a\n                        class="yToolbarActions__dropdown-element se-language-selector__element fd-menu__link"\n                        (click)="onSelectedLanguage(language)">\n                        <span class="fd-menu__title"> {{ language.value.name }} </span>\n                    </a>\n                </li>\n            </ng-container>\n        </ul>\n    `});t.HeaderLanguageDropdownComponent=class HeaderLanguageDropdownComponent extends a.LanguageDropdown{constructor(e,t,n){super(e,t,n);this.languageService=e;this.crossFrameEventService=t;this.logService=n;this.languageSortStrategy="none"}};t.HeaderLanguageDropdownComponent=__decorate([o.Component({selector:"header-language-dropdown",template:`\n        <ul role="menu" class="fd-menu__list se-language-selector">\n            <li *ngIf="selectedLanguage" class="fd-menu__item">\n                <a\n                    class="yToolbarActions__dropdown-element se-language-selector__element--selected fd-menu__link">\n                    <span class="fd-menu__title"> {{ selectedLanguage.name }} </span>\n                </a>\n            </li>\n            <ng-container *ngFor="let language of items">\n                <li\n                    *ngIf="selectedLanguage.isoCode !== language.value.isoCode"\n                    class="fd-menu__item">\n                    <a\n                        class="yToolbarActions__dropdown-element se-language-selector__element fd-menu__link"\n                        (click)="onSelectedLanguage(language)">\n                        <span class="fd-menu__title"> {{ language.value.name }} </span>\n                    </a>\n                </li>\n            </ng-container>\n        </ul>\n    `}),__metadata("design:paramtypes",[t.LanguageService,t.CrossFrameEventService,a.LogService])],t.HeaderLanguageDropdownComponent);window.__smartedit__.addDecoratorPayload("Component","ConfirmDialogComponent",{selector:"se-confirm-dialog",template:`<ng-container *ngIf="config"><se-message *ngIf="config.message" [type]="config.message.type" [messageId]="config.message.id"><ng-container se-message-description><span [translate]="config.message.text"></span></ng-container></se-message><div id="confirmationModalDescription" [ngClass]="{ 'fd-has-margin-top-small' : config.message }" [translate]="config.description" [translateParams]="config.descriptionPlaceholders"></div></ng-container>`});t.ConfirmDialogComponent=class ConfirmDialogComponent{constructor(e){this.modalManager=e}ngOnInit(){this.modalManager.getModalData().pipe(_.take(1)).subscribe((e=>this.config=e))}};t.ConfirmDialogComponent=__decorate([o.Component({selector:"se-confirm-dialog",template:`<ng-container *ngIf="config"><se-message *ngIf="config.message" [type]="config.message.type" [messageId]="config.message.id"><ng-container se-message-description><span [translate]="config.message.text"></span></ng-container></se-message><div id="confirmationModalDescription" [ngClass]="{ 'fd-has-margin-top-small' : config.message }" [translate]="config.description" [translateParams]="config.descriptionPlaceholders"></div></ng-container>`}),__metadata("design:paramtypes",[a.ModalManagerService])],t.ConfirmDialogComponent);t.ConfirmDialogModule=class ConfirmDialogModule{};t.ConfirmDialogModule=__decorate([o.NgModule({imports:[u.CommonModule,a.TranslationModule.forChild(),t.MessageModule],declarations:[t.ConfirmDialogComponent],entryComponents:[t.ConfirmDialogComponent]})],t.ConfirmDialogModule);const Oo=new o.InjectionToken("CLIENT_PAGED_LIST_CELL_COMPONENT_DATA_TOKEN");window.__smartedit__.addDecoratorPayload("Component","ClientPagedListCellComponent",{selector:"se-client-paged-list-cell",changeDetection:o.ChangeDetectionStrategy.OnPush,template:`<ng-container *ngIf="key.component; else cellText"><ng-container *ngComponentOutlet="key.component; injector: componentInjector"></ng-container></ng-container><ng-template #cellText><span>{{ item[key.property] }}</span></ng-template>`});let Po=class ClientPagedListCellComponent{constructor(e){this.injector=e}ngOnInit(){this.createComponentInjector()}createComponentInjector(){this.componentInjector=o.Injector.create({parent:this.injector,providers:[{provide:Oo,useValue:{item:this.item,key:this.key}}]})}};__decorate([o.Input(),__metadata("design:type",Object)],Po.prototype,"item",void 0);__decorate([o.Input(),__metadata("design:type",Object)],Po.prototype,"key",void 0);Po=__decorate([o.Component({selector:"se-client-paged-list-cell",changeDetection:o.ChangeDetectionStrategy.OnPush,template:`<ng-container *ngIf="key.component; else cellText"><ng-container *ngComponentOutlet="key.component; injector: componentInjector"></ng-container></ng-container><ng-template #cellText><span>{{ item[key.property] }}</span></ng-template>`}),__metadata("design:paramtypes",[o.Injector])],Po);window.__smartedit__.addDecoratorPayload("Component","ClientPagedListComponent",{selector:"se-client-paged-list",changeDetection:o.ChangeDetectionStrategy.OnPush,providers:[t.FilterByFieldPipe,t.StartFromPipe,u.SlicePipe],template:`<div class="fluid-container se-paged-list-result"><p class="se-page-list__page-count" *ngIf="displayCount"><span>({{ totalItems }} {{ 'se.pagelist.countsearchresult' | translate }})</span></p><table class="se-paged-list-table table table-striped table-hover fd-table"><thead><tr><th *ngFor="let key of keys; trackBy: keysTrackBy" (click)="onOrderByColumn(key.property)" [ngStyle]="{ 'width': columnWidth + '%' }" class="se-paged-list__header" [ngClass]="'se-paged-list__header-' + key.property"><ng-container *ngIf="key.i18n">{{ key.i18n | translate }} <span class="header-icon" [hidden]="visibleSortingHeader !== key.property" [ngClass]="{\n                          'sap-icon--navigation-down-arrow': headersSortingState[key.property],\n                          'sap-icon--navigation-up-arrow': !headersSortingState[key.property]\n                      }"></span></ng-container></th><th class="se-paged-list__header"></th><th class="se-paged-list__header" *ngIf="dropdownItems"></th></tr></thead><tbody class="se-paged-list__table-body"><tr *ngFor="let item of filteredItems" class="se-paged-list-item"><td *ngFor="let key of keys" [ngClass]="'se-paged-list-item-' + key.property"><se-client-paged-list-cell [item]="item" [key]="key"></se-client-paged-list-cell></td><td><se-tooltip *ngIf="item.icon" [triggers]="['mouseenter', 'mouseleave']" [placement]="'bottom'" [title]="'se.icon.tooltip.visibility' | translate: { numberOfRestrictions: item.icon.numberOfRestrictions }" [isChevronVisible]="true"><img [src]="item.icon.src" se-tooltip-trigger/></se-tooltip></td><ng-container *ngIf="dropdownItems"><td *seHasOperationPermission="'se.edit.page'" class="paged-list-table__body__td paged-list-table__body__td-menu"><se-dropdown-menu [dropdownItems]="dropdownItems" [selectedItem]="item" class="pull-right"></se-dropdown-menu></td></ng-container></tr></tbody></table><div class="pagination-container"><se-pagination [totalItems]="totalItems < itemsPerPage ? itemsPerPage : totalItems" [itemsPerPage]="itemsPerPage" (onChange)="onCurrentPageChange($event)" [currentPage]="currentPage"></se-pagination></div></div>`});let wo=class ClientPagedListComponent{constructor(e,t,n,i){this.cdr=e;this.filterByFieldPipe=t;this.startFromPipe=n;this.slicePipe=i;this.reversed=false;this.displayCount=false;this.totalItems=0;this.currentPage=1;this.headersSortingState={}}ngOnChanges(e){if(e.items||e.query||e.itemFilterKeys||e.itemsPerPage){if(e.query){this.currentPage=1}this.filteredItems=this.filterItems();this.totalItems=e.query&&e.query.currentValue?this.filteredItems.length:this.items.length}if(e.keys){this.columnWidth=100/(this.keys.length||1)}if(e.reversed){this.columnToggleReversed=this.reversed}if(e.sortBy){this.headersSortingState=Object.assign(Object.assign({},this.headersSortingState),{[this.sortBy]:this.columnToggleReversed});this.visibleSortingHeader=this.sortBy;this.items=ln.sortBy(this.items,this.sortBy,this.columnToggleReversed);this.filteredItems=this.filterItems()}}keysTrackBy(e,t){return t.property}onOrderByColumn(e){this.columnToggleReversed=!this.columnToggleReversed;this.headersSortingState[e]=this.columnToggleReversed;this.visibleSortingHeader=e;this.items=ln.sortBy(this.items,e,this.columnToggleReversed);this.filteredItems=this.filterItems();if(!this.cdr.destroyed){this.cdr.detectChanges()}}onCurrentPageChange(e){this.currentPage=e;this.filteredItems=this.filterItems();if(!this.cdr.destroyed){this.cdr.detectChanges()}}filterItems(){const e=this.itemFilterKeys||[];const t=this.filterByFieldPipe.transform(this.items,this.query,e);const n=(this.currentPage-1)*this.itemsPerPage;const i=this.startFromPipe.transform(t,n);const o=this.slicePipe.transform(i,0,this.itemsPerPage);return o}};__decorate([o.Input(),__metadata("design:type",Array)],wo.prototype,"items",void 0);__decorate([o.Input(),__metadata("design:type",Array)],wo.prototype,"itemFilterKeys",void 0);__decorate([o.Input(),__metadata("design:type",Array)],wo.prototype,"keys",void 0);__decorate([o.Input(),__metadata("design:type",Number)],wo.prototype,"itemsPerPage",void 0);__decorate([o.Input(),__metadata("design:type",String)],wo.prototype,"sortBy",void 0);__decorate([o.Input(),__metadata("design:type",Object)],wo.prototype,"reversed",void 0);__decorate([o.Input(),__metadata("design:type",String)],wo.prototype,"query",void 0);__decorate([o.Input(),__metadata("design:type",Object)],wo.prototype,"displayCount",void 0);__decorate([o.Input(),__metadata("design:type",Array)],wo.prototype,"dropdownItems",void 0);wo=__decorate([o.Component({selector:"se-client-paged-list",changeDetection:o.ChangeDetectionStrategy.OnPush,providers:[t.FilterByFieldPipe,t.StartFromPipe,u.SlicePipe],template:`<div class="fluid-container se-paged-list-result"><p class="se-page-list__page-count" *ngIf="displayCount"><span>({{ totalItems }} {{ 'se.pagelist.countsearchresult' | translate }})</span></p><table class="se-paged-list-table table table-striped table-hover fd-table"><thead><tr><th *ngFor="let key of keys; trackBy: keysTrackBy" (click)="onOrderByColumn(key.property)" [ngStyle]="{ 'width': columnWidth + '%' }" class="se-paged-list__header" [ngClass]="'se-paged-list__header-' + key.property"><ng-container *ngIf="key.i18n">{{ key.i18n | translate }} <span class="header-icon" [hidden]="visibleSortingHeader !== key.property" [ngClass]="{\n                          'sap-icon--navigation-down-arrow': headersSortingState[key.property],\n                          'sap-icon--navigation-up-arrow': !headersSortingState[key.property]\n                      }"></span></ng-container></th><th class="se-paged-list__header"></th><th class="se-paged-list__header" *ngIf="dropdownItems"></th></tr></thead><tbody class="se-paged-list__table-body"><tr *ngFor="let item of filteredItems" class="se-paged-list-item"><td *ngFor="let key of keys" [ngClass]="'se-paged-list-item-' + key.property"><se-client-paged-list-cell [item]="item" [key]="key"></se-client-paged-list-cell></td><td><se-tooltip *ngIf="item.icon" [triggers]="['mouseenter', 'mouseleave']" [placement]="'bottom'" [title]="'se.icon.tooltip.visibility' | translate: { numberOfRestrictions: item.icon.numberOfRestrictions }" [isChevronVisible]="true"><img [src]="item.icon.src" se-tooltip-trigger/></se-tooltip></td><ng-container *ngIf="dropdownItems"><td *seHasOperationPermission="'se.edit.page'" class="paged-list-table__body__td paged-list-table__body__td-menu"><se-dropdown-menu [dropdownItems]="dropdownItems" [selectedItem]="item" class="pull-right"></se-dropdown-menu></td></ng-container></tr></tbody></table><div class="pagination-container"><se-pagination [totalItems]="totalItems < itemsPerPage ? itemsPerPage : totalItems" [itemsPerPage]="itemsPerPage" (onChange)="onCurrentPageChange($event)" [currentPage]="currentPage"></se-pagination></div></div>`}),__metadata("design:paramtypes",[o.ChangeDetectorRef,t.FilterByFieldPipe,t.StartFromPipe,u.SlicePipe])],wo);t.ClientPagedListModule=class ClientPagedListModule{};t.ClientPagedListModule=__decorate([o.NgModule({imports:[u.CommonModule,t.PaginationModule,t.FundamentalsModule,t.TooltipModule,t.DropdownMenuModule,t.HasOperationPermissionDirectiveModule,t.FilterByFieldPipeModule,t.StartFromPipeModule,a.TranslationModule.forChild()],entryComponents:[wo],declarations:[wo,Po],exports:[wo]})],t.ClientPagedListModule);const Ao=new o.InjectionToken("MEDIA_FILE_SELECTOR_CUSTOM_TOKEN");const Ro=new o.InjectionToken("MEDIA_FILE_SELECTOR_CUSTOM_INJECTOR_TOKEN");const Do={UPLOAD:"se.media.format.upload",REPLACE:"se.media.format.replace",UNDER_EDIT:"se.media.format.under.edit",REMOVE:"se.media.format.remove"};const Mo=new o.InjectionToken("MEDIA_SELECTOR_I18N_KEY_TOKEN");const No=new o.InjectionToken("MEDIA_UPLOAD_FIELDS_CUSTOM_TOKEN");const xo=new o.InjectionToken("MEDIA_ADVANCED_PROPERTIES_CUSTOM_TOKEN");let Fo=class ExperienceInterceptor{constructor(e,t,n){this.sharedDataService=e;this.stringUtils=t;this.httpUtils=n}intercept(e,t){if(!Te.test(e.url)){return t.handle(e)}return p.from(this.sharedDataService.get(zt)).pipe(_.switchMap((n=>{if(!n){return t.handle(e)}const i={};i.CONTEXT_SITE_ID_WITH_COLON=n.siteDescriptor.uid;i.CONTEXT_CATALOG_VERSION_WITH_COLON=n.catalogDescriptor.catalogVersion;i.CONTEXT_CATALOG_WITH_COLON=n.catalogDescriptor.catalogId;i[se]=n.siteDescriptor.uid;i[oe]=n.catalogDescriptor.catalogVersion;i[ie]=n.catalogDescriptor.catalogId;i[le]=n.pageContext?n.pageContext.siteId:n.siteDescriptor.uid;i[ae]=n.pageContext?n.pageContext.catalogVersion:n.catalogDescriptor.catalogVersion;i[re]=n.pageContext?n.pageContext.catalogId:n.catalogDescriptor.catalogId;const o=e.clone({url:this.stringUtils.replaceAll(e.url,i),params:e.params&&typeof e.params==="object"?this.httpUtils.transformHttpParams(e.params,i):e.params});return t.handle(o)})))}};Fo=__decorate([o.Injectable(),__metadata("design:paramtypes",[a.ISharedDataService,a.StringUtils,a.HttpUtils])],Fo);t.SmarteditConstantsModule=class SmarteditConstantsModule{};t.SmarteditConstantsModule=__decorate([o.NgModule({providers:[{provide:un,useValue:ne},{provide:mn,useValue:xt}]})],t.SmarteditConstantsModule);const Lo=new o.InjectionToken("gatewayProxiedAnnotationFactoryToKen");const Uo=new o.InjectionToken("cachedAnnotationFactoryToken");const ko=new o.InjectionToken("cacheConfigAnnotationFactoryToken");const Vo=new o.InjectionToken("invalidateCacheAnnotationFactoryToken");const jo=new o.InjectionToken("operationContextAnnotationFactoryToken");t.SmarteditCommonsModule=class SmarteditCommonsModule{};t.SmarteditCommonsModule=__decorate([o.NgModule({imports:[t.FundamentalsModule,N.LocationUpgradeModule.config(),t.YjqueryModule,t.SeGenericEditorModule,t.WizardModule,t.SmarteditConstantsModule],providers:[t.SmarteditBootstrapGateway,t.LanguageServiceGateway,t.LanguageService,{provide:a.LANGUAGE_SERVICE,useClass:t.LanguageService},{provide:ISlotRestrictionsService,useClass:t.SlotRestrictionsService},{provide:IEditorModalService,useClass:t.EditorModalService},{provide:IPageInfoService,useClass:PageInfoService},{provide:IFileValidation,useClass:t.FileValidationService},{provide:IMediaToUpload,useClass:t.MediaUploaderService},{provide:IMediaService,useClass:t.MediaService},t.TimerService,t.DiscardablePromiseUtils,G.provideValues({SSO_LOGOUT_ENTRY_POINT:Ie,SSO_AUTHENTICATION_ENTRY_POINT:fe,SSO_OAUTH2_AUTHENTICATION_ENTRY_POINT:Ee,SMARTEDIT_RESOURCE_URI_REGEXP:Oe,SMARTEDIT_ROOT:Pe,SMARTEDIT_INNER_FILES:Lt,SMARTEDIT_INNER_FILES_POST:Ut,[a.OPERATION_CONTEXT_TOKEN]:ve,[a.WHO_AM_I_RESOURCE_URI_TOKEN]:ye,[a.I18N_RESOURCE_URI_TOKEN]:Se}),{provide:c.HTTP_INTERCEPTORS,useClass:Fo,multi:true},{provide:ISyncPollingService,useClass:t.SyncPollingService},{provide:a.IModalService,useClass:a.ModalService},{provide:a.ISettingsService,useClass:t.SettingsService},t.SliderPanelServiceFactory,a.LogService,a.BrowserService,a.FingerPrintingService,a.CacheEngine,a.CacheService,a.CloneableUtils,t.CrossFrameEventService,{provide:a.LoginDialogResourceProvider,useValue:Ne},{provide:a.LANGUAGE_SERVICE_CONSTANTS,useValue:{LANGUAGE_RESOURCE_URI:st,I18N_LANGUAGES_RESOURCE_URI:rt}},{provide:a.EVENT_SERVICE,useFactory:e=>e,deps:[t.CrossFrameEventService]},{provide:t.CrossFrameEventServiceGateway.crossFrameEventServiceGatewayToken,useClass:t.CrossFrameEventServiceGateway},a.OperationContextService,a.BooleanUtils,a.CryptographicUtils,a.FunctionsUtils,a.HttpUtils,NodeUtils,a.PromiseUtils,t.JQueryUtilsService,{provide:a.StringUtils,useClass:StringUtils},StringUtils,a.UrlUtils,{provide:a.WindowUtils,useClass:t.WindowUtils},t.WindowUtils,t.SystemEventService,t.PriorityService,t.GatewayFactory,t.GatewayProxy,t.InterceptorHelper,{provide:Lo,useFactory:GatewayProxiedAnnotationFactory,deps:[t.GatewayProxy]},{provide:Uo,useFactory:a.CachedAnnotationFactory,deps:[a.CacheService]},{provide:ko,useFactory:a.CacheConfigAnnotationFactory,deps:[a.LogService]},{provide:Vo,useFactory:a.InvalidateCacheAnnotationFactory,deps:[a.CacheService]},{provide:jo,useFactory:a.OperationContextAnnotationFactory,deps:[o.Injector,a.OperationContextService,a.OPERATION_CONTEXT_TOKEN]},a.RestServiceFactory,t.PermissionsRestService,t.AuthorizationService,a.FileMimeTypeService,a.FileReaderService,a.FileValidatorFactory,a.ModalService,t.WorkflowService,t.WorkflowTasksPollingService,t.CmsitemsRestService,t.PageVersioningService,t.PageVersionSelectionService,t.CMSModesService,t.PageContentSlotsService,t.SlotSharedService,t.ComponentMenuService,{provide:"seFileValidationServiceConstants",useValue:ci},G.initialize(((e,t,n,i,o)=>{}),[Lo,Uo,ko,Vo,jo]),G.bootstrap(((e,t,n,i,o)=>{e.register(a.booleanUtils.areAllTruthy(operationContextInteractivePredicate,a.retriableErrorPredicate),t).register(a.booleanUtils.areAllTruthy(operationContextNonInteractivePredicate,a.retriableErrorPredicate),n).register(a.booleanUtils.areAllTruthy(operationContextCMSPredicate,a.timeoutErrorPredicate,a.updatePredicate),n).register(a.booleanUtils.areAllTruthy(operationContextToolingPredicate,a.timeoutErrorPredicate,a.updatePredicate),i);o.register(st,ve.TOOLING)}),[a.RetryInterceptor,a.DefaultRetryStrategy,a.ExponentialRetryStrategy,a.LinearRetryStrategy,a.OperationContextService,a.LogService])]})],t.SmarteditCommonsModule);Object.defineProperty(t,"ALERT_CONFIG_DEFAULTS",{enumerable:true,get:function(){return a.ALERT_CONFIG_DEFAULTS}});Object.defineProperty(t,"ALERT_CONFIG_DEFAULTS_TOKEN",{enumerable:true,get:function(){return a.ALERT_CONFIG_DEFAULTS_TOKEN}});Object.defineProperty(t,"AbstractCachedRestService",{enumerable:true,get:function(){return a.AbstractCachedRestService}});Object.defineProperty(t,"Alert",{enumerable:true,get:function(){return a.Alert}});Object.defineProperty(t,"AlertModule",{enumerable:true,get:function(){return a.AlertModule}});Object.defineProperty(t,"AuthenticationService",{enumerable:true,get:function(){return a.AuthenticationService}});Object.defineProperty(t,"BaseAlertFactory",{enumerable:true,get:function(){return a.AlertFactory}});Object.defineProperty(t,"BaseAlertService",{enumerable:true,get:function(){return a.AlertService}});Object.defineProperty(t,"BrowserService",{enumerable:true,get:function(){return a.BrowserService}});Object.defineProperty(t,"CacheAction",{enumerable:true,get:function(){return a.CacheAction}});Object.defineProperty(t,"CacheConfig",{enumerable:true,get:function(){return a.CacheConfig}});Object.defineProperty(t,"CacheConfigAnnotationFactory",{enumerable:true,get:function(){return a.CacheConfigAnnotationFactory}});Object.defineProperty(t,"CacheService",{enumerable:true,get:function(){return a.CacheService}});Object.defineProperty(t,"Cached",{enumerable:true,get:function(){return a.Cached}});Object.defineProperty(t,"CachedAnnotationFactory",{enumerable:true,get:function(){return a.CachedAnnotationFactory}});Object.defineProperty(t,"CloneableUtils",{enumerable:true,get:function(){return a.CloneableUtils}});Object.defineProperty(t,"CryptographicUtils",{enumerable:true,get:function(){return a.CryptographicUtils}});Object.defineProperty(t,"DEFAULT_AUTHENTICATION_ENTRY_POINT",{enumerable:true,get:function(){return a.DEFAULT_AUTHENTICATION_ENTRY_POINT}});Object.defineProperty(t,"DEFAULT_AUTH_MAP",{enumerable:true,get:function(){return a.DEFAULT_AUTH_MAP}});Object.defineProperty(t,"DEFAULT_CREDENTIALS_MAP",{enumerable:true,get:function(){return a.DEFAULT_CREDENTIALS_MAP}});Object.defineProperty(t,"DEFAULT_LANGUAGE_ISO",{enumerable:true,get:function(){return a.DEFAULT_LANGUAGE_ISO}});Object.defineProperty(t,"EVENTS",{enumerable:true,get:function(){return a.EVENTS}});Object.defineProperty(t,"EVENT_SERVICE",{enumerable:true,get:function(){return a.EVENT_SERVICE}});Object.defineProperty(t,"EvictionTag",{enumerable:true,get:function(){return a.EvictionTag}});Object.defineProperty(t,"FileMimeTypeService",{enumerable:true,get:function(){return a.FileMimeTypeService}});Object.defineProperty(t,"FileReaderService",{enumerable:true,get:function(){return a.FileReaderService}});Object.defineProperty(t,"FileValidatorFactory",{enumerable:true,get:function(){return a.FileValidatorFactory}});Object.defineProperty(t,"FingerPrintingService",{enumerable:true,get:function(){return a.FingerPrintingService}});Object.defineProperty(t,"FunctionsUtils",{enumerable:true,get:function(){return a.FunctionsUtils}});Object.defineProperty(t,"FundamentalModalTemplateModule",{enumerable:true,get:function(){return a.FundamentalModalTemplateModule}});Object.defineProperty(t,"HttpBackendService",{enumerable:true,get:function(){return a.HttpBackendService}});Object.defineProperty(t,"HttpErrorInterceptorService",{enumerable:true,get:function(){return a.HttpErrorInterceptorService}});Object.defineProperty(t,"HttpInterceptorModule",{enumerable:true,get:function(){return a.HttpInterceptorModule}});Object.defineProperty(t,"HttpUtils",{enumerable:true,get:function(){return a.HttpUtils}});Object.defineProperty(t,"I18N_RESOURCE_URI_TOKEN",{enumerable:true,get:function(){return a.I18N_RESOURCE_URI_TOKEN}});Object.defineProperty(t,"I18N_ROOT_RESOURCE_URI",{enumerable:true,get:function(){return a.I18N_ROOT_RESOURCE_URI}});Object.defineProperty(t,"IAlertService",{enumerable:true,get:function(){return a.IAlertService}});Object.defineProperty(t,"IAlertServiceType",{enumerable:true,get:function(){return a.IAlertServiceType}});Object.defineProperty(t,"IAuthenticationManagerService",{enumerable:true,get:function(){return a.IAuthenticationManagerService}});Object.defineProperty(t,"IAuthenticationService",{enumerable:true,get:function(){return a.IAuthenticationService}});Object.defineProperty(t,"IBrowserService",{enumerable:true,get:function(){return a.BrowserService}});Object.defineProperty(t,"IModalService",{enumerable:true,get:function(){return a.IModalService}});Object.defineProperty(t,"ISessionService",{enumerable:true,get:function(){return a.ISessionService}});Object.defineProperty(t,"ISettingsService",{enumerable:true,get:function(){return a.ISettingsService}});Object.defineProperty(t,"ISharedDataService",{enumerable:true,get:function(){return a.ISharedDataService}});Object.defineProperty(t,"IStorageService",{enumerable:true,get:function(){return a.IStorageService}});Object.defineProperty(t,"ITranslationsFetchService",{enumerable:true,get:function(){return a.ITranslationsFetchService}});Object.defineProperty(t,"InvalidateCache",{enumerable:true,get:function(){return a.InvalidateCache}});Object.defineProperty(t,"InvalidateCacheAnnotationFactory",{enumerable:true,get:function(){return a.InvalidateCacheAnnotationFactory}});Object.defineProperty(t,"LANDING_PAGE_PATH",{enumerable:true,get:function(){return a.LANDING_PAGE_PATH}});Object.defineProperty(t,"LogService",{enumerable:true,get:function(){return a.LogService}});Object.defineProperty(t,"ModalButtonAction",{enumerable:true,get:function(){return a.ModalButtonAction}});Object.defineProperty(t,"ModalButtonStyle",{enumerable:true,get:function(){return a.ModalButtonStyle}});Object.defineProperty(t,"ModalManagerService",{enumerable:true,get:function(){return a.ModalManagerService}});Object.defineProperty(t,"ModalService",{enumerable:true,get:function(){return a.ModalService}});Object.defineProperty(t,"OPERATION_CONTEXT_TOKEN",{enumerable:true,get:function(){return a.OPERATION_CONTEXT_TOKEN}});Object.defineProperty(t,"OperationContextAnnotationFactory",{enumerable:true,get:function(){return a.OperationContextAnnotationFactory}});Object.defineProperty(t,"OperationContextRegistered",{enumerable:true,get:function(){return a.OperationContextRegistered}});Object.defineProperty(t,"OperationContextService",{enumerable:true,get:function(){return a.OperationContextService}});Object.defineProperty(t,"ParentWindowUtils",{enumerable:true,get:function(){return a.WindowUtils}});Object.defineProperty(t,"PermissionErrorInterceptor",{enumerable:true,get:function(){return a.PermissionErrorInterceptor}});Object.defineProperty(t,"PromiseUtils",{enumerable:true,get:function(){return a.PromiseUtils}});Object.defineProperty(t,"ResponseAdapterInterceptor",{enumerable:true,get:function(){return a.ResponseAdapterInterceptor}});Object.defineProperty(t,"RestServiceFactory",{enumerable:true,get:function(){return a.RestServiceFactory}});Object.defineProperty(t,"RetryInterceptor",{enumerable:true,get:function(){return a.RetryInterceptor}});Object.defineProperty(t,"SELECTED_LANGUAGE",{enumerable:true,get:function(){return a.SELECTED_LANGUAGE}});Object.defineProperty(t,"SSOAuthenticationHelper",{enumerable:true,get:function(){return a.SSOAuthenticationHelper}});Object.defineProperty(t,"SWITCH_LANGUAGE_EVENT",{enumerable:true,get:function(){return a.SWITCH_LANGUAGE_EVENT}});Object.defineProperty(t,"SeTranslationModule",{enumerable:true,get:function(){return a.TranslationModule}});Object.defineProperty(t,"TranslationModule",{enumerable:true,get:function(){return a.TranslationModule}});Object.defineProperty(t,"URIBuilder",{enumerable:true,get:function(){return a.URIBuilder}});Object.defineProperty(t,"UnauthorizedErrorInterceptor",{enumerable:true,get:function(){return a.UnauthorizedErrorInterceptor}});Object.defineProperty(t,"UrlUtils",{enumerable:true,get:function(){return a.UrlUtils}});Object.defineProperty(t,"WHO_AM_I_RESOURCE_URI_TOKEN",{enumerable:true,get:function(){return a.WHO_AM_I_RESOURCE_URI_TOKEN}});Object.defineProperty(t,"annotationService",{enumerable:true,get:function(){return a.annotationService}});Object.defineProperty(t,"booleanUtils",{enumerable:true,get:function(){return a.booleanUtils}});Object.defineProperty(t,"commonNgZone",{enumerable:true,get:function(){return a.commonNgZone}});Object.defineProperty(t,"functionsUtils",{enumerable:true,get:function(){return a.functionsUtils}});Object.defineProperty(t,"httpUtils",{enumerable:true,get:function(){return a.httpUtils}});Object.defineProperty(t,"promiseUtils",{enumerable:true,get:function(){return a.promiseUtils}});Object.defineProperty(t,"urlUtils",{enumerable:true,get:function(){return a.urlUtils}});t.ALL_ACTIVE_THEMES_URI=sn;t.ALL_PERSPECTIVE=Ot;t.ANNOUNCEMENT_DATA=gn;t.AbstractDecorator=AbstractDecorator;t.ApiUtils=ApiUtils;t.CATALOG_DETAILS_COLUMNS=vt;t.CATALOG_DETAILS_ITEM_DATA=Qn;t.CATALOG_VERSION_PERMISSIONS_RESOURCE_URI_CONSTANT=_e;t.CATALOG_VERSION_UUID_ATTRIBUTE=Ke;t.CLICK_DROPDOWN=mt;t.CLICK_DROPDOWN_TOKEN=Ki;t.CLIENT_PAGED_LIST_CELL_COMPONENT_DATA_TOKEN=Oo;t.CLOSE_CTX_MENU=me;t.CMSITEMS_UPDATE_EVENT=Wt;t.CMSWEBSERVICES_PATH=Te;t.CMS_EVENT_OPEN_PAGE_WORKFLOW_MENU=Gt;t.COLLAPSIBLE_DEFAULT_CONFIGURATION=pi;t.COMPONENT_CLASS=qe;t.CONFIGURATION_URI=we;t.CONTAINER_ID_ATTRIBUTE=Ye;t.CONTAINER_TYPE_ATTRIBUTE=ot;t.CONTENT_SLOT_TYPE=it;t.CONTEXTUAL_MENU_ITEM_DATA=z;t.CONTEXT_CATALOG=ie;t.CONTEXT_CATALOG_VERSION=oe;t.CONTEXT_SITE_ID=se;t.CONTRACT_CHANGE_LISTENER_COMPONENT_PROCESS_STATUS=Qe;t.CONTRACT_CHANGE_LISTENER_PROCESS_EVENTS=Ze;t.CSS_CLASSNAMES=Ti;t.CTX_MENU_DROPDOWN_IS_OPEN=he;t.CURRENT_USER_THEME_URI=on;t.CustomDropdownPopulatorsToken=qi;t.CustomHandlingStrategy=CustomHandlingStrategy;t.DATA_TABLE_COMPONENT_DATA=hi;t.DATE_CONSTANTS=_t;t.DEFAULT_AUTHENTICATION_CLIENT_ID=Ce;t.DEFAULT_GENERIC_EDITOR_FLOAT_PRECISION=lo;t.DEFAULT_LANGUAGE=ue;t.DINameUtils=DINameUtils;t.DOMAIN_TOKEN=$;t.DO_NOT_USE_STORAGE_MANAGER_TOKEN=Yn;t.DRAG_AND_DROP_CROSS_ORIGIN_BEFORE_TIME=Mt;t.DROPDOWN_IMPLEMENTATION_SUFFIX=pt;t.DROPDOWN_IMPLEMENTATION_SUFFIX_TOKEN=$i;t.DROPDOWN_MENU_ITEM_DATA=di;t.DROPDOWN_POPULATOR=ht;t.DateUtils=DateUtils;t.DropdownPopulatorInterface=DropdownPopulatorInterface;t.ELEMENT_UUID_ATTRIBUTE=Q;t.ENUM_RESOURCE_URI=dt;t.EVENT_CONTENT_CATALOG_UPDATE=Ft;t.EVENT_INNER_FRAME_CLICKED=$e;t.EVENT_NOTIFICATION_CHANGED=Re;t.EVENT_OPEN_IN_PAGE_TREE=Qt;t.EVENT_OUTER_FRAME_CLICKED=We;t.EVENT_OVERALL_REFRESH_TREE_NODE=Xt;t.EVENT_PAGE_TREE_COMPONENT_SELECTED=Yt;t.EVENT_PAGE_TREE_PANEL_SWITCH=Kt;t.EVENT_PAGE_TREE_SLOT_NEED_UPDATE=Jt;t.EVENT_PAGE_TREE_SLOT_SELECTED=qt;t.EVENT_PART_REFRESH_TREE_NODE=Zt;t.EVENT_PERSPECTIVE_ADDED=Ue;t.EVENT_PERSPECTIVE_CHANGED=xe;t.EVENT_PERSPECTIVE_REFRESHED=Le;t.EVENT_PERSPECTIVE_UNLOADING=Fe;t.EVENT_PERSPECTIVE_UPDATED=ke;t.EVENT_SMARTEDIT_COMPONENT_UPDATED=He;t.EVENT_STRICT_PREVIEW_MODE_REQUESTED=ze;t.EVENT_THEME_CHANGED=je;t.EVENT_THEME_SAVED=Ve;t.EXPERIENCE_STORAGE_KEY=zt;t.EXTENDED_VIEW_PORT_MARGIN=ne;t.EXTENDED_VIEW_PORT_MARGIN_TOKEN=un;t.EditableListNodeItem=EditableListNodeItem;t.FILE_VALIDATION_CONFIG=ci;t.FrequentlyChangingContentName=fn;t.GENERIC_EDITOR_LOADED_EVENT=at;t.GENERIC_EDITOR_UNRELATED_VALIDATION_MESSAGES_EVENT=lt;t.GENERIC_EDITOR_WIDGET_DATA=Li;t.GatewayProxied=Vn;t.GatewayProxiedAnnotationFactory=GatewayProxiedAnnotationFactory;t.GenericEditorDropdownServiceFactory=GenericEditorDropdownServiceFactory;t.GenericEditorUtil=GenericEditorUtil;t.HEART_BEAT_TIMEOUT_THRESHOLD_MS=xt;t.HEART_BEAT_TIMEOUT_THRESHOLD_MS_TOKEN=mn;t.HIDE_SLOT_MENU=de;t.HIDE_TOOLBAR_ITEM_CONTEXT=Et;t.HasOperationPermissionBaseDirective=HasOperationPermissionBaseDirective;t.I18N_LANGUAGES_RESOURCE_URI=rt;t.I18N_RESOURCE_URI=Se;t.IAnnouncementService=IAnnouncementService;t.ICatalogDetailsService=ICatalogDetailsService;t.ICatalogService=ICatalogService;t.ICatalogVersionPermissionService=ICatalogVersionPermissionService;t.IConfirmationModalService=IConfirmationModalService;t.IContextualMenuService=IContextualMenuService;t.ID_ATTRIBUTE=Z;t.IDecoratorService=IDecoratorService;t.IDragAndDropCrossOrigin=IDragAndDropCrossOrigin;t.IDragEventType=Kn;t.IEditorModalService=IEditorModalService;t.IExperienceService=IExperienceService;t.IFeatureService=IFeatureService;t.IFileValidation=IFileValidation;t.IGenericEditorDropdownServiceConstructor=IGenericEditorDropdownServiceConstructor;t.IIframeClickDetectionService=IIframeClickDetectionService;t.IMediaService=IMediaService;t.IMediaToUpload=IMediaToUpload;t.INotificationMouseLeaveDetectionService=INotificationMouseLeaveDetectionService;t.INotificationService=INotificationService;t.IPageInfoService=IPageInfoService;t.IPageService=IPageService;t.IPageTreeNodeService=IPageTreeNodeService;t.IPageTreeService=IPageTreeService;t.IPermissionService=IPermissionService;t.IPerspectiveService=IPerspectiveService;t.IPositionRegistry=IPositionRegistry;t.IPreviewService=IPreviewService;t.IRenderService=IRenderService;t.IResizeListener=IResizeListener;t.IRestServiceFactory=IRestServiceFactory;t.ISlotRestrictionsService=ISlotRestrictionsService;t.ISmartEditContractChangeListener=ISmartEditContractChangeListener;t.IStorageGateway=IStorageGateway;t.IStorageManager=IStorageManager;t.IStorageManagerFactory=IStorageManagerFactory;t.IStorageManagerGateway=IStorageManagerGateway;t.IStoragePropertiesService=IStoragePropertiesService;t.ISyncPollingService=ISyncPollingService;t.ITEM_COMPONENT_DATA_TOKEN=Ai;t.IToolbarService=IToolbarService;t.IToolbarServiceFactory=IToolbarServiceFactory;t.IUrlService=IUrlService;t.IUserTrackingService=IUserTrackingService;t.IWaitDialogService=IWaitDialogService;t.LANGUAGE_RESOURCE_URI=st;t.LINKED_DROPDOWN=ut;t.LINKED_DROPDOWN_TOKEN=Wi;t.LOGOUT=te;t.MEDIAS_PATH=jt;t.MEDIA_ADVANCED_PROPERTIES_CUSTOM_TOKEN=xo;t.MEDIA_FILE_SELECTOR_CUSTOM_INJECTOR_TOKEN=Ro;t.MEDIA_FILE_SELECTOR_CUSTOM_TOKEN=Ao;t.MEDIA_FOLDER_PATH=Bt;t.MEDIA_PATH=Vt;t.MEDIA_RESOURCE_URI=kt;t.MEDIA_SELECTOR_I18N_KEY=Do;t.MEDIA_SELECTOR_I18N_KEY_TOKEN=Mo;t.MEDIA_UPLOAD_FIELDS_CUSTOM_TOKEN=No;t.MUTATION_TYPES=ge;t.MessageGateway=MessageGateway;t.NG_ROUTE_PREFIX=J;t.NG_ROUTE_WILDCARD=ee;t.NONE_PERSPECTIVE=Tt;t.NamespacedStorageManager=NamespacedStorageManager;t.NavigationNodeItem=NavigationNodeItem;t.NodeUtils=NodeUtils;t.OPEN_PAGE_WORKFLOW_MENU=Ht;t.OPERATION_CONTEXT=ve;t.OVERLAY_COMPONENT_CLASS=nt;t.OVERLAY_DISABLED_EVENT=pe;t.OVERLAY_ID=Ge;t.OVERLAY_RERENDERED_EVENT=Xe;t.ObjectUtils=ObjectUtils;t.PAGES_CONTENT_SLOT_RESOURCE_URI=$t;t.PAGE_CONTEXT_CATALOG=re;t.PAGE_CONTEXT_CATALOG_VERSION=ae;t.PAGE_CONTEXT_SITE_ID=le;t.PAGE_TREE_NODE_CLASS=nn;t.PAGE_TREE_PANEL_WIDTH_COOKIE_NAME=en;t.PAGE_TREE_SLOT_EXPANDED_EVENT=tn;t.PERSPECTIVE_SELECTOR_WIDGET_KEY=Be;t.POPUP_OVERLAY_DATA=Ii;t.PREVIEW_RESOURCE_URI=be;t.PREVIOUS_USERNAME_HASH=Me;t.PRODUCT_LIST_RESOURCE_API=ft;t.PRODUCT_RESOURCE_API=Ct;t.PageInfoService=PageInfoService;t.REFRESH_CONTEXTUAL_MENU_ITEMS_EVENT=De;t.RESOLVED_LOCALE_TO_CKEDITOR_LOCALE_MAP=oo;t.RICH_TEXT_CONFIGURATION=so;t.RarelyChangingContentName=In;t.RichTextLoaderService=RichTextLoaderService;t.SCROLL_AREA_CLASS=Rt;t.SEND_MOUSE_POSITION_THROTTLE=Pt;t.SETTINGS_URI=Ae;t.SHOW_SLOT_MENU=ce;t.SHOW_TOOLBAR_ITEM_CONTEXT=It;t.SITES_RESOURCE_URI=gt;t.SMARTEDITCONTAINER_COMPONENT_NAME=q;t.SMARTEDITLOADER_COMPONENT_NAME=K;t.SMARTEDIT_ATTRIBUTE_PREFIX=Je;t.SMARTEDIT_COMPONENT_NAME=Y;t.SMARTEDIT_COMPONENT_PROCESS_STATUS=et;t.SMARTEDIT_DRAG_AND_DROP_EVENTS=bt;t.SMARTEDIT_ELEMENT_HOVERED=At;t.SMARTEDIT_IFRAME_DRAG_AREA=Dt;t.SMARTEDIT_IFRAME_WRAPPER_ID=Nt;t.SMARTEDIT_INNER_FILES=Lt;t.SMARTEDIT_INNER_FILES_POST=Ut;t.SMARTEDIT_LOGIN_DIALOG_RESOURCES=Ne;t.SMARTEDIT_RESOURCE_URI_REGEXP=Oe;t.SMARTEDIT_ROOT=Pe;t.SSO_AUTHENTICATION_ENTRY_POINT=fe;t.SSO_LOGOUT_ENTRY_POINT=Ie;t.SSO_OAUTH2_AUTHENTICATION_ENTRY_POINT=Ee;t.STORAGE_PROPERTIES_TOKEN=qn;t.STORE_FRONT_CONTEXT=yt;t.ScriptUtils=ScriptUtils;t.SeCustomComponent=SeCustomComponent;t.SeEntryModule=SeEntryModule;t.SeRouteService=SeRouteService;t.SmarteditErrorHandler=SmarteditErrorHandler;t.StorageManagerFactory=StorageManagerFactory;t.StorageNamespaceConverter=StorageNamespaceConverter;t.StringUtils=StringUtils;t.TAB_DATA=ui;t.THROTTLE_SCROLLING_DELAY=wt;t.TOOLBAR_ITEM=Cn;t.TREE_NODE=yi;t.TYPES_RESOURCE_URI=St;t.TYPE_ATTRIBUTE=X;t.TextTruncateService=TextTruncateService;t.Timer=Timer;t.TreeDragAndDropEvent=TreeDragAndDropEvent;t.TreeNestedDataSource=TreeNestedDataSource;t.TreeNodeItem=TreeNodeItem;t.TruncatedText=TruncatedText;t.USER_TRACKING_FUNCTIONALITY=rn;t.USER_TRACKING_KEY_MAP=an;t.UUID_ATTRIBUTE=tt;t.VALIDATION_MESSAGE_TYPES=ct;t.WHO_AM_I_RESOURCE_URI=ye;t.WIZARD_API=vn;t.WIZARD_MANAGER=_n;t.WizardService=WizardService;t.YJQUERY_TOKEN=Bn;t.apiUtils=cn;t.authorizationEvictionTag=Tn;t.catalogEvictionTag=wn;t.catalogSyncedEvictionTag=Pn;t.cmsitemsEvictionTag=ei;t.cmsitemsUri=Jn;t.contentCatalogUpdateEvictionTag=Fn;t.dateUtils=dn;t.diNameUtils=V;t.frequentlyChangingContent=En;t.genericEditorDropdownComponentOnInit=genericEditorDropdownComponentOnInit;t.getLocalizedFilterFn=getLocalizedFilterFn;t.isBlankValidator=isBlankValidator;t.moduleUtils=G;t.nodeUtils=U;t.objectToArray=objectToArray;t.objectUtils=ln;t.operationContextCMSPredicate=operationContextCMSPredicate;t.operationContextInteractivePredicate=operationContextInteractivePredicate;t.operationContextNonInteractivePredicate=operationContextNonInteractivePredicate;t.operationContextToolingPredicate=operationContextToolingPredicate;t.pageChangeEvictionTag=Nn;t.pageCreationEvictionTag=An;t.pageDeletionEvictionTag=Rn;t.pageEvictionTag=xn;t.pageRestoredEvictionTag=Mn;t.pageUpdateEvictionTag=Dn;t.parseComponentSelector=parseComponentSelector;t.parseValidationMessage=parseValidationMessage;t.perspectiveChangedEvictionTag=Ln;t.rarelyChangingContent=bn;t.registerCustomComponents=registerCustomComponents;t.scriptUtils=pn;t.seCustomComponents=j;t.stringUtils=W;t.userEvictionTag=On;t.windowUtils=H;t.yjQueryServiceFactory=yjQueryServiceFactory},76527:(e,t,n)=>{var i=n(36092);var o=n(22630);if(!window.Zone){n(84509)}if(!window.smarteditJQuery&&i&&i.noConflict){window.smarteditJQuery=i.noConflict()}window.smarteditLodash=o.noConflict();n(45202)},76973:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=n(32709);var o=n(54526);var s=n(9501);var r=n(22630);var a=n(12549);var l=n(67564);var c=n(30178);var d=n(26404);var p=n(66791);function _interopNamespace(e){if(e&&e.__esModule)return e;var t=Object.create(null);if(e){Object.keys(e).forEach((function(n){if(n!=="default"){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:true,get:function(){return e[n]}})}}))}t["default"]=e;return Object.freeze(t)}var u=_interopNamespace(r);function __decorate(e,t,n,i){var o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s;return o>3&&s&&Object.defineProperty(t,n,s),s}function __param(e,t){return function(n,i){t(n,i,e)}}function __metadata(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}function __awaiter(e,t,n,i){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function fulfilled(e){try{step(i.next(e))}catch(e){o(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){o(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))}t.AnnouncementService=class AnnouncementService extends a.IAnnouncementService{};t.AnnouncementService=__decorate([a.GatewayProxied("showAnnouncement","closeAnnouncement")],t.AnnouncementService);t.CatalogService=class CatalogService extends a.ICatalogService{};t.CatalogService=__decorate([a.GatewayProxied()],t.CatalogService);t.ContextualMenuService=class ContextualMenuService{constructor(e,t){this.priorityService=e;this.systemEventService=t;this.onContextualMenuItemsAdded=new l.BehaviorSubject(null);this._contextualMenus={}}addItems(e){try{if(e!==undefined){this._featuresList=this._getFeaturesList(this._contextualMenus);const t=Object.keys(e);t.forEach((t=>this._initContextualMenuItems(e,t)))}}catch(e){throw new Error("addItems() - Cannot add items. "+e)}}removeItemByKey(e){Object.keys(this._contextualMenus).forEach((t=>{const n=this._contextualMenus[t];this._contextualMenus[t]=n.filter((t=>t.key!==e));if(this._contextualMenus[t].length===0){delete this._contextualMenus[t]}}))}containsItem(e){const t=Object.keys(this._contextualMenus).map((t=>{const n=this._contextualMenus[t];return n.findIndex((t=>t.key===e))>-1}));return t.findIndex((e=>e===true))>-1}getContextualMenuByType(e){let t=[];if(this._contextualMenus){Object.keys(this._contextualMenus).forEach((n=>{if(a.stringUtils.regExpFactory(n).test(e)){t=this._getUniqueItemArray(t,this._contextualMenus[n])}}))}return t}getContextualMenuItems(e){const{iLeftBtns:t}=e;delete e.iLeftBtns;const n=this.getContextualMenuByType(e.componentType);const i=n.map((t=>{if(!t.condition){return Promise.resolve(t)}const n=t.condition(e);return n instanceof Promise?n.then((e=>e?t:null)):Promise.resolve(n?t:null)}));return Promise.all(i).then((e=>{const n=[];const i=[];this.priorityService.sort(e.filter((e=>e!==null))).forEach((e=>{const o=n.length<t?n:i;o.push(e)}));return{leftMenuItems:n,moreMenuItems:i}}))}refreshMenuItems(){this.systemEventService.publishAsync(a.REFRESH_CONTEXTUAL_MENU_ITEMS_EVENT)}_getFeaturesList(e){const t=Object.keys(e).reduce(((t,n)=>[...t,...e[n].map((e=>e.key))]),[]);return t.reduce(((e,t)=>e.indexOf(t)<0?[...e,t]:[...e]),[])}_validateItem(e){if(!e.action){throw new Error("Contextual menu item must provide an action: "+JSON.stringify(e))}}_getUniqueItemArray(e,t){let n;t.forEach((t=>{n=t;if(e.every((e=>n.key!==e.key))){e.push(n)}}));return e}_initContextualMenuItems(e,t){const n=e[t].filter((e=>{this._validateItem(e);if(!e.key){throw new Error("Item doesn't have key.")}if(this._featuresList.indexOf(e.key)!==-1){throw new Error(`Item with that key (${e.key}) already exist.`)}return true}));this._contextualMenus[t]=a.objectUtils.uniqueArray(this._contextualMenus[t]||[],n);this.onContextualMenuItemsAdded.next(t)}};t.ContextualMenuService=__decorate([i.Injectable(),__metadata("design:paramtypes",[a.PriorityService,a.SystemEventService])],t.ContextualMenuService);t.DelegateRestService=class DelegateRestService{delegateForSingleInstance(e,t,n,i,o,s){"proxyFunction";return null}delegateForArray(e,t,n,i,o,s){"proxyFunction";return null}delegateForPage(e,t,n,i,o){"proxyFunction";return null}delegateForQueryByPost(e,t,n,i,o,s){"proxyFunction";return null}};t.DelegateRestService=__decorate([a.GatewayProxied(),i.Injectable()],t.DelegateRestService);t.ExperienceService=class ExperienceService extends a.IExperienceService{constructor(e,t,n){super();this.routingService=e;this.logService=t;this.previewService=n}buildRefreshedPreviewUrl(){return this.getCurrentExperience().then((e=>{if(!e){throw new Error("ExperienceService.buildRefreshedPreviewUrl() - Invalid experience from ExperienceService.getCurrentExperience()")}const t=this.previewService.getResourcePathFromPreviewUrl(e.siteDescriptor.previewUrl);return t.then((t=>{const n=this._convertExperienceToPreviewData(e,t);return this.previewService.updateUrlWithNewPreviewTicketId(this.routingService.absUrl(),n)}),(e=>{this.logService.error("ExperienceService.buildRefreshedPreviewUrl() - failed to retrieve resource path");return Promise.reject(e)}))}),(e=>{this.logService.error("ExperienceService.buildRefreshedPreviewUrl() - failed to retrieve current experience");return Promise.reject(e)}))}};t.ExperienceService=__decorate([a.GatewayProxied("loadExperience","updateExperiencePageContext","getCurrentExperience","setCurrentExperience","hasCatalogVersionChanged","buildRefreshedPreviewUrl","compareWithCurrentExperience"),__metadata("design:paramtypes",[a.SmarteditRoutingService,a.LogService,a.IPreviewService])],t.ExperienceService);t.FeatureService=class FeatureService extends a.IFeatureService{constructor(e,t,n,i){super(n,e);this.logService=e;this.decoratorService=t;this.contextualMenuService=i}addDecorator(e){const t=e.enablingCallback;const n=e.disablingCallback;const i=e.displayCondition;e.enablingCallback=function(){this.enable(e.key,i);if(t){t()}}.bind(this.decoratorService);e.disablingCallback=function(){this.disable(e.key);if(n){n()}}.bind(this.decoratorService);delete e.displayCondition;return this.register(e)}addContextualMenuButton(e){const t=Object.assign({},e);delete e.nameI18nKey;delete e.descriptionI18nKey;delete e.regexpKeys;t.enablingCallback=function(){const n={};t.regexpKeys.forEach((t=>{n[t]=[e]}));if(!this.containsItem(t.key)){this.addItems(n)}}.bind(this.contextualMenuService);t.disablingCallback=function(){this.removeItemByKey(t.key)}.bind(this.contextualMenuService);return this.register(t)}_remoteEnablingFromInner(e){if(this._featuresToAlias&&this._featuresToAlias[e]){this._featuresToAlias[e].enablingCallback()}else{this.logService.warn("could not enable feature named "+e+", it was not found in the iframe")}return Promise.resolve()}_remoteDisablingFromInner(e){if(this._featuresToAlias&&this._featuresToAlias[e]){this._featuresToAlias[e].disablingCallback()}else{this.logService.warn("could not disable feature named "+e+", it was not found in the iframe")}return Promise.resolve()}};t.FeatureService=__decorate([a.GatewayProxied("_registerAliases","addToolbarItem","register","enable","disable","_remoteEnablingFromInner","_remoteDisablingFromInner","addDecorator","getFeatureProperty","addContextualMenuButton"),__metadata("design:paramtypes",[a.LogService,a.IDecoratorService,a.CloneableUtils,a.IContextualMenuService])],t.FeatureService);t.NotificationService=class NotificationService extends a.INotificationService{};t.NotificationService=__decorate([a.GatewayProxied("pushNotification","removeNotification","removeAllNotifications")],t.NotificationService);t.NotificationMouseLeaveDetectionService=class NotificationMouseLeaveDetectionService extends a.INotificationMouseLeaveDetectionService{constructor(e){super();this.document=e;this.notificationPanelBounds=null;this.mouseLeaveCallback=null;this._onMouseMove=this._onMouseMove.bind(this)}_remoteStartDetection(e){this.notificationPanelBounds=e;this.document.addEventListener("mousemove",this._onMouseMove);return Promise.resolve()}_remoteStopDetection(){this.document.removeEventListener("mousemove",this._onMouseMove);this.notificationPanelBounds=null;return Promise.resolve()}_getBounds(){return Promise.resolve(this.notificationPanelBounds)}_getCallback(){return Promise.resolve(this.mouseLeaveCallback)}};t.NotificationMouseLeaveDetectionService=__decorate([a.GatewayProxied("stopDetection","_remoteStartDetection","_remoteStopDetection","_callCallback"),i.Injectable(),__param(0,i.Inject(c.DOCUMENT)),__metadata("design:paramtypes",[Document])],t.NotificationMouseLeaveDetectionService);t.DragAndDropCrossOrigin=class DragAndDropCrossOrigin extends a.IDragAndDropCrossOrigin{constructor(e,t,n,i,o,s){super();this.document=e;this.yjQuery=t;this.crossFrameEventService=n;this.inViewElementObserver=i;this.dragAndDropScrollingService=o;this.polyfillService=s;this.onDnDCrossOriginStart=e=>{this.dragAndDropScrollingService.toggleThrottling(this.polyfillService.isEligibleForThrottledScrolling())};this.onTrackMouseInner=(e,t)=>{if(this.isSearchingElement){return}this.isSearchingElement=true;this.currentElementHovered=this.yjQuery(this.inViewElementObserver.elementFromPoint(t));const n=this.getMousePositionInPage(t);if(this.lastElementHovered&&this.lastElementHovered.length){if(this.currentElementHovered.length&&this.lastElementHovered[0]!==this.currentElementHovered[0]||!this.currentElementHovered.length){this.dispatchDragEvent(this.lastElementHovered[0],a.IDragEventType.DRAG_LEAVE,n);this.lastElementHovered.data(a.SMARTEDIT_ELEMENT_HOVERED,false)}}if(this.currentElementHovered.length){if(!this.currentElementHovered.data(a.SMARTEDIT_ELEMENT_HOVERED)){this.dispatchDragEvent(this.currentElementHovered[0],a.IDragEventType.DRAG_ENTER,n);this.currentElementHovered.data(a.SMARTEDIT_ELEMENT_HOVERED,true)}this.dispatchDragEvent(this.currentElementHovered[0],a.IDragEventType.DRAG_OVER,n)}this.lastElementHovered=this.currentElementHovered;this.isSearchingElement=false};this.onDropElementInner=(e,t)=>{if(this.currentElementHovered.length){this.currentElementHovered.data(a.SMARTEDIT_ELEMENT_HOVERED,false);this.dispatchDragEvent(this.currentElementHovered[0],a.IDragEventType.DROP,t);this.dispatchDragEvent(this.currentElementHovered[0],a.IDragEventType.DRAG_LEAVE,t)}}}initialize(){this.crossFrameEventService.subscribe(a.SMARTEDIT_DRAG_AND_DROP_EVENTS.TRACK_MOUSE_POSITION,this.onTrackMouseInner.bind(this));this.crossFrameEventService.subscribe(a.SMARTEDIT_DRAG_AND_DROP_EVENTS.DROP_ELEMENT,this.onDropElementInner.bind(this));this.crossFrameEventService.subscribe(a.SMARTEDIT_DRAG_AND_DROP_EVENTS.DRAG_DROP_CROSS_ORIGIN_START,this.onDnDCrossOriginStart.bind(this))}dispatchDragEvent(e,t,n){const i=this.document.createEvent("CustomEvent");i.initCustomEvent(t,true,true,null);i.dataTransfer={data:{},setData(e,t){this.data[e]=t},getData(e){return this.data[e]}};i.pageX=n.x;i.pageY=n.y;e.dispatchEvent(i)}getMousePositionInPage(e){const t=this.yjQuery(this.document.scrollingElement||this.document.documentElement);return{x:e.x+t.scrollLeft(),y:e.y+t.scrollTop()}}};t.DragAndDropCrossOrigin=__decorate([__param(0,i.Inject(c.DOCUMENT)),__param(1,i.Inject(a.YJQUERY_TOKEN)),__metadata("design:paramtypes",[Document,Function,a.CrossFrameEventService,a.InViewElementObserver,a.DragAndDropScrollingService,a.PolyfillService])],t.DragAndDropCrossOrigin);var m;t.PageInfoService=m=class PageInfoService extends a.IPageInfoService{constructor(e,t,n){super();this.yjQuery=e;this.restServiceFactory=t;this.logService=n;this.pageTemplateRestService=t.get("/cmswebservices/v1/pagetemplate")}getPageUID(){return this.try((()=>this.getBodyClassAttributeByRegEx(m.PATTERN_SMARTEDIT_PAGE_UID)))}getPageUUID(){return this.try((()=>this.getBodyClassAttributeByRegEx(m.PATTERN_SMARTEDIT_PAGE_UUID)))}getCatalogVersionUUIDFromPage(){return this.try((()=>this.getBodyClassAttributeByRegEx(m.PATTERN_SMARTEDIT_CATALOG_VERSION_UUID)))}isSameCatalogVersionOfPageAndPageTemplate(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getPageUUID();const t=yield this.getCatalogVersionUUIDFromPage();const n={pageUuid:e};const i=yield this.pageTemplateRestService.get(n);return t===i.catalogVersion}))}getBodyClassAttributeByRegEx(e){try{const t=this.yjQuery("body").attr("class");return e.exec(t)[1]}catch(e){throw{name:"InvalidStorefrontPageError",message:"Error: the page is not a valid storefront page."}}}try(e){try{return Promise.resolve(e())}catch(e){this.logService.warn("Missing SmartEdit attributes on body element of the storefront - SmartEdit will resume once the attributes are added");return Promise.reject(e)}}};t.PageInfoService.PATTERN_SMARTEDIT_CATALOG_VERSION_UUID=/smartedit-catalog-version-uuid\-(\S+)/;t.PageInfoService.PATTERN_SMARTEDIT_PAGE_UID=/smartedit-page-uid\-(\S+)/;t.PageInfoService.PATTERN_SMARTEDIT_PAGE_UUID=/smartedit-page-uuid\-(\S+)/;__decorate([a.Cached({actions:[a.rarelyChangingContent],tags:[a.pageChangeEvictionTag]}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],t.PageInfoService.prototype,"isSameCatalogVersionOfPageAndPageTemplate",null);t.PageInfoService=m=__decorate([a.GatewayProxied("getPageUID","getPageUUID","getCatalogVersionUUIDFromPage","isSameCatalogVersionOfPageAndPageTemplate"),__param(0,i.Inject(a.YJQUERY_TOKEN)),__metadata("design:paramtypes",[Function,a.IRestServiceFactory,a.LogService])],t.PageInfoService);t.PageTreeService=class PageTreeService extends a.IPageTreeService{constructor(){super()}};t.PageTreeService=__decorate([a.GatewayProxied("registerTreeComponent","getTreeComponent"),__metadata("design:paramtypes",[])],t.PageTreeService);t.PageTreeNodeService=class PageTreeNodeService extends a.IPageTreeNodeService{constructor(e,t,n,i,o){super();this.componentHandlerService=e;this.yjQuery=t;this.crossFrameEventService=n;this.windowUtils=i;this.logService=o}buildSlotNodes(){this.slotNodes=this.buildSlotNodesByElement(this.yjQuery("body"));this.crossFrameEventService.publish(a.EVENT_OVERALL_REFRESH_TREE_NODE)}updateSlotNodes(e){if(this.slotNodes&&e.length>0){const t=new Set;const n={};if(this.hasSlotNode(e)){this.buildSlotNodes();return}e.forEach((e=>{if(t.has(e.parent)||!e.parent){return}t.add(e.parent);const i=this.yjQuery(e.parent);const o=i.attr(a.ELEMENT_UUID_ATTRIBUTE);if(!o){return}const s=this.buildSlotNodesByElement(i);n[o]=s;this.slotNodes.forEach((e=>{if(e.elementUuid===o){e.childrenNode=s}}))}));this.crossFrameEventService.publish(a.EVENT_PART_REFRESH_TREE_NODE,n)}}getSlotNodes(){return Promise.resolve(this.slotNodes)}scrollToElement(e){const t=this.yjQuery(`[data-smartedit-element-uuid="${e}"]`).get().shift();if(t){if(this.elementTopInViewport(t)||this.elementCenterInViewport(t)){return}t.scrollIntoView({behavior:"smooth",block:"center"})}else{this.logService.error(`data-smartedit-element-uuid="${e}" is not existed!`)}}existedSmartEditElement(e){const t=this.yjQuery(`smartedit-element[data-smartedit-element-uuid="${e}"]`).get().shift();return Promise.resolve(!!t)}handleBodyWidthChange(){const e=this.buildSlotNodesByElement(this.yjQuery("body"));let t=false;if(this.slotNodes.length!==e.length){t=true}else{for(let n=0;n<this.slotNodes.length;n++){t=!this.areSameNodes(this.slotNodes[n],e[n]);if(t){break}}}if(t){this.slotNodes=e;this.crossFrameEventService.publish(a.EVENT_OVERALL_REFRESH_TREE_NODE)}}_buildSlotNode(e){const t=this.yjQuery(e);const n=Array.from(this.componentHandlerService.getFirstSmartEditComponentChildren(t)).filter((e=>this._isValidElement(e))).map((e=>this._buildSlotNode(e)));if(!t.attr(a.ELEMENT_UUID_ATTRIBUTE)){t.attr(a.ELEMENT_UUID_ATTRIBUTE,a.stringUtils.generateIdentifier())}return{componentId:t.attr(a.ID_ATTRIBUTE),componentUuid:t.attr(a.UUID_ATTRIBUTE),componentTypeFromPage:t.attr(a.TYPE_ATTRIBUTE),catalogVersionUuid:t.attr(a.CATALOG_VERSION_UUID_ATTRIBUTE),containerId:t.attr(a.CONTAINER_ID_ATTRIBUTE),containerType:t.attr(a.CONTAINER_TYPE_ATTRIBUTE),elementUuid:t.attr(a.ELEMENT_UUID_ATTRIBUTE),isExpanded:false,childrenNode:n}}_isValidElement(e){const t=this.yjQuery(e);if(!t||!t.is(":visible")){return false}return!(!t.attr(a.ID_ATTRIBUTE)||!t.attr(a.UUID_ATTRIBUTE)||!t.attr(a.TYPE_ATTRIBUTE)||!t.attr(a.CATALOG_VERSION_UUID_ATTRIBUTE))}areSameNodes(e,t){let n=true;if(e.elementUuid!==t.elementUuid||e.childrenNode.length!==t.childrenNode.length){n=false}else{for(let i=0;i<e.childrenNode.length;i++){if(e.childrenNode[i].elementUuid!==t.childrenNode[i].elementUuid){n=false;break}}}return n}hasSlotNode(e){const t=e.find((e=>{if(e.node){const t=this.yjQuery(e.node);return t.attr(a.TYPE_ATTRIBUTE)===a.CONTENT_SLOT_TYPE}else{return false}}));return!!t}elementTopInViewport(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.top<(this.windowUtils.getWindow().innerHeight||document.documentElement.clientHeight)&&t.left<(this.windowUtils.getWindow().innerWidth||document.documentElement.clientWidth)}elementCenterInViewport(e){const t=e.getBoundingClientRect();return t.top<0&&t.left<0&&t.bottom>(this.windowUtils.getWindow().innerHeight||document.documentElement.clientHeight)&&t.right>(this.windowUtils.getWindow().innerWidth||document.documentElement.clientWidth)}buildSlotNodesByElement(e){return Array.from(this.componentHandlerService.getFirstSmartEditComponentChildren(e)).filter((e=>this._isValidElement(e))).map((e=>this._buildSlotNode(e)))}};t.PageTreeNodeService=__decorate([a.GatewayProxied("getSlotNodes","scrollToElement","existedSmartEditElement"),__param(1,i.Inject(a.YJQUERY_TOKEN)),__metadata("design:paramtypes",[a.IComponentHandlerService,Function,a.CrossFrameEventService,a.WindowUtils,a.LogService])],t.PageTreeNodeService);t.PerspectiveService=class PerspectiveService extends a.IPerspectiveService{constructor(){super()}};t.PerspectiveService=__decorate([a.GatewayProxied(),__metadata("design:paramtypes",[])],t.PerspectiveService);t.PreviewService=class PreviewService extends a.IPreviewService{constructor(e){super(e)}};t.PreviewService=__decorate([a.GatewayProxied(),__metadata("design:paramtypes",[a.UrlUtils])],t.PreviewService);class RestService{constructor(e,t,n){this.delegateRestService=e;this.uri=t;this.identifier=n;this.metadataActivated=false}getById(e,t){return this.delegateRestService.delegateForSingleInstance("getById",e,this.uri,this.identifier,this.metadataActivated,t)}get(e,t){return this.delegateRestService.delegateForSingleInstance("get",e,this.uri,this.identifier,this.metadataActivated,t)}update(e,t){return this.delegateRestService.delegateForSingleInstance("update",e,this.uri,this.identifier,this.metadataActivated,t)}patch(e,t){return this.delegateRestService.delegateForSingleInstance("patch",e,this.uri,this.identifier,this.metadataActivated,t)}save(e,t){return this.delegateRestService.delegateForSingleInstance("save",e,this.uri,this.identifier,this.metadataActivated,t)}query(e,t){return this.delegateRestService.delegateForArray("query",e,this.uri,this.identifier,this.metadataActivated,t)}page(e,t){return this.delegateRestService.delegateForPage(e,this.uri,this.identifier,this.metadataActivated,t)}remove(e,t){return this.delegateRestService.delegateForSingleInstance("remove",e,this.uri,this.identifier,this.metadataActivated,t)}queryByPost(e,t,n){return this.delegateRestService.delegateForQueryByPost(e,t,this.uri,this.identifier,this.metadataActivated,n)}activateMetadata(){this.metadataActivated=true}}t.RestServiceFactory=class RestServiceFactory{constructor(e){this.delegateRestService=e}get(e,t){return new RestService(this.delegateRestService,e,t)}};t.RestServiceFactory=__decorate([i.Injectable(),__metadata("design:paramtypes",[t.DelegateRestService])],t.RestServiceFactory);t.SessionService=class SessionService extends a.ISessionService{constructor(){super()}};t.SessionService=__decorate([a.GatewayProxied(),i.Injectable(),__metadata("design:paramtypes",[])],t.SessionService);t.SharedDataService=class SharedDataService extends a.ISharedDataService{constructor(){super()}};t.SharedDataService=__decorate([a.GatewayProxied(),__metadata("design:paramtypes",[])],t.SharedDataService);t.StorageService=class StorageService extends a.IStorageService{constructor(){super()}};t.StorageService=__decorate([a.GatewayProxied(),__metadata("design:paramtypes",[])],t.StorageService);t.UrlService=class UrlService extends a.IUrlService{};t.UrlService=__decorate([a.GatewayProxied("openUrlInPopup","path")],t.UrlService);t.WaitDialogService=class WaitDialogService extends a.IWaitDialogService{};t.WaitDialogService=__decorate([a.GatewayProxied()],t.WaitDialogService);t.SeNamespaceService=class SeNamespaceService{constructor(e){this.logService=e;this.reprocessPage=r.debounce(this._reprocessPage.bind(this),50)}renderComponent(e,t,n){return this.namespace&&typeof this.namespace.renderComponent==="function"?this.namespace.renderComponent(e,t,n):false}_reprocessPage(){if(this.namespace&&typeof this.namespace.reprocessPage==="function"){this.namespace.reprocessPage();return}this.logService.warn("No reprocessPage function defined on smartediFt namespace")}get namespace(){window.smartedit=window.smartedit||{};return window.smartedit}};t.SeNamespaceService=__decorate([i.Injectable(),__metadata("design:paramtypes",[a.LogService])],t.SeNamespaceService);t.PermissionService=class PermissionService extends a.IPermissionService{constructor(e){super();this.logService=e}_remoteCallRuleVerify(e,t){if(this.ruleVerifyFunctions&&this.ruleVerifyFunctions[e]){return this.ruleVerifyFunctions[e].verify(t)}this.logService.warn("could not call rule verify function for rule key: "+e+", it was not found in the iframe");return null}};t.PermissionService=__decorate([a.GatewayProxied(),__metadata("design:paramtypes",[a.LogService])],t.PermissionService);t.AlertService=class AlertService extends a.IAlertService{};t.AlertService=__decorate([a.GatewayProxied(),i.Injectable()],t.AlertService);t.AuthenticationService=class AuthenticationService extends a.IAuthenticationService{};t.AuthenticationService=__decorate([a.GatewayProxied()],t.AuthenticationService);t.DecoratorService=class DecoratorService{constructor(e,t){this.promiseUtils=e;this.stringUtils=t;this._activeDecorators={};this.componentDecoratorsMap={}}addMappings(e){for(const t in e){if(e.hasOwnProperty(t)){const n=e[t];this.componentDecoratorsMap[t]=u.union(this.componentDecoratorsMap[t]||[],n)}}}enable(e,t){if(!(e in this._activeDecorators)){this._activeDecorators[e]={displayCondition:t}}}disable(e){if(this._activeDecorators[e]){delete this._activeDecorators[e]}}getDecoratorsForComponent(e,t){let n=[];if(this.componentDecoratorsMap){for(const t in this.componentDecoratorsMap){if(this.stringUtils.regExpFactory(t).test(e)){n=u.union(n,this.componentDecoratorsMap[t])}}}return this.getDecoratorPromise(n,e,t)}getDecoratorPromise(e,t,n){const i=[];const o=[];e.forEach((e=>{const s=this._activeDecorators[e];if(s&&s.displayCondition){if(typeof s.displayCondition!=="function"){throw new Error("The active decorator's displayCondition property must be a function and must return a boolean")}const o=this.promiseUtils.defer();s.displayCondition(t,n).then((t=>{if(t){o.resolve(e)}else{o.resolve(null)}}));i.push(o.promise)}else if(s){o.push(e)}}));return Promise.all(i).then((e=>o.concat(e.filter((e=>e)))))}};t.DecoratorService=__decorate([i.Injectable(),__metadata("design:paramtypes",[a.PromiseUtils,a.StringUtils])],t.DecoratorService);t.TranslationsFetchService=class TranslationsFetchService extends a.ITranslationsFetchService{get(e){"proxyFunction";return null}isReady(){"proxyFunction";return null}waitToBeReady(){"proxyFunction";return null}};t.TranslationsFetchService=__decorate([a.GatewayProxied(),i.Injectable()],t.TranslationsFetchService);t.RenderService=class RenderService extends a.IRenderService{constructor(e,t,n,i,o,s,r,l,c,d,p,m,h,g,_,v){super(i,p,m,h,g,r,_,v,n);this.smarteditBootstrapGateway=e;this.httpClient=t;this.logService=n;this.yjQuery=i;this.alertService=o;this.componentHandlerService=s;this.crossFrameEventService=r;this.jQueryUtilsService=l;this.experienceService=c;this.seNamespaceService=d;this.systemEventService=p;this.crossFrameEventService.subscribe(a.EVENT_PERSPECTIVE_CHANGED,((e,t)=>{this.renderPage(t)}));this.crossFrameEventService.subscribe(a.EVENT_PERSPECTIVE_REFRESHED,((e,t)=>{this.renderPage(t)}));this.crossFrameEventService.subscribe(a.EVENT_THEME_SAVED,(()=>{this.reBootstrapPage()}));this.systemEventService.subscribe(a.CONTRACT_CHANGE_LISTENER_PROCESS_EVENTS.PROCESS_COMPONENTS,((e,t)=>{const n=u.map(t,(e=>{if(e.dataset[a.SMARTEDIT_COMPONENT_PROCESS_STATUS]!==a.CONTRACT_CHANGE_LISTENER_COMPONENT_PROCESS_STATUS.KEEP_VISIBLE){e.dataset[a.SMARTEDIT_COMPONENT_PROCESS_STATUS]=this.componentHandlerService.isOverlayOn()?a.CONTRACT_CHANGE_LISTENER_COMPONENT_PROCESS_STATUS.PROCESS:a.CONTRACT_CHANGE_LISTENER_COMPONENT_PROCESS_STATUS.REMOVE}return e}));return Promise.resolve(n)}))}toggleOverlay(e){const t=this.componentHandlerService.getOverlay();t.css("visibility",e?"visible":"hidden")}refreshOverlayDimensions(e=null){e=e||this.yjQuery("body");const t=this.componentHandlerService.getFirstSmartEditComponentChildren(e);t.each(((e,t)=>{this.updateComponentSizeAndPosition(t);this.refreshOverlayDimensions(t)}))}updateComponentSizeAndPosition(e,t){const n=this.yjQuery(e);t=t||this.componentHandlerService.getComponentCloneInOverlay(n).get(0);if(!t){return}const i=this._getParentInOverlay(n).get(0).getBoundingClientRect();const o=n.get(0).offsetWidth;const s=n.get(0).offsetHeight;const r=n.get(0).getBoundingClientRect();const l=r.top-i.top;const c=r.left-i.left;t.style.position="absolute";t.style.top=l+"px";t.style.left=c+"px";t.style.width=o+"px";t.style.height=s+"px";t.style.minWidth="51px";t.style.minHeight="48px";const d=this._buildShallowCloneId(n.attr(a.ID_ATTRIBUTE),n.attr(a.TYPE_ATTRIBUTE),n.attr(a.CONTAINER_ID_ATTRIBUTE));const p=this.yjQuery(t).find('[id="'+d+'"]');p.width(o);p.height(s);p.css("min-height",49);p.css("min-width",51)}reBootstrapPage(){this._markSmartEditBootstrap()}renderPage(e){if(e){this._resizeSlots()}this.componentHandlerService.getOverlay().hide();this.isRenderingBlocked().then((t=>{this._markSmartEditAsReady();const n=this._createOverlay();if(e&&!t){n.show()}this.systemEventService.publish(a.CONTRACT_CHANGE_LISTENER_PROCESS_EVENTS.RESTART_PROCESS);this.crossFrameEventService.publish(a.OVERLAY_RERENDERED_EVENT)}))}renderSlots(e=null){return __awaiter(this,void 0,void 0,(function*(){if(a.stringUtils.isBlank(e)||e instanceof Array&&e.length===0){return Promise.reject("renderService.renderSlots.slotIds.required")}if(typeof e==="string"){e=[e]}const t=u.uniqBy(e,(e=>e));const n=t.filter((e=>!this.seNamespaceService.renderComponent(e,"ContentSlot")));if(n.length<=0){return true}else{let e;let t;try{e=yield this.experienceService.buildRefreshedPreviewUrl()}catch(e){this.logService.error("renderService.renderSlots() - error with buildRefreshedPreviewUrl");return Promise.reject(e)}try{t=yield this.httpClient.get(e,{headers:{Accept:"text/html",Pragma:"no-cache"},responseType:"text"}).toPromise()}catch(e){this.alertService.showDanger({message:e,minWidth:"",mousePersist:true,duration:1e3,dismissible:true,width:"300px"});return Promise.reject(e)}const i=this.jQueryUtilsService.unsafeParseHTML(t);n.forEach((e=>{const t="."+a.COMPONENT_CLASS+"["+a.TYPE_ATTRIBUTE+"='ContentSlot']["+a.ID_ATTRIBUTE+"='"+e+"']";const n=this.jQueryUtilsService.extractFromElement(i,t);const o=this.yjQuery(t);o.html(n.html());if(o.data("smartedit-resized-slot")){o.css("height","auto")}}));this._reprocessPage();return Promise.resolve()}}))}renderComponent(e,t){const n=this.componentHandlerService.getComponent(e,t);const i=this.componentHandlerService.getParent(n).attr(a.ID_ATTRIBUTE);if(this.seNamespaceService.renderComponent(e,t,i)){return Promise.resolve(true)}else{return this.renderSlots(i)}}renderRemoval(e,t,n){const i=this.componentHandlerService.getComponentUnderSlot(e,t,n).remove();this.refreshOverlayDimensions();return i}destroyComponent(e,t,n){const i=this.yjQuery(e);const o=this.yjQuery(t);const s=n&&n[a.ID_ATTRIBUTE]?n[a.ID_ATTRIBUTE]:i.attr(a.ID_ATTRIBUTE);const r=n&&n[a.TYPE_ATTRIBUTE]?n[a.TYPE_ATTRIBUTE]:i.attr(a.TYPE_ATTRIBUTE);if(o.attr(a.ID_ATTRIBUTE)){this.componentHandlerService.getOverlayComponentWithinSlot(s,r,o.attr(a.ID_ATTRIBUTE)).remove()}else{this.componentHandlerService.getComponentInOverlay(s,r).remove()}}createComponent(e){if(this.componentHandlerService.isOverlayOn()&&this._isComponentVisible(e)){this._cloneComponent(e)}}_resizeSlots(){Array.prototype.slice.call(this.componentHandlerService.getFirstSmartEditComponentChildren(document.body)).forEach((e=>{e.style.height="auto"}))}_getParentInOverlay(e){const t=this.componentHandlerService.getParent(e);if(t.length){return this.componentHandlerService.getOverlayComponent(t)}else{return this.componentHandlerService.getOverlay()}}_buildShallowCloneId(e,t,n){const i=!a.stringUtils.isBlank(n)?"_"+n:"";return e+"_"+t+i+"_overlay"}_cloneComponent(e){if(!this.yjQuery(e).is(":visible")){return}const t=this.yjQuery(e);const n=this._getParentInOverlay(t);if(!n.length){this.logService.error("renderService: parentOverlay empty for component:",t.attr(a.ID_ATTRIBUTE));return}if(!this._validateComponentAttributesContract(t)){return}const i=a.stringUtils.generateIdentifier();if(!t.attr(a.ELEMENT_UUID_ATTRIBUTE)){t.attr(a.ELEMENT_UUID_ATTRIBUTE,i)}const o=t.attr(a.ID_ATTRIBUTE);const s=t.attr(a.TYPE_ATTRIBUTE);const r=t.attr(a.CONTAINER_ID_ATTRIBUTE);const l=this._getDocument().createElement("div");l.id=this._buildShallowCloneId(o,s,r);const c=this._getDocument().createElement("smartedit-element");const d=this.yjQuery(c);d.append(l);this.updateComponentSizeAndPosition(t.get(0),c);if(s==="NavigationBarCollectionComponent"){c.style.zIndex="7"}d.addClass(a.OVERLAY_COMPONENT_CLASS);Array.prototype.slice.apply(t.get(0).attributes).forEach((e=>{if(e.nodeName.indexOf(a.SMARTEDIT_ATTRIBUTE_PREFIX)===0){d.attr(e.nodeName,e.nodeValue)}}));n.append(c)}_createOverlay(){const e=this.componentHandlerService.getOverlay();if(e.length){return e}const t=this._getDocument().createElement("div");t.id=a.OVERLAY_ID;t.style.position="absolute";t.style.top="0px";t.style.left="0px";t.style.bottom="0px";t.style.right="0px";t.style.display="none";document.body.appendChild(t);return this.yjQuery(t)}_validateComponentAttributesContract(e){const t=[a.ID_ATTRIBUTE,a.UUID_ATTRIBUTE,a.TYPE_ATTRIBUTE,a.CATALOG_VERSION_UUID_ATTRIBUTE];let n=true;t.forEach((t=>{if(!e||!e.attr(t)){n=false;this.logService.warn("RenderService - smarteditComponent element discovered with missing contract attribute: "+t)}}));return n}_markSmartEditAsReady(){this.smarteditBootstrapGateway.getInstance().publish("smartEditReady",{})}_markSmartEditBootstrap(){this.smarteditBootstrapGateway.getInstance().publish("bootstrapSmartEdit",{})}_isComponentVisible(e){return e.offsetParent!==null}_reprocessPage(){this.seNamespaceService.reprocessPage()}};t.RenderService=__decorate([a.GatewayProxied("blockRendering","isRenderingBlocked","renderSlots","renderComponent","renderRemoval","toggleOverlay","refreshOverlayDimensions","renderPage"),__param(3,i.Inject(a.YJQUERY_TOKEN)),__metadata("design:paramtypes",[a.SmarteditBootstrapGateway,o.HttpClient,a.LogService,Function,a.IAlertService,a.IComponentHandlerService,a.CrossFrameEventService,a.JQueryUtilsService,a.IExperienceService,t.SeNamespaceService,a.SystemEventService,a.INotificationService,a.IPageInfoService,a.IPerspectiveService,a.WindowUtils,a.ModalService])],t.RenderService);t.IframeClickDetectionService=class IframeClickDetectionService extends a.IIframeClickDetectionService{constructor(e){super();e.addEventListener("mousedown",(()=>this.onIframeClick()))}};t.IframeClickDetectionService=__decorate([a.GatewayProxied("onIframeClick"),i.Injectable(),__param(0,i.Inject(c.DOCUMENT)),__metadata("design:paramtypes",[Document])],t.IframeClickDetectionService);class ToolbarService extends a.IToolbarService{constructor(e,t,n,i){super(n,i);this.gatewayId=e;t.initForService(this,["addAliases","removeItemByKey","removeAliasByKey","_removeItemOnInner","triggerActionOnInner"])}_removeItemOnInner(e){if(e in this.actions){delete this.actions[e]}this.logService.warn("removeItemByKey() - Failed to find action for key "+e)}triggerActionOnInner(e){if(!this.actions[e.key]){this.logService.error("triggerActionByKey() - Failed to find action for key "+e.key);return}this.actions[e.key]()}}t.ToolbarServiceFactory=class ToolbarServiceFactory{constructor(e,t,n){this.gatewayProxy=e;this.logService=t;this.permissionService=n;this.toolbarServicesByGatewayId={}}getToolbarService(e){if(!this.toolbarServicesByGatewayId[e]){this.toolbarServicesByGatewayId[e]=new ToolbarService(e,this.gatewayProxy,this.logService,this.permissionService)}return this.toolbarServicesByGatewayId[e]}};t.ToolbarServiceFactory=__decorate([i.Injectable(),__metadata("design:paramtypes",[a.GatewayProxy,a.LogService,a.IPermissionService])],t.ToolbarServiceFactory);t.ResizeComponentService=class ResizeComponentService{constructor(e,t){this.componentHandlerService=e;this.yjQuery=t}resizeComponents(e){const t=this.yjQuery(this.componentHandlerService.getAllSlotsSelector());const n=this.yjQuery(this.componentHandlerService.getAllComponentsSelector());if(e){t.addClass("ySEEmptySlot");n.addClass("se-storefront-component")}else{t.removeClass("ySEEmptySlot");n.removeClass("se-storefront-component")}}};t.ResizeComponentService=__decorate([__param(1,i.Inject(a.YJQUERY_TOKEN)),__metadata("design:paramtypes",[a.IComponentHandlerService,Function])],t.ResizeComponentService);t.PositionRegistry=class PositionRegistry{constructor(e){this.yjQuery=e;this.positionRegistry=[]}register(e){this.unregister(e);this.positionRegistry.push({element:e,position:this.calculatePositionHash(e)})}unregister(e){const t=this.positionRegistry.find((t=>t.element===e));const n=this.positionRegistry.indexOf(t);if(n>-1){this.positionRegistry.splice(n,1)}}getRepositionedComponents(){return this.positionRegistry.filter((e=>this.yjQuery(e.element).height()!==0)).filter((e=>{const t=e.element;const n=this.calculatePositionHash(t);if(n!==e.position){e.position=n;return true}else{return false}})).map((e=>e.element))}dispose(){this.positionRegistry=[]}_listenerCount(){return this.positionRegistry.length}floor(e){return Math.floor(e*100)/100}calculatePositionHash(e){const t=this.yjQuery("body")[0].getBoundingClientRect();const n=e.getBoundingClientRect();return this.floor(n.top-t.top)+"_"+this.floor(n.left-t.left)}};t.PositionRegistry=__decorate([__param(0,i.Inject(a.YJQUERY_TOKEN)),__metadata("design:paramtypes",[Function])],t.PositionRegistry);class ResizeListener{constructor(){this.resizeListenersRegistry=new Map;this._resizeObserver=new d.ResizeObserver((e=>{for(const t of e){const e=t.target;const n=this.resizeListenersRegistry.get(e);n.listener()}}))}register(e,t){if(!this.resizeListenersRegistry.has(e)){this.resizeListenersRegistry.set(e,{listener:t});this._resizeObserver.observe(e)}}dispose(){this.resizeListenersRegistry.forEach(((e,t)=>{this.unregister(t)}))}unregister(e){if(this.resizeListenersRegistry.has(e)){this._resizeObserver.unobserve(e);this.resizeListenersRegistry.delete(e)}}_listenerCount(){return this.resizeListenersRegistry.size}}t.CatalogVersionPermissionService=class CatalogVersionPermissionService extends a.ICatalogVersionPermissionService{constructor(){super()}};t.CatalogVersionPermissionService=__decorate([a.GatewayProxied(),__metadata("design:paramtypes",[])],t.CatalogVersionPermissionService);t.ComponentHandlerService=class ComponentHandlerService extends a.IComponentHandlerService{constructor(e){super(e)}isExternalComponent(e,t){const n=this.getOriginalComponent(e,t);const i=this.getCatalogVersionUuid(n);return Promise.resolve(i!==this.getBodyClassAttributeByRegEx(a.PageInfoService.PATTERN_SMARTEDIT_CATALOG_VERSION_UUID))}reloadInner(){a.windowUtils.getWindow().location.reload();return Promise.resolve()}};t.ComponentHandlerService=__decorate([a.GatewayProxied("isExternalComponent","reloadInner"),__param(0,i.Inject(a.YJQUERY_TOKEN)),__metadata("design:paramtypes",[Function])],t.ComponentHandlerService);var h;(function(e){e["ADDED"]="added";e["DESTROYED"]="destroyed"})(h||(h={}));const g=100;const _=250;const v={root:null,rootMargin:"1000px",threshold:0};const S=500;let y=class SmartEditContractChangeListener{constructor(e,t,n,i,o,s,r,l,c,d){this.yjQueryUtilsService=e;this.componentHandlerService=t;this.pageInfoService=n;this.resizeListener=i;this.positionRegistry=o;this.logService=s;this.yjQuery=r;this.systemEventService=l;this.polyfillService=c;this.pageTreeNodeService=d;this.MUTATION_OBSERVER_OPTIONS={attributes:true,attributeOldValue:true,childList:true,characterData:false,subtree:true};this.enableExtendedView=false;this._componentsAddedCallback=null;this._componentsRemovedCallback=null;this._componentResizedCallback=null;this._componentRepositionedCallback=null;this._onComponentChangedCallback=null;this._pageChangedCallback=null;this._throttledProcessQueue=u.throttle((()=>this._rawProcessQueue()),S);this.componentsQueue=new Map;this.prevBodyWidth=0;this.smartEditAttributeNames=[a.TYPE_ATTRIBUTE,a.ID_ATTRIBUTE,a.UUID_ATTRIBUTE]}_newMutationObserver(e){return new MutationObserver(e)}_newIntersectionObserver(e){return new IntersectionObserver(e,v)}_addToComponentQueue(e){const t=this.componentsQueue.get(e.target);if(t){t.isIntersecting=e.isIntersecting}else if(this.yjQueryUtilsService.isInDOM(e.target)){this.componentsQueue.set(e.target,{component:e.target,isIntersecting:e.isIntersecting,processed:null,oldProcessedValue:null,parent:this.componentHandlerService.getParent(e.target)[0]})}}_componentsQueueLength(){return this.componentsQueue.size}isExtendedViewEnabled(){return this.enableExtendedView}setEconomyMode(e){this.economyMode=e;if(!this.economyMode){Array.from(this.componentHandlerService.getFirstSmartEditComponentChildren(this.yjQuery("body"))).forEach((e=>{this.applyToSelfAndAllChildren(e,(e=>{this._registerSizeAndPositionListeners(e)}))}))}}initListener(){this.enableExtendedView=this.polyfillService.isEligibleForExtendedView();this.pageInfoService.getPageUUID().then((e=>{this.currentPage=e;if(this._pageChangedCallback){this.executeCallback(this._pageChangedCallback.bind(undefined,this.currentPage))}}));this.systemEventService.subscribe(a.CONTRACT_CHANGE_LISTENER_PROCESS_EVENTS.RESTART_PROCESS,(()=>{this._processQueue();return Promise.resolve()}));if(this.enableExtendedView){setInterval((()=>{this._processQueue()}),_)}this.mutationObserver=this._newMutationObserver(this.mutationObserverCallback.bind(this));this.mutationObserver.observe(document.body,this.MUTATION_OBSERVER_OPTIONS);this.resizeObserver=new d.ResizeObserver(this.resizeObserverCallback.bind(this));this.resizeObserver.observe(document.body);this.intersectionObserver=this._newIntersectionObserver((e=>{e.forEach((e=>{this._addToComponentQueue(e)}));this._processQueue()}));Array.from(this.componentHandlerService.getFirstSmartEditComponentChildren(this.yjQuery("body"))).forEach((e=>{this.applyToSelfAndAllChildren(e,this.intersectionObserver.observe.bind(this.intersectionObserver))}));this._startExpendableListeners()}_processQueue(){if(a.functionsUtils.isUnitTestMode()){this._rawProcessQueue()}else{this._throttledProcessQueue()}}isIntersecting(e){if(!this.yjQueryUtilsService.isInDOM(e.component)){return false}return this.enableExtendedView?this.yjQueryUtilsService.isInExtendedViewPort(e.component):e.isIntersecting}_rawProcessQueue(){const e=Array.from(this.componentsQueue.values());this.systemEventService.publish(a.CONTRACT_CHANGE_LISTENER_PROCESS_EVENTS.PROCESS_COMPONENTS,e.map((({component:e})=>e))).then(this.publishSuccess.bind(this,e))}_addComponents(e){if(this._componentsAddedCallback){this.executeCallback(this._componentsAddedCallback.bind(undefined,u.map(e,"component"),this.economyMode))}if(!this.economyMode){e.filter((e=>e.oldProcessedValue===null)).forEach((e=>{this._registerSizeAndPositionListeners(e.component)}))}}_removeComponents(e,t=false){e.filter((e=>!this.yjQueryUtilsService.isInDOM(e.component)||t)).forEach((e=>{if(!this.economyMode){this._unregisterSizeAndPositionListeners(e.component)}this.componentsQueue.delete(e.component)}));if(this._componentsRemovedCallback){const t=e.map((e=>u.pick(e,["component","parent","oldAttributes"])));this.executeCallback(this._componentsRemovedCallback.bind(undefined,t,this.economyMode))}}_registerSizeAndPositionListeners(e){if(this._componentRepositionedCallback){this.positionRegistry.register(e)}if(this._componentResizedCallback){this.resizeListener.register(e,this._componentResizedCallback.bind(undefined,e))}}_unregisterSizeAndPositionListeners(e){if(this._componentRepositionedCallback){this.positionRegistry.unregister(e)}if(this._componentResizedCallback){this.resizeListener.unregister(e)}}stopListener(){if(this.mutationObserver){this.mutationObserver.disconnect()}this.intersectionObserver.disconnect();this.mutationObserver=null;this._stopExpendableListeners()}_stopExpendableListeners(){this.resizeListener.dispose();if(this.repositionListener){clearInterval(this.repositionListener);this.repositionListener=null}this.positionRegistry.dispose()}_startExpendableListeners(){if(this._componentRepositionedCallback){this.repositionListener=setInterval((()=>{this.positionRegistry.getRepositionedComponents().forEach((e=>{this._componentRepositionedCallback(e)}))}),g)}}onComponentsAdded(e){this._componentsAddedCallback=e}onComponentsRemoved(e){this._componentsRemovedCallback=e}onComponentChanged(e){this._onComponentChangedCallback=e}onComponentResized(e){this._componentResizedCallback=e}onComponentRepositioned(e){this._componentRepositionedCallback=e}onPageChanged(e){this._pageChangedCallback=e}loopObservedQueue(e,t){const n=[];const i=[];const o=new Set(t||[]);e.forEach((e=>{if(!o.has(e.component)){return}const t=e.component.dataset[a.SMARTEDIT_COMPONENT_PROCESS_STATUS];switch(t){case a.CONTRACT_CHANGE_LISTENER_COMPONENT_PROCESS_STATUS.PROCESS:if(e.processed!==h.ADDED&&this.isIntersecting(e)){n.push(e)}else if(e.processed===h.ADDED&&!this.isIntersecting(e)){i.push(e)}break;case a.CONTRACT_CHANGE_LISTENER_COMPONENT_PROCESS_STATUS.REMOVE:if(e.processed===h.ADDED){i.push(e)}break}e.oldProcessedValue=e.processed}));n.forEach((e=>{e.processed=h.ADDED}));i.forEach((e=>{e.processed=h.DESTROYED}));return{addedComponents:n,removedComponents:i}}publishSuccess(e,t){const{addedComponents:n,removedComponents:i}=this.loopObservedQueue(e,t);if(i.length){this._removeComponents(i)}if(n.length){n.sort(a.nodeUtils.compareHTMLElementsPosition("component"));this._addComponents(n)}if(!this.economyMode){u.chain(n.concat(i)).filter((e=>e.oldProcessedValue===null||!this.yjQueryUtilsService.isInDOM(e.component))).map("parent").compact().uniq().value().forEach((e=>{this.repairParentResizeListener(e)}))}}aggregateAddedOrRemovedNodesAndTheirParents(e,t){const n=e.filter((e=>e.type===a.MUTATION_TYPES.CHILD_LIST.NAME&&e[t]&&e[t].length)).map((e=>{const n=u.flatten(Array.from(e[t]).filter((e=>e.nodeType===Node.ELEMENT_NODE)).map((e=>{if(this.componentHandlerService.isSmartEditComponent(e)){return e}else{return Array.from(this.componentHandlerService.getFirstSmartEditComponentChildren(e))}}))).sort(a.nodeUtils.compareHTMLElementsPosition());const i=this.componentHandlerService.getClosestSmartEditComponent(e.target);return n.map((e=>({node:e,parent:i.length?i[0]:null})))}));return u.uniqWith(u.flatten(n),((e,t)=>e.node.contains(t.node)||t.node.contains(e.node)))}aggregateMutationsOnChangedAttributes(e){const t=e.reduce(((e,t)=>{if(!(t.target&&t.target.nodeType===Node.ELEMENT_NODE&&t.type===a.MUTATION_TYPES.ATTRIBUTES.NAME)){return e}let n=e.get(t.target);if(!n){n={node:t.target,oldAttributes:{}};e.set(t.target,n)}n.oldAttributes[t.attributeName]=t.oldValue;return e}),new Map);return Array.from(t.values())}isSmarteditNode(e){return this.componentHandlerService.isSmartEditComponent(e.node)&&this.smartEditAttributeNames.some((t=>e.node.hasAttribute(t)))}isSmarteditAttributeChanged(e){return this.smartEditAttributeNames.some((t=>e.oldAttributes.hasOwnProperty(t)))}wasSmarteditNode(e){return this.componentsQueue.has(e.node)&&this.smartEditAttributeNames.every((t=>!e.node.hasAttribute(t)))}mutationsHasPageChange(e){return e.find((e=>{const t=e.target;return e.type===a.MUTATION_TYPES.ATTRIBUTES.NAME&&t.tagName==="BODY"&&e.attributeName==="class"}))}applyToSelfAndAllChildren(e,t){t(e);Array.from(this.componentHandlerService.getFirstSmartEditComponentChildren(e)).forEach((e=>{this.applyToSelfAndAllChildren(e,t)}))}repairParentResizeListener(e){if(e){const t=this.componentsQueue.get(e);if(t&&t.processed===h.ADDED&&this.yjQueryUtilsService.isInDOM(e)){this._componentResizedCallback(e)}}}executeCallback(e){if(a.functionsUtils.isUnitTestMode()){e()}else{setTimeout((()=>e()),0)}}handleSmartEditNode(e){const t=this.componentsQueue.get(e.node);if(!t){this.applyToSelfAndAllChildren(e.node,this.intersectionObserver.observe.bind(this.intersectionObserver))}else{this.executeCallback(this._onComponentChangedCallback.bind(undefined,e.node,e.oldAttributes))}}handleNoSmarteditNode(e){this.applyToSelfAndAllChildren(e.node,this.intersectionObserver.unobserve.bind(this.intersectionObserver));const t=this.componentHandlerService.getClosestSmartEditComponent(e.node);this._removeComponents([{isIntersecting:false,component:e.node,parent:t.length?t[0]:null,oldAttributes:e.oldAttributes}],true)}loopAggregateNodes(e){e.forEach((e=>{this.applyToSelfAndAllChildren(e.node,(t=>{const n=this.componentsQueue.get(t);if(!n){return}if(!this.economyMode){this.repairParentResizeListener(e.parent)}this._removeComponents([{isIntersecting:false,component:t,parent:e.parent}])}))}))}loopMutationsOnChangedAttributes(e){this.aggregateMutationsOnChangedAttributes(e).forEach((e=>{if(this.isSmarteditAttributeChanged(e)){if(this.isSmarteditNode(e)){this.handleSmartEditNode(e)}else if(this.wasSmarteditNode(e)){this.handleNoSmarteditNode(e)}}}))}mutationObserverCallback(e){this.logService.debug(e);if(this._pageChangedCallback&&this.mutationsHasPageChange(e)){this.pageInfoService.getPageUUID().then((e=>{if(this.currentPage!==e){this.executeCallback(this._pageChangedCallback.bind(undefined,e))}this.currentPage=e}))}const t=this.aggregateAddedOrRemovedNodesAndTheirParents(e,a.MUTATION_TYPES.CHILD_LIST.ADD_OPERATION);if(this._componentsAddedCallback){t.forEach((e=>{this.applyToSelfAndAllChildren(e.node,this.intersectionObserver.observe.bind(this.intersectionObserver))}))}const n=this.aggregateAddedOrRemovedNodesAndTheirParents(e,a.MUTATION_TYPES.CHILD_LIST.REMOVE_OPERATION);this.pageTreeNodeService.updateSlotNodes(t.concat(n));this.loopAggregateNodes(n);if(this._onComponentChangedCallback){this.loopMutationsOnChangedAttributes(e)}}resizeObserverCallback(e){for(const t of e){const{width:e}=t.contentRect;if(e!==this.prevBodyWidth){this.prevBodyWidth=e;this.pageTreeNodeService.handleBodyWidthChange()}}}};y=__decorate([__param(6,i.Inject(a.YJQUERY_TOKEN)),__metadata("design:paramtypes",[a.JQueryUtilsService,a.IComponentHandlerService,a.IPageInfoService,a.IResizeListener,a.IPositionRegistry,a.LogService,Function,a.SystemEventService,a.PolyfillService,a.IPageTreeNodeService])],y);t.SmarteditServicesModule=class SmarteditServicesModule{};t.SmarteditServicesModule=__decorate([i.NgModule({imports:[a.DragAndDropServiceModule,a.SmarteditCommonsModule],providers:[{provide:a.IPermissionService,useClass:t.PermissionService},t.DelegateRestService,t.RestServiceFactory,ResizeListener,t.SeNamespaceService,t.ContextualMenuService,{provide:a.IComponentHandlerService,useClass:t.ComponentHandlerService},t.ResizeComponentService,a.PriorityService,{provide:a.IRestServiceFactory,useClass:t.RestServiceFactory},{provide:a.IRenderService,useClass:t.RenderService},{provide:a.ICatalogVersionPermissionService,useClass:t.CatalogVersionPermissionService},{provide:a.ISmartEditContractChangeListener,useClass:y},{provide:a.IPageInfoService,useClass:t.PageInfoService},{provide:a.IResizeListener,useClass:ResizeListener},{provide:a.IPositionRegistry,useClass:t.PositionRegistry},{provide:a.IAnnouncementService,useClass:t.AnnouncementService},{provide:a.IPerspectiveService,useClass:t.PerspectiveService},{provide:a.IFeatureService,useClass:t.FeatureService},{provide:a.INotificationMouseLeaveDetectionService,useClass:t.NotificationMouseLeaveDetectionService},{provide:a.IWaitDialogService,useClass:t.WaitDialogService},{provide:a.IPreviewService,useClass:t.PreviewService},{provide:a.IDragAndDropCrossOrigin,useClass:t.DragAndDropCrossOrigin},a.PolyfillService,{provide:a.INotificationService,useClass:t.NotificationService},{provide:a.IAlertService,useClass:t.AlertService},{provide:a.IPageTreeNodeService,useClass:t.PageTreeNodeService},{provide:a.IPageTreeService,useClass:t.PageTreeService},a.moduleUtils.initialize((e=>{}),[a.INotificationMouseLeaveDetectionService])]})],t.SmarteditServicesModule);t.ConfirmationModalService=class ConfirmationModalService extends a.IConfirmationModalService{};t.ConfirmationModalService=__decorate([a.GatewayProxied("confirm")],t.ConfirmationModalService);t.UserTrackingService=class UserTrackingService extends a.IUserTrackingService{};t.UserTrackingService=__decorate([a.GatewayProxied("initConfiguration","trackingUserAction"),i.Injectable()],t.UserTrackingService);let C=class SakExecutorService{constructor(e){this.decoratorService=e}wrapDecorators(e,t){return this.decoratorService.getDecoratorsForComponent(t.getAttribute(a.TYPE_ATTRIBUTE),t.getAttribute(a.ID_ATTRIBUTE)).then((n=>{const i=n.reduce(((e,n)=>{const i=u.kebabCase(n.replace("se.",""));const o=u.camelCase(n.replace("se.",""));const s=document.createElement(i);s.className=`${o} se-decorator-wrap`;if(i==="slot-contextual-menu"&&t.style.position==="absolute"&&parseInt(t.style.top,10)<32){s.setAttribute("show-at-bottom","true")}s.setAttribute("active","false");s.setAttribute("component-attributes","componentAttributes");s.appendChild(e);this.setAttributeOn(s,"data-smartedit-element-uuid",t);this.setAttributeOn(s,"data-smartedit-component-id",t);this.setAttributeOn(s,"data-smartedit-component-uuid",t);this.setAttributeOn(s,"data-smartedit-component-type",t);this.setAttributeOn(s,"data-smartedit-catalog-version-uuid",t);this.setAttributeOn(s,"data-smartedit-container-id",t);this.setAttributeOn(s,"data-smartedit-container-uuid",t);this.setAttributeOn(s,"data-smartedit-container-type",t);return s}),e);return i}))}setAttributeOn(e,t,n){const i=n.getAttribute(t);if(i){e.setAttribute(t,i)}}};C=__decorate([i.Injectable(),__metadata("design:paramtypes",[a.IDecoratorService])],C);var f;(function(e){e["Small"]="small";e["Compact"]="compact"})(f||(f={}));window.__smartedit__.addDecoratorPayload("Component","ContextualMenuItemComponent",{selector:"se-contextual-menu-item",template:`<div *ngIf="mode === 'small'" id="{{itemConfig.i18nKey | translate}}-{{componentAttributes.smarteditComponentId}}-{{componentAttributes.smarteditComponentType}}-{{index}}" class="se-ctx-menu-element__btn {{itemConfig.displayIconClass}} {{itemConfig.displayClass}}" [ngClass]="{'is-active': itemConfig.isOpen }" [title]="itemConfig.i18nKey | translate"></div><div *ngIf="mode === 'compact'" class="se-ctx-menu-element__label {{itemConfig.displayClass}}" id="{{itemConfig.i18nKey | translate}}-{{componentAttributes.smarteditComponentId}}-{{componentAttributes.smarteditComponentType}}-{{index}}">{{itemConfig.i18nKey | translate}}</div>`});let E=class ContextualMenuItemComponent{constructor(e){this.element=e;this.modes=[f.Small,f.Compact]}ngOnInit(){this.classes=`cmsx-ctx__icon-more--small ${this.itemConfig.displayClass}`;this.validateInput();if(this.itemConfig.action&&this.itemConfig.action.callbacks){this.setupListeners()}}ngOnDestroy(){this.removeListeners()}validateInput(){if(typeof this.mode!=="string"||this.modes.indexOf(this.mode)===-1){throw new Error("Error initializing contextualMenuItem - unknown mode")}}removeListeners(){Object.keys(this.listeners||{}).forEach((e=>{this.element.nativeElement.removeEventListener(e,this.listeners[e])}))}setupListeners(){const{smarteditComponentType:e,smarteditComponentId:t,smarteditComponentUuid:n,smarteditContainerType:i,smarteditContainerId:o}=this.componentAttributes;const{smarteditSlotId:s,smarteditSlotUuid:r}=this.slotAttributes;const a={componentType:e,componentId:t,componentUuid:n,containerType:i,containerId:o,componentAttributes:this.componentAttributes,slotId:s,slotUuid:r};this.listeners=Object.keys(this.itemConfig.action.callbacks).reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:()=>this.itemConfig.action.callbacks[t](a)})),{});Object.keys(this.listeners).forEach((e=>{this.element.nativeElement.addEventListener(e,(()=>this.listeners[e]()))}))}};__decorate([i.Input(),__metadata("design:type",String)],E.prototype,"mode",void 0);__decorate([i.Input(),__metadata("design:type",Number)],E.prototype,"index",void 0);__decorate([i.Input(),__metadata("design:type",Object)],E.prototype,"componentAttributes",void 0);__decorate([i.Input(),__metadata("design:type",Object)],E.prototype,"slotAttributes",void 0);__decorate([i.Input(),__metadata("design:type",Object)],E.prototype,"itemConfig",void 0);E=__decorate([i.Component({selector:"se-contextual-menu-item",template:`<div *ngIf="mode === 'small'" id="{{itemConfig.i18nKey | translate}}-{{componentAttributes.smarteditComponentId}}-{{componentAttributes.smarteditComponentType}}-{{index}}" class="se-ctx-menu-element__btn {{itemConfig.displayIconClass}} {{itemConfig.displayClass}}" [ngClass]="{'is-active': itemConfig.isOpen }" [title]="itemConfig.i18nKey | translate"></div><div *ngIf="mode === 'compact'" class="se-ctx-menu-element__label {{itemConfig.displayClass}}" id="{{itemConfig.i18nKey | translate}}-{{componentAttributes.smarteditComponentId}}-{{componentAttributes.smarteditComponentType}}-{{index}}">{{itemConfig.i18nKey | translate}}</div>`}),__metadata("design:paramtypes",[i.ElementRef])],E);window.__smartedit__.addDecoratorPayload("Component","SmarteditComponent",{selector:a.SMARTEDIT_COMPONENT_NAME,template:``});let I=class SmarteditComponent{constructor(e){a.registerCustomComponents(e)}};I=__decorate([i.Component({selector:a.SMARTEDIT_COMPONENT_NAME,template:``}),__metadata("design:paramtypes",[i.Injector])],I);class BaseContextualMenuComponent{constructor(){this.remainOpenMap={}}isHybrisIcon(e){return e&&e.indexOf("hyicon")>=0}setRemainOpen(e,t){this.remainOpenMap[e]=t}showOverlay(e){if(e){return true}return Object.keys(this.remainOpenMap).reduce(((e,t)=>e||this.remainOpenMap[t]),false)}}window.__smartedit__.addDecoratorPayload("Component","MoreItemsComponent",{selector:"se-more-items-component",template:`\n        <div class="se-contextual-more-menu fd-menu">\n            <ul\n                id="{{ parent.smarteditComponentId }}-{{ parent.smarteditComponentType }}-more-menu"\n                class="fd-menu__list se-contextual-more-menu__list">\n                <li\n                    *ngFor="let item of parent.getItems().moreMenuItems; let $index = index"\n                    [attr.data-smartedit-id]="parent.smarteditComponentId"\n                    [attr.data-smartedit-type]="parent.smarteditComponentType"\n                    class="se-contextual-more-menu__item fd-menu__item"\n                    [ngClass]="item.customCss">\n                    <se-popup-overlay\n                        [popupOverlay]="parent.itemTemplateOverlayWrapper"\n                        [popupOverlayTrigger]="parent.shouldShowTemplate(item)"\n                        [popupOverlayData]="{ item: item }"\n                        (popupOverlayOnShow)="parent.onShowItemPopup(item)"\n                        (popupOverlayOnHide)="parent.onHideItemPopup(false)">\n                        <se-contextual-menu-item\n                            [mode]="'compact'"\n                            [index]="$index"\n                            [componentAttributes]="parent.componentAttributes"\n                            [slotAttributes]="parent.slotAttributes"\n                            [itemConfig]="item"\n                            (click)="parent.triggerMenuItemAction(item, $event)"\n                            [attr.data-component-id]="parent.smarteditComponentId"\n                            [attr.data-component-uuid]="\n                                parent.componentAttributes.smarteditComponentUuid\n                            "\n                            [attr.data-component-type]="parent.smarteditComponentType"\n                            [attr.data-slot-id]="parent.smarteditSlotId"\n                            [attr.data-slot-uuid]="parent.smarteditSlotUuid"\n                            [attr.data-container-id]="parent.smarteditContainerId"\n                            [attr.data-container-type]="parent.smarteditContainerType">\n                        </se-contextual-menu-item>\n                    </se-popup-overlay>\n                </li>\n            </ul>\n        </div>\n    `});t.MoreItemsComponent=class MoreItemsComponent{constructor(e){this.parent=e}};t.MoreItemsComponent=__decorate([i.Component({selector:"se-more-items-component",template:`\n        <div class="se-contextual-more-menu fd-menu">\n            <ul\n                id="{{ parent.smarteditComponentId }}-{{ parent.smarteditComponentType }}-more-menu"\n                class="fd-menu__list se-contextual-more-menu__list">\n                <li\n                    *ngFor="let item of parent.getItems().moreMenuItems; let $index = index"\n                    [attr.data-smartedit-id]="parent.smarteditComponentId"\n                    [attr.data-smartedit-type]="parent.smarteditComponentType"\n                    class="se-contextual-more-menu__item fd-menu__item"\n                    [ngClass]="item.customCss">\n                    <se-popup-overlay\n                        [popupOverlay]="parent.itemTemplateOverlayWrapper"\n                        [popupOverlayTrigger]="parent.shouldShowTemplate(item)"\n                        [popupOverlayData]="{ item: item }"\n                        (popupOverlayOnShow)="parent.onShowItemPopup(item)"\n                        (popupOverlayOnHide)="parent.onHideItemPopup(false)">\n                        <se-contextual-menu-item\n                            [mode]="'compact'"\n                            [index]="$index"\n                            [componentAttributes]="parent.componentAttributes"\n                            [slotAttributes]="parent.slotAttributes"\n                            [itemConfig]="item"\n                            (click)="parent.triggerMenuItemAction(item, $event)"\n                            [attr.data-component-id]="parent.smarteditComponentId"\n                            [attr.data-component-uuid]="\n                                parent.componentAttributes.smarteditComponentUuid\n                            "\n                            [attr.data-component-type]="parent.smarteditComponentType"\n                            [attr.data-slot-id]="parent.smarteditSlotId"\n                            [attr.data-slot-uuid]="parent.smarteditSlotUuid"\n                            [attr.data-container-id]="parent.smarteditContainerId"\n                            [attr.data-container-type]="parent.smarteditContainerType">\n                        </se-contextual-menu-item>\n                    </se-popup-overlay>\n                </li>\n            </ul>\n        </div>\n    `}),__param(0,i.Inject(i.forwardRef((()=>t.ContextualMenuDecoratorComponent)))),__metadata("design:paramtypes",[t.ContextualMenuDecoratorComponent])],t.MoreItemsComponent);window.__smartedit__.addDecoratorPayload("Component","ContextualMenuItemOverlayComponent",{template:`\n        <div *ngIf="item.action.component" class="se-contextual-extra-menu">\n            <ng-container\n                *ngComponentOutlet="\n                    item.action.component;\n                    injector: componentInjector\n                "></ng-container>\n        </div>\n    `,selector:"se-contextual-menu-item-overlay"});t.ContextualMenuItemOverlayComponent=class ContextualMenuItemOverlayComponent{constructor(e,t,n){this.data=e;this.parent=t;this.injector=n}ngOnInit(){this.createComponentInjector()}get item(){return this.data.item}createComponentInjector(){this.componentInjector=i.Injector.create({parent:this.injector,providers:[{provide:a.CONTEXTUAL_MENU_ITEM_DATA,useValue:{componentAttributes:this.parent.componentAttributes,setRemainOpen:(e,t)=>this.parent.setRemainOpen(e,t)}}]})}};t.ContextualMenuItemOverlayComponent=__decorate([i.Component({template:`\n        <div *ngIf="item.action.component" class="se-contextual-extra-menu">\n            <ng-container\n                *ngComponentOutlet="\n                    item.action.component;\n                    injector: componentInjector\n                "></ng-container>\n        </div>\n    `,selector:"se-contextual-menu-item-overlay"}),__param(0,i.Inject(a.POPUP_OVERLAY_DATA)),__param(1,i.Inject(i.forwardRef((()=>t.ContextualMenuDecoratorComponent)))),__metadata("design:paramtypes",[Object,t.ContextualMenuDecoratorComponent,i.Injector])],t.ContextualMenuItemOverlayComponent);window.__smartedit__.addDecoratorPayload("Component","ContextualMenuDecoratorComponent",{selector:"contextual-menu",template:`<div class="se-ctx-menu-decorator-wrapper" [ngClass]="{'se-ctx-menu-decorator__border--visible': showContextualMenuBorders()}"><div class="se-ctx-menu__overlay" *ngIf="showOverlay(active)"><div class="se-ctx-menu__overlay__left-section" *ngIf="getItems()"><div *ngFor="let item of getItems().leftMenuItems; let $index = index" id="{{ item.key }}"><se-popup-overlay [popupOverlay]="itemTemplateOverlayWrapper" [popupOverlayTrigger]="shouldShowTemplate(item)" [popupOverlayData]="{ item: item }" (popupOverlayOnShow)="onShowItemPopup(item)" (popupOverlayOnHide)="onHideItemPopup(false)"><se-contextual-menu-item [mode]="'small'" [index]="$index" [componentAttributes]="componentAttributes" [slotAttributes]="slotAttributes" [itemConfig]="item" (click)="triggerMenuItemAction(item, $event)" [attr.data-component-id]="smarteditComponentId" [attr.data-component-uuid]="componentAttributes.smarteditComponentUuid" [attr.data-component-type]="smarteditComponentType" [attr.data-slot-id]="smarteditSlotId" [attr.data-slot-uuid]="smarteditSlotUuid" [attr.data-container-id]="smarteditContainerId" [attr.data-container-type]="smarteditContainerType"></se-contextual-menu-item></se-popup-overlay></div></div><se-popup-overlay [popupOverlay]="moreMenuPopupConfig" [popupOverlayTrigger]="moreMenuIsOpen" (popupOverlayOnShow)="onShowMoreMenuPopup()" (popupOverlayOnHide)="onHideMoreMenuPopup()"><div *ngIf="getItems() && getItems().moreMenuItems.length > 0" class="se-ctx-menu-element__btn se-ctx-menu-element__btn--more" [ngClass]="{'se-ctx-menu-element__btn--more--open': moreMenuIsOpen }" (click)="toggleMoreMenu()"><span [title]="moreButton.i18nKey | translate" class="{{moreButton.displayClass}}"></span></div></se-popup-overlay></div><div class="se-wrapper-data"><div><ng-content></ng-content></div></div></div>`});t.ContextualMenuDecoratorComponent=class ContextualMenuDecoratorComponent extends BaseContextualMenuComponent{constructor(e,n,i,o,s,r,l,c){super();this.yjQuery=e;this.element=n;this.contextualMenuService=i;this.systemEventService=o;this.componentHandlerService=s;this.nodeUtils=r;this.crossFrameEventService=l;this.userTrackingService=c;this.openItem=null;this.moreMenuIsOpen=false;this.itemTemplateOverlayWrapper={component:t.ContextualMenuItemOverlayComponent};this.moreMenuPopupConfig={component:t.MoreItemsComponent,halign:"left"};this.moreButton={displayClass:"sap-icon--overflow",i18nKey:"se.cms.contextmenu.title.more"};this.oldWidth=null;this.crossFrameEventService.subscribe(a.EVENT_PAGE_TREE_COMPONENT_SELECTED,((e,t)=>{if(this.smarteditElementUuid===t.elementUuid){this._pageTreeActive=t.active;if(!this._pageTreeActive){this._active=false}}else{this._pageTreeActive=false}}));this.crossFrameEventService.subscribe(a.EVENT_OUTER_FRAME_CLICKED,(()=>{if(this.crossFrameEventService.isIframe()){this.hideAllPopups()}}))}set active(e){if(typeof e==="string"){this._active=e==="true"}else{this._active=e}if(!this._active){this._pageTreeActive=false}}get active(){return this._active||this._pageTreeActive}ngDoCheck(){if(this.element){const e=this.element.nativeElement.offsetWidth;if(this.oldWidth!==e){this.oldWidth=e;this.ngOnDestroy();this.onInit()}}}ngOnDestroy(){if(this.dndUnRegFn){this.dndUnRegFn()}if(this.unregisterRefreshItems){this.unregisterRefreshItems()}}ngOnInit(){this.componentAttributes=this.nodeUtils.collectSmarteditAttributesByElementUuid(this.smarteditElementUuid);this.slotAttributes={smarteditSlotId:this.smarteditSlotId,smarteditSlotUuid:this.smarteditSlotUuid};this.onInit();this.contextualMenuService.onContextualMenuItemsAdded.pipe(p.filter((e=>e===this.smarteditComponentType))).subscribe((e=>this.updateItems()))}get smarteditSlotId(){return this.componentHandlerService.getParentSlotForComponent(this.element.nativeElement)}get smarteditSlotUuid(){return this.componentHandlerService.getParentSlotUuidForComponent(this.element.nativeElement)}onInit(){this.updateItems();this.dndUnRegFn=this.systemEventService.subscribe(a.CLOSE_CTX_MENU,(()=>this.hideAllPopups()));this.unregisterRefreshItems=this.systemEventService.subscribe(a.REFRESH_CONTEXTUAL_MENU_ITEMS_EVENT,(()=>this.updateItems))}toggleMoreMenu(){this.moreMenuIsOpen=!this.moreMenuIsOpen}shouldShowTemplate(e){return this.displayedItem===e}onShowItemPopup(e){this.setRemainOpen("someContextualPopupOverLay",true);this.openItem=e;this.openItem.isOpen=true}onHideItemPopup(e=false){if(this.openItem){this.openItem.isOpen=false;this.openItem=null}this.displayedItem=null;this.setRemainOpen("someContextualPopupOverLay",false);if(e){this.onHideMoreMenuPopup()}}onShowMoreMenuPopup(){this.setRemainOpen("someContextualPopupOverLay",true)}onHideMoreMenuPopup(){this.moreMenuIsOpen=false;this.setRemainOpen("someContextualPopupOverLay",false)}hideAllPopups(){this.onHideMoreMenuPopup();this.onHideItemPopup()}getItems(){return this.items}showContextualMenuBorders(){return this.active&&this.items&&this.items.leftMenuItems.length>0}triggerMenuItemAction(e,t){t.stopPropagation();t.preventDefault();this.userTrackingService.trackingUserAction(a.USER_TRACKING_FUNCTIONALITY.CONTEXT_MENU,e.i18nKey);if(e.action.component){if(this.displayedItem===e){this.displayedItem=null}else{this.displayedItem=e}}else if(e.action.callback){this.hideAllPopups();e.action.callback({componentType:this.smarteditComponentType,componentId:this.smarteditComponentId,containerType:this.smarteditContainerType,containerId:this.smarteditContainerId,componentAttributes:this.componentAttributes,slotId:this.smarteditSlotId,slotUuid:this.smarteditSlotUuid,element:this.yjQuery(this.element.nativeElement)},t)}}maxContextualMenuItems(){const e=50;const t=Math.round(this.yjQuery(this.element.nativeElement).width()/e)-1;let n=t>=4?3:t-1;n=n<0?0:n;return n}updateItems(){this.contextualMenuService.getContextualMenuItems({componentType:this.smarteditComponentType,componentId:this.smarteditComponentId,containerType:this.smarteditContainerType,containerId:this.smarteditContainerId,componentAttributes:this.componentAttributes,iLeftBtns:this.maxContextualMenuItems(),element:this.yjQuery(this.element.nativeElement)}).then((e=>{this.items=e}))}};__decorate([i.Input("data-smartedit-component-type"),__metadata("design:type",String)],t.ContextualMenuDecoratorComponent.prototype,"smarteditComponentType",void 0);__decorate([i.Input("data-smartedit-component-id"),__metadata("design:type",String)],t.ContextualMenuDecoratorComponent.prototype,"smarteditComponentId",void 0);__decorate([i.Input("data-smartedit-container-type"),__metadata("design:type",String)],t.ContextualMenuDecoratorComponent.prototype,"smarteditContainerType",void 0);__decorate([i.Input("data-smartedit-container-id"),__metadata("design:type",String)],t.ContextualMenuDecoratorComponent.prototype,"smarteditContainerId",void 0);__decorate([i.Input("data-smartedit-catalog-version-uuid"),__metadata("design:type",String)],t.ContextualMenuDecoratorComponent.prototype,"smarteditCatalogVersionUuid",void 0);__decorate([i.Input("data-smartedit-element-uuid"),__metadata("design:type",String)],t.ContextualMenuDecoratorComponent.prototype,"smarteditElementUuid",void 0);__decorate([i.Input(),__metadata("design:type",Object)],t.ContextualMenuDecoratorComponent.prototype,"componentAttributes",void 0);__decorate([i.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],t.ContextualMenuDecoratorComponent.prototype,"active",null);t.ContextualMenuDecoratorComponent=__decorate([a.SeCustomComponent(),i.Component({selector:"contextual-menu",template:`<div class="se-ctx-menu-decorator-wrapper" [ngClass]="{'se-ctx-menu-decorator__border--visible': showContextualMenuBorders()}"><div class="se-ctx-menu__overlay" *ngIf="showOverlay(active)"><div class="se-ctx-menu__overlay__left-section" *ngIf="getItems()"><div *ngFor="let item of getItems().leftMenuItems; let $index = index" id="{{ item.key }}"><se-popup-overlay [popupOverlay]="itemTemplateOverlayWrapper" [popupOverlayTrigger]="shouldShowTemplate(item)" [popupOverlayData]="{ item: item }" (popupOverlayOnShow)="onShowItemPopup(item)" (popupOverlayOnHide)="onHideItemPopup(false)"><se-contextual-menu-item [mode]="'small'" [index]="$index" [componentAttributes]="componentAttributes" [slotAttributes]="slotAttributes" [itemConfig]="item" (click)="triggerMenuItemAction(item, $event)" [attr.data-component-id]="smarteditComponentId" [attr.data-component-uuid]="componentAttributes.smarteditComponentUuid" [attr.data-component-type]="smarteditComponentType" [attr.data-slot-id]="smarteditSlotId" [attr.data-slot-uuid]="smarteditSlotUuid" [attr.data-container-id]="smarteditContainerId" [attr.data-container-type]="smarteditContainerType"></se-contextual-menu-item></se-popup-overlay></div></div><se-popup-overlay [popupOverlay]="moreMenuPopupConfig" [popupOverlayTrigger]="moreMenuIsOpen" (popupOverlayOnShow)="onShowMoreMenuPopup()" (popupOverlayOnHide)="onHideMoreMenuPopup()"><div *ngIf="getItems() && getItems().moreMenuItems.length > 0" class="se-ctx-menu-element__btn se-ctx-menu-element__btn--more" [ngClass]="{'se-ctx-menu-element__btn--more--open': moreMenuIsOpen }" (click)="toggleMoreMenu()"><span [title]="moreButton.i18nKey | translate" class="{{moreButton.displayClass}}"></span></div></se-popup-overlay></div><div class="se-wrapper-data"><div><ng-content></ng-content></div></div></div>`}),__param(0,i.Inject(a.YJQUERY_TOKEN)),__metadata("design:paramtypes",[Function,i.ElementRef,a.IContextualMenuService,a.SystemEventService,a.IComponentHandlerService,a.NodeUtils,a.CrossFrameEventService,a.IUserTrackingService])],t.ContextualMenuDecoratorComponent);const b=".se-decorative-body__padding--left";const T=".se-decorative-body__padding--right";const O=".se-decorative-panel-area";const P=".se-decoratorative-body-area";window.__smartedit__.addDecoratorPayload("Component","SlotContextualMenuDecoratorComponent",{selector:"slot-contextual-menu",template:`<div class="se-decorative-panel-wrapper"><ng-container *ngIf="showOverlay(active) && !showAtBottom"><ng-container *ngTemplateOutlet="decorativePanelArea"></ng-container></ng-container><div class="se-decoratorative-body-area"><div class="se-decorative-body__padding--left" [ngClass]="{ 'active': active }"></div><div class="se-decorative-body__inner-border" [ngClass]="{ 'active': active }"></div><div class="se-wrapper-data" [ngClass]="{ 'active': active }"><ng-content></ng-content></div><div class="se-decorative-body__padding--right" [ngClass]="{ 'active': active }"></div></div><ng-container *ngIf="showOverlay(active) && showAtBottom"><ng-container *ngTemplateOutlet="decorativePanelArea"></ng-container></ng-container><ng-template #decorativePanelArea><div class="se-decorative-panel-area" [ngStyle]="showAtBottom && { 'margin-top': '0px' }"><span class="se-decorative-panel__title">{{smarteditComponentId}}</span><div class="se-decorative-panel__slot-contextual-menu"><slot-contextual-menu-item [item]="item" *ngFor="let item of items"></slot-contextual-menu-item></div></div></ng-template></div>`});t.SlotContextualMenuDecoratorComponent=class SlotContextualMenuDecoratorComponent extends BaseContextualMenuComponent{constructor(e,t,n,i,o,s){super();this.element=e;this.yjQuery=t;this.systemEventService=n;this.contextualMenuService=i;this.nodeUtils=o;this.crossFrameEventService=s;this.oldRightMostOffsetFromPage=null;this.maxContextualMenuItems=3;this.showAtBottom=this.element.nativeElement.getAttribute("show-at-bottom")||false;const l=200;this.positionPanelHorizontally=r.throttle(this.positionPanelHorizontally,l);this.positionPanelVertically=r.throttle((()=>this.positionPanelVertically()),l);this.hidePadding=r.throttle(this.hidePadding,l);this.crossFrameEventService.subscribe(a.EVENT_PAGE_TREE_SLOT_SELECTED,((e,t)=>{if(this.smarteditElementUuid===t.elementUuid){this._active=t.active}else{this._active=false}}))}set active(e){this._active=e==="true"}get active(){return this._active}ngOnChanges(e){if(e.active){this.hidePadding();if(this.active){this.positionPanelVertically();this.positionPanelHorizontally()}}}ngOnInit(){this.componentAttributes=this.nodeUtils.collectSmarteditAttributesByElementUuid(this.smarteditElementUuid);this.updateItems();this.showSlotMenuUnregFn=this.systemEventService.subscribe(this.smarteditComponentId+a.SHOW_SLOT_MENU,((e,t)=>{this.remainOpenMap.slotMenuButton=true;this.positionPanelVertically();this.positionPanelHorizontally()}));this.hideSlotMenuUnregFn=this.systemEventService.subscribe(a.HIDE_SLOT_MENU,(()=>{if(this.remainOpenMap.slotMenuButton){delete this.remainOpenMap.slotMenuButton}this.hidePadding()}));this.refreshContextualMenuUnregFn=this.systemEventService.subscribe(a.REFRESH_CONTEXTUAL_MENU_ITEMS_EVENT,(()=>this.updateItems()));this.contextualMenuService.onContextualMenuItemsAdded.pipe(p.filter((e=>e===this.smarteditComponentType))).subscribe((()=>this.updateItems()))}ngDoCheck(){const e=this.getRightMostOffsetFromPage();if(this.active&&!isNaN(e)&&e!==this.oldRightMostOffsetFromPage){this.oldRightMostOffsetFromPage=e;this.positionPanelHorizontally(e)}}ngOnDestroy(){if(this.showSlotMenuUnregFn){this.showSlotMenuUnregFn()}if(this.hideSlotMenuUnregFn){this.hideSlotMenuUnregFn()}if(this.refreshContextualMenuUnregFn){this.refreshContextualMenuUnregFn()}if(this.hideSlotUnSubscribeFn){this.hideSlotUnSubscribeFn()}if(this.showSlotUnSubscribeFn){this.showSlotUnSubscribeFn()}}updateItems(){this.contextualMenuService.getContextualMenuItems({componentType:this.smarteditComponentType,componentId:this.smarteditComponentId,containerType:this.smarteditContainerType,containerId:this.smarteditContainerId,componentAttributes:this.componentAttributes,iLeftBtns:this.maxContextualMenuItems,element:this.yjQuery(this.element.nativeElement)}).then((e=>{this.items=[...e.leftMenuItems,...e.moreMenuItems]}))}triggerMenuItemAction(e,t){e.action.callback({componentType:this.smarteditComponentType,componentId:this.smarteditComponentId,containerType:this.smarteditContainerType,containerId:this.smarteditContainerId,componentAttributes:this.componentAttributes,slotId:this.smarteditSlotId,slotUuid:this.smarteditSlotUuid,element:this.yjQuery(this.element.nativeElement)},t)}hidePadding(){this.yjQuery(this.element.nativeElement).find(b).css("display","none");this.yjQuery(this.element.nativeElement).find(T).css("display","none")}getRightMostOffsetFromPage(){const e=this.yjQuery(this.element.nativeElement).find(O);return this.yjQuery(this.element.nativeElement).offset().left+e.width()}positionPanelHorizontally(e){const t=this.yjQuery(this.element.nativeElement).find(O);e=e!==undefined?e:this.getRightMostOffsetFromPage();const n=e>=this.yjQuery("body").width();if(n){const e=t.outerWidth()-this.yjQuery(this.element.nativeElement).find(".se-wrapper-data").width();t.css("margin-left",-e);this.yjQuery(this.element.nativeElement).find(b).css("margin-left",-e)}this.hidePadding();this.yjQuery(this.element.nativeElement).find(n?b:T).css("display","flex")}positionPanelVertically(){const e=this.yjQuery(this.element.nativeElement).find(O);const t=this.yjQuery(this.element.nativeElement).find(P);let n;const i=e.height();const o=-32;if(this.yjQuery(this.element.nativeElement).offset().top<=i){const e=6;n=t.height()+e;t.css("margin-top",-(n+i))}else{n=o}e.css("margin-top",n)}};__decorate([i.Input("data-smartedit-component-type"),__metadata("design:type",String)],t.SlotContextualMenuDecoratorComponent.prototype,"smarteditComponentType",void 0);__decorate([i.Input("data-smartedit-component-id"),__metadata("design:type",String)],t.SlotContextualMenuDecoratorComponent.prototype,"smarteditComponentId",void 0);__decorate([i.Input("data-smartedit-container-type"),__metadata("design:type",String)],t.SlotContextualMenuDecoratorComponent.prototype,"smarteditContainerType",void 0);__decorate([i.Input("data-smartedit-container-id"),__metadata("design:type",String)],t.SlotContextualMenuDecoratorComponent.prototype,"smarteditContainerId",void 0);__decorate([i.Input("data-smartedit-slot-id"),__metadata("design:type",String)],t.SlotContextualMenuDecoratorComponent.prototype,"smarteditSlotId",void 0);__decorate([i.Input("data-smartedit-slot-uuid"),__metadata("design:type",String)],t.SlotContextualMenuDecoratorComponent.prototype,"smarteditSlotUuid",void 0);__decorate([i.Input("data-smartedit-catalog-version-uuid"),__metadata("design:type",String)],t.SlotContextualMenuDecoratorComponent.prototype,"smarteditCatalogVersionUuid",void 0);__decorate([i.Input("data-smartedit-element-uuid"),__metadata("design:type",String)],t.SlotContextualMenuDecoratorComponent.prototype,"smarteditElementUuid",void 0);__decorate([i.Input(),__metadata("design:type",Object)],t.SlotContextualMenuDecoratorComponent.prototype,"componentAttributes",void 0);__decorate([i.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],t.SlotContextualMenuDecoratorComponent.prototype,"active",null);t.SlotContextualMenuDecoratorComponent=__decorate([a.SeCustomComponent(),i.Component({selector:"slot-contextual-menu",template:`<div class="se-decorative-panel-wrapper"><ng-container *ngIf="showOverlay(active) && !showAtBottom"><ng-container *ngTemplateOutlet="decorativePanelArea"></ng-container></ng-container><div class="se-decoratorative-body-area"><div class="se-decorative-body__padding--left" [ngClass]="{ 'active': active }"></div><div class="se-decorative-body__inner-border" [ngClass]="{ 'active': active }"></div><div class="se-wrapper-data" [ngClass]="{ 'active': active }"><ng-content></ng-content></div><div class="se-decorative-body__padding--right" [ngClass]="{ 'active': active }"></div></div><ng-container *ngIf="showOverlay(active) && showAtBottom"><ng-container *ngTemplateOutlet="decorativePanelArea"></ng-container></ng-container><ng-template #decorativePanelArea><div class="se-decorative-panel-area" [ngStyle]="showAtBottom && { 'margin-top': '0px' }"><span class="se-decorative-panel__title">{{smarteditComponentId}}</span><div class="se-decorative-panel__slot-contextual-menu"><slot-contextual-menu-item [item]="item" *ngFor="let item of items"></slot-contextual-menu-item></div></div></ng-template></div>`}),__param(1,i.Inject(a.YJQUERY_TOKEN)),__metadata("design:paramtypes",[i.ElementRef,Function,a.SystemEventService,a.IContextualMenuService,a.NodeUtils,a.CrossFrameEventService])],t.SlotContextualMenuDecoratorComponent);window.__smartedit__.addDecoratorPayload("Component","SlotContextualMenuItemComponent",{selector:"slot-contextual-menu-item",template:`\n        <div *ngIf="!item.action.component">\n            <span\n                *ngIf="item.iconIdle && parent.isHybrisIcon(item.displayClass)"\n                id="{{ item.i18nKey | translate }}-{{ parent.smarteditComponentId }}-{{\n                    parent.smarteditComponentType\n                }}-hyicon"\n                (click)="parent.triggerMenuItemAction(item, $event)"\n                [ngClass]="{ clickable: true }">\n                <img\n                    [src]="isHovered ? item.iconNonIdle : item.iconIdle"\n                    id="{{ item.i18nKey | translate }}-{{ parent.smarteditComponentId }}-{{\n                        parent.smarteditComponentType\n                    }}-hyicon-img"\n                    title="{{ item.i18nKey | translate }}" />\n            </span>\n            <img\n                [title]="item.i18nKey | translate"\n                *ngIf="item.iconIdle && !parent.isHybrisIcon(item.displayClass)"\n                [ngClass]="{ clickable: true }"\n                (click)="parent.triggerMenuItemAction(item, $event)"\n                [src]="isHovered ? item.iconNonIdle : item.iconIdle"\n                [alt]="item.i18nKey"\n                class="{{ item.displayClass }}"\n                id="{{ item.i18nKey | translate }}-{{ parent.smarteditComponentId }}-{{\n                    parent.smarteditComponentType\n                }}" />\n        </div>\n\n        <div *ngIf="item.action.component">\n            <ng-container\n                *ngComponentOutlet="\n                    item.action.component;\n                    injector: componentInjector\n                "></ng-container>\n        </div>\n    `});t.SlotContextualMenuItemComponent=class SlotContextualMenuItemComponent{constructor(e,t){this.parent=e;this.injector=t}onMouseOver(){this.isHovered=true}onMouseOut(){this.isHovered=false}ngOnInit(){this.createComponentInjector()}ngOnChanges(){this.createComponentInjector()}createComponentInjector(){this.componentInjector=i.Injector.create({parent:this.injector,providers:[{provide:a.CONTEXTUAL_MENU_ITEM_DATA,useValue:{componentAttributes:this.parent.componentAttributes,setRemainOpen:(e,t)=>this.parent.setRemainOpen(e,t)}}]})}};__decorate([i.Input(),__metadata("design:type",Object)],t.SlotContextualMenuItemComponent.prototype,"item",void 0);__decorate([i.HostListener("mouseover"),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],t.SlotContextualMenuItemComponent.prototype,"onMouseOver",null);__decorate([i.HostListener("mouseout"),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],t.SlotContextualMenuItemComponent.prototype,"onMouseOut",null);t.SlotContextualMenuItemComponent=__decorate([i.Component({selector:"slot-contextual-menu-item",template:`\n        <div *ngIf="!item.action.component">\n            <span\n                *ngIf="item.iconIdle && parent.isHybrisIcon(item.displayClass)"\n                id="{{ item.i18nKey | translate }}-{{ parent.smarteditComponentId }}-{{\n                    parent.smarteditComponentType\n                }}-hyicon"\n                (click)="parent.triggerMenuItemAction(item, $event)"\n                [ngClass]="{ clickable: true }">\n                <img\n                    [src]="isHovered ? item.iconNonIdle : item.iconIdle"\n                    id="{{ item.i18nKey | translate }}-{{ parent.smarteditComponentId }}-{{\n                        parent.smarteditComponentType\n                    }}-hyicon-img"\n                    title="{{ item.i18nKey | translate }}" />\n            </span>\n            <img\n                [title]="item.i18nKey | translate"\n                *ngIf="item.iconIdle && !parent.isHybrisIcon(item.displayClass)"\n                [ngClass]="{ clickable: true }"\n                (click)="parent.triggerMenuItemAction(item, $event)"\n                [src]="isHovered ? item.iconNonIdle : item.iconIdle"\n                [alt]="item.i18nKey"\n                class="{{ item.displayClass }}"\n                id="{{ item.i18nKey | translate }}-{{ parent.smarteditComponentId }}-{{\n                    parent.smarteditComponentType\n                }}" />\n        </div>\n\n        <div *ngIf="item.action.component">\n            <ng-container\n                *ngComponentOutlet="\n                    item.action.component;\n                    injector: componentInjector\n                "></ng-container>\n        </div>\n    `}),__param(0,i.Inject(i.forwardRef((()=>t.SlotContextualMenuDecoratorComponent)))),__metadata("design:paramtypes",[t.SlotContextualMenuDecoratorComponent,i.Injector])],t.SlotContextualMenuItemComponent);const w="smartedit-element";window.__smartedit__.addDecoratorPayload("Component","SmarteditElementComponent",{selector:w,template:` <div id="projectedContent"><ng-content></ng-content></div> `});let A=class SmarteditElementComponent{constructor(e,t,n,i,o){this.elementRef=e;this.sakExecutorService=t;this.systemEventService=n;this.crossFrameEventService=i;this.polyfillService=o;this.active=false;this.componentDecoratorEnabled=true;this.removeDecorators=()=>{if(this.bundle&&this.element.contains(this.bundle)){this.element.removeChild(this.bundle)}this.bundle=this.projectedContent;this.element.appendChild(this.bundle)};this.appendDecorators=()=>{if(this.bundle&&this.element.contains(this.bundle)){this.element.removeChild(this.bundle)}this.sakExecutorService.wrapDecorators(this.projectedContent,this.element).then((e=>{this.bundle=e;this.element.appendChild(this.bundle)}))};this.propagateActiveStateToChildren=()=>{this.element.querySelectorAll("[active]").forEach((e=>{if(this.uuid===this.getUuid(e)){e.setAttribute("active",this.active+"")}}))}}ngOnInit(){const e=this.element.querySelector("#projectedContent");this.projectedContent=e.children[0];this.element.removeChild(e);this.appendDecorators()}ngAfterViewInit(){this.mousenterListener=e=>{if(!this.active){this.active=this.componentDecoratorEnabled;this.propagateActiveStateToChildren()}};this.mouseleaveListener=e=>{if(this.active){this.active=false;this.propagateActiveStateToChildren()}};this.element.addEventListener("mouseenter",this.mousenterListener);this.element.addEventListener("mouseleave",this.mouseleaveListener);this.unregisterPerspectiveChangeEvent=this.crossFrameEventService.subscribe(a.EVENT_PERSPECTIVE_CHANGED,((e,t)=>{t&&this.appendDecorators()}));this.unregisterPerspectiveRefreshedEvent=this.crossFrameEventService.subscribe(a.EVENT_PERSPECTIVE_REFRESHED,((e,t)=>{t&&this.appendDecorators()}));this.unregisterComponentUpdatedEvent=this.crossFrameEventService.subscribe(a.EVENT_SMARTEDIT_COMPONENT_UPDATED,this.onComponentUpdated.bind(this));this.unregisterDnDStart=this.systemEventService.subscribe(a.SMARTEDIT_DRAG_AND_DROP_EVENTS.DRAG_DROP_START,((e,t)=>{if(this.polyfillService.isEligibleForEconomyMode()&&t&&this.uuid===t.attr(a.ELEMENT_UUID_ATTRIBUTE)){this.componentDecoratorEnabled=false;this.removeDecorators()}}));this.unregisterDnDEnd=this.systemEventService.subscribe(a.SMARTEDIT_DRAG_AND_DROP_EVENTS.DRAG_DROP_END,(()=>{if(this.polyfillService.isEligibleForEconomyMode()){this.componentDecoratorEnabled=true;this.appendDecorators()}}))}ngOnDestroy(){this.removeDecorators();this.unregisterPerspectiveChangeEvent();this.unregisterPerspectiveRefreshedEvent();this.unregisterComponentUpdatedEvent();this.unregisterDnDEnd();this.unregisterDnDStart();this.element.removeEventListener("mouseenter",this.mousenterListener);this.element.removeEventListener("mouseleave",this.mouseleaveListener);delete this.bundle}onComponentUpdated(e,t){const n=t&&t.requiresReplayingDecorators;const i=t&&t.componentId===this.smarteditComponentId&&t.componentType===this.smarteditComponentType;if(i&&n){this.appendDecorators()}}getUuid(e){return e.getAttribute(a.ELEMENT_UUID_ATTRIBUTE)}get uuid(){return this.element.getAttribute(a.ELEMENT_UUID_ATTRIBUTE)}get element(){return this.elementRef.nativeElement}};__decorate([i.Input("data-smartedit-component-id"),__metadata("design:type",String)],A.prototype,"smarteditComponentId",void 0);__decorate([i.Input("data-smartedit-component-uuid"),__metadata("design:type",String)],A.prototype,"smarteditComponentUuid",void 0);__decorate([i.Input("data-smartedit-component-type"),__metadata("design:type",String)],A.prototype,"smarteditComponentType",void 0);__decorate([i.Input("data-smartedit-container-id"),__metadata("design:type",String)],A.prototype,"smarteditContainerId",void 0);__decorate([i.Input("data-smartedit-container-type"),__metadata("design:type",String)],A.prototype,"smarteditContainerType",void 0);A=__decorate([a.SeCustomComponent(),i.Component({selector:w,template:` <div id="projectedContent"><ng-content></ng-content></div> `}),__metadata("design:paramtypes",[i.ElementRef,C,a.SystemEventService,a.CrossFrameEventService,a.PolyfillService])],A);let R=class StorageGateway{handleStorageRequest(e,t,n){"proxyFunction";return null}};R=__decorate([a.GatewayProxied("handleStorageRequest")],R);class StorageProxy{constructor(e,t){this.configuration=e;this.storageGateway=t}clear(){return this.storageGateway.handleStorageRequest(this.configuration,"clear",[])}dispose(){return this.storageGateway.handleStorageRequest(this.configuration,"dispose",[])}entries(){return this.storageGateway.handleStorageRequest(this.configuration,"entries",[])}find(e){const t=e?[e]:[];return this.storageGateway.handleStorageRequest(this.configuration,"find",t)}get(e){const t=e?[e]:[];return this.storageGateway.handleStorageRequest(this.configuration,"get",t)}getLength(){return this.storageGateway.handleStorageRequest(this.configuration,"getLength",[])}put(e,t){const n=t?[e,t]:[e];return this.storageGateway.handleStorageRequest(this.configuration,"put",n)}remove(e){const t=e?[e]:[];return this.storageGateway.handleStorageRequest(this.configuration,"remove",t)}}let D=class StorageManagerGateway{constructor(e,t){this.$log=e;this.storageGateway=t}registerStorageController(e){throw new Error(`registerStorageController() is not supported from the smartedit (inner) application, please register controllers from smarteditContainer`)}getStorage(e){const t=`Unable to get storage ${e.storageId}`;return new Promise(((n,i)=>{this.getStorageSanitityCheck(e).then((o=>{if(o){n(new StorageProxy(e,this.storageGateway))}else{this.$log.error(t);i(t)}}),(e=>{this.$log.error(t);this.$log.error(e);i(t)}))}))}deleteExpiredStorages(e){"proxyFunction";return undefined}deleteStorage(e,t){"proxyFunction";return undefined}getStorageSanitityCheck(e){"proxyFunction";return undefined}hasStorage(e){"proxyFunction";return false}};D=__decorate([a.GatewayProxied("getStorageSanitityCheck","deleteExpiredStorages","deleteStorage","hasStorage"),__metadata("design:paramtypes",[a.LogService,a.IStorageGateway])],D);let M=class StorageModule{};M=__decorate([i.NgModule({providers:[{provide:a.IStorageGateway,useValue:R},{provide:a.IStorageManagerGateway,useValue:D},{provide:a.IStorageManagerFactory,deps:[a.IStorageManagerGateway],useFactory:e=>new a.StorageManagerFactory(e)},{provide:a.IStorageManager,deps:[a.IStorageManagerFactory],useFactory:e=>e.getStorageManager("se.nsp")}]})],M);const smarteditFactory=e=>{let n=class Smartedit{};n=__decorate([i.NgModule({schemas:[i.CUSTOM_ELEMENTS_SCHEMA],imports:[s.BrowserModule,o.HttpClientModule,M,t.SmarteditServicesModule,a.PopupOverlayModule,a.HttpInterceptorModule.forRoot(a.RetryInterceptor),a.SeTranslationModule.forRoot(t.TranslationsFetchService),...e.modules],declarations:[I,A,t.ContextualMenuDecoratorComponent,E,t.MoreItemsComponent,t.ContextualMenuItemOverlayComponent,t.SlotContextualMenuDecoratorComponent,t.SlotContextualMenuItemComponent],entryComponents:[I,A,t.ContextualMenuDecoratorComponent,E,t.MoreItemsComponent,t.ContextualMenuItemOverlayComponent,t.SlotContextualMenuDecoratorComponent,t.SlotContextualMenuItemComponent],providers:[{provide:a.IAuthenticationManagerService,useClass:a.AuthenticationManager},{provide:a.IConfirmationModalService,useClass:t.ConfirmationModalService},{provide:a.IAuthenticationService,useClass:t.AuthenticationService},{provide:i.ErrorHandler,useClass:a.SmarteditErrorHandler},{provide:a.IDecoratorService,useClass:t.DecoratorService},{provide:a.IContextualMenuService,useClass:t.ContextualMenuService},C,{provide:a.ISessionService,useClass:t.SessionService},{provide:a.IToolbarServiceFactory,useClass:t.ToolbarServiceFactory},{provide:a.ISharedDataService,useClass:t.SharedDataService},{provide:a.IStorageService,useClass:t.StorageService},{provide:a.IUrlService,useClass:t.UrlService},{provide:a.IIframeClickDetectionService,useClass:t.IframeClickDetectionService},{provide:a.ICatalogService,useClass:t.CatalogService},{provide:a.IExperienceService,useClass:t.ExperienceService},{provide:a.IUserTrackingService,useClass:t.UserTrackingService},a.SmarteditRoutingService,a.moduleUtils.provideValues(e.constants),a.moduleUtils.bootstrap(smarteditBootstrap,[a.GatewayFactory,a.ISmartEditContractChangeListener,t.SeNamespaceService,t.ResizeComponentService,a.IRenderService,a.SystemEventService,a.IPageInfoService,a.IExperienceService,a.PolyfillService,a.CrossFrameEventService,a.IPerspectiveService,a.LanguageService,a.IFeatureService,a.IPageTreeNodeService,a.LogService,a.IUserTrackingService])],bootstrap:[I]})],n);return n};window.__smartedit__.SmarteditFactory=smarteditFactory;function smarteditBootstrap(e,t,n,i,o,s,r,l,c,d,p,m,h,g,_,v){e.initListener();t.onComponentsAdded(((e,t)=>{if(!t){n.reprocessPage();i.resizeComponents(true)}e.forEach((e=>o.createComponent(e)));s.publishAsync(a.OVERLAY_RERENDERED_EVENT,{addedComponents:e})}));t.onComponentsRemoved(((e,t)=>{if(!t){n.reprocessPage()}e.forEach((e=>o.destroyComponent(e.component,e.parent,e.oldAttributes)));s.publishAsync(a.OVERLAY_RERENDERED_EVENT,{removedComponents:u.map(e,"component")})}));t.onComponentResized((e=>{n.reprocessPage();o.updateComponentSizeAndPosition(e)}));t.onComponentRepositioned((e=>{o.updateComponentSizeAndPosition(e)}));t.onComponentChanged(((e,t)=>{n.reprocessPage();o.destroyComponent(e,e.parent,t);o.createComponent(e)}));t.onPageChanged((e=>{r.getCatalogVersionUUIDFromPage().then((e=>{r.getPageUID().then((t=>{l.updateExperiencePageContext(e,t).catch((e=>{_.error(`smartedit.ts - can't updateExperiencePageContext: ${e}`)}))}))}));g.buildSlotNodes()}));if(c.isEligibleForEconomyMode()){s.subscribe(a.SMARTEDIT_DRAG_AND_DROP_EVENTS.DRAG_DROP_START,(function(){t.setEconomyMode(true)}));s.subscribe(a.SMARTEDIT_DRAG_AND_DROP_EVENTS.DRAG_DROP_END,(function(){n.reprocessPage();i.resizeComponents(true);t.setEconomyMode(false)}))}d.subscribe(a.EVENTS.PAGE_CHANGE,(()=>{p.refreshPerspective();m.registerSwitchLanguage()}));t.initListener();g.buildSlotNodes();v.initConfiguration();h.register({key:"se.emptySlotFix",nameI18nKey:"se.emptyslotfix",enablingCallback:()=>{i.resizeComponents(true)},disablingCallback:()=>{i.resizeComponents(false)}});h.addDecorator({key:"se.contextualMenu",nameI18nKey:"contextualMenu"});h.addDecorator({key:"se.slotContextualMenu",nameI18nKey:"se.slot.contextual.menu"})}if(true){i.enableProdMode()}t.BaseContextualMenuComponent=BaseContextualMenuComponent;t.ResizeListener=ResizeListener;t.RestService=RestService;t.smarteditFactory=smarteditFactory},45202:()=>{if(window.seBlockUmd){if(!window.module){window.module=window.seBlockUmd.module}if(!window.define){window.define=window.seBlockUmd.define}}window.seBlockUmd=undefined;delete window.seBlockUmd},49247:(e,t,n)=>{"use strict";n.r(t)},78138:(e,t,n)=>{"use strict";n.r(t)},9952:(e,t,n)=>{"use strict";n.r(t)},57758:(e,t,n)=>{"use strict";n.r(t)},90282:(e,t,n)=>{"use strict";n.r(t)},91912:(e,t,n)=>{"use strict";n.r(t)},13986:(e,t,n)=>{"use strict";n.r(t)},80091:(e,t,n)=>{var i={"./af":90322,"./af.js":90322,"./ar":36936,"./ar-dz":47846,"./ar-dz.js":47846,"./ar-kw":14844,"./ar-kw.js":14844,"./ar-ly":30609,"./ar-ly.js":30609,"./ar-ma":41760,"./ar-ma.js":41760,"./ar-sa":21609,"./ar-sa.js":21609,"./ar-tn":94816,"./ar-tn.js":94816,"./ar.js":36936,"./az":56927,"./az.js":56927,"./be":20467,"./be.js":20467,"./bg":52854,"./bg.js":52854,"./bm":57612,"./bm.js":57612,"./bn":63636,"./bn-bd":16512,"./bn-bd.js":16512,"./bn.js":63636,"./bo":4910,"./bo.js":4910,"./br":75907,"./br.js":75907,"./bs":20714,"./bs.js":20714,"./ca":2709,"./ca.js":2709,"./cs":81993,"./cs.js":81993,"./cv":45597,"./cv.js":45597,"./cy":31826,"./cy.js":31826,"./da":55896,"./da.js":55896,"./de":77960,"./de-at":40538,"./de-at.js":40538,"./de-ch":11141,"./de-ch.js":11141,"./de.js":77960,"./dv":10501,"./dv.js":10501,"./el":33641,"./el.js":33641,"./en-au":22069,"./en-au.js":22069,"./en-ca":28443,"./en-ca.js":28443,"./en-gb":47868,"./en-gb.js":47868,"./en-ie":39444,"./en-ie.js":39444,"./en-il":97025,"./en-il.js":97025,"./en-in":45983,"./en-in.js":45983,"./en-nz":59346,"./en-nz.js":59346,"./en-sg":44610,"./en-sg.js":44610,"./eo":43536,"./eo.js":43536,"./es":9489,"./es-do":50214,"./es-do.js":50214,"./es-mx":26570,"./es-mx.js":26570,"./es-us":54657,"./es-us.js":54657,"./es.js":9489,"./et":42230,"./et.js":42230,"./eu":23757,"./eu.js":23757,"./fa":81505,"./fa.js":81505,"./fi":83450,"./fi.js":83450,"./fil":13887,"./fil.js":13887,"./fo":64757,"./fo.js":64757,"./fr":50782,"./fr-ca":57358,"./fr-ca.js":57358,"./fr-ch":53170,"./fr-ch.js":53170,"./fr.js":50782,"./fy":90116,"./fy.js":90116,"./ga":99305,"./ga.js":99305,"./gd":37434,"./gd.js":37434,"./gl":35192,"./gl.js":35192,"./gom-deva":71383,"./gom-deva.js":71383,"./gom-latn":67159,"./gom-latn.js":67159,"./gu":23057,"./gu.js":23057,"./he":50506,"./he.js":50506,"./hi":62151,"./hi.js":62151,"./hr":73685,"./hr.js":73685,"./hu":90299,"./hu.js":90299,"./hy-am":73828,"./hy-am.js":73828,"./id":20339,"./id.js":20339,"./is":66646,"./is.js":66646,"./it":16612,"./it-ch":71105,"./it-ch.js":71105,"./it.js":16612,"./ja":21302,"./ja.js":21302,"./jv":3325,"./jv.js":3325,"./ka":15675,"./ka.js":15675,"./kk":50272,"./kk.js":50272,"./km":31015,"./km.js":31015,"./kn":56697,"./kn.js":56697,"./ko":81103,"./ko.js":81103,"./ku":56548,"./ku.js":56548,"./ky":39143,"./ky.js":39143,"./lb":30124,"./lb.js":30124,"./lo":37483,"./lo.js":37483,"./lt":97523,"./lt.js":97523,"./lv":80542,"./lv.js":80542,"./me":57938,"./me.js":57938,"./mi":23031,"./mi.js":23031,"./mk":58894,"./mk.js":58894,"./ml":80838,"./ml.js":80838,"./mn":86644,"./mn.js":86644,"./mr":76982,"./mr.js":76982,"./ms":38959,"./ms-my":91174,"./ms-my.js":91174,"./ms.js":38959,"./mt":73268,"./mt.js":73268,"./my":81006,"./my.js":81006,"./nb":39029,"./nb.js":39029,"./ne":92075,"./ne.js":92075,"./nl":80895,"./nl-be":12121,"./nl-be.js":12121,"./nl.js":80895,"./nn":50975,"./nn.js":50975,"./oc-lnc":22233,"./oc-lnc.js":22233,"./pa-in":81937,"./pa-in.js":81937,"./pl":23574,"./pl.js":23574,"./pt":95192,"./pt-br":93125,"./pt-br.js":93125,"./pt.js":95192,"./ro":97397,"./ro.js":97397,"./ru":28042,"./ru.js":28042,"./sd":86920,"./sd.js":86920,"./se":64945,"./se.js":64945,"./si":76725,"./si.js":76725,"./sk":47730,"./sk.js":47730,"./sl":18397,"./sl.js":18397,"./sq":17394,"./sq.js":17394,"./sr":49447,"./sr-cyrl":49655,"./sr-cyrl.js":49655,"./sr.js":49447,"./ss":7242,"./ss.js":7242,"./sv":23265,"./sv.js":23265,"./sw":43291,"./sw.js":43291,"./ta":78645,"./ta.js":78645,"./te":10011,"./te.js":10011,"./tet":13696,"./tet.js":13696,"./tg":69535,"./tg.js":69535,"./th":46680,"./th.js":46680,"./tk":916,"./tk.js":916,"./tl-ph":33231,"./tl-ph.js":33231,"./tlh":559,"./tlh.js":559,"./tr":18124,"./tr.js":18124,"./tzl":54087,"./tzl.js":54087,"./tzm":76903,"./tzm-latn":85311,"./tzm-latn.js":85311,"./tzm.js":76903,"./ug-cn":64182,"./ug-cn.js":64182,"./uk":63022,"./uk.js":63022,"./ur":74849,"./ur.js":74849,"./uz":17978,"./uz-latn":97799,"./uz-latn.js":97799,"./uz.js":17978,"./vi":97243,"./vi.js":97243,"./x-pseudo":48528,"./x-pseudo.js":48528,"./yo":42938,"./yo.js":42938,"./zh-cn":92026,"./zh-cn.js":92026,"./zh-hk":75664,"./zh-hk.js":75664,"./zh-mo":28697,"./zh-mo.js":28697,"./zh-tw":27538,"./zh-tw.js":27538};function webpackContext(e){var t=webpackContextResolve(e);return n(t)}function webpackContextResolve(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");t.code="MODULE_NOT_FOUND";throw t}return i[e]}webpackContext.keys=function webpackContextKeys(){return Object.keys(i)};webpackContext.resolve=webpackContextResolve;e.exports=webpackContext;webpackContext.id=80091},59335:(e,t,n)=>{"use strict";var i;i={value:true};n(36254);n(98138);n(90248);n(51285);n(43691);n(93003);n(13286);n(64355);n(83668);n(41322);n(4406);n(61700);n(9357);n(40915);n(72320);n(11416);n(41545);n(13741);n(70095);n(73117);n(26404);n(64555);n(84509);n(66121);n(78795);window.jQuery=n(36092);n(76527);n(13986);n(76973);n(9952);n(65545);n(49247);n(32053);n(91912);n(2928);n(57758);n(57219);n(78138);n(73720);n(90282);n(1271)},43471:()=>{}};var t={};function __webpack_require__(n){var i=t[n];if(i!==undefined){return i.exports}var o=t[n]={id:n,loaded:false,exports:{}};e[n].call(o.exports,o,o.exports,__webpack_require__);o.loaded=true;return o.exports}__webpack_require__.m=e;(()=>{var e=[];__webpack_require__.O=(t,n,i,o)=>{if(n){o=o||0;for(var s=e.length;s>0&&e[s-1][2]>o;s--)e[s]=e[s-1];e[s]=[n,i,o];return}var r=Infinity;for(var s=0;s<e.length;s++){var[n,i,o]=e[s];var a=true;for(var l=0;l<n.length;l++){if((o&1===0||r>=o)&&Object.keys(__webpack_require__.O).every((e=>__webpack_require__.O[e](n[l])))){n.splice(l--,1)}else{a=false;if(o<r)r=o}}if(a){e.splice(s--,1);var c=i();if(c!==undefined)t=c}}return t}})();(()=>{__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;__webpack_require__.d(t,{a:t});return t}})();(()=>{__webpack_require__.d=(e,t)=>{for(var n in t){if(__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)){Object.defineProperty(e,n,{enumerable:true,get:t[n]})}}}})();(()=>{__webpack_require__.g=function(){if(typeof globalThis==="object")return globalThis;try{return this||new Function("return this")()}catch(e){if(typeof window==="object")return window}}()})();(()=>{__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})();(()=>{__webpack_require__.r=e=>{if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})}})();(()=>{__webpack_require__.nmd=e=>{e.paths=[];if(!e.children)e.children=[];return e}})();(()=>{var e={179:0};__webpack_require__.O.j=t=>e[t]===0;var webpackJsonpCallback=(t,n)=>{var[i,o,s]=n;var r,a,l=0;if(i.some((t=>e[t]!==0))){for(r in o){if(__webpack_require__.o(o,r)){__webpack_require__.m[r]=o[r]}}if(s)var c=s(__webpack_require__)}if(t)t(n);for(;l<i.length;l++){a=i[l];if(__webpack_require__.o(e,a)&&e[a]){e[a][0]()}e[a]=0}return __webpack_require__.O(c)};var t=self["webpackChunksmarteditmaster"]=self["webpackChunksmarteditmaster"]||[];t.forEach(webpackJsonpCallback.bind(null,0));t.push=webpackJsonpCallback.bind(null,t.push.bind(t))})();var n=__webpack_require__.O(undefined,[200],(()=>__webpack_require__(59335)));n=__webpack_require__.O(n)})();